; "Over the Blood-Dark Sea (ZIL)"
; ---------------------------------------------------------------------------------------------

<CONSTANT GAME-TITLE "||Over the Blood-Dark Sea">
<CONSTANT GAME-DESCRIPTION "|Dave Morris and Jamie Thomson (1995)||Implemented in ZIL by SD Separa (2020)|">
<CONSTANT RELEASEID 1>
<CONSTANT IFID "28661C3E-1309-484F-92C7-C681B054D742">
<VERSION XZIP>

<SETG EXTRA-FLAGS (CACHEBIT HOUSEBIT SHACKBIT CURSEBIT DISEASEBIT POISONBIT)>

<INSERT-FILE "minilib">

<ROUTINE GO ()
	<V-VERSION>
	<TELL CR "IFID: ">
	<TELL IFID>
	<CRLF>
	<GAME-BOOK>
	<QUIT-MESSAGE>>

; "GLOBALS"
; ---------------------------------------------------------------------------------------------

<CONSTANT NONE <>>
<CONSTANT F <>>

<GLOBAL PERIOD-CR ".|">
<GLOBAL EXCLAMATION-CR "!|">

; "CHOICES"
; ---------------------------------------------------------------------------------------------

<CONSTANT SELECT-CHOICES <LTABLE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE>>
<CONSTANT TEMP-LIST <LTABLE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE NONE>>

<CONSTANT R-NONE 0> 
<CONSTANT R-TEST-ABILITY 1> ; "test ABILITY versus difficulty roll"
<CONSTANT R-RANDOM 2> ; "rolls a number of dice and choose destination based on threshold"
<CONSTANT R-CODEWORD 3> ; "presence of codeword(s)"
<CONSTANT R-CODEWORDS 4> ; "presence of codeword(s)"
<CONSTANT R-ITEM 5> ; "possession of item (s)"
<CONSTANT R-ALL 6> ; "possession of all these item (s)"
<CONSTANT R-ANY 7> ; "possession of any of the item (s)"
<CONSTANT R-MONEY 8> ; "tests ability to pay indicated amount"
<CONSTANT R-CODEWORD-ITEM 9> ; "presence of codeword and item"
<CONSTANT R-DISCHARGE 10> ; "discharge a weapon"
<CONSTANT R-TITLE 11> ; "check for presence of titles"
<CONSTANT R-VISITS 12> ; "check if location was visited multiple times, requirements format <STORY-NUMBER NUMBER-OF-VISITS NAME-OF-LOCATION>"
<CONSTANT R-RANK 13> ; "check if location was visited multiple times"
<CONSTANT R-GAIN-CODEWORD 14> ; "gain codeword (s)"
<CONSTANT R-PROFESSION 15> ; "check profession"
<CONSTANT R-DOCK 16> ; "dock at port at this port"
<CONSTANT R-LOCATION 17> ; "test current location"
<CONSTANT R-LOSE-ITEM 18> ; "lose item"
<CONSTANT R-WEAPON 19> ; "you have a weapon of a specific combat score"
<CONSTANT R-DOCKED 20> ; "you have a ship docked here"

; "No requirements"
<CONSTANT TWO-CHOICES <PLTABLE R-NONE R-NONE>>
<CONSTANT THREE-CHOICES <PLTABLE R-NONE R-NONE R-NONE>>
<CONSTANT FOUR-CHOICES <PLTABLE R-NONE R-NONE R-NONE R-NONE>>
<CONSTANT FIVE-CHOICES <PLTABLE R-NONE R-NONE R-NONE R-NONE R-NONE>>
<CONSTANT SIX-CHOICES <PLTABLE R-NONE R-NONE R-NONE R-NONE R-NONE R-NONE>>
<CONSTANT SEVEN-CHOICES <PLTABLE R-NONE R-NONE R-NONE R-NONE R-NONE R-NONE R-NONE>>
<CONSTANT EIGHT-CHOICES <PLTABLE R-NONE R-NONE R-NONE R-NONE R-NONE R-NONE R-NONE R-NONE>>

; "ABILITIES"
; ---------------------------------------------------------------------------------------------

; "ability types"
<CONSTANT ABILITY-CHARISMA 1>
<CONSTANT ABILITY-COMBAT 2>
<CONSTANT ABILITY-MAGIC 3>
<CONSTANT ABILITY-SANCTITY 4>
<CONSTANT ABILITY-SCOUTING 5>
<CONSTANT ABILITY-THIEVERY 6>
<CONSTANT ABILITY-DEFENSE 7>

; "ability labels"
<CONSTANT ABILITIES <LTABLE "CHARISMA" "COMBAT" "MAGIC" "SANCTITY" "SCOUTING" "THIEVERY" "DEFENSE">>

; "PLAYER / CHARACTER / NPC"
; ---------------------------------------------------------------------------------------------

; "Globals"

<CONSTANT LIMIT-POSSESSIONS 12>
<GLOBAL CURRENT-SHIP NONE>
<GLOBAL MONEY 0>
<GLOBAL LOST-SHARDS 0>
<GLOBAL MAX-STAMINA 9>
<GLOBAL STAMINA 0>
<GLOBAL IS-MALE T>

; "For situations that require ransom"
<GLOBAL RANSOM 0>

<GLOBAL BEST-WEAPON NONE>
<GLOBAL BEST-ARMOUR NONE>
<GLOBAL PREVIOUS-STAMINA 0>

; "Current Character"
<GLOBAL CURRENT-CHARACTER NONE>

; "GOD worshipped"
<GLOBAL GOD NONE>

; "resurrection arrangement"
<GLOBAL RESURRECTION-ARRANGEMENTS NONE>

; "diseases and aliments"
<OBJECT AILMENTS (DESC "ailments/diseases/curses") (FLAGS CONTBIT OPENBIT)>

; "object to refer to all of your money"
<OBJECT ALL-MONEY (DESC "all your money") (FLAGS TAKEBIT NDESCBIT)>

; "container for blessings"
<OBJECT BLESSINGS (DESC "blessings") (FLAGS CONTBIT OPENBIT)>

; "container for ship's cargo"
<OBJECT CARGO (DESC "cargo") (FLAGS CONTBIT OPENBIT)>

; "container for codewords"
<OBJECT CODEWORDS (DESC "codewords") (FLAGS CONTBIT OPENBIT)>

; "currency description"
<OBJECT CURRENCY (DESC "shards")>

; "lost stuff"
<OBJECT LOST-STUFF (DESC "things lost") (FLAGS CONTBIT OPENBIT)>

; "container for titles and honours acquired"
<OBJECT TITLES-AND-HONOURS (DESC "Titles and Honours") (FLAGS CONTBIT OPENBIT)>

; "container for ships owned"
<OBJECT SHIPS (DESC "ships") (FLAGS CONTBIT OPENBIT)>

; "storage and/secret caches"
<OBJECT PLAYER-STORAGE (DESC "houses/shacks/secret caches") (FLAGS CONTBIT OPENBIT)>

; "shacks"

<OBJECT SHACK-SMOGMAW
	(DESC "Shack at Smogmaw")
	(MONEY 0)
	(FLAGS CONTBIT OPENBIT SHACKBIT)>

; "houses"

<OBJECT HOUSE-VERVAYENS
	(DESC "House at Smogmaw")
	(MONEY 0)
	(FLAGS CONTBIT OPENBIT HOUSEBIT)>

; "NON-PERSON OBJECTS Properties"
; ---------------------------------------------------------------------------------------------

<PROPDEF QUANTITY -1>
<PROPDEF CHARGES -1>
<PROPDEF CONDITION -1>

<PROPDEF EFFECTS NONE>

; "STORY"
; ---------------------------------------------------------------------------------------------

<GLOBAL CURRENT-STORY NONE>
<GLOBAL PREVIOUS-STORY NONE>
<GLOBAL CONTINUE-TO-CHOICES T>
<GLOBAL RUN-ONCE F>
<GLOBAL STARTING-POINT STORY001>
<GLOBAL CURRENT-LOCATION LOCATION-OCEAN>

<CONSTANT LOCATIONS <LTABLE "the open ocean" "Braelak, the Sorcerers' Isle" "Smogmaw" "Copper Island" "Dweomer" "Fiddler's Green" "Metriciens" "the Fortress of The Reaver King" "the Island of Fire" "Vervayens" "Starspike Island" "the Unmarked Island" "the Sea of Hydras">>

<CONSTANT LOCATION-OCEAN 1>
<CONSTANT LOCATION-SORCERERS 2>
<CONSTANT LOCATION-SMOGMAW 3>
<CONSTANT LOCATION-COPPER 4>
<CONSTANT LOCATION-DWEOMER 5>
<CONSTANT LOCATION-FIDDLER 6>
<CONSTANT LOCATION-METRICIENS 7>
<CONSTANT LOCATION-REAVER 8>
<CONSTANT LOCATION-FIRE 9>
<CONSTANT LOCATION-VERVAYENS 10>
<CONSTANT LOCATION-STARSPIKE 11>
<CONSTANT LOCATION-UNMARKED 12>
<CONSTANT LOCATION-HYDRA 13>

; "Gamebook loop"
; ---------------------------------------------------------------------------------------------

<ROUTINE GAME-BOOK ("AUX" KEY)
	<INSTRUCTIONS>
	<RESET-PLAYER>
	<RESET-OBJECTS>
	<RESET-SELECTIONS>
	<RESET-STORY>
	<CHOOSE-CHARACTER>
	<SETG HERE ,STARTING-POINT>
	<REPEAT ()
		<CRLF>
		<RESET-CHOICES>
		<COND (,RUN-ONCE
			<MARK-VISITS>
			<CHECK-BACKGROUND>
		)>
		<SETG CURRENT-STORY ,HERE>
		<GOTO ,HERE>
		<MARK-LOCATION>
		<UPDATE-STATUS-LINE>
		<PRINT-SECTION>
		<CHECK-EVENTS>
		<COND (<EQUAL? ,CURRENT-STORY ,HERE>
			<CHECK-DOOM>
			<CHECK-VICTORY>
		)>
		<COND (,RUN-ONCE
			<GAIN-ITEMS>
			<GAIN-CODEWORDS>
			<GAIN-TITLES>
		)>
		<COND (,CONTINUE-TO-CHOICES
			<SET KEY <PROCESS-STORY>>
			<COND (<EQUAL? .KEY !\h !\H !\?> <DISPLAY-HELP> <PRESS-A-KEY> <SET KEY NONE>)>
			<COND (<EQUAL? .KEY !\p !\P> <DESCRIBE-PLAYER> <PRESS-A-KEY> <SET KEY NONE>)>
			<COND (<EQUAL? .KEY !\q !\Q> <CRLF> <TELL "Are you sure you want to quit the game?"> <COND(<YES?> <RETURN>)>)>
			<COND (<EQUAL? .KEY !\r !\R> <CRLF> <TELL "Restore from a previous save?"> <COND (<YES?> <COND (<NOT <RESTORE>> <EMPHASIZE "Restore failed."> <PRESS-A-KEY>)>)>)>
			<COND (<EQUAL? .KEY !\s !\S> <CRLF> <TELL "Save current progress?"> <COND (<YES?> <COND (<NOT <SAVE>> <EMPHASIZE "Save failed."> <PRESS-A-KEY>)>)>)>
			<COND (<EQUAL? .KEY !\u !\U> <USE-INVENTORY> <SET KEY NONE>)>
			<COND (<EQUAL? .KEY !\x !\X> <RETURN>)>
		)>
		<UPDATE-STATUS-LINE>
	>>

; "Gamebook Engine Routines"
; ---------------------------------------------------------------------------------------------

; "generic D6 roller"
<GLOBAL LAST-ROLL 0>

<ROUTINE ROLL-DICE ("OPT" DIE "AUX" RESULT)
	<SET RESULT 0>
	<COND (<NOT .DIE> <SET DIE 1>)>
	<DO (I 1 .DIE)
		<SET RESULT <+ .RESULT <RANDOM 6>>>
	>
	<SETG LAST-ROLL .RESULT>
	<RETURN .RESULT>>

; "Story Routines - print story, process choices, triggers"
; ---------------------------------------------------------------------------------------------

<ROUTINE CHECK-BACKGROUND ("AUX" BACKGROUND STORY)
	<SET BACKGROUND <GETP ,HERE ,P?BACKGROUND>>
	<COND (.BACKGROUND
		<SET STORY <APPLY .BACKGROUND>>
		<COND (.STORY <SETG HERE .STORY>)>
		<UPDATE-STATUS-LINE>
	)>>

<ROUTINE CHECK-DOOM ("AUX" DOOM HAS-ROYAL-RING)
	<SET DOOM <GETP ,HERE ,P?DOOM>>
	<COND (.DOOM
		<COND (,RESURRECTION-ARRANGEMENTS
			<SET HAS-ROYAL-RING <CHECK-ITEM ,ROYAL-RING>>
			<STORY-LOSE-EVERYTHING F>
			<STORY-LOSE-SHIP>
			<COND (.HAS-ROYAL-RING
				<EMPHASIZE "Through a quirk of magical fate, somehow the royal ring has travelled with you through the lands of the dead.">
				<MOVE ,ROYAL-RING ,PLAYER>
			)>
			<SETG STAMINA ,MAX-STAMINA>
			<STORY-JUMP <GETP ,RESURRECTION-ARRANGEMENTS ,P?CONTINUE>>
			<COND (<N=? ,RESURRECTION-ARRANGEMENTS ,RESURRECTION-ISLAND-REBIRTH>
				<SETG RESURRECTION-ARRANGEMENTS NONE>
			)>
		)(ELSE
			<PRINT-ENDING ,BAD-ENDING 3>G
		)>
		<SETG CONTINUE-TO-CHOICES F>
	)>>

<ROUTINE CHECK-EVENTS ("AUX" EVENTS)
	<SET EVENTS <GETP ,HERE ,P?EVENTS>>
	<COND (.EVENTS <APPLY .EVENTS>)>>

<ROUTINE CHECK-GOD (GOD)
	<RETURN <AND ,GOD <EQUAL? ,GOD .GOD>>>>

<ROUTINE CHECK-PROFESSION (IS-PROFESSION "AUX" PROFESSION)
	<SET PROFESSION <GETP ,CURRENT-CHARACTER ,P?PROFESSION>>
	<COND (.PROFESSION <RETURN <EQUAL? .IS-PROFESSION .PROFESSION>>)>
	<RETURN <EQUAL? ,CURRENT-CHARACTER .IS-PROFESSION>>>

<ROUTINE CHECK-VICTORY ("AUX" VICTORY)
	<SET VICTORY <GETP ,HERE ,P?VICTORY>>
	<COND (.VICTORY
		<COND (<EQUAL? .VICTORY T>
			<PRINT-ENDING ,GOOD-ENDING 4>
		)(ELSE
			<PRINT-ENDING .VICTORY 6>
		)>
		<SETG CONTINUE-TO-CHOICES F>
	)>>

<ROUTINE CODEWORD-JUMP (CODEWORD STORY)
	<COND (<CHECK-CODEWORD .CODEWORD> <STORY-JUMP .STORY>)>>

<ROUTINE CONTINUE-TEXT (TEXT)
	<COND (<IS-ALIVE> <TELL CR .TEXT CR>)>>

<ROUTINE GAIN-CODEWORDS ("OPT" CODEWORDS)
	<COND (<NOT .CODEWORDS> <SET CODEWORDS <GETP ,CURRENT-STORY ,P?CODEWORDS>>)>
	<GAIN-OBJECTS .CODEWORDS ,GAIN-CODEWORD>>

<ROUTINE GAIN-ITEMS ("OPT" ITEMS)
	<COND (<NOT .ITEMS> <SET ITEMS <GETP ,CURRENT-STORY ,P?ITEMS>>)>
	<GAIN-OBJECTS .ITEMS ,TAKE-ITEM>>

<ROUTINE GAIN-OBJECTS (OBJECTS GAIN-ROUTINE "AUX" COUNT)
	<COND (<NOT .OBJECTS> <RETURN>)>
	<COND (.OBJECTS
		<SET COUNT <GET .OBJECTS 0>>
		<DO (I 1 .COUNT)
			<APPLY .GAIN-ROUTINE <GET .OBJECTS .I>>
		>
	)>>

<ROUTINE GAIN-TITLES ("OPT" TITLES)
	<COND (<NOT .TITLES> <SET TITLES <GETP ,CURRENT-STORY ,P?TITLES>>)>
	<GAIN-OBJECTS .TITLES ,GAIN-TITLE>>

<ROUTINE IS-ALIVE ("OPT" THRESHOLD)
	<COND (<NOT .THRESHOLD> <SET THRESHOLD 0>)>
	<COND (<G? ,STAMINA .THRESHOLD> <RTRUE>)>
	<RFALSE>>

<ROUTINE ITEM-JUMP (ITEM STORY)
	<COND (<CHECK-ITEM .ITEM> <STORY-JUMP .STORY>)>>

<ROUTINE MARK-LOCATION ("OPT" SECTION "AUX" LOCATION)
	<COND (<NOT .SECTION> <SET .SECTION ,HERE>)>
	<SET LOCATION <GETP .SECTION ,P?LOCATION>>
	<COND (.LOCATION
		<SET-LOCATION .LOCATION>
	)>>

<ROUTINE MARK-VISITS ("OPT" SECTION VISITS)
	<COND (<NOT .SECTION> <SET .SECTION ,HERE>)>
	<SET VISITS <GETP .SECTION ,P?VISITS>>
	<COND (.VISITS
		<INC .VISITS>
		<PUTP .SECTION ,P?VISITS .VISITS>
	)>>

<ROUTINE PREVENT-DOOM ("OPT" STORY)
	<COND (<NOT .STORY> <SET STORY ,HERE>)>
	<COND (<GETP .STORY ,P?DOOM> <PUTP .STORY ,P?DOOM F>)>>

<ROUTINE PRINT-SECTION ("OPT" SECTION "AUX" TEXT)
	<COND (<NOT .SECTION> <SET SECTION ,HERE>)>
	<SET TEXT <GETP .SECTION ,P?STORY>>
	<COND (.TEXT
		<CRLF>
		<TELL .TEXT>
		<CRLF>
	)>>

<ROUTINE PROCESS-CHOICES (CHOICES "AUX" DESTINATIONS REQUIREMENTS TYPES KEY CHOICE TYPE LIST MODIFIER)
	<SET DESTINATIONS <GETP ,HERE ,P?DESTINATIONS>>
	<SET REQUIREMENTS <GETP ,HERE ,P?REQUIREMENTS>>
	<SET TYPES <GETP ,HERE ,P?TYPES>>
	<TELL CR "What will you choose? ">
	<REPEAT ()
		<REPEAT ()
			<SET KEY <INPUT 1>>
			<COND (
				<OR
					<AND <G=? .KEY !\1> <L=? .KEY !\9>>
					<AND <G=? .KEY !\A> <L=? .KEY !\J> <G? <GET .CHOICES 0> 9> <L=? <+ <- .KEY !\A> 10> <GET .CHOICES 0>>>
					<AND <G=? .KEY !\a> <L=? .KEY !\j> <G? <GET .CHOICES 0> 9> <L=? <+ <- .KEY !\a> 10> <GET .CHOICES 0>>>
					<AND <EQUAL? .KEY !\H !\h> <L? <GET .CHOICES 0> 17>>
					<EQUAL? .KEY !\? !\Q !\q !\P !\p !\R !\r !\S !\s !\U !\u>
				>
				<RETURN>
			)>
		>
		<COND (
			<OR
				<AND <G=? .KEY !\1> <L=? .KEY !\9>>
				<AND <G=? .KEY !\A> <L=? .KEY !\J> <G? <GET .CHOICES 0> 9>>
				<AND <G=? .KEY !\a> <L=? .KEY !\j> <G? <GET .CHOICES 0> 9>>
			>
			<COND (<AND <G=? .KEY !\1> <L=? .KEY !\9>> <SET CHOICE <- .KEY !\0>>)>
			<COND (<AND <G=? .KEY !\A> <L=? .KEY !\J>> <SET CHOICE <+ <- .KEY !\A> 10>>)>
			<COND (<AND <G=? .KEY !\a> <L=? .KEY !\j>> <SET CHOICE <+ <- .KEY !\a> 10>>)>
			<COND (<AND <G=? <GET .CHOICES 0> 1> <L=? .CHOICE <GET .CHOICES 0>>>
				<COND (.REQUIREMENTS <SET LIST <GET .REQUIREMENTS .CHOICE>>)>
				<COND (<AND <G=? .CHOICE 1> <L=? .CHOICE <GET .DESTINATIONS 0>> <L=? .CHOICE <GET .TYPES 0>>>
					<SET TYPE <GET .TYPES .CHOICE>>
					<COND (<EQUAL? .TYPE ,R-NONE>
						<SETG HERE <GET .DESTINATIONS .CHOICE>>
						<CRLF>
					)(<AND <EQUAL? .TYPE ,R-TEST-ABILITY> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<CRLF>
						<CRLF>
						<COND (<G? <GET .LIST 0> 2>
							<SET MODIFIER <GET .LIST 3>>
						)(ELSE
							<SET MODIFIER 0>
						)>
						<COND (<TEST-ABILITY ,CURRENT-CHARACTER <GET .LIST 1> <GET .LIST 2> .MODIFIER>
							<SETG HERE <GET <GET .DESTINATIONS .CHOICE> 1>>
						)(ELSE
							<SETG HERE <GET <GET .DESTINATIONS .CHOICE> 2>>
						)>
						<PRESS-A-KEY>
					)(<AND <EQUAL? .TYPE ,R-CODEWORD> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<COND (<CHECK-CODEWORD .LIST>
							<SETG HERE <GET .DESTINATIONS .CHOICE>>
							<CRLF>
						)(ELSE
							<HLIGHT ,H-BOLD>
							<CRLF>
							<TELL CR "You do not have " T .LIST " codeword" ,EXCLAMATION-CR>
							<HLIGHT 0>
							<PRESS-A-KEY>
						)>
					)(<AND <EQUAL? .TYPE ,R-CODEWORDS> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<COND (<CHECK-CODEWORDS .LIST>
							<SETG HERE <GET .DESTINATIONS .CHOICE>>
							<CRLF>
						)(ELSE
							<NOT-ALL-ANY ,R-ALL .LIST ,CODEWORDS>
						)>
					)(<AND <EQUAL? .TYPE ,R-ANY> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<COND (<CHECK-ANY .LIST>
							<SETG HERE <GET .DESTINATIONS .CHOICE>>
							<CRLF>
						)(ELSE
							<NOT-ALL-ANY ,R-ANY .LIST>
						)>
					)(<AND <EQUAL? .TYPE ,R-ALL> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<COND (<CHECK-ALL .LIST>
							<SETG HERE <GET .DESTINATIONS .CHOICE>>
							<CRLF>
						)(ELSE
							<NOT-ALL-ANY ,R-ALL .LIST>
						)>
					)(<AND <EQUAL? .TYPE ,R-ITEM ,R-DISCHARGE> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<COND (<CHECK-ITEM .LIST>
							<COND (<CHECK-CHARGES .LIST>
								<COND (<EQUAL? .TYPE ,R-DISCHARGE> <DISCHARGE-ITEM .LIST 1>)>
								<SETG HERE <GET .DESTINATIONS .CHOICE>>
								<CRLF>
							)(ELSE
								<NOT-CHARGED <GET .REQUIREMENTS .CHOICE>>
							)>
						)(ELSE
							<NOT-POSSESSED .LIST>
						)>
					)(<AND <EQUAL? .TYPE ,R-CODEWORD-ITEM> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<COND (<AND <CHECK-CODEWORD <GET .LIST 1>> <CHECK-ITEM <GET .LIST 2>>>
							<SETG HERE <GET .DESTINATIONS .CHOICE>>
							<CRLF>
						)(ELSE
							<HLIGHT ,H-BOLD>
							<CRLF>
							<TELL CR "You do not have " T <GET .LIST 1> " codeword or ">
							<COND (<FSET? <GET .LIST 2> ,NARTICLEBIT>
								<TELL "the">
							)(<FSET? <GET .LIST 2> ,VOWELBIT>
								<TELL "an">
							)(ELSE
								<TELL "a">
							)>
							<TELL " " D <GET .LIST 2> ,EXCLAMATION-CR>
							<HLIGHT 0>
							<PRESS-A-KEY>
						)>
					)(<AND <EQUAL? .TYPE ,R-MONEY> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<COND (<CHECK-MONEY .LIST>
							<SETG HERE <GET .DESTINATIONS .CHOICE>>
							<CRLF>
							<COND (<G? .LIST 0>
								<COST-MONEY .LIST ,TEXT-PAID>
								<PRESS-A-KEY>
							)>
						)>
					)(<AND <EQUAL? .TYPE ,R-RANK> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<COND (<CHECK-RANK .LIST>
							<SETG HERE <GET .DESTINATIONS .CHOICE>>
							<CRLF>
						)>
					)(<AND <EQUAL? .TYPE ,R-RANDOM> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<SETG HERE <PROCESS-RANDOM .LIST <GET .DESTINATIONS .CHOICE>>>
					)(<AND <EQUAL? .TYPE ,R-GAIN-CODEWORD> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<CRLF>
						<GAIN-CODEWORD .LIST>
						<PRESS-A-KEY>
						<SETG HERE <GET .DESTINATIONS .CHOICE>>
					)(<AND <EQUAL? .TYPE ,R-PROFESSION> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<COND (<CHECK-PROFESSION .LIST>
							<SETG HERE <GET .DESTINATIONS .CHOICE>>
							<CRLF>
						)(ELSE
							<CRLF>
							<CRLF>
							<HLIGHT ,H-BOLD>
							<TELL "You are not a " D .LIST ,EXCLAMATION-CR>
							<HLIGHT 0>
						)>
					)(<AND <EQUAL? .TYPE ,R-DOCK> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<CRLF>
						<COND (,CURRENT-SHIP
							<CRLF>
							<TELL "Your " D ,CURRENT-SHIP " docks at " <GET ,DOCKS .LIST> ,PERIOD-CR>
							<STORY-SET-DOCK .LIST ,CURRENT-SHIP>
							<PRESS-A-KEY>
							<SETG HERE <GET .DESTINATIONS .CHOICE>>
						)(ELSE
							<COND (<G? <COUNT-CONTAINER ,SHIPS> 0>
								<EMPHASIZE "Your ships are docked elsewhere!">
							)(ELSE
								<EMPHASIZE "You have no ship!">
							)>
						)>
					)(<AND <EQUAL? .TYPE ,R-LOCATION> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<COND (<CHECK-LOCATION .LIST>
							<SETG HERE <GET .DESTINATIONS .CHOICE>>
							<CRLF>
						)(ELSE
							<CRLF>
							<CRLF>
							<HLIGHT ,H-BOLD>
							<TELL "You are not in " <GET-LOCATION .LIST> ,EXCLAMATION-CR>
							<HLIGHT 0>
							<PRESS-A-KEY>
						)>
					)(<AND <EQUAL? .TYPE ,R-LOSE-ITEM> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<COND (<CHECK-ITEM <GET .REQUIREMENTS .CHOICE>>
							<CRLF>
							<LOSE-ITEM <GET .REQUIREMENTS .CHOICE>>
							<SETG HERE <GET .DESTINATIONS .CHOICE>>
							<CRLF>
						)(ELSE
							<NOT-POSSESSED .LIST>
						)>
					)(<AND <EQUAL? .TYPE ,R-TITLE> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<COND (<CHECK-TITLE .LIST>
							<SETG HERE <GET .DESTINATIONS .CHOICE>>
							<CRLF>
						)(ELSE
							<HLIGHT ,H-BOLD>
							<CRLF>
							<TELL CR "You are not ">
							<COND (<FSET? .LIST ,NARTICLEBIT>
								<TELL "the">
							)(<FSET? .LIST ,VOWELBIT>
								<TELL "an">
							)(ELSE
								<TELL "a">
							)>
							<TELL " " D .LIST ,EXCLAMATION-CR>
							<HLIGHT 0>
							<PRESS-A-KEY>
						)>
					)(<AND <EQUAL? .TYPE ,R-WEAPON> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<COND (<EQUAL? <FIND-BEST ,P?COMBAT ,WEAPONBIT ,PLAYER .LIST> .LIST>
							<CRLF>
							<SETG HERE <GET .DESTINATIONS .CHOICE>>
						)(ELSE
							<CRLF>
							<HLIGHT ,H-BOLD>
							<TELL CR "You do not have a weapon with +" N .LIST " COMBAT score" ,EXCLAMATION-CR>
							<HLIGHT 0>
							<PRESS-A-KEY>
						)>
					)(<AND <EQUAL? .TYPE ,R-DOCKED> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<COND (<CHECK-DOCKED .LIST>
							<COND (<N=? ,CURRENT-SHIP <CHECK-DOCKED .LIST>> <SETG CURRENT-SHIP <CHECK-DOCKED .LIST>>)>
							<SETG HERE <GET .DESTINATIONS .CHOICE>>
							<CRLF>
						)(ELSE
							<HLIGHT ,H-BOLD>
							<CRLF>
							<TELL CR "You do not have a ship docked at ">
							<TELL " " <GET ,DOCKS .LIST> ,EXCLAMATION-CR>
							<HLIGHT 0>
							<PRESS-A-KEY>
						)>
					)(<AND <EQUAL? .TYPE ,R-VISITS> .REQUIREMENTS <L=? .CHOICE <GET .REQUIREMENTS 0>>>
						<COND (<CHECK-VISITS-MORE <GET .LIST 1> <GET .LIST 2>>
							<SETG HERE <GET .DESTINATIONS .CHOICE>>
							<CRLF>
						)(ELSE
							<HLIGHT ,H-BOLD>
							<CRLF>
							<TELL CR "You do have not visited " <GET .LIST 3> " enough times" ,EXCLAMATION-CR>
							<HLIGHT 0>
							<PRESS-A-KEY>
						)>
					)>
					<RETURN>
				)(ELSE
					<CRLF>
					<TELL CR "Internal Error" ,PERIOD-CR>
					<SET KEY !\q>
					<RETURN>
				)>
			)>
		)>
		<COND (<EQUAL? .KEY !\? !\P !\p !\q !\Q !\r !\R !\s !\S !\U !\u> <CRLF> <RETURN>)>
	>
	<RETURN .KEY>>

<ROUTINE PROCESS-STORY ("AUX" COUNT CHOICES TYPES REQUIREMENTS LIST CONTINUE CHOICE CHOICE-TYPE)
	<SET CHOICES <GETP ,HERE ,P?CHOICES>>
	<SET TYPES <GETP ,HERE ,P?TYPES>>
	<SET REQUIREMENTS <GETP ,HERE ,P?REQUIREMENTS>>
	<SET CONTINUE <GETP ,HERE ,P?CONTINUE>>
	<SETG CURRENT-STORY ,HERE>
	<SETG RUN-ONCE T>
	<COND (.CHOICES
		<REPEAT ()
			<CRLF>
			<SET COUNT <GET .CHOICES 0>>
			<DO (I 1 .COUNT)
				<SET CHOICE-TYPE <GET .TYPES .I>>
				<COND (.REQUIREMENTS <SET LIST <GET .REQUIREMENTS .I>>)>
				<HLIGHT ,H-BOLD>
				<COND (<L? .I 10>
					<TELL N .I>
				)(ELSE
					<TELL C <+ !\A <- .I 10>>>
				)>
				<TELL ") ">
				<HLIGHT 0>
				<TELL <GET .CHOICES .I>>
				<COND (<AND <EQUAL? .CHOICE-TYPE ,R-TEST-ABILITY> .REQUIREMENTS> <TELL " (Difficulty: "> <HLIGHT ,H-BOLD> <TELL N <GET .LIST 2>> <HLIGHT 0> <TELL")">)>
				<COND (<AND <EQUAL? .CHOICE-TYPE ,R-ITEM ,R-CODEWORD ,R-DISCHARGE ,R-TITLE> .REQUIREMENTS> <TELL " ("> <COND (<EQUAL? .CHOICE-TYPE ,R-ITEM ,R-DISCHARGE> <HLIGHT ,H-BOLD>)(ELSE <HLIGHT ,H-ITALIC>)> <TELL D .LIST> <HLIGHT 0> <TELL ")">)>
				<COND (<AND <EQUAL? .CHOICE-TYPE ,R-CODEWORD-ITEM> .REQUIREMENTS> <TELL " (Codeword "> <HLIGHT ,H-ITALIC> <TELL D <GET .LIST 1>> <HLIGHT 0> <TELL " and "> <COND (<FSET? <GET .LIST 2> ,NARTICLEBIT> <TELL "the">)(<FSET? <GET .LIST 2> ,VOWELBIT> <TELL "an">)(ELSE TELL "a")> <TELL " "> <PRINT-ITEM <GET .LIST 2> T> <TELL ")">)>
				<COND (<AND <EQUAL? .CHOICE-TYPE ,R-MONEY> .REQUIREMENTS> <COND (<G? .LIST 0> <TELL " (" N .LIST " " D ,CURRENCY ")">)>)>
				<COND (<AND <EQUAL? .CHOICE-TYPE ,R-RANK> .REQUIREMENTS> <COND (<G? .LIST 0> <TELL " (Rank "> <HLIGHT ,H-BOLD> <TELL N .LIST> <HLIGHT 0> <TELL ")">)>)>
				<COND (<AND <EQUAL? .CHOICE-TYPE ,R-ANY> .REQUIREMENTS> <PRINT-ANY .LIST>)>
				<COND (<AND <EQUAL? .CHOICE-TYPE ,R-ALL> .REQUIREMENTS> <PRINT-ALL .LIST>)>
				<COND (<AND <EQUAL? .CHOICE-TYPE ,R-VISITS> .REQUIREMENTS> <COND (<G=? <GET .LIST 0> 3> <TELL " (visited " <GET .LIST 3> " > " N <GET .LIST 2> " times)">)>)>
				<COND (<AND <EQUAL? .CHOICE-TYPE ,R-PROFESSION> .REQUIREMENTS> <COND (<G? .LIST 0> <TELL " (" D .LIST ")">)>)>
				<COND (<AND <EQUAL? .CHOICE-TYPE ,R-DOCK> .REQUIREMENTS> <COND (<G? .LIST 0> <TELL " (ship docks at " <GET ,DOCKS .LIST> ")">)>)>
				<COND (<AND <EQUAL? .CHOICE-TYPE ,R-WEAPON> .REQUIREMENTS> <COND (<G? .LIST 0> <TELL " (COMBAT +" N .LIST ")">)>)>
				<COND (<AND <EQUAL? .CHOICE-TYPE ,R-DOCKED> .REQUIREMENTS> <COND (<G? .LIST 0> <TELL " (ship docked at " <GET ,DOCKS .LIST> ")">)>)>
				<COND (<AND <EQUAL? .CHOICE-TYPE ,R-LOSE-ITEM> .REQUIREMENTS> <TELL " (lose the ">  <PRINT-ITEM .LIST T> <TELL ")">)>
				<CRLF>
			>
			<SET CHOICE <PROCESS-CHOICES .CHOICES>>
			<COND (.CHOICE
				<COND (<AND <G=? .CHOICE !\A> <L=? .CHOICE !\Z> <G=? <GET .CHOICES 0> <+ <- .CHOICE !\A> 10>>> <SET .CHOICE NONE> <RETURN>)>
				<COND (<AND <G=? .CHOICE !\a> <L=? .CHOICE !\z> <G=? <GET .CHOICES 0> <+ <- .CHOICE !\a> 10>>> <SET .CHOICE NONE> <RETURN>)>
				<RETURN>
			)>
		>
		<COND (<EQUAL? ,CURRENT-STORY ,HERE>
			<SETG RUN-ONCE F>
		)(ELSE
			<SETG PREVIOUS-STORY ,CURRENT-STORY>
			<SETG RUN-ONCE T>
		)>
		<RETURN .CHOICE>
	)(.CONTINUE
		<SETG HERE .CONTINUE>
		<SETG PREVIOUS-STORY ,CURRENT-STORY>
		<PRESS-A-KEY>
		<SETG RUN-ONCE T>
		<RETURN>
	)>
	<RETURN !\x>>

<ROUTINE RANDOM-EVENT ("OPT" DICE (MODIFIER 0) (SILENT F) "AUX" ROLL)
	<COND (<NOT .DICE> <SET DICE 1>)>
	<EMPHASIZE ,TEXT-RANDOM-EVENT>
	<PRESS-A-KEY>
	<REPEAT ()
		<SET ROLL <ROLL-DICE .DICE>>
		<CRLF>
		<TELL "You rolled ">
		<HLIGHT ,H-BOLD>
		<TELL N .ROLL>
		<HLIGHT 0>
		<COND (<N=? .MODIFIER 0>
			<TELL " (">
			<HLIGHT ,H-BOLD>
			<COND (<G? .MODIFIER 0>
				<TELL "+">
			)>
			<TELL N .MODIFIER>
			<HLIGHT 0>
			<TELL ") = ">
			<SET .ROLL <+ .ROLL .MODIFIER>>
			<HLIGHT ,H-BOLD>
			<COND (<L? .ROLL 0> <SET .ROLL 0>)>
			<TELL N .ROLL>
			<HLIGHT 0>
		)>
		<CRLF>
		<COND (<NOT .SILENT>
			<PRESS-A-KEY>
		)>
		<COND (<NOT <PROCESS-RANDOM-BLESSING>> <RETURN>)>
	>
	<SETG LAST-ROLL .ROLL>
	<RETURN .ROLL>>

<ROUTINE STORY-JUMP (STORY)
	<COND (.STORY
		<SETG HERE .STORY>
		<SETG CONTINUE-TO-CHOICES F>
		<SETG RUN-ONCE T>
		<PRESS-A-KEY>
	)>>

<ROUTINE TITLE-JUMP (TITLE STORY "AUX")
	<COND (<CHECK-TITLE .TITLE> <STORY-JUMP .STORY>)>>

<ROUTINE TITLES-JUMP (TITLES STORY "AUX")
	<COND (<CHECK-TITLES .TITLES> <STORY-JUMP .STORY>)>>

; "Story - Choice Requirements Validations"
; ---------------------------------------------------------------------------------------------

<ROUTINE CHECK-AILMENT (DISEASE)
	<COND (<NOT .DISEASE> <RTRUE>)>
	<RETURN <IN? .DISEASE ,AILMENTS>>>

<ROUTINE CHECK-ALL (ITEMS "OPT" CONTAINER "AUX" COUNT)
	<COND (<NOT .CONTAINER> <SET CONTAINER ,PLAYER>)>
	<COND (.ITEMS
		<SET COUNT <GET .ITEMS 0>>
		<DO (I 1 .COUNT)
			<COND (<NOT <IN? <GET .ITEMS .I> .CONTAINER>> <RFALSE>)>
		>
	)>
	<RTRUE>>

<ROUTINE CHECK-ANY (ITEMS "OPT" CONTAINER "AUX" COUNT)
	<COND (<NOT .CONTAINER> <SET CONTAINER ,PLAYER>)>
	<COND (.ITEMS
		<SET COUNT <GET .ITEMS 0>>
		<DO (I 1 .COUNT)
			<COND (<IN? <GET .ITEMS .I> .CONTAINER> <RTRUE>)>
		>
		<RFALSE>
	)>
	<RTRUE>>

<ROUTINE CHECK-BLESSING (BLESS)
	<COND (<NOT .BLESS> <RTRUE>)>
	<RETURN <IN? .BLESS ,BLESSINGS>>>

<ROUTINE CHECK-CHARGES (ITEM "AUX" CHARGES)
	<COND (<NOT .ITEM> <RTRUE>)>
	<SET CHARGES <GETP .ITEM ,P?CHARGES>>
	<COND (<L? .CHARGES 0>
		<RTRUE>
	)(<G? .CHARGES 0>
		<RTRUE>
	)>
	<RFALSE>>

<ROUTINE CHECK-CODEWORD (CODEWORD)
	<COND (<NOT .CODEWORD> <RTRUE>)>
	<RETURN <IN? .CODEWORD ,CODEWORDS>>>

<ROUTINE CHECK-CODEWORDS (CODEWORDS)
	<RETURN <CHECK-ALL .CODEWORDS ,CODEWORDS>>>

<ROUTINE CHECK-CREW (THIS-CONDITION "AUX" CONDITION)
	<COND (,CURRENT-SHIP
		<SET CONDITION <GETP ,CURRENT-SHIP ,P?CONDITION>>
		<RETURN <AND <CHECK-SHIP ,CURRENT-SHIP> <G=? .CONDITION .THIS-CONDITION>>>
	)>
	<RFALSE>>

<ROUTINE CHECK-DOCKED (DOCK "AUX" SHIP RESULT)
	<SET RESULT NONE>
	<COND (<G? <COUNT-CONTAINER ,SHIPS> 0>
		<COND (,CURRENT-SHIP
			<COND (<EQUAL? <GETP ,CURRENT-SHIP ,P?DOCKED> .DOCK> <RETURN ,CURRENT-SHIP>)>
		)>
		<SET SHIP <FIRST? ,SHIPS>>
		<REPEAT ()
			<COND (<NOT .SHIP> <RETURN>)>
			<COND (<IS-DOCKED .DOCK .SHIP>
				<SET RESULT .SHIP>
				<RETURN>
			)>
			<SET .SHIP <NEXT? .SHIP>>
		>
		<RETURN .RESULT>
	)>
	<RFALSE>>

<ROUTINE CHECK-ITEM (ITEM "AUX" QUANTITY)
	<COND (<NOT .ITEM> <RTRUE>)>
	<SET QUANTITY <GETP .ITEM ,P?QUANTITY>>
	<COND (<L? .QUANTITY 0>
		<RETURN <IN? .ITEM ,PLAYER>>
	)(ELSE
		<RETURN <AND <IN? .ITEM ,PLAYER> <G? .QUANTITY 0>>>
	)>>

<ROUTINE CHECK-LOCATION (LOCATION)
	<RETURN <AND ,CURRENT-LOCATION <EQUAL? ,CURRENT-LOCATION .LOCATION>>>>

<ROUTINE CHECK-MONEY (AMOUNT)
	<COND (<OR <AND <G? .AMOUNT 0> <L? ,MONEY .AMOUNT>> <L=? ,MONEY 0>>
		<CRLF>
		<CRLF>
		<HLIGHT ,H-BOLD>
		<TELL "You do not have enough " D ,CURRENCY ,PERIOD-CR>
		<HLIGHT 0>
		<PRESS-A-KEY>
		<RFALSE>
	)>
	<RTRUE>>

<ROUTINE CHECK-RANK (LEVEL "OPT" CHARACTER "AUX" RANK)
	<COND (<NOT .CHARACTER> <SET CHARACTER ,CURRENT-CHARACTER>)>
	<SET RANK <GET-RANK .CHARACTER>>
	<COND (<AND .RANK <G=? .RANK .LEVEL>>
		<RTRUE>
	)(ELSE
		<CRLF>
		<EMPHASIZE "Your Rank is not high enough!">
		<PRESS-A-KEY>
	)>
	<RFALSE>>

<ROUTINE CHECK-SHIP (THIS-SHIP)
	<COND (,CURRENT-SHIP
		<RETURN <AND <IN? .THIS-SHIP ,SHIPS> <EQUAL? ,CURRENT-SHIP .THIS-SHIP>>>
	)>
	<RFALSE>>

<ROUTINE CHECK-STAMINA (AMOUNT)
	<COND (<G? .AMOUNT 0>
		<COND (<L=? ,STAMINA .AMOUNT>
			<CRLF>
			<EMPHASIZE "You'll die if you do that!">
			<PRESS-A-KEY>
			<RFALSE>
		)>
	)>
	<RTRUE>>

<ROUTINE CHECK-STORAGE (STORAGE)
	<COND (<NOT .STORAGE> <RTRUE>)>
	<RETURN <IN? .STORAGE ,PLAYER-STORAGE>>>

<ROUTINE CHECK-TITLE (TITLE)
	<COND (<NOT .TITLE> <RTRUE>)>
	<RETURN <IN? .TITLE ,TITLES-AND-HONOURS>>>

<ROUTINE CHECK-TITLES (TITLES "AUX" COUNT)
	<SET COUNT <GET .TITLES 0>>
	<DO (I 1 .COUNT)
		<COND (<NOT <CHECK-TITLE <GET .TITLES .I>>> <RFALSE>)>
	>
	<RTRUE>>

<ROUTINE CHECK-VISITS-EQUAL ("OPT" LOCATION COUNTER "AUX" VISITS)
	<COND (<NOT .LOCATION> <SET LOCATION ,HERE>)>
	<COND (<NOT .COUNTER> <SET .COUNTER 1>)>
	<SET VISITS <GETP .LOCATION ,P?VISITS>>
	<COND (<G=? .VISITS 0>
		<RETURN <EQUAL? .VISITS .COUNTER>>
	)>
	<RFALSE>>

<ROUTINE CHECK-VISITS-MORE ("OPT" LOCATION COUNTER "AUX" VISITS)
	<COND (<NOT .LOCATION> <SET LOCATION ,HERE>)>
	<COND (<NOT .COUNTER> <SET .COUNTER 1>)>
	<SET VISITS <GETP .LOCATION ,P?VISITS>>
	<COND (.VISITS <RETURN <G? .VISITS .COUNTER>>)>
	<RFALSE>>

<ROUTINE GET-DIFFICULTY (STORY INDEX "AUX" ODDS)
	<SET ODDS <GET <GETP .STORY ,P?REQUIREMENTS> .INDEX>>
	<RETURN <GET .ODDS 2>>>

<ROUTINE GET-RANK ("OPT" CHARACTER "AUX" (RANK 1))
	<COND (<NOT .CHARACTER> <SET CHARACTER ,CURRENT-CHARACTER>)>
	<COND (.CHARACTER <SET RANK <GETP .CHARACTER ,P?RANK>>)>
	<RETURN .RANK>>

<ROUTINE IS-DOCKED (DOCK "OPT" (SHIP NONE))
	<COND (<NOT .SHIP> <SET SHIP ,CURRENT-SHIP>)>
	<COND (.SHIP <RETURN <EQUAL? <GETP .SHIP ,P?DOCKED> .DOCK>>)>
	<RFALSE>>

<ROUTINE NOT-ALL-ANY (TYPE LIST "OPT" CONTAINER "AUX" COUNT)
	<COND (<NOT .CONTAINER> <SET CONTAINER ,PLAYER>)>
	<COND (<EQUAL? .TYPE ,R-ANY ,R-ALL>
		<SET COUNT <GET .LIST 0>>
		<HLIGHT ,H-BOLD>
		<CRLF>
		<TELL CR "You do not have ">
		<COND (<G? .COUNT 1>
			<COND (<EQUAL? .TYPE ,R-ANY>
				<TELL "any">
			)(<EQUAL? .TYPE ,R-ALL>
				<TELL "all">
			)>
			<TELL " of the">
		)(<EQUAL? .CONTAINER ,CODEWORDS>
			<TELL "the">
		)(<FSET? <GET .LIST 1> ,VOWELBIT>
			<TELL "an">
		)(ELSE
			<TELL "a">
		)>
		<TELL " ">
		<COND (<EQUAL? .CONTAINER ,CODEWORDS>
			<TELL "codeword">
			<COND (<G? .COUNT 1>
				<TELL "s">
				<HLIGHT 0>
				<PRINT-CODEWORDS .LIST>
			)(ELSE
				<TELL " ">
				<HLIGHT 0>
				<HLIGHT ,H-ITALIC>
				<TELL D <GET .LIST 1>>
				<HLIGHT 0>
				<TELL ,PERIOD-CR>
			)>
		)(ELSE
			<COND (<G? .COUNT 1>
				<TELL "items">
				<HLIGHT 0>
				<COND (<EQUAL? .TYPE ,R-ANY>
					<PRINT-ANY .LIST>
				)(<EQUAL? .TYPE ,R-ALL>
					<PRINT-ALL .LIST>
				)>
			)(ELSE
				<HLIGHT 0>
				<HLIGHT ,H-ITALIC>
				<TELL D <GET .LIST 1>>
				<HLIGHT 0>
				<TELL ,PERIOD-CR>
			)>
		)>
		<HLIGHT 0>
		<CRLF>
		<PRESS-A-KEY>
	)>>

<ROUTINE NOT-CHARGED (OBJECT)
	<CRLF>
	<CRLF>
	<HLIGHT ,H-BOLD>
	<TELL CT .OBJECT " has no charges left" ,PERIOD-CR>
	<HLIGHT 0>
	<PRESS-A-KEY>>

<ROUTINE NOT-POSSESSED (OBJECT)
	<HLIGHT ,H-BOLD>
	<CRLF>
	<TELL CR "You do not have ">
	<COND (<FSET? .OBJECT ,NARTICLEBIT>
		<TELL "the">
	)(ELSE
		<TELL "a">
		<COND (<FSET? .OBJECT ,VOWELBIT> <TELL "n">)>
	)>
	<TELL " " D .OBJECT ,EXCLAMATION-CR>
	<HLIGHT 0>
	<PRESS-A-KEY>>

<ROUTINE PROCESS-RANDOM (LIST DESTINATIONS "AUX" ODDS (EVENTS 0) RESULT (DESTINATION NONE) (MODIFIERS 0) (OUTCOMES NONE) (HAS-DESTINATION F))
	<SET ODDS <GET .LIST 3>>
	<COND (.ODDS <SET EVENTS <GET .ODDS 0>>)>
	<SET DESTINATION ,HERE>
	<CRLF>
	<COND (<G? .EVENTS 0>
		<REPEAT ()
			<SET HAS-DESTINATION F>
			<CRLF>
			<TELL "Rolling (" N <GET .LIST 1> ") and triggering events with " N .EVENTS " possible outcomes ">
			<SET MODIFIERS <GET .LIST 2>>
			<SET OUTCOMES <GET .LIST 4>>
			<COND (<N=? .MODIFIERS 0>
				<TELL "(">
				<COND (<G? .MODIFIERS 0> <TELL "+">)>
				<TELL N .MODIFIERS " to rolls)">
			)>
			<TELL ".." ,PERIOD-CR>
			<PRESS-A-KEY>
			<SET RESULT <ROLL-DICE <GET .LIST 1>>> ; "roll # of dice"
			<SET RESULT <+ .RESULT <GET .LIST 2>>> ; "add/subtract modifiers"
			<CRLF>
			<TELL "You rolled " N .RESULT "." CR>
			<SETG LAST-ROLL .RESULT>
			<DO (I 1 .EVENTS)
				<COND (<L=? .RESULT <GET .ODDS .I>>
					<SET DESTINATION <GET .DESTINATIONS .I>>
					<COND (.OUTCOMES
						<EMPHASIZE <GET .OUTCOMES .I> "Outcome">
					)>
					<PRESS-A-KEY>
					<COND (<NOT <PROCESS-RANDOM-BLESSING>>
						<SET HAS-DESTINATION T>
					)>
					<RETURN>
				)>
			>
			<COND (.HAS-DESTINATION <RETURN>)>
		>
	)>
	<RETURN .DESTINATION>>

<ROUTINE PROCESS-RANDOM-BLESSING ("AUX" RESULT)
	<SET RESULT F>
	<COND (<CHECK-BLESSING ,BLESSING-LUCK>
		<CRLF>
		<TELL "Change the outcome with " T ,BLESSING-LUCK " blessing?">
		<COND (<YES?>
			<DELETE-BLESSING ,BLESSING-LUCK>
			<SET RESULT T>
		)>
	)>
	<RETURN .RESULT>>

<ROUTINE RESET-DIFFICULTY (STORY INDEX DIFFICULTY "AUX" ODDS)
	<SET ODDS <GET <GETP .STORY ,P?REQUIREMENTS> .INDEX>>
	<PUT .ODDS 2 .DIFFICULTY>>

<ROUTINE RESET-ODDS (DICE MODIFIERS "OPT" STORY "AUX" REQUIREMENTS)
	<COND (<NOT .STORY> <SET .STORY ,HERE>)>
	<SET REQUIREMENTS <GETP .STORY ,P?REQUIREMENTS>>
	<COND (.REQUIREMENTS
		<PUT <GET .REQUIREMENTS 1> 1 .DICE>
		<PUT <GET .REQUIREMENTS 1> 2 .MODIFIERS>
	)>>

; "Story - Support Routines (display)"
; ---------------------------------------------------------------------------------------------

<ROUTINE PRINT-ALL (ITEMS)
	<PRINT-LIST .ITEMS "and ">>

<ROUTINE PRINT-ANY (ITEMS)
	<PRINT-LIST .ITEMS "or ">>

<ROUTINE PRINT-CODEWORDS (CODEWORDS)
	<PRINT-LIST .CODEWORDS "and ">>

<ROUTINE PRINT-LIST (ITEMS "OPT" LASTFIX "AUX" COUNT)
	<COND (.ITEMS
		<SET COUNT <GET .ITEMS 0>>
		<COND (<G? .COUNT 0>
			<TELL " (">
			<DO (I 1 .COUNT)
				<COND (<G? .I 1>
					<COND (<NOT <EQUAL? .COUNT 2>>
						<TELL ", ">
					)(ELSE
						<TELL " ">
					)>
				)>
				<COND (<AND <G? .COUNT 1> <EQUAL? .I .COUNT> .LASTFIX> <TELL .LASTFIX>)>
				<HLIGHT ,H-ITALIC>
				<TELL D <GET .ITEMS .I>>
				<HLIGHT 0>
			>
			<TELL ")">
		)>
	)>>

; "Choose Character / Profession"
; ---------------------------------------------------------------------------------------------

<ROUTINE CHOOSE-CHARACTER ("AUX" COUNT KEY CHOICE CHARACTER POSSESSIONS)
	<SET COUNT <GET ,CHARACTERS 0>>
	<COND (<G? .COUNT 0>
		<REPEAT ()
			<SET COUNT <GET ,CHARACTERS 0>>
			<CRLF>
			<HLIGHT ,H-BOLD>
			<TELL "Choose a character:">
			<HLIGHT 0>
			<CRLF>
			<PRINT-MENU ,CHARACTERS T F>
			<HLIGHT ,H-BOLD>
			<TELL "C">
			<HLIGHT 0>
			<TELL " - Choose a Profession" CR>
			<HLIGHT ,H-BOLD>
			<TELL "R">
			<HLIGHT 0>
			<TELL " - Restore from previous save" CR>
			<HLIGHT ,H-BOLD>
			<TELL "Q">
			<HLIGHT 0>
			<TELL " - Quit the game" CR>
			<TELL "Select which character?">
			<REPEAT ()
				<SET KEY <INPUT 1>>
				<COND (<OR <AND <G=? .KEY !\1> <L=? .KEY !\9> <L=? <- .KEY !\0> .COUNT>> <EQUAL? .KEY !\C !\c !\Q !\q !\R !\r>> <RETURN>)>
			>
			<COND (<AND <G=? .KEY !\1> <L=? .KEY !\9>>
				<SET CHOICE <- .KEY !\0>>
				<COND (<AND <G=? <GET ,CHARACTERS 0> 1> <G=? .CHOICE 1> <L=? .CHOICE <GET ,CHARACTERS 0>>>
				<SET CHARACTER <GET ,CHARACTERS .CHOICE>>
					<CRLF>
					<DESCRIBE-CHARACTER .CHARACTER>
					<CRLF>
					<TELL "Select this character?">
					<COND (<YES?>
						<SETG CURRENT-CHARACTER .CHARACTER>
						<SET POSSESSIONS <GETP .CHARACTER ,P?POSSESSIONS>>
						<COND (.POSSESSIONS
							<SET COUNT <GET .POSSESSIONS 0>>
							<DO (I 1 .COUNT)
								<MOVE <GET .POSSESSIONS .I> ,PLAYER>
							>
						)>
						<SETG CURRENT-CHARACTER .CHARACTER>
						<SETG MONEY <GETP .CHARACTER ,P?MONEY>>
						<SETG STAMINA <GETP .CHARACTER ,P?STAMINA>>
						<SETG MAX-STAMINA ,STAMINA>
						<SETG IS-MALE <GETP .CHARACTER ,P?IS-MALE>>
						<MOVE ,ALL-MONEY ,PLAYER>
						<TELL CR "You have selected " CT ,CURRENT-CHARACTER CR>
						<TELL CR "[Press a key to begin]" CR>
						<INPUT 1>
						<RETURN>
					)>
				)(ELSE
					<CRLF>
				)>
			)(<EQUAL? .KEY !\C !\c>
				<COND (<CHOOSE-PROFESSION> <RETURN>)>
			)(<EQUAL? .KEY !\R !\r>
				<COND (<NOT <RESTORE>>
					<EMPHASIZE "Restore failed.">
				)>
			)(<EQUAL? .KEY !\Q !\q>
				<CRLF>
				<TELL CR ,TEXT-SURE>
				<COND (<YES?>
					<QUIT-MESSAGE>
				)>
			)(ELSE
				<CRLF>
			)>
		>
	)>>

<ROUTINE CHOOSE-PROFESSION ("AUX" COUNT KEY CHOICE PROFESSION POSSESSIONS (RESULT F))
	<CRLF>
	<TELL CR ,INSTRUCTIONS-PROFESSIONS>
	<CRLF>
	<SET COUNT <GET ,PROFESSIONS 0>>
	<COND (<G? .COUNT 0>
		<REPEAT ()
			<SET COUNT <GET ,PROFESSIONS 0>>
			<CRLF>
			<HLIGHT ,H-BOLD>
			<TELL "Choose a professions:">
			<HLIGHT 0>
			<CRLF>
			<PRINT-MENU ,PROFESSIONS T F>
			<HLIGHT ,H-BOLD>
			<TELL "R">
			<HLIGHT 0>
			<TELL " - Return to character selection" CR>
			<HLIGHT ,H-BOLD>
			<TELL "Q">
			<HLIGHT 0>
			<TELL " - Quit the game" CR>
			<TELL "Select which profession?">
			<REPEAT ()
				<SET KEY <INPUT 1>>
				<COND (<OR <AND <G=? .KEY !\1> <L=? .KEY !\9> <L=? <- .KEY !\0> .COUNT>> <EQUAL? .KEY !\Q !\q !\R !\r>> <RETURN>)>
			>
			<COND (<AND <G=? .KEY !\1> <L=? .KEY !\9>>
				<SET CHOICE <- .KEY !\0>>
				<COND (<AND <G=? <GET ,PROFESSIONS 0> 1> <G=? .CHOICE 1> <L=? .CHOICE <GET ,PROFESSIONS 0>>>
					<SET PROFESSION <GET ,PROFESSIONS .CHOICE>>
					<CRLF>
					<DESCRIBE-CHARACTER .PROFESSION>
					<CRLF>
					<TELL "Select this profession?">
					<COND (<YES?>
						<SETG CURRENT-CHARACTER .PROFESSION>
						<SET POSSESSIONS <GETP .PROFESSION ,P?POSSESSIONS>>
						<COND (.POSSESSIONS
							<SET COUNT <GET .POSSESSIONS 0>>
							<DO (I 1 .COUNT)
								<MOVE <GET .POSSESSIONS .I> ,PLAYER>
							>
						)>
						<SETG CURRENT-CHARACTER .PROFESSION>
						<SETG MONEY <GETP .PROFESSION ,P?MONEY>>
						<SETG STAMINA <GETP .PROFESSION ,P?STAMINA>>
						<SETG MAX-STAMINA ,STAMINA>
						<MOVE ,ALL-MONEY ,PLAYER>
						<CRLF>
						<TELL "Is your character male?">
						<COND (<YES?>
							<SETG IS-MALE T>
						)(ELSE
							<SETG IS-MALE F>
						)>
						<TELL CR "You have selected " T ,CURRENT-CHARACTER CR>
						<TELL CR "[Press a key to begin]" CR>
						<INPUT 1>
						<SET RESULT T>
						<RETURN>
					)>
				)(ELSE
					<CRLF>
				)>
			)(<EQUAL? .KEY !\R !\r>
				<CRLF>
				<RETURN>
			)(<EQUAL? .KEY !\Q !\q>
				<CRLF>
				<TELL CR ,TEXT-SURE>
				<COND (<YES?> <QUIT-MESSAGE>)>
			)>
		>
	)>
	<RETURN .RESULT>>

<ROUTINE DESCRIBE-CHARACTER (CHARACTER "AUX" COUNT ITEM POSSESSIONS)
	<COND (.CHARACTER
		<CRLF>
		<HLIGHT ,H-BOLD>
		<TELL CT .CHARACTER CR>
		<HLIGHT 0>
		<COND (<GETP .CHARACTER ,P?LDESC>
			<CRLF>
			<TELL <GETP .CHARACTER ,P?LDESC> ,PERIOD-CR>
		)>
		<DESCRIBE-PLAYER-STATS .CHARACTER .CHARACTER>
		<CRLF>
		<HLIGHT ,H-BOLD>
		<TELL "Possessions: ">
		<HLIGHT 0>
		<SET POSSESSIONS <GETP .CHARACTER ,P?POSSESSIONS>>
		<COND (.POSSESSIONS
			<SET COUNT <GET .POSSESSIONS 0>>
			<COND (<G? .COUNT 0>
				<DO (I 1 .COUNT)
					<SET ITEM <GET .POSSESSIONS .I>>
					<COND (<G? .I 1> <TELL ", ">)>
					<PRINT-ITEM .ITEM>
				>
			)>
		)(ELSE
			<TELL "None">
		)>
		<CRLF>
	)>>

; "Container routines"
; ---------------------------------------------------------------------------------------------

<ROUTINE COUNT-CONTAINER (CONTAINER "OPT" (FLAG NONE) "AUX" COUNT ITEM QUANTITY REMOVE)
	<SET COUNT 0>
	<SET ITEM <FIRST? .CONTAINER>>
	<REPEAT ()
		<SET REMOVE NONE>
		<COND (<NOT .ITEM> <RETURN>)>
		<COND (<NOT <FSET? .ITEM ,NDESCBIT>>
			<COND (<OR <NOT .FLAG> <FSET? .ITEM .FLAG>>
				<SET QUANTITY <GETP .ITEM ,P?QUANTITY>>
				<COND (<G? .QUANTITY 0>
					<SET COUNT <+ .COUNT .QUANTITY>>
				)(<EQUAL? .QUANTITY 0>
					<PUTP .ITEM ,P?QUANTITY 1>
					<SET REMOVE .ITEM>
				)(ELSE
					<INC .COUNT>
				)>
			)>
		)>
		<SET ITEM <NEXT? .ITEM>>
		<COND (.REMOVE <REMOVE .REMOVE>)> ; "remove objects with 0 quantities"
	>
	<RETURN .COUNT>>

<ROUTINE PRINT-CONTAINER (CONTAINER "OPT" (FLAG NONE) "AUX" COUNT ITEMS)
	<COND (<EQUAL? .CONTAINER ,PLAYER> <FIND-BEST-GEAR>)>
	<SET COUNT 0>
	<SET ITEMS <FIRST? .CONTAINER>>
	<COND (.ITEMS
		<REPEAT ()
			<COND (.ITEMS
				<COND (<NOT <FSET? .ITEMS ,NDESCBIT>>
					<COND (.FLAG
						<COND (<FSET? .ITEMS .FLAG>
							<PRINT-ITEM .ITEMS F .COUNT>
							<INC .COUNT>
						)>
					)(ELSE
						<PRINT-ITEM .ITEMS F .COUNT>
						<INC .COUNT>
					)>
				)>
			)(ELSE
				<RETURN>
			)>
			<SET ITEMS <NEXT? .ITEMS>>
		>
	)>
	<COND (<G? .COUNT 0>
		<CRLF>
	)(ELSE
		<TELL "None" CR>
	)>>

<ROUTINE TRANSFER-CONTAINER (FROM TO "AUX" ITEM NEXT)
	<COND (<COUNT-CONTAINER .FROM>
		<SET ITEM <FIRST? .FROM>>
		<REPEAT ()
			<COND (<NOT .ITEM> <RETURN>)>
			<SET NEXT <NEXT? .ITEM>>
			<MOVE .ITEM .TO>
			<SET ITEM .NEXT>
		>
	)>>

; "Player or Item routines"
; ---------------------------------------------------------------------------------------------

<ROUTINE ADD-QUANTITY (OBJECT "OPT" AMOUNT CONTAINER (BUY F) "AUX" QUANTITY CURRENT)
	<COND (<NOT .OBJECT> <RETURN>)>
	<COND (<L=? .AMOUNT 0> <RETURN>)>
	<COND (<NOT .CONTAINER> <SET CONTAINER ,PLAYER>)>
	<COND (<EQUAL? .CONTAINER ,PLAYER>
		<COND (<G? .AMOUNT 0>
			<DO (I 1 .AMOUNT)
				<TAKE-ITEM .OBJECT>
			>
		)>
	)(ELSE
		<SET CURRENT <GETP .OBJECT ,P?QUANTITY>>
		<SET QUANTITY <+ .CURRENT .AMOUNT>>
		<PUTP .OBJECT ,P?QUANTITY .QUANTITY>
	)>>

<ROUTINE AFFLICTED-WITH (DISEASE "OPT" EFFECT)
	<COND (<NOT .EFFECT> <SET EFFECT ,TEXT-AFFLICTED>)>
	<COND (<NOT <CHECK-AILMENT .DISEASE>>
		<COND (<OR <FSET? .DISEASE ,POISONBIT> <FSET? .DISEASE ,DISEASEBIT>>
			<COND (<CHECK-BLESSING ,BLESSING-IMMUNITY-POISON-DISEASE>
				<CRLF>
				<TELL "Use the blessing ">
				<PRINT-ITEM ,BLESSING-IMMUNITY-POISON-DISEASE T>
				<TELL " to counter the ">
				<PRINT-ITEM .DISEASE T>
				<TELL "?">
				<COND (<YES?>
					<DELETE-BLESSING ,BLESSING-IMMUNITY-POISON-DISEASE>
					<RETURN>
				)>
			)>
		)>
		<CRLF>
		<TELL "You are " .EFFECT " with the ">
		<PRINT-ITEM .DISEASE T>
		<TELL ,PERIOD-CR>
		<MOVE .DISEASE ,AILMENTS>
	)>>

<ROUTINE BUY-ITEM (ITEM FEE)
	<COND (<AND <G=? ,MONEY .FEE> <NOT <CHECK-ITEM .ITEM>>>
		<CRLF>
		<TELL "Do you want to buy ">
		<PRINT-ITEM .ITEM T>
		<TELL " for ">
		<HLIGHT ,H-BOLD>
		<TELL N .FEE " shards?">
		<HLIGHT 0>
		<COND (<YES?>
			<COST-MONEY .FEE ,TEXT-PAID>
			<TAKE-ITEM .ITEM>
		)>
	)>>

<ROUTINE BUY-ITEMS (ITEM PRICE "OPT" MAX "AUX" NUMBER)
	<COND (<NOT .MAX> <SET MAX 1>)>
	<COND (<G=? ,MONEY .PRICE>
		<REPEAT ()
			<COND (<L=? ,MONEY .PRICE> <RETURN>)>
			<CRLF>
			<COND (<FSET? .ITEM ,NARTICLEBIT>
				<TELL "The">
			)(ELSE
				<TELL "A">
				<COND (<FSET? .ITEM ,VOWELBIT> <TELL "n">)>
			)>
			<TELL " ">
			<PRINT-ITEM .ITEM T>
			<TELL " sells at ">
			<HLIGHT ,H-BOLD>
			<TELL N .PRICE " " D ,CURRENCY>
			<HLIGHT 0>
			<TELL " each.">
			<SET NUMBER <GET-NUMBER "How many will you buy?" 0 .MAX>>
			<COND (<G? .NUMBER 0>
				<COND (<G=? ,MONEY <* .PRICE .NUMBER>>
					<CRLF>
					<TELL ,TEXT-SURE>
					<COND (<YES?>
						<COST-MONEY <* .PRICE .NUMBER> ,TEXT-PAID>
						<DO (I 1 .NUMBER)
							<TAKE-ITEM .ITEM T>
						>
						<COND (<G=? .NUMBER .MAX>
							<RETURN>
						)(ELSE
							<SET MAX <- .MAX .NUMBER>>
						)>
					)>
				)(ELSE
					<EMPHASIZE "You can't afford that!">
				)>
			)(ELSE
				<RETURN>
			)>
		>
	)>>

<ROUTINE COST-MONEY (COST "OPT" REASON)
	<COND (<G? .COST 0>
		<CRLF>
		<HLIGHT ,H-BOLD>
		<TELL "You ">
		<COND (.REASON
			<TELL .REASON>
		)(ELSE
			<TELL "are charged">
		)>
		<TELL " " N .COST " " D ,CURRENCY ,PERIOD-CR>
		<HLIGHT 0>
		<SETG MONEY <- ,MONEY .COST>>
		<COND (<L? ,MONEY 0> <SETG MONEY 0>)>
		<UPDATE-STATUS-LINE>
	)>>

<ROUTINE COUNT-BLESSINGS (ITEM "AUX" (ITEMS 0) (BLESSINGS 0) (PROPERTY NONE))
	<COND (.ITEM
		<SET ITEMS <GET ,ABILITIES 0>>
		<DO (I 1 .ITEMS)
			<SET PROPERTY <GET-ABILITY-PROPERTY .I>>
			<COND (<AND .PROPERTY <GETP .ITEM .PROPERTY> <G? <GETP .ITEM .PROPERTY> 0>>
				<INC .BLESSINGS>
			)>
		>
	)>
	<RETURN .BLESSINGS>>

<ROUTINE COUNT-POSSESSIONS ()
	<RETURN <COUNT-CONTAINER ,PLAYER>>>

<ROUTINE CURE-AILMENTS (FEE FLAG "OPT" (FLAG2 NONE) "AUX" COUNT)
	<COND (<NOT .FLAG> <RETURN>)>
	<COND (<G=? ,MONEY .FEE>
		<SET COUNT <COUNT-CONTAINER ,AILMENTS .FLAG>>
		<COND (.FLAG2 <SET COUNT <+ .COUNT <COUNT-CONTAINER ,AILMENTS .FLAG2>>>)>
		<COND (<G? .COUNT 0>
			<CRLF>
			<COND (<G? .FEE 0>
				<TELL "Pay ">
				<HLIGHT ,H-BOLD>
				<TELL N .FEE " " D ,CURRENCY>
				<HLIGHT 0>
			)(<EQUAL? .FEE 0>
				<TELL "Do you wish">
			)>
			<TELL " to be cured?">
			<COND (<YES?>
				<COND (<G? .FEE 0> <COST-MONEY .FEE ,TEXT-PAID>)>
				<COND (<G? <COUNT-CONTAINER ,AILMENTS .FLAG> 0>
					<CRLF>
					<TELL "You are cured of: ">
					<PRINT-CONTAINER ,AILMENTS .FLAG>
					<RESET-CONTAINER ,AILMENTS .FLAG>
				)>
				<COND (.FLAG2
					<COND (<G? <COUNT-CONTAINER ,AILMENTS .FLAG2> 0>
						<CRLF>
						<TELL "You are cured of: ">
						<PRINT-CONTAINER ,AILMENTS .FLAG2>
						<RESET-CONTAINER ,AILMENTS .FLAG2>
					)>
				)>
			)>
		)(ELSE
			<COND (<EQUAL? .FLAG ,CURSEBIT ,CURSEBIT>
				<EMPHASIZE "There are no curses to lift!">
			)(<EQUAL? .FLAG ,POISONBIT ,POISONBIT>
				<EMPHASIZE "You are not poisoned!">
			)(<EQUAL? .FLAG ,DISEASEBIT ,DISEASEBIT>
				<EMPHASIZE "There are no diseases to cure!">
			)>
		)>
	)(ELSE
		<EMPHASIZE "You cannot afford a cure at this time!">
	)>>

<ROUTINE DELETE-AILMENT (AILMENT FLAG TYPE FIX)
	<COND (<CHECK-AILMENT .AILMENT>
		<COND (<FSET? .AILMENT .FLAG>
			<CRLF>
			<TELL "The " .TYPE ": ">
			<PRINT-ITEM .AILMENT T>
			<TELL " has been " .FIX ,EXCLAMATION-CR>
			<REMOVE .AILMENT>
		)>
	)>>

<ROUTINE DELETE-BLESSING (BLESSING)
	<DELETE-OBJECT .BLESSING ,CHECK-BLESSING "blessing of">>

<ROUTINE DELETE-CODEWORD (CODEWORD)
	<DELETE-OBJECT .CODEWORD ,CHECK-CODEWORD "codeword">>

<ROUTINE DELETE-CURSE (CURSE)
	<DELETE-AILMENT .CURSE ,CURSEBIT "curse" "lifted">>

<ROUTINE DELETE-DISEASE (DISEASE)
	<DELETE-AILMENT .DISEASE ,DISEASEBIT "disease" "cured">>

<ROUTINE DELETE-POISON (POISON)
	<DELETE-AILMENT .POISON ,POISONBIT "poison" "remedied">>

<ROUTINE DELETE-TITLE (TITLE)
	<DELETE-OBJECT .TITLE ,CHECK-TITLE "title of">>

<ROUTINE DELETE-OBJECT (OBJECT CHECK-ROUTINE DESCRIPTION "OPT" (RENDER ,H-BOLD))
	<COND (<AND .OBJECT <APPLY .CHECK-ROUTINE .OBJECT>>
		<CRLF>
		<TELL "You lose the " .DESCRIPTION " ">
		<HLIGHT .RENDER>
		<TELL D .OBJECT>
		<HLIGHT 0>
		<TELL ,PERIOD-CR>
		<REMOVE .OBJECT>
	)>>

<ROUTINE DESCRIBE-INVENTORY-MAIN ("AUX" COUNT)
	<SET COUNT <COUNT-POSSESSIONS>>
	<TELL "You are carrying " N .COUNT " items">
	<COND (<G? .COUNT 0>
		<TELL ": ">
		<PRINT-CONTAINER ,PLAYER>
	)(ELSE
		<TELL ,PERIOD-CR>
	)>>

<ROUTINE DESCRIBE-INVENTORY ()
	<COND (,CURRENT-CHARACTER
		<CRLF>
		<DESCRIBE-INVENTORY-MAIN>
	)>>

<ROUTINE DESCRIBE-PLAYER ()
	<COND (,CURRENT-CHARACTER
		<DESCRIBE-PLAYER-BACKGROUND>
		<DESCRIBE-PLAYER-STATS>
		<DESCRIBE-PLAYER-LOCATION>
		<DESCRIBE-PLAYER-STORAGE>
		<DESCRIBE-PLAYER-POSSESSIONS>
		<DESCRIBE-PLAYER-CODEWORDS>
		<DESCRIBE-PLAYER-SHIPS>
		<DESCRIBE-PLAYER-TITLES>
		<DESCRIBE-PLAYER-BLESSINGS>
		<DESCRIBE-PLAYER-WORSHIP>
		<DESCRIBE-PLAYER-RESURRECTIONS>
		<DESCRIBE-PLAYER-AILMENTS>
		<DESCRIBE-PLAYER-CURRENCY>
	)>>

<ROUTINE DESCRIBE-PLAYER-AILMENTS ()
	<COND (<G? <COUNT-CONTAINER ,AILMENTS> 0>
		<HLIGHT ,H-BOLD>
		<PRINT-CAP-OBJ ,AILMENTS>
		<TELL ": ">
		<HLIGHT 0>
		<PRINT-CONTAINER ,AILMENTS>
	)>>

<ROUTINE DESCRIBE-PLAYER-BACKGROUND ()
	<CRLF>
	<HLIGHT ,H-BOLD>
	<TELL CT ,CURRENT-CHARACTER CR>
	<HLIGHT 0>
	<COND (<GETP ,CURRENT-CHARACTER ,P?LDESC>
		<CRLF>
		<TELL <GETP ,CURRENT-CHARACTER ,P?LDESC> CR>
	)>>

<ROUTINE DESCRIBE-PLAYER-BLESSINGS ()
	<COND (<G? <COUNT-CONTAINER ,BLESSINGS> 0>
		<HLIGHT ,H-BOLD>
		<PRINT-CAP-OBJ ,BLESSINGS>
		<TELL ": ">
		<HLIGHT 0>
		<PRINT-CONTAINER ,BLESSINGS>
	)>>

<ROUTINE DESCRIBE-PLAYER-CODEWORDS ()
	<COND (<G? <COUNT-CONTAINER ,CODEWORDS> 0>
		<HLIGHT ,H-BOLD>
		<PRINT-CAP-OBJ ,CODEWORDS>
		<TELL ": ">
		<HLIGHT 0>
		<PRINT-CONTAINER ,CODEWORDS>
	)>>

<ROUTINE DESCRIBE-PLAYER-CURRENCY ()
	<HLIGHT ,H-BOLD>
	<PRINT-CAP-OBJ ,CURRENCY>
	<TELL ": ">
	<HLIGHT 0>
	<TELL N ,MONEY CR>>

<ROUTINE DESCRIBE-PLAYER-LOCATION ()
	<CRLF>
	<HLIGHT ,H-BOLD>
	<TELL "Current Location: ">
	<HLIGHT 0>
	<TELL "Somewhere in " <GET-LOCATION ,CURRENT-LOCATION> CR>>

<ROUTINE DESCRIBE-PLAYER-POSSESSIONS ()
	<COND (<L=? <COUNT-CONTAINER ,PLAYER-STORAGE> 0> <CRLF>)>
	<HLIGHT ,H-BOLD>
	<TELL "Possessions: ">
	<HLIGHT 0>
	<PRINT-CONTAINER ,PLAYER>
	<COND (<OR ,BEST-ARMOUR ,BEST-WEAPON>
		<COND (,BEST-ARMOUR
			<HLIGHT ,H-BOLD>
			<TELL "Best Armour: ">
			<HLIGHT 0>
			<PRINT-ITEM ,BEST-ARMOUR>
			<COND (,BEST-WEAPON <TELL " ">)>
		)>
		<COND (,BEST-WEAPON
			<HLIGHT ,H-BOLD>
			<TELL "Best Weapon: ">
			<HLIGHT 0>
			<PRINT-ITEM ,BEST-WEAPON>
		)>
		<CRLF>
	)>>

<ROUTINE DESCRIBE-PLAYER-RESURRECTIONS ()
	<COND (,RESURRECTION-ARRANGEMENTS
		<HLIGHT ,H-BOLD>
		<TELL "Resurrection Arrangements: ">
		<HLIGHT 0>
		<TELL D ,RESURRECTION-ARRANGEMENTS>
		<CRLF>
	)>>

<ROUTINE DESCRIBE-PLAYER-STATS ("OPT" CHARACTER CONTAINER)
	<COND (<NOT .CHARACTER> <SET CHARACTER ,CURRENT-CHARACTER>)>
	<COND (<NOT .CONTAINER> <SET CONTAINER ,PLAYER>)>
	<CRLF>
	<TELL "RANK: " N <GET-RANK .CHARACTER>>
	<COND (,CURRENT-CHARACTER
		<TELL ", ">
		<HLIGHT ,H-ITALIC>
		<COND (,IS-MALE
			<TELL "Male">
		)(ELSE
			<TELL "Female">
		)>
		<HLIGHT 0>
	)>
	<CRLF>
	<COND (<GETP .CHARACTER ,P?PROFESSION>
		<TELL "PROFESSION: " D <GETP .CHARACTER ,P?PROFESSION> CR>
	)>
	<COND (<NOT ,CURRENT-CHARACTER>
		<TELL "STAMINA: " N <GETP .CHARACTER ,P?STAMINA> CR>
	)(ELSE
		<TELL "STAMINA: " N ,STAMINA CR>
	)>
	<TELL "DEFENSE: " N <CALCULATE-DEFENSE .CHARACTER .CONTAINER> CR>
	<TELL "CHARISMA: " N <CALCULATE-ABILITY .CHARACTER ,ABILITY-CHARISMA .CONTAINER> CR>
	<TELL "COMBAT: " N <CALCULATE-ABILITY .CHARACTER ,ABILITY-COMBAT .CONTAINER> CR>
	<TELL "MAGIC: " N <CALCULATE-ABILITY .CHARACTER ,ABILITY-MAGIC .CONTAINER> CR>
	<TELL "SANCTITY: " N <CALCULATE-ABILITY .CHARACTER ,ABILITY-SANCTITY .CONTAINER> CR>
	<TELL "SCOUTING: " N <CALCULATE-ABILITY .CHARACTER ,ABILITY-SCOUTING .CONTAINER> CR>
	<TELL "THIEVERY: " N <CALCULATE-ABILITY .CHARACTER ,ABILITY-THIEVERY .CONTAINER> CR>>

<ROUTINE DESCRIBE-PLAYER-SHIPS ()
	<COND (<G? <COUNT-CONTAINER ,SHIPS> 0>
		<HLIGHT ,H-BOLD>
		<PRINT-CAP-OBJ ,SHIPS>
		<TELL ": ">
		<HLIGHT 0>
		<PRINT-CONTAINER ,SHIPS>
		<HLIGHT ,H-BOLD>
		<PRINT-CAP-OBJ ,CARGO>
		<TELL ": ">
		<HLIGHT 0>
		<PRINT-CONTAINER ,CARGO>
	)>>

<ROUTINE DESCRIBE-PLAYER-TITLES ()
	<COND (<G? <COUNT-CONTAINER ,TITLES-AND-HONOURS> 0>
		<HLIGHT ,H-BOLD>
		<PRINT-CAP-OBJ ,TITLES-AND-HONOURS>
		<TELL ": ">
		<HLIGHT 0>
		<PRINT-CONTAINER ,TITLES-AND-HONOURS>
	)>>

<ROUTINE DESCRIBE-PLAYER-STORAGE ()
	<COND (<G? <COUNT-CONTAINER ,PLAYER-STORAGE> 0>
		<CRLF>
		<HLIGHT ,H-BOLD>
		<PRINT-CAP-OBJ ,PLAYER-STORAGE>
		<TELL ": ">
		<HLIGHT 0>
		<PRINT-CONTAINER ,PLAYER-STORAGE>
	)>>

<ROUTINE DESCRIBE-PLAYER-WORSHIP ()
	<COND (,GOD
	<HLIGHT ,H-BOLD>
	<TELL "God: ">
	<HLIGHT 0>
	<TELL D ,GOD>
	<CRLF>
	)>>

<ROUTINE DISCHARGE-ITEM (ITEM "OPT" AMOUNT "AUX" (CHARGES 0))
	<SET CHARGES <GETP .ITEM ,P?CHARGES>>
	<COND (<G? .CHARGES 0>
		<COND (<NOT .AMOUNT> <SET AMOUNT 1>)>
		<SET CHARGES <- .CHARGES .AMOUNT>>
		<COND (<L? .CHARGES 1> <SET CHARGES 0>)>
		<PUTP .ITEM ,P?CHARGES .CHARGES>
	)>>

<ROUTINE DROP-REPLACE-ITEM (OBJ "AUX" KEY COUNT ITEM CHOICE QUANTITY)
	<COND (<AND .OBJ <G=? <COUNT-POSSESSIONS> ,LIMIT-POSSESSIONS>>
		<REPEAT ()
			<CRLF>
			<TELL "Please choose an item to drop:" CR>
			<SET COUNT 0>
			<SET ITEM <FIRST? ,PLAYER>>
			<REPEAT ()
				<COND (<NOT .ITEM> <RETURN>)>
				<COND (<NOT <FSET? .ITEM ,NDESCBIT>>
					<INC .COUNT>
					<HLIGHT ,H-BOLD>
					<TELL N .COUNT>
					<HLIGHT 0>
					<TELL " - " T .ITEM>
					<SET QUANTITY <GETP .ITEM ,P?QUANTITY>>
					<COND (<G? .QUANTITY 0> <TELL " (" N .QUANTITY ")">)>
					<CRLF>
				)>
				<SET ITEM <NEXT? .ITEM>>
			>
			<HLIGHT ,H-BOLD>
			<TELL N <+ .COUNT 1>>
			<HLIGHT 0>
			<TELL " - drop " T .OBJ " instead" ,PERIOD-CR>
			<REPEAT ()
				<SET KEY <INPUT 1>>
				<COND (<AND <G? .KEY !\0> <L=? .KEY <+ .COUNT 49>>> <RETURN>)>
			>
			<COND (<AND <G? .KEY 48> <L? .KEY <+ .COUNT 49>>>
				<SET CHOICE <- .KEY 48>>
				<SET ITEM <GET-ITEM .CHOICE>>
				<COND (.ITEM
					<CRLF>
					<TELL "Drop " T .ITEM "?">
					<COND (<YES?>
						<HLIGHT 0>
						<TELL CR "You dropped ">
						<HLIGHT ,H-BOLD>
						<TELL T .ITEM>
						<HLIGHT 0>
						<TELL " and took ">
						<HLIGHT ,H-BOLD>
						<TELL T .OBJ>
						<HLIGHT 0>
						<TELL ,PERIOD-CR>
						<COND (<NOT <EQUAL? .ITEM .OBJ>>
							<SET QUANTITY <GETP .ITEM ,P?QUANTITY>>
							<COND (<G? .QUANTITY 0>
								<DEC .QUANTITY>
								<COND (<G? .QUANTITY 0>
									<PUTP .ITEM ,P?QUANTITY .QUANTITY>
								)(ELSE
									<PUTP .ITEM ,P?QUANTITY 1>
									<REMOVE .ITEM>
								)>
							)(<EQUAL? .QUANTITY 0>
								<PUTP .ITEM ,P?QUANTITY 1>
								<REMOVE .ITEM>
							)(ELSE
								<REMOVE .ITEM>
							)>
							<COND (<IN? .OBJ ,PLAYER>
								<SET QUANTITY <GETP .OBJ ,P?QUANTITY>>
								<COND (<G=? .QUANTITY 0> <PUTP .OBJ ,P?QUANTITY <+ .QUANTITY 1>>)>
							)>
							<MOVE .OBJ ,PLAYER>
						)>
						<RETURN>
					)>
				)>
			)(<EQUAL? .KEY <+ .COUNT 49>>
				<CRLF>
				<TELL "Drop " T .OBJ "?">
				<COND (<YES?>
					<HLIGHT 0>
					<TELL CR "You dropped ">
					<HLIGHT ,H-BOLD>
					<TELL T .OBJ>
					<HLIGHT 0>
					<TELL ,PERIOD-CR>
					<SET QUANTITY <GETP .OBJ ,P?QUANTITY>>
					<COND (<L? .QUANTITY 0> <REMOVE .OBJ>)>
					<RETURN>
				)>
			)>
		>
	)>>

<ROUTINE GAIN-BLESSING (BLESSING)
	<GAIN-OBJECT .BLESSING ,BLESSINGS "blessing" ,CHECK-BLESSING>>

<ROUTINE GAIN-CODEWORD (CODEWORD)
	<GAIN-OBJECT .CODEWORD ,CODEWORDS "codeword" ,CHECK-CODEWORD>>

<ROUTINE GAIN-MONEY (AMOUNT)
	<COND (<G? .AMOUNT 0>
		<CRLF>
		<TELL "You gain ">
		<HLIGHT ,H-BOLD>
		<TELL N .AMOUNT " " D ,CURRENCY>
		<HLIGHT 0>
		<TELL ,PERIOD-CR>
		<SETG MONEY <+ ,MONEY .AMOUNT>>
		<UPDATE-STATUS-LINE>
	)>>

<ROUTINE GAIN-OBJECT (OBJECT CONTAINER DESCRIPTION CHECK-ROUTINE)
	<COND (<NOT <APPLY .CHECK-ROUTINE .OBJECT>>
		<CRLF>
		<TELL "You gained the " .DESCRIPTION " ">
		<PRINT-ITEM .OBJECT <NOT <EQUAL? .CONTAINER ,CODEWORDS>>>
		<TELL ,PERIOD-CR>
		<MOVE .OBJECT .CONTAINER>
	)>>

<ROUTINE GAIN-RANK ("OPT" (GAIN 1) "AUX" RANK)
	<COND (,CURRENT-CHARACTER
		<CRLF>
		<SET RANK <GET-RANK ,CURRENT-CHARACTER>>
		<SET RANK <+ .RANK .GAIN>>
		<TELL "You've gained a rank! Your rank is now is now: ">
		<HLIGHT ,H-BOLD>
		<TELL N .RANK>
		<HLIGHT 0>
		<TELL ,PERIOD-CR>
		<PUTP ,CURRENT-CHARACTER ,P?RANK .RANK>
	)>>

<ROUTINE GAIN-CACHE (CACHE)
	<GAIN-OBJECT .CACHE ,PLAYER-STORAGE "secret cache" ,CHECK-STORAGE>>

<ROUTINE GAIN-STAMINA (POINTS "AUX" DIFFERENCE)
	<COND (<L? ,STAMINA ,MAX-STAMINA>
		<SET DIFFERENCE <- ,MAX-STAMINA ,STAMINA>>
		<CRLF>
		<SETG STAMINA <+ ,STAMINA .POINTS>>
		<HLIGHT ,H-BOLD>
		<TELL "You gained ">
		<COND (<G? ,STAMINA ,MAX-STAMINA>
			<SETG STAMINA ,MAX-STAMINA>
			<TELL N .DIFFERENCE>
		)(ELSE
			<TELL N .POINTS>
		)>
		<TELL " stamina" ,PERIOD-CR>
		<HLIGHT 0>
    )>>

<ROUTINE GAIN-TITLE (TITLE)
	<GAIN-OBJECT .TITLE ,TITLES-AND-HONOURS "title" ,CHECK-TITLE>>

<ROUTINE GAIN-STORAGE (SHACK)
	<GAIN-OBJECT .SHACK ,PLAYER-STORAGE "shack" ,CHECK-STORAGE>>

<ROUTINE GET-ITEM (ITEM "OPT" CONTAINER "AUX" ITEMS COUNT)
	<COND (<NOT .CONTAINER> <SET CONTAINER ,PLAYER>)>
	<COND(<AND .ITEM <G=? <COUNT-CONTAINER .CONTAINER> 0>>
		<SET COUNT 0>
		<SET ITEMS <FIRST? .CONTAINER>>
		<REPEAT ()
			<COND (.ITEMS
				<COND (<NOT <FSET? .ITEMS ,NDESCBIT>>
					<INC .COUNT>
					<COND (<EQUAL? .COUNT .ITEM> <RETURN>)>
				)>
			)(ELSE
				<RETURN>
			)>
			<SET ITEMS <NEXT? .ITEMS>>
		>
		<RETURN .ITEMS>
	)>>

<ROUTINE GET-LOCATION (LOCATION)
	<COND (<L=? .LOCATION 20>
		<RETURN <GET ,LOCATIONS .LOCATION>>
	)(<L=? .LOCATION 40>
		
	)>>

<ROUTINE GIVE-ITEM (ITEM "OPT" (SILENT F))
	<REMOVE-ITEM .ITEM "gave" F .SILENT>>

<ROUTINE KEEP-ITEM (ITEM "OPT" JUMP)
	<CRLF>
	<TELL "Keep " T .ITEM "?">
	<COND (<YES?>
		<COND (<NOT <CHECK-ITEM .ITEM>> <TAKE-ITEM .ITEM>)>
		<COND (.JUMP <STORY-JUMP .JUMP>)>
		<RTRUE>
	)>
	<COND (<CHECK-ITEM .ITEM> <LOSE-ITEM .ITEM>)>
	<RFALSE>>

<ROUTINE LOSE-ABILITY (ABILITY "OPT" LOSS "AUX" SCORE PROPERTY)
	<COND (<NOT ,CURRENT-CHARACTER> <RETURN>)>
	<COND (<NOT .LOSS> <SET LOSS 1>)>
	<SET SCORE <GET-ABILITY-SCORE ,CURRENT-CHARACTER .ABILITY>>
	<CRLF>
	<TELL "Your " <GET ,ABILITIES .ABILITY> " score has decreased from ">
	<HLIGHT ,H-BOLD>
	<TELL N .SCORE>
	<HLIGHT 0>
	<SET PROPERTY <GET-ABILITY-PROPERTY .ABILITY>>
	<TELL " to ">
	<SET SCORE <- .SCORE .LOSS>>
	<COND (<L? .SCORE 1> <SET .SCORE 1>)>
	<HLIGHT ,H-BOLD>
	<TELL N .SCORE ,EXCLAMATION-CR>
	<COND (.PROPERTY <PUTP ,CURRENT-CHARACTER .PROPERTY .SCORE>)>
	<HLIGHT 0>>

<ROUTINE LOSE-ITEM (ITEM "OPT" (SILENT F))
	<REMOVE-ITEM .ITEM "lost" F .SILENT>>

<ROUTINE LOSE-MONEY (COST)
	<COST-MONEY .COST "lose">>

<ROUTINE LOSE-STAMINA (DAMAGE MESSAGE STORY)
	<SETG STAMINA <- ,STAMINA .DAMAGE>>
	<COND (<L? ,STAMINA 0> <SETG STAMINA 0>)>
	<UPDATE-STATUS-LINE>
	<CRLF>
	<HLIGHT ,H-BOLD>
	<COND (<L? ,STAMINA 1>
		<PUTP .STORY ,P?DOOM T>
		<TELL .MESSAGE>
		<SETG CONTINUE-TO-CHOICES F>
	)(ELSE
		<PUTP .STORY ,P?DOOM F>
		<TELL "You lost " N .DAMAGE " stamina">
	)>
	<HLIGHT 0>
	<TELL ,PERIOD-CR>>

<ROUTINE LOSE-STUFF (CONTAINER LOST-CONTAINER ITEM "OPT" MAX ACTION "AUX" (COUNT 0) ITEMS)
	<COND (<NOT .MAX> <SET MAX 1>)>
	<RESET-CONTAINER .LOST-CONTAINER>
	<COND (<G? <COUNT-CONTAINER .CONTAINER> .MAX>
		<RESET-TEMP-LIST>
		<SET ITEMS <COUNT-CONTAINER .CONTAINER>>
		<DO (I 1 .ITEMS)
			<SET COUNT <+ .COUNT 1>>
			<COND (<L=? .COUNT .ITEMS>
				<PUT ,TEMP-LIST .COUNT <GET-ITEM .I .CONTAINER>>
			)>
		>
		<REPEAT ()
			<COND (.ACTION <APPLY .ACTION>)>
			<SELECT-FROM-LIST ,TEMP-LIST .COUNT .MAX .ITEM .CONTAINER "retain">
			<COND (<EQUAL? <COUNT-CONTAINER .CONTAINER> .MAX>
				<CRLF>
				<TELL "You have selected: ">
				<PRINT-CONTAINER .CONTAINER>
				<CRLF>
				<TELL "Do you agree?">
				<COND (<YES?> <RETURN>)>
			)(ELSE
				<CRLF>
				<HLIGHT ,H-BOLD>
				<TELL "You must select " N .MAX " " .ITEM>
				<COND (<G? .MAX 1> <TELL "s">)>
				<TELL ,PERIOD-CR>
				<HLIGHT 0>
			)>
		>
		<DO (I 1 .COUNT)
			<COND (<NOT <IN? <GET ,TEMP-LIST .I> .CONTAINER>>
				<MOVE <GET ,TEMP-LIST .I> .LOST-CONTAINER>
			)>
		>
	)>>

<ROUTINE POISONED-WITH (POISON)
	<AFFLICTED-WITH .POISON ,TEXT-POISONED>>

<ROUTINE PRINT-BLESSINGS (ITEM "OPT"  "AUX" (COUNT 0) (ITEMS 0) (SCORE 0) (PROPERTY NONE))
	<COND (<G? <COUNT-BLESSINGS .ITEM> 0>
		<SET ITEMS <GET ,ABILITIES 0>>
		<DO (I 1 .ITEMS)
			<SET PROPERTY <GET-ABILITY-PROPERTY .I>>
			<COND (<G? .PROPERTY 0>
				<SET SCORE <GETP .ITEM .PROPERTY>>
				<COND (<AND .SCORE <G? .SCORE 0>>
					<INC .COUNT>
					<COND (<G? .COUNT 1> <TELL ", ">)>
					<TELL "+" N .SCORE " " <GET ,ABILITIES .I>>
				)>
			)>
		>
	)>>

<ROUTINE PRINT-ITEM (ITEMS "OPT" (BOLD F) (COUNT 0) (NO-QUANTITY F) "AUX" (QUANTITY 1) CHARGES BLESSINGS (WORN F) (EFFECTS NONE) CONDITION)
	<COND (.ITEMS
		<COND (<NOT <FSET? .ITEMS ,NDESCBIT>>
			<SET BLESSINGS <COUNT-BLESSINGS .ITEMS>>
			<COND (<NOT .NO-QUANTITY> <SET QUANTITY <GETP .ITEMS ,P?QUANTITY>>)>
			<SET CHARGES <GETP .ITEMS ,P?CHARGES>>
			<SET WORN <AND <FSET? .ITEMS ,WEARBIT> <FSET? .ITEMS ,WORNBIT>>>
			<SET EFFECTS <GETP .ITEMS ,P?EFFECTS>>
			<SET CONDITION <GETP .ITEMS ,P?CONDITION>>
			<COND (<G? .COUNT 0> <TELL ", ">)>
			<COND (.BOLD <HLIGHT ,H-BOLD>)(ELSE <HLIGHT ,H-ITALIC>)>
			<TELL D .ITEMS>
			<HLIGHT 0>
			<COND (<OR <G? .BLESSINGS 0> <G? .QUANTITY 1> <G? .CHARGES 0> .WORN .EFFECTS <G=? .CONDITION 0>> <TELL " (">)>
			<COND (<G? .BLESSINGS 0> <PRINT-BLESSINGS .ITEMS>)>
			<COND (<G? .QUANTITY 1>
				<COND (<G? .BLESSINGS 0>
					<TELL ", quantity: ">
				)(<OR <G? .CHARGES 0> .WORN>
					<TELL "quantity: ">
				)>
				<TELL N .QUANTITY>
			)>
			<COND (<G=? .CHARGES 1>
				<COND (<OR <G? .BLESSINGS 0> <G? .QUANTITY 1>> <TELL ", ">)>
				<TELL "charges: " N .CHARGES>
			)>
			<COND (.WORN
				<COND (<OR <G? .BLESSINGS 0> <G? .QUANTITY 1> <G? .CHARGES 0>> <TELL ", ">)>
				<TELL "worn">
			)>
			<COND (.EFFECTS
				<COND (<OR <G? .BLESSINGS 0> <G? .QUANTITY 1> <G? .CHARGES 0> .WORN> <TELL ", ">)>
				<PRINT-MODIFIERS .ITEMS>
			)>
			<COND (<G=? .CONDITION 0>
				<COND (<OR <G? .BLESSINGS 0> <G? .QUANTITY 1> <G? .CHARGES 0> .WORN .EFFECTS> <TELL ", ">)>
				<TELL "condition: " <GET ,CONDITIONS <+ .CONDITION 1>>>
				<COND (<GETP .ITEMS ,P?DOCKED> <TELL ", docked at: " <GET ,DOCKS <GETP .ITEMS ,P?DOCKED>>>)>
			)>
			<COND (<OR <G? .BLESSINGS 0> <G? .QUANTITY 1> <G? .CHARGES 0> .WORN .EFFECTS <G=? .CONDITION 0>> <TELL ")">)>
			<COND (<G? <GETP .ITEMS ,P?MONEY> 0> <TELL " (" N <GETP .ITEMS ,P?MONEY> " " D ,CURRENCY ")">)>
		)>
	)>>

<ROUTINE PRINT-MODIFIERS (ITEM "AUX" (EFFECTS NONE) (EFFECT 0) (MODIFIERS 0))
	<COND (<NOT .ITEM> <RETURN>)>
	<SET EFFECTS <GETP .ITEM ,P?EFFECTS>>
	<COND (.EFFECTS
		<DO (I 1 6)
			<SET EFFECT <GET .EFFECTS .I>>
			<COND (<N=? .EFFECT 0>
				<COND (<G? .MODIFIERS 0> <TELL ", ">)>
				<COND (<G? .EFFECT 0> <TELL "+">)>
				<TELL N .EFFECT " " <GET ,ABILITIES .I>>
				<INC .MODIFIERS>
			)>
		>
	)>>

<ROUTINE REMOVE-ITEM (ITEM REASON "OPT" (USE-THE F) (SILENT F) "AUX" QUANTITY)
	<SET QUANTITY <GETP .ITEM ,P?QUANTITY>>
	<CRLF>
	<TELL "You " .REASON " ">
	<COND (<L? .QUANTITY 0>
		<REMOVE .ITEM>
	)(ELSE
		<COND (<G? .QUANTITY 0>
			<DEC .QUANTITY>
			<COND (<G? .QUANTITY 0>
				<PUTP .ITEM ,P?QUANTITY .QUANTITY>
			)(ELSE
				<PUTP .ITEM ,P?QUANTITY 1>
				<REMOVE .ITEM>
			)>
		)(ELSE
			<PUTP .ITEM ,P?QUANTITY 1>
			<REMOVE .ITEM>
		)>
	)>
    <COND (<OR .USE-THE <L? .QUANTITY 0>>
        <TELL "the ">
	)(ELSE
		<TELL "a">
		<COND (<FSET? .ITEM ,VOWELBIT> <TELL "n">)>
		<TELL " ">
	)>
	<PRINT-ITEM .ITEM T>
	<TELL ,PERIOD-CR>
	<COND (<NOT .SILENT> <PRESS-A-KEY>)>
	<WEAR-BEST>
	<FIND-BEST-GEAR>>

<ROUTINE RETURN-ITEM (ITEM "OPT" (SILENT F))
	<REMOVE-ITEM .ITEM "returned" T .SILENT>>

<ROUTINE SELECT-FROM-LIST (LIST ITEMS MAX "OPT" DESC CONTAINER ACTION "AUX" KEY COUNT CHOICE)
	<COND (<NOT .CONTAINER> <SET CONTAINER ,PLAYER>)>
	<COND (<NOT .ACTION> <SET ACTION "take">)>
	<SET COUNT 0>
	<COND (<NOT .DESC> <SET DESC "item">)>
	<RESET-SELECTIONS>
	<REPEAT ()
		<CRLF>
		<COND (<EQUAL? .CONTAINER ,PLAYER>
			<TELL "You are already carrying " N <COUNT-POSSESSIONS> " items in your inventory" ,PERIOD-CR>
		)>
		<TELL "You can select up to " N .MAX " " .DESC "s from:" CR>
		<DO (I 1 .ITEMS)
			<HLIGHT ,H-BOLD>
			<COND (<L? .I 10>
				<TELL N .I>
			)(ELSE
				<TELL C <+ <- .I 10> !\A>>
			)>
			<HLIGHT 0>
			<TELL " - [">
			<COND (<INTBL? <GET .LIST .I> ,SELECT-CHOICES 21> <TELL "X">)(ELSE <TELL " ">)>
			<TELL "] - ">
			<PRINT-ITEM <GET .LIST .I> T>
			<CRLF>
		>
		<HLIGHT ,H-BOLD>
		<TELL "P">
		<HLIGHT 0>
		<TELL " - View your character (" D ,CURRENT-CHARACTER ")" CR>
		<HLIGHT ,H-BOLD>
		<TELL "0">
		<HLIGHT 0>
		<TELL " - I'm alright with my choices" ,PERIOD-CR>
		<TELL "Select which " .DESC "(s) to ">
		<TELL .ACTION>
		<TELL ":" CR>
		<REPEAT ()
			<SET KEY <INPUT 1>>
			<COND (
				<OR
					<AND <G=? .KEY !\A> <L=? .KEY !\F> <L=? <+ <- .KEY !\A> 10> .ITEMS>>
					<AND <G=? .KEY !\a> <L=? .KEY !\f> <L=? <+ <- .KEY !\a> 10> .ITEMS>>
					<AND <G=? .KEY !\1> <L=? .KEY !\9> <L=? <- .KEY !\0> .ITEMS>>
					<EQUAL? .KEY !\P !\p !\0 !\?>
				>
				<RETURN>
			)>
		>
		<COND (<EQUAL? .KEY !\0>
			<COND (<L? .COUNT .MAX>
				<CRLF>
				<TELL ,TEXT-SURE>
				<COND(<YES?> <RETURN>)>
			)(ELSE
				<RETURN>
			)>
		)>
		<COND (<EQUAL? .KEY !\p !\P> <DESCRIBE-PLAYER> <PRESS-A-KEY>)>
		<COND (<EQUAL? .KEY !\?> <DISPLAY-HELP> <PRESS-A-KEY>)>
		<COND (<OR <AND <G=? .KEY !\1> <L=? .KEY !\9>> <AND <G=? .KEY !\a> <L=? .KEY !\f>> <AND <G=? .KEY !\A> <L=? .KEY !\F>>>
			<COND (<AND <G=? .KEY !\a> <L=? .KEY !\f>>
				<SET CHOICE <+ <- .KEY !\a> 10>>
			)(<AND <G=? .KEY !\A> <L=? .KEY !\F>>
				<SET CHOICE <+ <- .KEY !\A> 10>>
			)(ELSE
				<SET CHOICE <- .KEY !\0>>
			)>
			<COND (<L=? .CHOICE .ITEMS>
				<COND (<INTBL? <GET .LIST .CHOICE> ,SELECT-CHOICES 21>
					<PUT ,SELECT-CHOICES <GET-INDEX ,SELECT-CHOICES <GET .LIST .CHOICE>> NONE>
					<DEC .COUNT>
				)(ELSE
					<COND (<EQUAL? .COUNT .MAX>
						<CRLF>
						<HLIGHT ,H-BOLD>
						<TELL "You have already selected " N .MAX " " .DESC "s" ,EXCLAMATION-CR>
						<HLIGHT 0>
					)(ELSE
						<INC .COUNT>
						<PUT ,SELECT-CHOICES <GET-INDEX ,SELECT-CHOICES NONE> <GET .LIST .CHOICE>>
					)>
				)>
			)>
		)>
	>
	<COND (<G? .COUNT 0>
		<DO (I 1 20)
			<COND (<GET ,SELECT-CHOICES .I>
				<COND (<EQUAL? <GET ,SELECT-CHOICES .I> ,MONEY-BAG>
					<GAIN-MONEY <GETP <GET ,SELECT-CHOICES .I> ,P?MONEY>>
				)(<EQUAL? .CONTAINER ,PLAYER>
					<TAKE-ITEM <GET ,SELECT-CHOICES .I>>
				)(ELSE
					<MOVE <GET ,SELECT-CHOICES .I> .CONTAINER>
				)>
			)>
		>
	)>>

<ROUTINE SET-DESTINATION (STORY DESTINATION NEW)
	<PUT <GETP .STORY ,P?DESTINATIONS> .DESTINATION .NEW>>

<ROUTINE SET-LOCATION (LOCATION)
	<SETG CURRENT-LOCATION .LOCATION>>

<ROUTINE TAKE-ITEM (ITEM "OPT" (BUY F) "AUX" QUANTITY)
	<COND (.ITEM
		<CRLF>
		<COND (.BUY
			<TELL "You bought ">
		)(ELSE
			<TELL "You gained ">
		)>
		<COND (<FSET? .ITEM ,NARTICLEBIT>
			<TELL "the">
		)(ELSE
			<TELL "a">
			<COND (<FSET? .ITEM ,VOWELBIT> <TELL "n">)>
		)>
		<TELL " ">
		<PRINT-ITEM .ITEM T 0 .BUY>
		<TELL ,PERIOD-CR>
		<COND (<G=? <COUNT-POSSESSIONS> ,LIMIT-POSSESSIONS>
			<EMPHASIZE "You are carrying too many items!">
			<DROP-REPLACE-ITEM .ITEM>
		)(ELSE
			; "check if object has the QUANTITY property"
			<SET QUANTITY <GETP .ITEM ,P?QUANTITY>>
			<COND (<L? .QUANTITY 0>
				<COND (<NOT <CHECK-ITEM .ITEM>> <MOVE .ITEM ,PLAYER>)>
			)(ELSE
				<COND (<IN? .ITEM ,PLAYER>
					<PUTP .ITEM ,P?QUANTITY <+ .QUANTITY 1>>
				)(ELSE
					<PUTP .ITEM ,P?QUANTITY 1>
					<MOVE .ITEM ,PLAYER>
				)>
			)>
		)>
	)>
	<WEAR-BEST>
	<FIND-BEST-GEAR>>

<ROUTINE TAKE-QUANTITIES (OBJECT PLURAL MESSAGE "OPT" AMOUNT)
	<CRLF>
	<TELL "Take the " .PLURAL "?">
	<COND (<YES?> <ADD-QUANTITY .OBJECT <GET-NUMBER .MESSAGE 0 .AMOUNT> ,PLAYER>)>>

<ROUTINE UPGRADE-ABILITIES (POINTS "AUX" KEY ABILITY CURRENT)
	<COND (<NOT ,CURRENT-CHARACTER> <RETURN>)>
	<REPEAT ()
		<COND (<L=? .POINTS 0> <RETURN>)>
		<CRLF>
		<TELL "You have " N .POINTS " point">
		<COND (<G? .POINTS 1> <TELL "s">)>
		<TELL " to allocate:" CR>
		<DO (I 1 6)
			<HLIGHT ,H-BOLD>
			<TELL N .I>
			<HLIGHT 0>
			<TELL " - " <GET ,ABILITIES .I> " (" N <GET-ABILITY-SCORE ,CURRENT-CHARACTER .I> ")" CR>
		>
		<TELL "Select ability to improve:">
		<REPEAT ()
			<SET KEY <INPUT 1>>
			<COND (<AND <G=? .KEY !\1> <L=? .KEY !\8>> <RETURN>)>
		>
		<CRLF>
		<SET ABILITY <- .KEY !\0>>
		<SET CURRENT <GET-ABILITY-SCORE ,CURRENT-CHARACTER .ABILITY>>
		<COND (<L? .CURRENT 12>
			<CRLF>
			<TELL "Add +1 to " <GET ,ABILITIES .ABILITY> "?">
			<COND (<YES?>
				<CRLF>
				<TELL "Your ">
				<HLIGHT ,H-BOLD>
				<TELL <GET ,ABILITIES .ABILITY>>
				<HLIGHT 0>
				<TELL " score improved from ">
				<HLIGHT ,H-BOLD>
				<TELL N .CURRENT>
				<HLIGHT 0>
				<TELL " -> ">
				<HLIGHT ,H-BOLD>
				<INC .CURRENT>
				<TELL N .CURRENT ,EXCLAMATION-CR>
				<HLIGHT 0>
				<PUTP ,CURRENT-CHARACTER <GET-ABILITY-PROPERTY .ABILITY> .CURRENT>
				<DEC .POINTS>
			)>
		)(ELSE
			<CRLF>
			<TELL "Your ">
			<HLIGHT ,H-BOLD>
			<TELL <GET ,ABILITIES .ABILITY>>
			<HLIGHT 0>
			<TELL " score is already at a maximum" ,EXCLAMATION-CR>
		)>
	>>

<ROUTINE UPGRADE-ABILITY (ABILITY "OPT" UPGRADE "AUX" SCORE PROPERTY)
	<COND (<NOT ,CURRENT-CHARACTER> <RETURN>)>
	<COND (<NOT .UPGRADE> <SET UPGRADE 1>)>
	<SET SCORE <GET-ABILITY-SCORE ,CURRENT-CHARACTER .ABILITY>>
	<CRLF>
	<TELL "Your " <GET ,ABILITIES .ABILITY> " score has improved from ">
	<HLIGHT ,H-BOLD>
	<TELL N .SCORE>
	<HLIGHT 0>
	<SET PROPERTY <GET-ABILITY-PROPERTY .ABILITY>>
	<TELL " to ">
	<SET SCORE <+ .SCORE .UPGRADE>>
	<COND (<G? .SCORE 12> <SET .SCORE 12>)>
	<HLIGHT ,H-BOLD>
	<TELL N .SCORE ,EXCLAMATION-CR>
	<COND (.PROPERTY <PUTP ,CURRENT-CHARACTER .PROPERTY .SCORE>)>
	<HLIGHT 0>>

<ROUTINE UPGRADE-STAMINA ("OPT" UPGRADE)
	<COND (<NOT .UPGRADE> <SET UPGRADE 1>)>
	<CRLF>
	<TELL "You've gained ">
	<HLIGHT ,H-BOLD>
	<TELL "+" N .UPGRADE>
	<HLIGHT 0>
	<TELL " stamina permanently!" CR>
	<SETG MAX-STAMINA <+ ,MAX-STAMINA .UPGRADE>>
	<SETG STAMINA <+ ,STAMINA .UPGRADE>>
	<COND (<G? ,STAMINA ,MAX-STAMINA> <SETG STAMINA ,MAX-STAMINA>)>
	<UPDATE-STATUS-LINE>>

<ROUTINE WEAR-BEST ("AUX" ITEMS DEFENSE (SCORE 0))
	<SET ITEMS <FIRST? ,PLAYER>>
	<REPEAT ()
		<COND (<NOT .ITEMS> <RETURN>)>
		<COND (<FSET? .ITEMS ,WEARBIT>
			<FCLEAR .ITEMS ,WORNBIT>
			<SET DEFENSE <GETP .ITEMS ,P?DEFENSE>>
			<COND (<AND <G? .DEFENSE 0> <G? .DEFENSE .SCORE>>
				<SET SCORE .DEFENSE>
			)>
		)>
		<SET .ITEMS <NEXT? .ITEMS>>
	>
	<COND (<G? .SCORE 0>
		<SET ITEMS <FIRST? ,PLAYER>>
		<REPEAT ()
			<COND (<NOT .ITEMS> <RETURN>)>
			<COND (<FSET? .ITEMS ,WEARBIT>
				<SET DEFENSE <GETP .ITEMS ,P?DEFENSE>>
				<COND (<AND <G? .DEFENSE 0> <EQUAL? .DEFENSE .SCORE>>
					<FSET .ITEMS ,WORNBIT>
					<SET-BEST-GEAR .ITEMS>
					<RETURN>
				)>
			)>
			<SET .ITEMS <NEXT? .ITEMS>>
		>
	)>>

; "Story - Storm routines"
; ---------------------------------------------------------------------------------------------

<CONSTANT CHOICES-HURRICANE-STRIKES <LTABLE "The hurricane strikes.">>
<CONSTANT CHOICES-STORM-FURY <LTABLE "The storm hits with full fury. Great grey waves break across the deck.">>
<CONSTANT CHOICES-TITANIC-FURY <LTABLE "The storm hits with titanic fury, ripping huge waves out of the sea and flinging them across the deck.">>
<CONSTANT STORM-OUTCOMES <LTABLE "The ship sinks!" "The mast splits!" "You weather the storm!">>
<CONSTANT HURRICANE-ODDS <PLTABLE 5 7 19>>
<CONSTANT STORM-ODDS <PLTABLE 4 6 19>>
<CONSTANT STORY-STORM-REQUIREMENTS <LTABLE <LTABLE 1 0 STORM-ODDS STORM-OUTCOMES>>>
<CONSTANT STORY-HURRICANE-REQUIREMENTS <LTABLE <LTABLE 1 0 HURRICANE-ODDS STORM-OUTCOMES>>>
<CONSTANT TEXT-BLESSING-STORM-SAFETY "Your Safety from Storms blessing protected you">
<CONSTANT TEXT-STORM-SEA "Heavy black clouds race towards you across the sky, whipping the waves into a frenzy. The crew mutter among themselves fearfully.">
<CONSTANT TEXT-STORM-SUBSIDES "Your ship is thrown about like flotsam and jetsam. When the storm subsides, you take stock. Much has been swept overboard.||Also, the ship has been swept way off course and the mate has no idea where you are. \"We're lost at sea, Cap'n,\" he moans.">

<ROUTINE STORM-AT-SEA (STORY JUMP "AUX" (DICE 1) (ODDS NONE) (PARAMETERS NONE) (CONDITION 0))
	<COND (<NOT .STORY> <SET STORY ,HERE>)>
	<RESET-ODDS 1 0 .STORY>
	<COND (<CHECK-BLESSING ,BLESSING-SAFETY-FROM-STORMS>
		<CRLF>
		<TELL "Use the blessing ">
		<PRINT-ITEM ,BLESSING-SAFETY-FROM-STORMS T>
		<TELL " for safe passage?">
		<COND (<YES?>
			<CRLF>
			<TELL ,TEXT-BLESSING-STORM-SAFETY>
			<TELL ,PERIOD-CR>
			<DELETE-BLESSING ,BLESSING-SAFETY-FROM-STORMS>
			<STORY-JUMP .JUMP>
			<RETURN>
		)>
	)>
	<RESET-ODDS 1 0 .STORY>
	<SET ODDS <GETP .STORY ,P?REQUIREMENTS>>
	<SET PARAMETERS <GET .ODDS 1>>
	<COND (<EQUAL? ,CURRENT-SHIP ,SHIP-BRIGANTINE>
		<SET DICE 2>
	)(<EQUAL? ,CURRENT-SHIP ,SHIP-GALLEON>
		<SET DICE 3>
	)>
	<PUT .PARAMETERS 1 .DICE>
	<PUT .PARAMETERS 2 0>
	<COND (,CURRENT-SHIP
		<SET CONDITION <GETP ,CURRENT-SHIP ,P?CONDITION>>
		<COND (.CONDITION
			<COND (<EQUAL? .CONDITION ,CONDITION-EXCELLENT>
				<PUT .PARAMETERS 2 1>
			)(<EQUAL? .CONDITION ,CONDITION-POOR>
				<PUT .PARAMETERS 2 -1>
			)>
		)>
	)(ELSE
		<PUT .PARAMETERS 2 -1>
	)>>

; "Story - Merchant routines (display)"
; ---------------------------------------------------------------------------------------------

<ROUTINE MERCHANT (WARES PRICELIST "OPT" CONTAINER (SELL F) (LIMIT 0) "AUX" ITEM ITEMS KEY QUANTITY)
	<COND (<NOT .CONTAINER> <SET CONTAINER ,PLAYER>)>
	<COND (<OR <NOT .WARES> <NOT .PRICELIST>> <RETURN>)>
	<SET ITEMS <GET .WARES 0>>
	<REPEAT MAIN ()
		<CRLF>
		<COND (<NOT .SELL>
			<TELL "You can buy anything you have money for:">
		)(ELSE
			<TELL "You can sell these items at these prices if you have them:">
		)>
		<CRLF>
		<PRINT-MENU .WARES T T NONE NONE .PRICELIST T>
		<COND (<AND <L? .ITEMS 12> <EQUAL? .CONTAINER ,CARGO>>
			<HLIGHT ,H-BOLD>
			<TELL "C">
			<HLIGHT 0>
			<TELL " - View cargo">
			<COND (,CURRENT-SHIP <TELL " (" D ,CURRENT-SHIP ")">)>
			<CRLF>
		)>
		<COND (<EQUAL? .CONTAINER ,PLAYER>
			<HLIGHT ,H-BOLD>
			<TELL "P">
			<HLIGHT 0>
			<TELL " - View character">
			<COND (,CURRENT-CHARACTER <TELL " (" D ,CURRENT-CHARACTER ")">)>
			<CRLF>
		)>
		<HLIGHT ,H-BOLD>
		<TELL "0">
		<HLIGHT 0>
		<TELL " - Bye" CR>
		<TELL "You are carrying " N ,MONEY " " D ,CURRENCY ": ">
		<REPEAT ()
			<SET KEY <INPUT 1>>
			<COND (
				<OR
					<AND <EQUAL? .KEY !\c !\C> <L? .ITEMS 12> <EQUAL? .CONTAINER ,CARGO>>
					<AND <G=? .KEY !\1> <L=? .KEY !\9> <L=? <- .KEY !\0> .ITEMS>>
					<AND <G=? .KEY !\A> <L=? .KEY !\J> <G? .ITEMS 9> <L=? <+ <- .KEY !\A> 10> .ITEMS>>
					<AND <G=? .KEY !\a> <L=? .KEY !\j> <G? .ITEMS 9> <L=? <+ <- .KEY !\a> 10> .ITEMS>>
					<AND <EQUAL? .KEY !\p !\P> <EQUAL? .CONTAINER ,PLAYER>>
					<EQUAL? .KEY !\? !\0>
				>
				<RETURN>
			)>
		>
		<CRLF>
		<COND (<AND <EQUAL? .KEY !\c !\C> <EQUAL? .CONTAINER ,CARGO> <L? .ITEMS 12>>
			<TELL CR "Current designated ship: ">
			<COND (,CURRENT-SHIP <PRINT-ITEM ,CURRENT-SHIP T>)(ELSE <TELL "None">)>
			<CRLF>
			<TELL "Cargo: ">
			<PRINT-CONTAINER ,CARGO>
			<PRESS-A-KEY>
		)>
		<COND (<AND <EQUAL? .KEY !\p !\P> <EQUAL? .CONTAINER ,PLAYER>> <DESCRIBE-PLAYER> <PRESS-A-KEY>)>
		<COND (<EQUAL? .KEY !\?> <DISPLAY-HELP> <PRESS-A-KEY>)>
		<COND (
			<OR
				<AND <G=? .KEY !\1> <L=? .KEY !\9> <L=? <- .KEY !\0> .ITEMS>>
				<AND <G=? .KEY !\A> <L=? .KEY !\J> <G? .ITEMS 9> <L=? <+ <- .KEY !\A> 10> .ITEMS>>
				<AND <G=? .KEY !\a> <L=? .KEY !\j> <G? .ITEMS 9> <L=? <+ <- .KEY !\a> 10> .ITEMS>>
			>
			<COND (<AND <G=? .KEY !\1> <L=? .KEY !\9> <L=? <- .KEY !\0> .ITEMS>>
				<SET ITEM <- .KEY !\0>>
			)(<AND <G=? .KEY !\A> <L=? .KEY !\J> <G? .ITEMS 9> <L=? <+ <- .KEY !\A> 10> .ITEMS>>
				<SET ITEM <+ <- .KEY !\A> 10>>
			)(<AND <G=? .KEY !\a> <L=? .KEY !\j> <G? .ITEMS 9> <L=? <+ <- .KEY !\a> 10> .ITEMS>>
				<SET ITEM <+ <- .KEY !\a> 10>>
			)>
			<CRLF>
			<COND (<NOT .SELL>
				<COND (<AND <G? .LIMIT 0> <N=? .CONTAINER ,PLAYER> <G=? <COUNT-CONTAINER .CONTAINER> .LIMIT>>
					<HLIGHT ,H-BOLD>
					<TELL "Your " D .CONTAINER " is already at full capacity" ,EXCLAMATION-CR>
					<HLIGHT 0>
					<PRESS-A-KEY>
					<AGAIN .MAIN>
				)(<EQUAL? <GET .PRICELIST .ITEM> 0>
					<HLIGHT ,H-BOLD>
					<TELL <GET .WARES .ITEM> " not available here" ,PERIOD-CR>
					<HLIGHT 0>
					<PRESS-A-KEY>
					<AGAIN .MAIN>
				)>
				<COND (<G? <GET .PRICELIST .ITEM> 0>
					<TELL "Purchase ">
					<PRINT-ITEM <GET .WARES .ITEM> T>
					<TELL " (" N <GET .PRICELIST .ITEM> " " D ,CURRENCY ")?">
				)(<L? <GET .PRICELIST .ITEM> 0>
					<TELL "Get ">
					<PRINT-ITEM <GET .WARES .ITEM> T>
					<TELL " for free?">
				)>
			)(ELSE
				<TELL "Sell ">
				<PRINT-ITEM <GET .WARES .ITEM> T>
				<TELL " (" N <GET .PRICELIST .ITEM> " " D ,CURRENCY ")?">
			)>
			<COND (<YES?>
				<COND (<NOT .SELL>
					<CRLF>
					<COND (<L? ,MONEY <GET .PRICELIST .ITEM>>
						<TELL "You can't afford the ">
						<PRINT-ITEM <GET .WARES .ITEM> T>
						<TELL ,EXCLAMATION-CR>
						<PRESS-A-KEY>
					)(ELSE
						<COND (<FSET? <GET .WARES .ITEM> ,TAKEBIT>
							<COND (<IN? <GET .WARES .ITEM> .CONTAINER>
								<SET QUANTITY <GETP <GET .WARES .ITEM> ,P?QUANTITY>>
								<COND (<L=? .QUANTITY 0>
									<TELL "You already have the ">
									<PRINT-ITEM <GET .WARES .ITEM> T>
									<TELL ,EXCLAMATION-CR>
									<PRESS-A-KEY>
								)(ELSE
									<COND (<G? <GET .PRICELIST .ITEM> 0> <SETG MONEY <- ,MONEY <GET .PRICELIST .ITEM>>>)>
									<ADD-QUANTITY <GET .WARES .ITEM> 1 .CONTAINER T>
								)>
							)(ELSE
								<COND (<G? <GET .PRICELIST .ITEM> 0>
									<SETG MONEY <- ,MONEY <GET .PRICELIST .ITEM>>>
									<TELL "You bought ">
								)(ELSE
									<TELL "You got ">
									<GOTTEN-FREE <GET .WARES .ITEM>>
								)>
								<COND (<FSET? <GET .WARES .ITEM> ,NARTICLEBIT>
									<TELL "the">
								)(ELSE
									<TELL "a">
									<COND (<FSET? <GET .WARES .ITEM> ,VOWELBIT> <TELL "n">)>
								)>
								<TELL " ">
								<PRINT-ITEM <GET .WARES .ITEM> T>
								<TELL ,PERIOD-CR>
								<COND (<AND <EQUAL? .CONTAINER ,PLAYER> <EQUAL? <COUNT-POSSESSIONS> ,LIMIT-POSSESSIONS> <NOT <IN? <GET .WARES .ITEM> .CONTAINER>>>
									<EMPHASIZE "You are carrying too many items.">
									<DROP-REPLACE-ITEM <GET .WARES .ITEM>>
								)(ELSE
									<MOVE <GET .WARES .ITEM> .CONTAINER>
								)>
							)>
						)(ELSE
							<TELL "You can't have that" ,EXCLAMATION-CR>
							<PRESS-A-KEY>
						)>
					)>
				)(ELSE
					<COND (<OR <AND <EQUAL? .CONTAINER ,PLAYER> <CHECK-ITEM <GET .WARES .ITEM>>> <IN? <GET .WARES .ITEM> .CONTAINER>>
						<CHECK-SOLD-FREE <GET .WARES .ITEM>>
						<REMOVE-ITEM <GET .WARES .ITEM> "sold" F T>
						<SETG MONEY <+ ,MONEY <GET .PRICELIST .ITEM>>>
					)(ELSE
						<CRLF>
						<TELL "You do not have any ">
						<PRINT-ITEM <GET .WARES .ITEM> T>
						<TELL ,EXCLAMATION-CR>
						<PRESS-A-KEY>
					)>
				)>
			)>
		)>
		<UPDATE-STATUS-LINE>
		<COND (<EQUAL? .KEY !\0>
			<CRLF>
			<TELL ,TEXT-SURE>
			<COND (<YES?> <RTRUE>)>
		)>
	>>

; "Use Item - (Player inventory)"
; ---------------------------------------------------------------------------------------------

<ROUTINE USE-ANTIDOTE (ANTIDOTE DISEASE DELETE-ROUTINE)
	<COND (<AND <CHECK-ITEM .ANTIDOTE> <CHECK-AILMENT .DISEASE>>
		<CRLF>
		<TELL "Use the ">
		<PRINT-ITEM .ANTIDOTE T>
		<TELL " to ">
		<COND (<FSET? .DISEASE ,POISONBIT>
			<TELL "counter">
		)(<FSET? .DISEASE ,CURSEBIT>
			<TELL "lift">
		)(ELSE
			<TELL "cure">
		)>
		<TELL " the ">
		<PRINT-ITEM .DISEASE T>
		<TELL "?">
		<COND (<YES?>
			<REMOVE-ITEM .ANTIDOTE ,TEXT-USED T T>
			<APPLY .DELETE-ROUTINE .DISEASE>
		)>
	)(<CHECK-ITEM .ANTIDOTE>
		<CRLF>
		<HLIGHT ,H-BOLD>
		<TELL "You are not ">
		<COND (<FSET? .DISEASE ,POISONBIT>
			<TELL ,TEXT-POISONED>
		)(<FSET? .DISEASE ,CURSEBIT>
			<TELL ,TEXT-CURSED>
		)(ELSE
			<TELL ,TEXT-AFFLICTED>
		)>
		<TELL " with the " D .DISEASE>
		<TELL ,EXCLAMATION-CR>
		<HLIGHT 0>
		<CRLF>
		<TELL "Do you want to drop it instead?">
		<COND (<YES?> <REMOVE-ITEM .ANTIDOTE "dropped" T T>)>
	)(ELSE
		<CRLF>
		<HLIGHT ,H-BOLD>
		<TELL "You do not have the ">
		<HLIGHT 0>
		<PRINT-ITEM .ANTIDOTE>
		<HLIGHT ,H-BOLD>
		<TELL ,EXCLAMATION-CR>
		<HLIGHT 0>
		<PRESS-A-KEY>
	)>>

<ROUTINE USE-INVENTORY ("AUX" KEY CHOICE ITEM COUNT ACTION)
	<REPEAT ()
		<EMPHASIZE "You are carrying the following items:">
		<SET COUNT <PRINT-CONTAINER-MENU ,PLAYER>>
		<HLIGHT ,H-BOLD>
		<TELL "V">
		<HLIGHT 0>
		<TELL " - View ship manifest" CR>
		<HLIGHT ,H-BOLD>
		<TELL "0">
		<HLIGHT 0>
		<TELL " - Back" CR>
		<TELL "Select an item to use:">
		<REPEAT ()
			<SET KEY <INPUT 1>>
			<COND (
				<OR
					<AND <G=? .KEY !\1> <L=? .KEY !\9> <L=?  <- .KEY !\0>.COUNT>>
					<AND <G=? .KEY !\A> <L=? .KEY !\J> <G? .COUNT 9> <L=? <+ <- .KEY !\A> 10> .COUNT>>
					<AND <G=? .KEY !\a> <L=? .KEY !\j> <G? .COUNT 9> <L=? <+ <- .KEY !\a> 10> .COUNT>>
					<EQUAL? .KEY !\V !\v !\0>
				>
				<RETURN>
			)>
		>
		<COND (<EQUAL? .KEY !\0>
			<CRLF>
			<RETURN>
		)(<EQUAL? .KEY !\V !\v>
			<CRLF>
			<COND (<G? <COUNT-CONTAINER ,SHIPS> 0>
				<VIEW-SHIP-MANIFEST>
			)(ELSE
				<EMPHASIZE ,TEXT-NO-SHIPS>
				<PRESS-A-KEY>
			)>
		)(<OR <AND <G=? .KEY !\1> <L=? .KEY !\9> <L=?  <- .KEY !\0>.COUNT>> <AND <G=? .KEY !\A> <L=? .KEY !\J> <G? .COUNT 9> <L=? <+ <- .KEY !\A> 10> .COUNT>> <AND <G=? .KEY !\a> <L=? .KEY !\j> <G? .COUNT 9> <L=? <+ <- .KEY !\a> 10> .COUNT>>>
			<COND (<AND <G=? .KEY !\1> <L=? .KEY !\9> <L=?  <- .KEY !\0>.COUNT>>
				<SET CHOICE <- .KEY !\0>>
			)(<AND <G=? .KEY !\A> <L=? .KEY !\J> <G? .COUNT 9> <L=? <+ <- .KEY !\A> 10> .COUNT>>
				<SET CHOICE <+ <- .KEY !\A> 10>>
			)(<AND <G=? .KEY !\a> <L=? .KEY !\j> <G? .COUNT 9> <L=? <+ <- .KEY !\a> 10> .COUNT>>
				<SET CHOICE <+ <- .KEY !\a> 10>>
			)>
			<SET ITEM <GET-ITEM .CHOICE ,PLAYER>>
			<COND (.ITEM
				<SET ACTION <GETP .ITEM ,P?ACTION>>
				<COND (.ACTION
					<CRLF>
					<COND (<APPLY .ACTION> <RETURN>)>
				)(ELSE
					<CRLF>
					<TELL CR "Drop the ">
					<PRINT-ITEM .ITEM T>
					<TELL "?">
					<COND (<YES?> <REMOVE-ITEM .ITEM "dropped" T T>)>
				)>
			)>
		)>
	>>

; "Reset routines"
; ---------------------------------------------------------------------------------------------

<ROUTINE RESET-AILMENTS ()
	<RESET-CONTAINER ,AILMENTS>>

<ROUTINE RESET-BLESSINGS ()
	<RESET-CONTAINER ,BLESSINGS>>

<ROUTINE RESET-CARGO ()
	<RESET-CONTAINER ,CARGO>>

<ROUTINE RESET-CHOICES ()
	<SETG CONTINUE-TO-CHOICES T>>

<ROUTINE RESET-CODEWORDS ()
	<RESET-CONTAINER ,CODEWORDS>>

<ROUTINE RESET-CONTAINER (CONTAINER "OPT" (FLAG) "AUX" ITEM NEXT)
	<SET ITEM <FIRST? .CONTAINER>>
	<REPEAT ()
		<COND (<NOT .ITEM> <RETURN>)>
		<SET NEXT <NEXT? .ITEM>>
		<COND (.FLAG
			<COND (<FSET? .ITEM .FLAG> <REMOVE .ITEM>)>
		)(ELSE
			<REMOVE .ITEM>
		)>
		<SET ITEM .NEXT>
	>
	<COND (<EQUAL? .CONTAINER ,PLAYER>
		<MOVE ,ALL-MONEY .CONTAINER>
		<SETG BEST-WEAPON NONE>
		<SETG BEST-ARMOUR NONE>
	)>>

<ROUTINE RESET-PLAYER ()
	<SETG LAST-ROLL 0>
	<SETG CURRENT-CHARACTER NONE>
	<SETG CURRENT-SHIP NONE>
	<SETG GOD NONE>
	<SETG MAX-STAMINA 0>
	<SETG MONEY 0>
	<SETG RESURRECTION-ARRANGEMENTS NONE>
	<SETG STAMINA 0>
	<SETG RANSOM 0>
	<RESET-AILMENTS>
	<RESET-BLESSINGS>
	<RESET-CARGO>
	<RESET-CODEWORDS>
	<RESET-POSSESSIONS>
	<RESET-TITLES>
	<RESET-PLAYER-STORAGE>
	<RESET-SHIPS>>

<ROUTINE RESET-POSSESSIONS ()
	<RESET-CONTAINER ,PLAYER>>

<ROUTINE RESET-SELECTIONS ()
	<DO (I 1 20) <PUT ,SELECT-CHOICES .I NONE>>>

<ROUTINE RESET-TEMP-LIST ("AUX" ITEMS)
	<SET ITEMS <GET ,TEMP-LIST 0>>
	<DO (I 1 .ITEMS)
		<PUT ,TEMP-LIST .I NONE>
	>>

<ROUTINE RESET-TITLES ()
	<RESET-CONTAINER ,TITLES-AND-HONOURS>>

<ROUTINE RESET-PLAYER-STORAGE ()
	<RESET-CONTAINER ,PLAYER-STORAGE>>

<ROUTINE RESET-SHIPS ()
	<RESET-CONTAINER ,SHIPS>>

; "System/Utility/Miscellaneous routines"
; ---------------------------------------------------------------------------------------------

<ROUTINE EMPHASIZE (TEXT "OPT" SPEAKER)
	<COND (.TEXT
		<CRLF>
		<HLIGHT ,H-BOLD>
		<COND (<ASSIGNED? SPEAKER>
			<TELL .SPEAKER ": ">
			<HLIGHT 0>
		)>
		<TELL .TEXT>
		<HLIGHT 0>
		<CRLF>
	)>>

<ROUTINE GET-INDEX (LIST ITEM "AUX" COUNT)
	<COND (.LIST
		<SET COUNT <GET .LIST 0>>
		<DO (I 1 .COUNT)
			<COND (<EQUAL? .ITEM <GET .LIST .I>>
				<RETURN .I>
			)>
		>
	)>
	<RETURN 0>>

<ROUTINE GET-NUMBER (MESSAGE "OPT" MINIMUM MAXIMUM "AUX" COUNT)
	<REPEAT ()
		<CRLF>
		<TELL .MESSAGE>
		<COND (<AND <OR <ASSIGNED? MINIMUM> <ASSIGNED? MAXIMUM>> <G? .MAXIMUM .MINIMUM>>
			<TELL " (" N .MINIMUM "-" N .MAXIMUM ")">
		)>
		<TELL "? ">
		<READLINE>
		<COND (<EQUAL? <GETB ,LEXBUF 1> 1> <SET COUNT <CONVERT-TO-NUMBER 1 10>>
			<COND (<OR .MINIMUM .MAXIMUM>
				<COND (<AND <G=? .COUNT .MINIMUM> <L=? .COUNT .MAXIMUM>> <RETURN>)>
			)(<G? .COUNT 0>
				<RETURN>
			)>
		)>
	>
	<RETURN .COUNT>>

<ROUTINE PRESS-A-KEY ()
	<TELL CR "[Press a key to continue]" CR>
	<INPUT 1>>

<ROUTINE PRINT-CONTAINER-MENU ("OPT" CONTAINER EXIT-KEY EXIT-TEXT "AUX" ITEMS COUNT)
	<COND (<NOT .CONTAINER> <SET CONTAINER ,PLAYER>)>
	<COND (<L=? <COUNT-CONTAINER .CONTAINER> 0> <RETURN>)>
	<SET ITEMS <FIRST? .CONTAINER>>
	<SET COUNT 0>
	<REPEAT ()
		<COND (<NOT .ITEMS> <RETURN>)>
		<COND (<NOT <FSET? .ITEMS ,NDESCBIT>>
			<INC .COUNT>
			<HLIGHT ,H-BOLD>
			<COND (<L? .COUNT 10>
				<TELL N .COUNT>
			)(ELSE
				<TELL C <+ !\A <- .COUNT 10>>>
			)>
			<HLIGHT 0>
			<TELL " - ">
			<PRINT-ITEM .ITEMS>
			<CRLF>
		)>
		<SET .ITEMS <NEXT? .ITEMS>>
	>
	<COND (<AND .EXIT-KEY .EXIT-TEXT>
		<HLIGHT ,H-BOLD>
		<TELL C .EXIT-KEY>
		<HLIGHT 0>
		<TELL " - " .EXIT-TEXT>
		<CRLF>
	)>
	<RETURN .COUNT>>

<ROUTINE PRINT-MENU (CHOICES ITEM-MENU SHOW-STATS "OPT" EXIT-KEY EXIT-TEXT PRICES (NO-QUANTITY F)"AUX" ITEMS)
	<COND (<NOT .CHOICES> <RETURN>)>
	<SET ITEMS <GET .CHOICES 0>>
	<DO (I 1 .ITEMS)
		<HLIGHT ,H-BOLD>
		<COND (<L? .I 10>
			<TELL N .I>
		)(ELSE
			<TELL C <+ !\A <- .I 10>>>
		)>
		<HLIGHT 0>
		<TELL " - ">
		<COND (.ITEM-MENU
			<COND (.SHOW-STATS
				<PRINT-ITEM <GET .CHOICES .I> T 0 .NO-QUANTITY>
			)(ELSE
				<TELL D <GET .CHOICES .I>>
			)>
		)(ELSE
			<TELL <GET .CHOICES .I>>
		)>
		<COND (.PRICES
			<COND (<G? <GET .PRICES .I> 0>
				<TELL " (">
				<HLIGHT ,H-BOLD>
				<TELL N <GET .PRICES .I>>
				<HLIGHT 0>
				<TELL " " D ,CURRENCY ")">
			)>
		)>
		<CRLF>
	>
	<COND (<AND .EXIT-KEY .EXIT-TEXT>
		<HLIGHT ,H-BOLD>
		<TELL C .EXIT-KEY>
		<HLIGHT 0>
		<TELL " - " .EXIT-TEXT>
		<CRLF>
	)>>

; "Status Line routines"
; ---------------------------------------------------------------------------------------------

<ROUTINE LINE-ERASE (ROW)
	<CURSET .ROW 1>
	<DO (I <LOWCORE SCRH> 1 -1) <PRINTC !\ >>
	<CURSET .ROW 1>>

<ROUTINE UPDATE-STATUS-LINE ("AUX" WIDTH)
	<SPLIT 2>
	<SCREEN 1>
	<SET WIDTH <LOWCORE SCRH>>
	<HLIGHT ,H-INVERSE>
	<LINE-ERASE 1>
	<COND (,HERE
		<CURSET 1 1>
		<TELL D ,HERE>
		<COND (<G? <GETP ,HERE ,P?VISITS> 1>
			<TELL " (Visited " N <GETP ,HERE ,P?VISITS> " times)">
		)>
		<COND (,CURRENT-CHARACTER
			<COND (,CURRENT-SHIP <TELL " "> <PRINT-CAP-OBJ ,CURRENT-SHIP>)>
			<CURSET 1 <- .WIDTH 20>>
			<TELL "Stamina: " N ,STAMINA "/" N ,MAX-STAMINA>
			<LINE-ERASE 2>
			<CURSET 2 1>
			<PRINT-CAP-OBJ ,CURRENT-CHARACTER>
			<CURSET 2 <- .WIDTH 20>>
			<PRINT-CAP-OBJ ,CURRENCY>
			<COND (<G? ,MONEY 9999>
				<TELL ": lots">
			)(ELSE
				<TELL ": " N ,MONEY>
			)>
		)>
	)>
	<SCREEN 0>
	<HLIGHT 0>>

; "Gamebook loop routines"
; ---------------------------------------------------------------------------------------------

<ROUTINE GAMES-UP ("OPT" TEXT "AUX" W)
	<COND (.TEXT <TELL .TEXT CR>)>
	<CRLF>
	<PRINT-GAME-OVER>
	<CRLF>
	<REPEAT PROMPT ()
		<PRINTI "Would you like to RESTART or QUIT? > ">
		<REPEAT ()
			<READLINE>
			<SET W <AND <GETB ,LEXBUF 1> <GET ,LEXBUF 1>>>
			<COND (<EQUAL? .W ,W?RESTART>
				<RESTART>
			)(<EQUAL? .W ,W?QUIT>
				<QUIT-MESSAGE>
			)(T
				<TELL CR "(Please type RESTART or QUIT) > ">
			)>
		>
	>>

<ROUTINE PRINT-ENDING (MESSAGE "OPT" COLOR)
	<COND (<NOT .COLOR> <SET COLOR 1>)>
	<CRLF>
	<HLIGHT ,H-BOLD>
	<COLOR .COLOR 0>
	<TELL .MESSAGE>
	<COLOR 1 0>
	<HLIGHT 0>
	<GAMES-UP>>

<ROUTINE QUIT-MESSAGE ()
	<TELL CR "Thanks for playing" ,PERIOD-CR>
	<QUIT>>

; "Characters for Over the Blood-Dark Sea"
; ---------------------------------------------------------------------------------------------

<CONSTANT CHARACTERS <PLTABLE CHARACTER-JALUDA CHARACTER-ARCADIA CHARACTER-DAMONTIR CHARACTER-SILAS CHARACTER-GREYMALKIN CHARACTER-VARKUNG>>
<CONSTANT PROFESSIONS <PLTABLE PROFESSION-PRIEST PROFESSION-MAGE PROFESSION-ROGUE PROFESSION-TROUBADOUR PROFESSION-WARRIOR PROFESSION-WAYFARER>>

<OBJECT CHARACTER-JALUDA
	(DESC "Jaluda The Black")
	(LDESC "Jaluda is a ruthlessly clever fighter who believes herself more than a match for any man. Those who have sailed with her describe this fearsome amazon as fiery and proud, not one to forget either a favour or a slight. She bears a mortal grudge against Amcha, the pirate king")
	(RANK 3)
	(PROFESSION PROFESSION-WARRIOR)
	(STAMINA 16)
	(MONEY 40)
	(CHARISMA 4)
	(COMBAT 7)
	(MAGIC 2)
	(SANCTITY 5)
	(SCOUTING 4)
	(THIEVERY 5)
	(POSSESSIONS <PLTABLE SWORD CHAIN-MAIL MAP>)
	(IS-MALE F)
	(FLAGS PERSONBIT NARTICLEBIT)>

<OBJECT CHARACTER-ARCADIA
	(DESC "Arcadia Ego")
	(LDESC "Arcadia is a young woman whose purity of spirit enables her to hear the murmuring of the gods in her dreams. Cast out by her family because they disapproved of her unworldly ways, she has dedicated her life to the quest for spiritual enlightenment. She is curious about the gods of Ankon-Konu, of which she knows little, and so plans a visit to Smogmaw in the near future")
	(RANK 3)
	(PROFESSION PROFESSION-PRIEST)
	(STAMINA 16)
	(MONEY 40)
	(CHARISMA 5)
	(COMBAT 3)
	(MAGIC 4)
	(SANCTITY 7)
	(SCOUTING 5)
	(THIEVERY 2)
	(POSSESSIONS <PLTABLE SWORD CHAIN-MAIL MAP>)
	(IS-MALE F)
	(FLAGS PERSONBIT NARTICLEBIT)>

<OBJECT CHARACTER-DAMONTIR
	(DESC "Damontir The Mad")
	(LDESC "Haunted by memories of a former life in which he wielded great power, Damontir would willingly pledge his lifeblood to the demons of darkness if he stood to gain a snippet of magical lore. Power is his only goal, and so his primary objective is to enrol at one of the sorcerous academies in Dweomer")
	(RANK 3)
	(PROFESSION PROFESSION-MAGE)
	(STAMINA 16)
	(MONEY 40)
	(CHARISMA 3)
	(COMBAT 3)
	(MAGIC 7)
	(SANCTITY 1)
	(SCOUTING 6)
	(THIEVERY 4)
	(POSSESSIONS <PLTABLE SWORD CHAIN-MAIL MAP>)
	(IS-MALE T)
	(FLAGS PERSONBIT NARTICLEBIT)>

<OBJECT CHARACTER-SILAS
	(DESC "Silas Cumberbatch")
	(LDESC "After a short spell in the Yellowport militia (he mistakenly enlisted thinking he was joining a queue for alms), Silas signed on aboard a merchantman bound for Metriciens. He found that the fresh breeze and the open sea inspired his ballads, and resolved not to return to a landlubber's life until he has learned the song of the mermaids")
	(RANK 3)
	(PROFESSION PROFESSION-TROUBADOUR)
	(STAMINA 16)
	(MONEY 40)
	(CHARISMA 7)
	(COMBAT 4)
	(MAGIC 5)
	(SANCTITY 4)
	(SCOUTING 3)
	(THIEVERY 5)
	(POSSESSIONS <PLTABLE SWORD CHAIN-MAIL MAP>)
	(IS-MALE T)
	(FLAGS PERSONBIT NARTICLEBIT)>

<OBJECT CHARACTER-GREYMALKIN
	(DESC "Greymalkin Smith")
	(LDESC "A dashing scoundrel, Greymalkin lives by his wits and has no care for either the future or the past. Money slips through his fingers as fast as he can earn it, but of late he has begun to be tempted by a story he overheard in a dockside tavern -- a story of great riches that lie unguarded on an island in the south seas")
	(RANK 3)
	(PROFESSION PROFESSION-ROGUE)
	(STAMINA 16)
	(MONEY 40)
	(CHARISMA 6)
	(COMBAT 5)
	(MAGIC 5)
	(SANCTITY 2)
	(SCOUTING 3)
	(THIEVERY 7)
	(POSSESSIONS <PLTABLE SWORD CHAIN-MAIL MAP>)
	(IS-MALE T)
	(FLAGS PERSONBIT NARTICLEBIT)>

<OBJECT CHARACTER-VARKUNG
	(DESC "Varkung of Metriciens")
	(LDESC "Varkung has always been fascinated by the distant places of the world. As a child he would spend hours staring at his father's maps and day-dreaming of the people and creatures who lived across the sea. Now, as a young man, he has the chance to go exploring. His first wish is to visit Starspike Island and see if, as legends claim, it really does stretch up beyond the sky")
	(RANK 3)
	(PROFESSION PROFESSION-WAYFARER)
	(STAMINA 16)
	(MONEY 40)
	(CHARISMA 3)
	(COMBAT 6)
	(MAGIC 3)
	(SANCTITY 4)
	(SCOUTING 7)
	(THIEVERY 5)
	(POSSESSIONS <PLTABLE SWORD CHAIN-MAIL MAP>)
	(IS-MALE T)
	(FLAGS PERSONBIT NARTICLEBIT)>

; "Professions and default stats"
; ---------------------------------------------------------------------------------------------

<OBJECT PROFESSION-PRIEST
	(DESC "Priest")
	(RANK 3)
	(STAMINA 16)
	(MONEY 40)
	(CHARISMA 5)
	(COMBAT 3)
	(MAGIC 4)
	(SANCTITY 7)
	(SCOUTING 5)
	(THIEVERY 2)
	(POSSESSIONS <PLTABLE SWORD CHAIN-MAIL MAP>)
	(FLAGS PERSONBIT)>

<OBJECT PROFESSION-MAGE
	(DESC "Mage")
	(RANK 3)
	(STAMINA 16)
	(MONEY 40)
	(CHARISMA 3)
	(COMBAT 3)
	(MAGIC 7)
	(SANCTITY 1)
	(SCOUTING 6)
	(THIEVERY 4)
	(POSSESSIONS <PLTABLE SWORD CHAIN-MAIL MAP>)
	(FLAGS PERSONBIT)>

<OBJECT PROFESSION-ROGUE
	(DESC "Rouge")
	(RANK 3)
	(STAMINA 16)
	(MONEY 40)
	(CHARISMA 6)
	(COMBAT 5)
	(MAGIC 5)
	(SANCTITY 2)
	(SCOUTING 3)
	(THIEVERY 7)
	(POSSESSIONS <PLTABLE SWORD CHAIN-MAIL MAP>)
	(FLAGS PERSONBIT)>

<OBJECT PROFESSION-TROUBADOUR
	(DESC "Troubadour")
	(RANK 3)
	(STAMINA 16)
	(MONEY 40)
	(CHARISMA 7)
	(COMBAT 4)
	(MAGIC 5)
	(SANCTITY 4)
	(SCOUTING 3)
	(THIEVERY 5)
	(POSSESSIONS <PLTABLE SWORD CHAIN-MAIL MAP>)
	(FLAGS PERSONBIT)>

<OBJECT PROFESSION-WARRIOR
	(DESC "Warrior")
	(RANK 3)
	(STAMINA 16)
	(MONEY 40)
	(CHARISMA 4)
	(COMBAT 7)
	(MAGIC 2)
	(SANCTITY 5)
	(SCOUTING 4)
	(THIEVERY 5)
	(POSSESSIONS <PLTABLE SWORD CHAIN-MAIL MAP>)
	(FLAGS PERSONBIT)>

<OBJECT PROFESSION-WAYFARER
	(DESC "Wayfarer")
	(RANK 3)
	(STAMINA 16)
	(MONEY 40)
	(CHARISMA 3)
	(COMBAT 6)
	(MAGIC 3)
	(SANCTITY 4)
	(SCOUTING 7)
	(THIEVERY 5)
	(POSSESSIONS <PLTABLE SWORD CHAIN-MAIL MAP>)
	(FLAGS PERSONBIT)>

; "Codewords for Over the Blood-Dark Sea"
; ---------------------------------------------------------------------------------------------

<OBJECT CODEWORD-CACOGAST (DESC "Cacogast")>
<OBJECT CODEWORD-CALCIUM (DESC "Calcium")>
<OBJECT CODEWORD-CALLID (DESC "Callid")>
<OBJECT CODEWORD-CANCEL (DESC "Cancel")>
<OBJECT CODEWORD-CATALYST (DESC "Catalyst")>
<OBJECT CODEWORD-CENOTAPH (DESC "Cenotaph")>
<OBJECT CODEWORD-CERTAIN (DESC "Certain")>
<OBJECT CODEWORD-CERUMEN (DESC "Cerumen")>
<OBJECT CODEWORD-CHANCE (DESC "Chance")>
<OBJECT CODEWORD-CHEESE (DESC "Cheese")>
<OBJECT CODEWORD-CHEOPS (DESC "Cheops")>
<OBJECT CODEWORD-CHILL (DESC "Chill")>
<OBJECT CODEWORD-CITRUS (DESC "Citrus")>
<OBJECT CODEWORD-CIVIL (DESC "Civil")>
<OBJECT CODEWORD-CHURCH (DESC "Church")>
<OBJECT CODEWORD-CLUTCH (DESC "Clutch")>
<OBJECT CODEWORD-COLOUR (DESC "Colour")>
<OBJECT CODEWORD-CORADE (DESC "Corade")>
<OBJECT CODEWORD-COSY (DESC "Cosy")>
<OBJECT CODEWORD-COVER (DESC "Cover")>
<OBJECT CODEWORD-COVET (DESC "Covet")>
<OBJECT CODEWORD-CROCUS (DESC "Crocus")>
<OBJECT CODEWORD-CULL (DESC "Cull")>
<OBJECT CODEWORD-CUSHAT (DESC "Cushat")>
<OBJECT CODEWORD-CUTLASS (DESC "Cutlass")>
<OBJECT CODEWORD-CYNOSURE (DESC "Cynosure")>

; "codewords from other books. Included here only for completeness"
; ---------------------------------------------------------------------------------------------

<OBJECT CODEWORD-AID (DESC "Aid")>
<OBJECT CODEWORD-ANGER (DESC "Anger")>
<OBJECT CODEWORD-BALUSTER (DESC "Baluster")>
<OBJECT CODEWORD-DANGLE (DESC "Dangle")>
<OBJECT CODEWORD-DIAMOND (DESC "Diamond")>
<OBJECT CODEWORD-DRAGON (DESC "Dragon")>
<OBJECT CODEWORD-EDIFICE (DESC "Edifice")>

; "Shack in Smogmaw (Added by SD Separa)"

<OBJECT CODEWORD-SMOGMAW (DESC "Smogmaw")>

; "Weapons"
; ---------------------------------------------------------------------------------------------

<OBJECT AXE
	(DESC "axe")
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT AXE1
	(DESC "axe")
	(COMBAT 1)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT AXE2
	(DESC "axe")
	(COMBAT 2)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT AXE3
	(DESC "axe")
	(COMBAT 3)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT BATTLE-AXE
	(DESC "battle-axe")
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT BATTLE-AXE1
	(DESC "battle-axe")
	(COMBAT 1)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT BATTLE-AXE2
	(DESC "battle-axe")
	(COMBAT 2)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT BATTLE-AXE3
	(DESC "battle-axe")
	(COMBAT 3)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT DAGGER
	(DESC "Dagger")
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT ENCHANTED-SPEAR
	(DESC "enchanted spear")
	(COMBAT 2)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT ENCHANTED-SWORD
	(DESC "enchanted sword")
	(COMBAT 3)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT MACE
	(DESC "mace")
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT MACE1
	(DESC "mace")
	(COMBAT 1)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT MACE2
	(DESC "mace")
	(COMBAT 2)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT MACE3
	(DESC "mace")
	(COMBAT 3)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT MAGIC-SPEAR
	(DESC "magic spear")
	(COMBAT 2)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT PICKAXE2
	(DESC "pickaxe")
	(COMBAT 2)
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT SPEAR
	(DESC "spear")
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT SPEAR1
	(DESC "spear")
	(COMBAT 1)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT SPEAR2
	(DESC "spear")
	(COMBAT 2)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT SPEAR3
	(DESC "spear")
	(COMBAT 3)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT STAFF
	(DESC "staff")
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT STAFF1
	(DESC "staff")
	(COMBAT 1)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT STAFF2
	(DESC "staff")
	(COMBAT 2)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT STAFF3
	(DESC "staff")
	(COMBAT 3)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT SWORD
	(DESC "sword")
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT SWORD1
	(DESC "sword")
	(COMBAT 1)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT SWORD2
	(DESC "sword")
	(COMBAT 2)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

<OBJECT SWORD3
	(DESC "sword")
	(COMBAT 3)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEAPONBIT)>

; "Armours"
; ---------------------------------------------------------------------------------------------

<OBJECT CHAIN-MAIL
	(DESC "chain mail")
	(DEFENSE 3)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEARBIT)>

<OBJECT HEAVY-PLATE
	(DESC "heavy plate")
	(DEFENSE 6)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEARBIT)>

<OBJECT LEATHER-ARMOUR
	(DESC "leather armour")
	(DEFENSE 1)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEARBIT)>

<OBJECT PLATE-ARMOUR
	(DESC "plate armour")
	(DEFENSE 5)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEARBIT)>

<OBJECT RING-MAIL
	(DESC "ring mail")
	(DEFENSE 2)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEARBIT)>

<OBJECT SPLINT-ARMOUR
	(DESC "splint armour")
	(DEFENSE 4)
	(QUANTITY 1)
	(FLAGS TAKEBIT WEARBIT)>

; Wands
; ---------------------------------------------------------------------------------------------

<OBJECT AMBER-WAND
	(DESC "amber wand")
	(MAGIC 1)
	(FLAGS TAKEBIT)>

<OBJECT CELESTIUM-WAND
	(DESC "celestium wand")
	(MAGIC 5)
	(FLAGS TAKEBIT)>

<OBJECT COBALT-WAND
	(DESC "cobalt wand")
	(MAGIC 3)
	(FLAGS TAKEBIT)>

<OBJECT EBONY-WAND
	(DESC "ebony wand")
	(MAGIC 2)
	(FLAGS TAKEBIT)>

<OBJECT SELENIUM-WAND
	(DESC "selenium wand")
	(MAGIC 4)
	(FLAGS TAKEBIT)>

; "other objects"
; ---------------------------------------------------------------------------------------------

<OBJECT BOARS-TUSK
	(DESC "boar's tusk")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT CANDLE
	(DESC "candle")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT CLIMBING-GEAR
	(DESC "climbing gear")
	(FLAGS TAKEBIT)>

<OBJECT CLOAK-OF-FEATHERS
	(DESC "cloak of feathers")
	(FLAGS TAKEBIT)>

<OBJECT COMPASS
	(DESC "compass")
	(SCOUTING 1)
	(FLAGS TAKEBIT)>

<OBJECT COPPER-ORE
	(DESC "copper ore")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT CORAL-RED-TRESSES
	(DESC "coral-red tresses")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT COURTIERS-MASK
	(DESC "courtier's mask")
	(FLAGS TAKEBIT)>

<OBJECT CROSS-STAFF
	(DESC "cross-staff")
	(SCOUTING 2)
	(FLAGS TAKEBIT)>

<OBJECT DECKED-MARKED-CARDS
	(DESC "deck of marked cards")
	(FLAGS TAKEBIT)>

<OBJECT FAERY-MEAD
	(DESC "faery mead")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT FISHING-HOOK
	(DESC "fishing hook")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT FOUR-LEAF-CLOVER
	(DESC "four-leaf clover")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT FRETWORK-KEY
	(DESC "fretwork key")
	(FLAGS TAKEBIT)>

<OBJECT GOLD-COMPASS
	(DESC "gold compass")
	(SCOUTING 2)
	(FLAGS TAKEBIT)>

<OBJECT GOLDEN-KATANA
	(DESC "golden katana")
	(FLAGS TAKEBIT)>

<OBJECT GREEN-GEM
	(DESC "green gem")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT HEART-SHAPED-LOCKET
	(DESC "heart-shaped locket")
	(FLAGS TAKEBIT)>

<OBJECT HOLY-SYMBOL
	(DESC "holy symbol")
	(SANCTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT HYDRA-TOOTH
	(DESC "hydra's tooth")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT INK-SAC
	(DESC "ink sac")
	(QUANTITY 1)
	(FLAGS TAKEBIT VOWELBIT)>

<OBJECT LANTERN
	(DESC "lantern")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT LOCKPICKS
	(DESC "lockpicks")
	(THIEVERY 1)
	(FLAGS TAKEBIT)>

<OBJECT MAGIC-LOCKPICKS
	(DESC "magic lockpicks")
	(THIEVERY 2)
	(FLAGS TAKEBIT)>

<OBJECT MAGIC-MANDOLIN
	(DESC "magic mandolin")
	(CHARISMA 2)
	(FLAGS TAKEBIT)>

<OBJECT MANDOLIN
	(DESC "mandolin")
	(CHARISMA 1)
	(FLAGS TAKEBIT)>

<OBJECT MAP
	(DESC "map")
	(FLAGS TAKEBIT)>

; "TO-DO: implement ASCII-art of MAP-OF-BAZALEK"
<OBJECT MAP-OF-BAZALEK
	(DESC "map of Bazalek")
	(FLAGS TAKEBIT)>

<OBJECT MARINERS-RUTTIER
	(DESC "mariner's ruttier")
	(FLAGS TAKEBIT)>

<OBJECT MONEY-BAG
	(DESC "Money")
	(MONEY 500)
	(FLAGS TAKEBIT)>

<OBJECT PARROT
	(DESC "parrot")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT PARROT-FUNGUS
	(DESC "parrot fungus")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT PICKAXE
	(DESC "pickaxe")
	(FLAGS TAKEBIT)>

<OBJECT PIRATE-CAPTAINS-HEAD
	(DESC "pirate captain's head")
	(FLAGS TAKEBIT)>

<OBJECT PLATINUM-EARRING
	(DESC "platinum earring")
	(FLAGS TAKEBIT)>

<OBJECT POTION-OF-COMELINESS
	(DESC "potion of comeliness")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT POTION-OF-GODLINESS
	(DESC "potion of godliness")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT POTION-OF-HEALING
	(DESC "potion of healing")
	(ACTION POTION-OF-HEALING-F)
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<ROUTINE POTION-OF-HEALING-F ()
	<COND (<CHECK-ITEM ,POTION-OF-HEALING>
		<COND (<L? ,STAMINA ,MAX-STAMINA>
			<CRLF>
			<TELL "Use the ">
			<PRINT-ITEM ,POTION-OF-HEALING T>
			<TELL " to heal up to ">
			<HLIGHT ,H-BOLD>
			<TELL "5">
			<HLIGHT 0>
			<TELL " stamina points?">
			<COND (<YES?>
				<GAIN-STAMINA 5>
				<REMOVE-ITEM ,POTION-OF-HEALING ,TEXT-USED T T>
				<UPDATE-STATUS-LINE>
			)>
		)(ELSE
			<EMPHASIZE "You are not injured!">
			<CRLF>
			<TELL "Do you want to drop this instead?">
			<COND (<YES?> <REMOVE-ITEM ,POTION-OF-HEALING "dropped" T T>)>
		)>
	)(ELSE
		<EMPHASIZE "You do not have a potion of healing?">
	)>
	<RFALSE>>

<OBJECT POTION-OF-INTELLECT
	(DESC "potion of intellect")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT POTION-OF-NATURE
	(DESC "potion of nature")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT POTION-OF-RESTORATION
	(DESC "potion of restoration")
	(QUANTITY 1)
	(ACTION POTION-OF-RESTORATION-F)
	(FLAGS TAKEBIT)>

<ROUTINE POTION-OF-RESTORATION-F ()
	<COND (<CHECK-ITEM ,POTION-OF-HEALING>
		<COND (<OR <L? ,STAMINA ,MAX-STAMINA> <G? <COUNT-CONTAINER ,AILMENTS ,POISONBIT> 0> <G? <COUNT-CONTAINER ,AILMENTS ,DISEASEBIT> 0>>
			<CRLF>
			<TELL "Use the ">
			<PRINT-ITEM ,POTION-OF-HEALING T>
			<TELL " to heal and cure any ailments (poisons and diseases)? ">
			<COND (<YES?>
				<REMOVE-ITEM ,POTION-OF-RESTORATION ,TEXT-USED T T>
				<COND (<L? ,STAMINA ,MAX-STAMINA>
					<SETG STAMINA ,MAX-STAMINA>
					<EMPHASIZE "Your stamina has fully recovered.">
				)>
				<COND (<OR <G? <COUNT-CONTAINER ,AILMENTS ,POISONBIT> 0> <G? <COUNT-CONTAINER ,AILMENTS ,DISEASEBIT> 0>>
					<RESET-CONTAINER ,AILMENTS ,DISEASEBIT>
					<RESET-CONTAINER ,AILMENTS ,POISONBIT>
					<EMPHASIZE "You were cured of any poisons and diseases you were suffering from.">
				)>
				<UPDATE-STATUS-LINE>
			)>
		)(ELSE
			<EMPHASIZE "You are not injured nor suffering from any poisons or diseases!">
		)>
	)(ELSE
		<EMPHASIZE "You do not have a potion of restoration!">
	)>
	<RFALSE>>

<OBJECT POTION-OF-STEALTH
	(DESC "potion of godliness")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT POTION-OF-STRENGTH
	(DESC "potion of strength")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT ROPE
	(DESC "rope")
	(FLAGS TAKEBIT)>

<OBJECT ROYAL-RING
	(DESC "royal ring")
	(FLAGS TAKEBIT)>

<OBJECT SCROLL-OF-EBRON
	(DESC "scroll of Ebron")
	(FLAGS TAKEBIT)>

<OBJECT SEA-GREEN-LENS
	(DESC "sea green lens")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT SELENIUM-ORE
	(DESC "selenium ore")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT SEXTANT
	(DESC "sextant")
	(SCOUTING 3)
	(FLAGS TAKEBIT)>

<OBJECT SHIPS-DEEDS
	(DESC "ship's deeds")
	(FLAGS TAKEBIT)>

<OBJECT SILVER-HOLY-SYMBOL
	(DESC "silver holy symbol")
	(SANCTITY 2)
	(FLAGS TAKEBIT)>

<OBJECT SILVER-HORSESHOE
	(DESC "silver horseshoe")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT SILVER-MEDALLION
	(DESC "silver medallion")
	(FLAGS TAKEBIT)>

<OBJECT SMOULDER-FISH
	(DESC "smoulder fish")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT SPECTRAL-VEIL
	(DESC "spectral veil")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT TREASURE-MAP
	(DESC "treasure map")
	(FLAGS TAKEBIT)>

<OBJECT VERDIGRIS-KEY
	(DESC "verdigris key")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT VIOLIN
	(DESC "violin")
	(FLAGS TAKEBIT)>

<OBJECT WATER-FLASK
	(DESC "water flask")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT WINGED-IDOL
	(DESC "winged idol")
	(FLAGS TAKEBIT)>

<OBJECT WITCH-HAND
	(DESC "witch's hand")
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

; "Resurrections"
; ---------------------------------------------------------------------------------------------

<OBJECT RESURRECTION-ANY
	(DESC "Any resurrection arrangement")
	(FLAGS TAKEBIT)>

<OBJECT RESURRECTION-ISLAND-REBIRTH
	(DESC "Island of Rebirth, Over the Blood-Dark Sea")
	(CONTINUE STORY351)
	(FLAGS TAKEBIT)>

<OBJECT RESURRECTION-NAGIL
	(DESC "Temple of Nagil, Over the Blood-Dark Sea")
	(CONTINUE NONE)
	(FLAGS TAKEBIT)>

<OBJECT RESURRECTION-TYRNAI
	(DESC "Temple of Tyrnai, Over the Blood-Dark Sea")
	(CONTINUE NONE)
	(FLAGS TAKEBIT)>

; GODS
; ---------------------------------------------------------------------------------------------

<OBJECT GOD-ALVIR-VALMIR
	(DESC "Alvir and Valmir the Twin Gods")>

<OBJECT GOD-ELNIR
	(DESC "Elnir the Sky God")>

<OBJECT GOD-LACUNA
	(DESC "Lacuna")>

<OBJECT GOD-MAKA
	(DESC "Maka")>

<OBJECT GOD-MOLHEM
	(DESC "Molhem")>

<OBJECT GOD-MOLHERN
	(DESC "Molhern, the God of Craftsmen")>

<OBJECT GOD-NAGIL
	(DESC "Nagil, the God of Death")
	(RESURRECTION RESURRECTION-ANY)>

<OBJECT GOD-THREE-FORTUNES
	(DESC "Three Fortunes")>

<OBJECT GOD-SIG
	(DESC "Sig the Cunning")>

<OBJECT GOD-TYRNAI
	(DESC "Tyrnai the War God")
	(RESURRECTION RESURRECTION-TYRNAI)>

; Blessings
; ---------------------------------------------------------------------------------------------

<OBJECT BLESSING-CHARISMA (DESC "CHARISMA")>
<OBJECT BLESSING-COMBAT (DESC "COMBAT")>
<OBJECT BLESSING-MAGIC (DESC "MAGIC")>
<OBJECT BLESSING-SANCTITY (DESC "SANCTITY")>
<OBJECT BLESSING-SCOUTING (DESC "SCOUTING")>
<OBJECT BLESSING-THIEVERY (DESC "THIEVERY")>
<OBJECT BLESSING-LUCK (DESC "LUCK")>
<OBJECT BLESSING-SAFETY-FROM-STORMS (DESC "Safety from Storms")>
<OBJECT BLESSING-IMMUNITY-POISON-DISEASE (DESC "Immunity to Disease and Poison")>

; "Curses/Diseases/Poison EFFECTS (CHARISMA COMBAT MAGIC SANCTITY SCOUTING THIEVERY)"
; ---------------------------------------------------------------------------------------------

<OBJECT CURSE-THREE-FORTUNES
	(DESC "Three Fortunes (Use one die for ability rolls)")
	(FLAGS CURSEBIT)>

<OBJECT DISEASE-MALARIA
	(DESC "malaria")
	(EFFECTS <PLTABLE -1 -1 -1 0 -1 -1>)
	(FLAGS DISEASEBIT)>

; Ships
; ---------------------------------------------------------------------------------------------

<CONSTANT CONDITIONS <LTABLE "poor" "average" "good" "excellent">>
<CONSTANT CONDITION-POOR 0>
<CONSTANT CONDITION-AVERAGE 1>
<CONSTANT CONDITION-GOOD 2>
<CONSTANT CONDITION-EXCELLENT 3>

<CONSTANT DOCKS <LTABLE "Smogmaw" "Dweomer" "Vervayens" "Sorcerers' Isle" "Copper Island">>

<CONSTANT DOCK-SMOGMAW 1>
<CONSTANT DOCK-DWEOMER 2>
<CONSTANT DOCK-VERVAYENS 3>
<CONSTANT DOCK-SORCERERS 4>
<CONSTANT DOCK-COPPER 5>

<OBJECT SHIP-BARQUE
	(DESC "barque")
	(CAPACITY 1)
	(DOCKED NONE)
	(CONDITION CONDITION-POOR)>

<OBJECT SHIP-BRIGANTINE
	(DESC "brigantine")
	(CAPACITY 2)
	(DOCKED NONE)
	(CONDITION CONDITION-POOR)>

<OBJECT SHIP-GALLEON
	(DESC "galleon")
	(CAPACITY 3)
	(DOCKED NONE)
	(CONDITION CONDITION-POOR)>

; "Disease/Poison EFFECTS (CHARISMA COMBAT MAGIC SANCTITY SCOUTING THIEVERY)"
; ---------------------------------------------------------------------------------------------

; "Monsters"
; ---------------------------------------------------------------------------------------------

<OBJECT MONSTER-ASSASSIN
	(DESC "Assassin")
	(COMBAT 8)
	(DEFENSE 10)
	(STAMINA 8)>

<OBJECT MONSTER-FLYING-SHARK
	(DESC "Flying shark")
	(COMBAT 9)
	(DEFENSE 10)
	(STAMINA 27)>

<OBJECT MONSTER-GORGON
	(DESC "Gorgon")
	(COMBAT 4)
	(DEFENSE 5)
	(STAMINA 8)>

<OBJECT MONSTER-HEAD
	(DESC "Head")
	(COMBAT 7)
	(DEFENSE 14)
	(STAMINA 5)>

<OBJECT MONSTER-MUTINEER
	(DESC "Mutineer")
	(COMBAT 6)
	(DEFENSE 9)
	(STAMINA 9)>

<OBJECT MONSTER-RESENTFUL-SAILOR
	(DESC "Resentful sailor")
	(COMBAT 5)
	(DEFENSE 6)
	(STAMINA 3)>

<OBJECT MONSTER-SERPENT
	(DESC "Serpent")
	(COMBAT 7)
	(DEFENSE 8)
	(STAMINA 10)>

<OBJECT MONSTER-VAMPIRE
	(DESC "Vampire")
	(COMBAT 15)
	(DEFENSE 18)
	(STAMINA 18)>

<OBJECT MONSTER-VIOLET-MAN
	(DESC "Violet man")
	(COMBAT 9)
	(DEFENSE 12)
	(STAMINA 9)>

; "Titles and Honours for Over the Blood-Dark Sea"
; ---------------------------------------------------------------------------------------------
<OBJECT TITLE-CHOSEN-NAGIL (DESC "Chosen One of Nagil")>
<OBJECT TITLE-ILLUMINATE-MOLHERN (DESC "Illuminate of Molhern") (FLAGS VOWELBIT)>
<OBJECT TITLE-SAVIOUR-VERVAYENS (DESC "Saviour of Vervayens Isle")>
<OBJECT TITLE-UNSPEAKABLE-CULTIST (DESC "Unspeakable Cultist") (EFFECTS <PLTABLE 0 0 0 -1 0 0>) (FLAGS VOWELBIT)>

; "Abilities and Combat"
; ---------------------------------------------------------------------------------------------

<CONSTANT LOOKUP-ABILITY <PLTABLE P?CHARISMA P?COMBAT P?MAGIC P?SANCTITY P?SCOUTING P?THIEVERY P?DEFENSE>>

<ROUTINE APPLY-EFFECTS (ABILITY "OPT" CONTAINER "AUX" ITEM (EFFECTS NONE) (SCORE 0))
	<COND (<NOT .CONTAINER> <SET CONTAINER ,AILMENTS>)>
	<SET SCORE 0>
	<COND (<G? <COUNT-CONTAINER .CONTAINER> 0>
		<SET ITEM <FIRST? .CONTAINER>>
		<REPEAT ()
			<COND (<NOT .ITEM> <RETURN>)>
			<SET EFFECTS <GETP .ITEM ,P?EFFECTS>>
			<COND (.EFFECTS <SET SCORE <+ .SCORE <GET .EFFECTS .ABILITY>>>)>
			<SET ITEM <NEXT? .ITEM>>
		>
	)>
	<RETURN .SCORE>>

; "Calculates ability scores"

<ROUTINE CALCULATE-ABILITY (CHARACTER ABILITY "OPT" CONTAINER (WITH-GEAR T) "AUX" SCORE PROPERTY)
	<COND (<NOT .CONTAINER> <SET .CONTAINER ,PLAYER>)>
	<SET PROPERTY <GET-ABILITY-PROPERTY .ABILITY>>
	<SET SCORE <GET-ABILITY-SCORE .CHARACTER .ABILITY>>
	<COND (<EQUAL? .ABILITY ,ABILITY-COMBAT>
		<COND (.WITH-GEAR
			<SET SCORE <+ .SCORE <FIND-BEST .PROPERTY ,WEAPONBIT .CONTAINER>>>
		)>
	)(ELSE
		<SET SCORE <+ .SCORE <FIND-BEST .PROPERTY NONE .CONTAINER>>>
	)>
	<COND (<AND <CHECK-GOD ,GOD-SIG> <EQUAL? .ABILITY ,ABILITY-THIEVERY>>
		<INC .SCORE>
	)>
	<SET SCORE <+ .SCORE <APPLY-EFFECTS .ABILITY ,AILMENTS>>>
	<SET SCORE <+ .SCORE <APPLY-EFFECTS .ABILITY ,TITLES-AND-HONOURS>>>
	<COND (<G? .SCORE 12> <SET SCORE 12>)>
	<COND (<L? .SCORE 1> <SET SCORE 1>)>
	<RETURN .SCORE>>

; "Get object property that is associated to ability"
<ROUTINE GET-ABILITY-PROPERTY (ABILITY "AUX" (PROPERTY NONE))
	<SET PROPERTY <GET ,LOOKUP-ABILITY .ABILITY>>
	<RETURN .PROPERTY>>

; "Get ability score"
<ROUTINE GET-ABILITY-SCORE (CHARACTER ABILITY "AUX" PROPERTY RESULT)
	<SET PROPERTY <GET-ABILITY-PROPERTY .ABILITY>>
	<COND (.PROPERTY
		<SET RESULT <GETP .CHARACTER .PROPERTY>>
		<RETURN .RESULT>
	)>
	<RETURN 1>>

; "Search gear/money routines"
; ---------------------------------------------------------------------------------------------

<ROUTINE FIND-ALL-ARMOUR ()
	<RETURN <FIND-ALL-GEAR ,FIND-ARMOUR>>>

; "Finds a weapon/armour on player and in player storage"
<ROUTINE FIND-ALL-GEAR ("OPT" (FIND-ROUTINE NONE) "AUX" RESULT FINAL CACHES)
	<COND (<NOT .FIND-ROUTINE> <SET FIND-ROUTINE ,FIND-WEAPON>)>
	<SET FINAL NONE>
	<SET RESULT NONE>
	<DO (I 0 3)
		<SET RESULT <APPLY .FIND-ROUTINE .I ,PLAYER>>
		<COND (.RESULT
			<SET FINAL .RESULT>
			<RETURN>
		)>
	>
	<COND (.FINAL <RETURN .FINAL>)>
	<COND (<G? <COUNT-CONTAINER ,PLAYER-STORAGE> 0>
		<SET CACHES <FIRST? ,PLAYER-STORAGE>>
		<REPEAT ()
			<COND (<NOT .CACHES> <RETURN>)>
			<SET RESULT NONE>
			<DO (I 0 3)
				<SET RESULT <FIND-WEAPON .I .CACHES>>
				<COND (.RESULT
					<SET FINAL .RESULT>
					<RETURN>
				)>
			>
			<COND (.FINAL <RETURN>)>
			<SET .CACHES <NEXT? .CACHES>>
		>
	)>
	<RETURN .FINAL>>

; "Finds a weapon/armour on player and in player storage"
<ROUTINE FIND-ALL-MONEY ("AUX" RESULT CACHES)
	<COND (<G? ,MONEY 0> <RTRUE>)>
	<SET RESULT 0>
	<COND (<G? <COUNT-CONTAINER ,PLAYER-STORAGE> 0>
		<SET CACHES <FIRST? ,PLAYER-STORAGE>>
		<REPEAT ()
			<COND (<NOT .CACHES> <RETURN>)>
			<SET RESULT 0>
			<DO (I 0 3)
				<SET RESULT <GETP .CACHES ,P?MONEY>>
				<COND (<G? .RESULT 0> <RETURN>)>
			>
			<COND (<G? .RESULT 0> <RETURN>)>
			<SET .CACHES <NEXT? .CACHES>>
		>
	)>
	<COND (<G? .RESULT 0> <RTRUE>)>
	<RFALSE>>

<ROUTINE FIND-ALL-WEAPON ()
	<RETURN <FIND-ALL-GEAR ,FIND-WEAPON>>>

; "Find armour in container"
<ROUTINE FIND-ARMOUR ("OPT" (SCORE 0) CONTAINER)
	<RETURN <FIND-GEAR ,WEARBIT ,P?DEFENSE .SCORE .CONTAINER>>>

; "Finds the item with the best PROPERTY score"
<ROUTINE FIND-BEST (PROPERTY "OPT" (FLAG NONE) CONTAINER (MATCH 0) "AUX" (SCORE 0) (ITEM NONE) (RESULT 0))
	<SET RESULT 0>
	<SET SCORE 0>
	<COND (<NOT .CONTAINER> <SET .CONTAINER ,PLAYER>)>
	<SET ITEM <FIRST? .CONTAINER>>
	<REPEAT ()
		<COND (<NOT .ITEM> <RETURN>)>
		<SET SCORE <GETP .ITEM .PROPERTY>>
		<COND (<G? .MATCH 0>
			<COND (.FLAG
				<COND (<AND <FSET? .ITEM .FLAG> <NOT <FSET? .ITEM ,NDESCBIT>>>
					<COND (<EQUAL? .SCORE .MATCH>
						<SET RESULT .SCORE>
						<SET-BEST-GEAR .ITEM>
						<RETURN>
					)>
				)>
			)(<AND <NOT <FSET? .ITEM ,NDESCBIT>> <EQUAL? .SCORE .MATCH>>
				<SET .RESULT .SCORE>
				<SET-BEST-GEAR .ITEM>
				<RETURN>
			)>
		)(.FLAG
			<COND (<AND <NOT <FSET? .ITEM ,NDESCBIT>> <FSET? .ITEM .FLAG>>
				<COND (<G=? .SCORE .RESULT>
					<SET .RESULT .SCORE>
					<SET-BEST-GEAR .ITEM>
				)>
			)>
		)(<AND <NOT <FSET? .ITEM ,NDESCBIT>> <G=? .SCORE .RESULT>>
			<SET-BEST-GEAR .ITEM>
			<SET .RESULT .SCORE>
		)>
		<SET ITEM <NEXT? .ITEM>>
	>
	<RETURN .RESULT>>

; "as above but find in list"
<ROUTINE FIND-BEST-LIST (PROPERTY "OPT" (FLAG NONE) LIST "AUX" COUNT SCORE ITEM RESULT)
	<COND (<NOT .LIST> <RETURN 0>)>
	<SET SCORE 0>
	<SET RESULT 0>
	<SET COUNT <GET .LIST 0>>
	<DO (I 1 .COUNT)
		<SET ITEM <GET .LIST .I>>
		<SET SCORE <GETP .ITEM .PROPERTY>>
		<COND (<AND .FLAG <NOT <FSET? .ITEM ,NDESCBIT>>>
			<COND (<FSET? .ITEM .FLAG>
				<COND (<G=? .SCORE .RESULT>
					<SET .RESULT .SCORE>
					<SET-BEST-GEAR .ITEM>
				)>
			)>
		)(<AND <G=? .SCORE .RESULT> <NOT <FSET? .ITEM ,NDESCBIT>>>
			<SET-BEST-GEAR .ITEM>
			<SET .RESULT .SCORE>
		)>
	>
	<RETURN .RESULT>>

<ROUTINE FIND-BEST-GEAR ()
	<SETG BEST-WEAPON NONE>
	<SETG BEST-ARMOUR NONE>
	<FIND-BEST ,P?COMBAT ,WEAPONBIT ,PLAYER>
	<FIND-BEST ,P?DEFENSE ,WEARBIT ,PLAYER>>

<ROUTINE FIND-GEAR (FLAG PROPERTY "OPT" (SCORE 0) CONTAINER "AUX" BONUS ITEMS RESULT)
	<COND (<NOT .CONTAINER> <SET CONTAINER ,PLAYER>)>
	<SET RESULT NONE>
	<SET ITEMS <FIRST? .CONTAINER>>
	<REPEAT ()
		<COND (<NOT .ITEMS> <RETURN>)>
		<COND (<FSET? .ITEMS .FLAG>
			<SET BONUS <GETP .ITEMS .PROPERTY>>
			<COND (<OR <NOT .BONUS> <L=? .BONUS 0>> <SET BONUS 0>)>
			<COND (<EQUAL? .SCORE .BONUS>
				<SET RESULT .ITEMS>
				<RETURN>
			)>
		)>
		<SET ITEMS <NEXT? .ITEMS>>
	>
	<RETURN .RESULT>>

<ROUTINE FIND-WEAPON ("OPT" (SCORE 0) CONTAINER)
	<RETURN <FIND-GEAR ,WEAPONBIT ,P?COMBAT .SCORE .CONTAINER>>>

<ROUTINE SET-BEST-GEAR (ITEM)
	<COND (<FSET? .ITEM ,WEAPONBIT>
		<SETG BEST-WEAPON .ITEM>
	)(<FSET? .ITEM ,WEARBIT>
		<SETG BEST-ARMOUR .ITEM>
	)>>

; "Fighting routines"
; ---------------------------------------------------------------------------------------------

; "messages during rounds of combat"
<ROUTINE ATTACK-INEFFECTIVE (ATTACKER)
	<CRLF>
	<HLIGHT ,H-BOLD>
	<COND (<EQUAL? .ATTACKER ,CURRENT-CHARACTER>
		<TELL D .ATTACKER>
	)(ELSE
		<TELL CT .ATTACKER>
	)>
	<TELL "'s attack was ineffective" ,EXCLAMATION-CR>
	<HLIGHT 0>>

<ROUTINE ATTACK-MESSAGE (ATTACKER DEFENDER ATTACK DAMAGE)
	<CRLF>
	<HLIGHT ,H-BOLD>
	<COND (<EQUAL? .ATTACKER ,CURRENT-CHARACTER>
		<TELL D .ATTACKER "'s">
	)(ELSE
		<TELL CT .ATTACKER "'s">
	)>
	<HLIGHT 0>
	<TELL " attack (" N .ATTACK ") hits ">
	<HLIGHT ,H-BOLD>
	<COND (<EQUAL? .DEFENDER ,CURRENT-CHARACTER>
		<TELL D .DEFENDER>
	)(ELSE
		<TELL T .DEFENDER>
	)>
	<HLIGHT 0>
	<TELL " for ">
	<HLIGHT ,H-BOLD>
	<TELL N .DAMAGE " damage">
	<HLIGHT 0>
	<TELL ,PERIOD-CR>>

; "Calculate combat score"
<ROUTINE CALCULATE-COMBAT (CHARACTER "OPT" CONTAINER (WITH-GEAR T))
	<COND (<NOT .CONTAINER> <SET CONTAINER ,PLAYER>)>
	<RETURN <CALCULATE-ABILITY .CHARACTER ,ABILITY-COMBAT .CONTAINER .WITH-GEAR>>>

; "Calculate defense score"
<ROUTINE CALCULATE-DEFENSE (CHARACTER "OPT" CONTAINER (WITH-GEAR T) "AUX" RESULT)
	<COND (<NOT .CONTAINER> <SET CONTAINER ,PLAYER>)>
	<SET RESULT <GET-RANK .CHARACTER>>
	<SET RESULT <+ .RESULT <CALCULATE-ABILITY .CHARACTER ,ABILITY-COMBAT .CONTAINER .WITH-GEAR>>>
	<COND (.WITH-GEAR
		<COND (<AND <N=? .CONTAINER ,PLAYER> <N=? .CHARACTER ,CURRENT-CHARACTER>>
			<SET RESULT <+ .RESULT <FIND-BEST-LIST ,P?DEFENSE ,WEARBIT <GETP .CHARACTER ,P?POSSESSIONS>>>>
		)(ELSE
			<SET RESULT <+ .RESULT <FIND-BEST ,P?DEFENSE ,WEARBIT .CONTAINER>>>
		)>
	)>
	<COND (<L? .RESULT 1> <SET RESULT 1>)>
	<RETURN .RESULT>>

; "Wrapper for combat. Sets DOOM on result"
<ROUTINE CHECK-COMBAT (MONSTER "OPT" STORY (MODIFIER 0) (LOOT NONE) (THRESHOLD 0) (FIRST-BLOW T) (WITH-GEAR T))
	<COND (<NOT .STORY> <SET STORY ,HERE>)>
	<COND (<FIGHT .MONSTER .MODIFIER .THRESHOLD .FIRST-BLOW .WITH-GEAR>
		<PREVENT-DOOM .STORY>
		<COND (.LOOT <TAKE-ITEM .LOOT>)>
		<RTRUE>
	)(ELSE
		<PUTP .STORY ,P?DOOM T>
		<RFALSE>
	)>>

; "Initialize Monster Stats"
<ROUTINE COMBAT-MONSTER (MONSTER COMBAT DEFENSE STAMINA)
	<PUTP .MONSTER ,P?COMBAT .COMBAT>
	<PUTP .MONSTER ,P?DEFENSE .DEFENSE>
	<PUTP .MONSTER ,P?DEFENSE .STAMINA>>

; "Display combatants' status"
<ROUTINE COMBAT-STATUS (ROUND MONSTER STAMINA-PLAYER STAMINA-MONSTER)
	<CRLF>
	<HLIGHT ,H-BOLD>
	<TELL "Round " N .ROUND ": ">
	<HLIGHT 0>
	<HLIGHT ,H-ITALIC>
	<TELL D ,CURRENT-CHARACTER> 
	<HLIGHT 0>
	<TELL " (STAMINA: " N .STAMINA-PLAYER "), ">
	<HLIGHT ,H-ITALIC>
	<TELL CT .MONSTER>
	<HLIGHT 0>
	<TELL " (STAMINA: " N .STAMINA-MONSTER ")">
	<TELL ,PERIOD-CR>
	<UPDATE-STATUS-LINE>>

<ROUTINE FIGHT (MONSTER "OPT" (MODIFIER 0) (THRESHOLD 0) (FIRST-BLOW T) (WITH-GEAR T) "AUX" RESULT ATTACK STAMINA-PLAYER COMBAT-PLAYER DEFENSE-PLAYER STAMINA-MONSTER COMBAT-MONSTER DEFENSE-MONSTER (ROUND 0))
	<SET STAMINA-PLAYER ,STAMINA>
	<COND (<L=? .STAMINA-PLAYER 0> <HAS-PREVAILED .MONSTER> <RETURN>)>
	<SET DEFENSE-PLAYER <CALCULATE-DEFENSE ,CURRENT-CHARACTER ,PLAYER .WITH-GEAR>>
	<SET COMBAT-PLAYER <CALCULATE-COMBAT ,CURRENT-CHARACTER ,PLAYER .WITH-GEAR>>
	<COND (<CHECK-ITEM ,POTION-OF-STRENGTH>
		<CRLF>
		<TELL "Use the ">
		<PRINT-ITEM ,POTION-OF-STRENGTH T>
		<TELL " in this fight (Current COMBAT score: ">
		<HLIGHT ,H-BOLD>
		<TELL N .COMBAT-PLAYER>
		<HLIGHT 0>
		<TELL ")?">
		<COND (<YES?>
			<REMOVE-ITEM ,POTION-OF-STRENGTH ,TEXT-USED F T>
			<INC .COMBAT-PLAYER>
		)>
	)>
	<COND (<G? .COMBAT-PLAYER 12> <SET .COMBAT-PLAYER 12>)>
	<SET STAMINA-MONSTER <GETP .MONSTER ,P?STAMINA>>
	<SET DEFENSE-MONSTER <GETP .MONSTER ,P?DEFENSE>>
	<SET COMBAT-MONSTER <GETP .MONSTER ,P?COMBAT>>
	<COND (<G? .COMBAT-MONSTER 12> <SET .COMBAT-MONSTER 12>)>
	<CRLF>
	<TELL "Resolving combat between ">
	<HLIGHT ,H-BOLD>
	<TELL D ,CURRENT-CHARACTER>
	<HLIGHT 0>
	<TELL " (COMBAT: " N .COMBAT-PLAYER " DEFENSE: " N .DEFENSE-PLAYER>
	<COND (<G? .MODIFIER 0> <TELL ", +" N .MODIFIER " to rolls">)>
	<TELL ") and ">
	<HLIGHT ,H-BOLD>
	<TELL T .MONSTER>
	<HLIGHT 0>
	<TELL " (COMBAT: " N .COMBAT-MONSTER " DEFENSE: " N .DEFENSE-MONSTER ")">
	<TELL ,PERIOD-CR>
	; "Track Previous Stamina"
	<SETG PREVIOUS-STAMINA .STAMINA-PLAYER> 
	<REPEAT ()
		<INC .ROUND>
		<COMBAT-STATUS .ROUND .MONSTER .STAMINA-PLAYER .STAMINA-MONSTER>
		<PRESS-A-KEY>
		<COND (<OR .FIRST-BLOW <G? .ROUND 1>>
			<SET ATTACK <+ <ROLL-DICE 2> .COMBAT-PLAYER .MODIFIER>>
			<SET RESULT <- .ATTACK .DEFENSE-MONSTER>>
			<COND (<G? .RESULT 0>
				<ATTACK-MESSAGE ,CURRENT-CHARACTER .MONSTER .ATTACK .RESULT>
				<SET STAMINA-MONSTER <- .STAMINA-MONSTER .RESULT>>
				<COND (<L=? .STAMINA-MONSTER .THRESHOLD> <RETURN>)>
			)(ELSE
				<ATTACK-INEFFECTIVE ,CURRENT-CHARACTER>
			)>
			<PRESS-A-KEY>
		)>
		<SET ATTACK <+ <ROLL-DICE 2> .COMBAT-MONSTER>>
		<SET RESULT <- .ATTACK .DEFENSE-PLAYER>>
		<COND (<G? .RESULT 0>
			<ATTACK-MESSAGE .MONSTER ,CURRENT-CHARACTER .ATTACK .RESULT>
			<SET STAMINA-PLAYER <- .STAMINA-PLAYER .RESULT>>
			<COND (<L? .STAMINA-PLAYER 1> <RETURN>)>
		)(ELSE
			<ATTACK-INEFFECTIVE .MONSTER>
		)>
		<PRESS-A-KEY>
		<UPDATE-STATUS-LINE>
	>
	<COND (<L? .STAMINA-PLAYER 0> <SET .STAMINA-PLAYER 0>)>
	<SETG STAMINA .STAMINA-PLAYER>
	<UPDATE-STATUS-LINE>
	<COND (<L=? .STAMINA-MONSTER .THRESHOLD>
		<HAS-PREVAILED ,CURRENT-CHARACTER>
		<RTRUE>
	)>
	<HAS-PREVAILED .MONSTER>
	<RFALSE>>

<ROUTINE HAS-PREVAILED (CHARACTER)
	<CRLF>
	<HLIGHT ,H-BOLD>
	<COND (<EQUAL? .CHARACTER ,CURRENT-CHARACTER>
		<TELL D .CHARACTER>
	)(ELSE
		<TELL CT .CHARACTER>
	)>
	<TELL " ">
	<COND (<FSET? .CHARACTER ,PLURALBIT> <TELL "have">)(ELSE <TELL "has">)>
	<TELL " prevailed">
	<HLIGHT 0>
	<TELL ,PERIOD-CR>>

<ROUTINE TEST-ABILITY (CHARACTER ABILITY DIFFICULTY "OPT" (MODIFIER 0) "AUX" SCORE (ROLL 0) (RESULT F) (TOTAL 0) (INITIAL-MODIFIER 0))
	<REPEAT ()
		<SET SCORE <CALCULATE-ABILITY .CHARACTER .ABILITY>>
		<TELL "Making a ">
		<HLIGHT ,H-BOLD>
		<TELL <GET ,ABILITIES .ABILITY>>
		<HLIGHT 0>
		<TELL " (" >
		<HLIGHT ,H-BOLD>
		<TELL N .SCORE>
		<HLIGHT 0>
		<TELL ") roll at ">
		<HLIGHT ,H-BOLD>
		<TELL N .DIFFICULTY>
		<HLIGHT 0>
		<TELL " difficulty.." ,PERIOD-CR>
		<SET MODIFIER <+ .MODIFIER <TEST-ABILITY-GOD .ABILITY>>>
		<SET INITIAL-MODIFIER .MODIFIER>
		<SET MODIFIER <+ .MODIFIER <TEST-ABILITY-POTION .ABILITY>>>
		<COND (<L=? .MODIFIER .INITIAL-MODIFIER> <PRESS-A-KEY>)>
		<COND (<CHECK-AILMENT ,CURSE-THREE-FORTUNES>
			<SET ROLL <ROLL-DICE 1>>
		)(ELSE
			<SET ROLL <ROLL-DICE 2>>
		)>
		<SET TOTAL <+ .SCORE .ROLL .MODIFIER>>
		<CRLF>
		<TELL "Rolled (">
		<HLIGHT ,H-BOLD>
		<TELL <GET ,ABILITIES .ABILITY> " " N .SCORE>
		<HLIGHT 0>
		<TELL ") + ">
		<HLIGHT ,H-BOLD>
		<TELL N .ROLL>
		<HLIGHT 0>
		<COND (<N=? .MODIFIER 0>
			<TELL " ">
			<COND (<G? .MODIFIER 0>
				<TELL "+ ">
			)(ELSE
				<TELL "- ">
			)>
			<HLIGHT ,H-BOLD>
			<COND (<G? .MODIFIER 0>
				<TELL N .MODIFIER>
			)(ELSE
				<TELL N <* .MODIFIER -1>>
			)>
			<HLIGHT 0>
		)>
		<TELL " = ">
		<HLIGHT ,H-BOLD>
		<TELL N .TOTAL>
		<HLIGHT 0>
		<TELL " ... ">
		<COND (<G? .TOTAL .DIFFICULTY>
			<HLIGHT ,H-BOLD>
			<TELL "Success!">
			<SET RESULT T>
			<HLIGHT 0>
			<CRLF>
			<RETURN>
		)(ELSE
			<HLIGHT ,H-BOLD>
			<TELL "Failed!">
			<HLIGHT 0>
			<SET RESULT F>
			<COND (<NOT <TEST-ABILITY-BLESSING .ABILITY>>
				<RETURN>
			)>
			<CRLF>
		)>
	>
	<RETURN .RESULT>>

<ROUTINE TEST-ABILITY-BLESSING (ABILITY "AUX" HAS-BLESSING BLESSING RESULT)
	<SET RESULT F>
	<SET HAS-BLESSING T>
	<COND (<AND <EQUAL? .ABILITY ,ABILITY-CHARISMA> <CHECK-BLESSING ,BLESSING-CHARISMA>>
		<SET BLESSING ,BLESSING-CHARISMA>
	)(<AND <EQUAL? .ABILITY ,ABILITY-COMBAT> <CHECK-BLESSING ,BLESSING-COMBAT>>
		<SET BLESSING ,BLESSING-COMBAT>
	)(<AND <EQUAL? .ABILITY ,ABILITY-MAGIC> <CHECK-BLESSING ,BLESSING-MAGIC>>
		<SET BLESSING ,BLESSING-MAGIC>
	)(<AND <EQUAL? .ABILITY ,ABILITY-SANCTITY> <CHECK-BLESSING ,BLESSING-SANCTITY>>
		<SET BLESSING ,BLESSING-SANCTITY>
	)(<AND <EQUAL? .ABILITY ,ABILITY-SCOUTING> <CHECK-BLESSING ,BLESSING-SCOUTING>>
		<SET BLESSING ,BLESSING-SCOUTING>
	)(<AND <EQUAL? .ABILITY ,ABILITY-THIEVERY> <CHECK-BLESSING ,BLESSING-THIEVERY>>
		<SET BLESSING ,BLESSING-THIEVERY>
	)(<CHECK-BLESSING ,BLESSING-LUCK>
		<SET BLESSING ,BLESSING-LUCK>
	)(ELSE
		<SET HAS-BLESSING F>
	)>
	<COND (.HAS-BLESSING
		<CRLF>
		<TELL CR "Use " T .BLESSING " blessing to reroll?">
		<COND (<YES?>
			<DELETE-BLESSING .BLESSING>
			<SET .RESULT T>
		)>
	)(ELSE
		<CRLF>
	)>
	<RETURN .RESULT>>

<ROUTINE TEST-ABILITY-GOD (ABILITY "AUX" RESULT)
	<SET RESULT 0>
	<COND (<EQUAL? .ABILITY ,ABILITY-THIEVERY>
		<COND (<CHECK-GOD ,GOD-SIG> <INC .RESULT>)>
	)>
	<RETURN .RESULT>>

<ROUTINE TEST-ABILITY-POTION (ABILITY "AUX" HAS-POTION POTION RESULT)
	<SET RESULT 0>
	<SET HAS-POTION T>
	<COND (<AND <EQUAL? .ABILITY ,ABILITY-CHARISMA> <CHECK-ITEM ,POTION-OF-COMELINESS>>
		<SET POTION ,POTION-OF-COMELINESS>
	)(<AND <EQUAL? .ABILITY ,ABILITY-COMBAT> <CHECK-ITEM ,POTION-OF-STRENGTH>>
		<SET POTION ,POTION-OF-STRENGTH>
	)(<AND <EQUAL? .ABILITY ,ABILITY-MAGIC> <CHECK-ITEM ,POTION-OF-INTELLECT>>
		<SET POTION ,POTION-OF-INTELLECT>
	)(<AND <EQUAL? .ABILITY ,ABILITY-SANCTITY> <CHECK-ITEM ,POTION-OF-GODLINESS>>
		<SET POTION ,POTION-OF-GODLINESS>
	)(<AND <EQUAL? .ABILITY ,ABILITY-SCOUTING> <CHECK-ITEM ,POTION-OF-NATURE>>
		<SET POTION ,POTION-OF-NATURE>
	)(<AND <EQUAL? .ABILITY ,ABILITY-THIEVERY> <CHECK-ITEM ,POTION-OF-STEALTH>>
		<SET POTION ,BLESSING-THIEVERY>
	)(ELSE
		<SET HAS-POTION F>
	)>
	<COND (.HAS-POTION
		<TELL CR "Use the ">
		<PRINT-ITEM .POTION T>
		<TELL " to add to the roll?">
		<COND (<YES?>
			<REMOVE-ITEM .POTION ,TEXT-USED T T>
			<SET RESULT 1>
		)>
	)>
	<RETURN .RESULT>>

; "Number conversion routines"
; ---------------------------------------------------------------------------------------------

<ROUTINE CONVERT-TO-NUMBER (N "OPT" BASE "AUX" INDEX START LEN)
	<COND (<NOT .BASE> <SET BASE 10>)>
	<COND (<0? <GETB ,LEXBUF 1>> <RETURN 0>)>
	<SET INDEX <* .N 4>>
	<SET START <- <GETB ,LEXBUF <+ .INDEX 1>> 1>>
	<SET LEN <GETB ,LEXBUF .INDEX>>
	<RETURN <TO-INTEGER .START .LEN .BASE>>>

<ROUTINE GET-DIGIT (CHARACTER "OPT" BASE "AUX" DIGIT)
	<COND (<NOT .BASE> <SET BASE 10>)>
	<SET DIGIT 0>
	<COND (<AND <G? .BASE 10> <G=? .CHARACTER !\A> <L=? .CHARACTER !\Z>>
		<SET DIGIT <+ <- .CHARACTER !\A> 10>>
	)(<AND <G? .BASE 10> <G=? .CHARACTER !\a> <L=? .CHARACTER !\z>>
		<SET DIGIT <+ <- .CHARACTER !\a> 10>>
	)(<AND <G=? .CHARACTER !\0> <L=? .CHARACTER !\9>>
		<SET DIGIT <- .CHARACTER !\0>>
	)>
	<COND (<OR <G? .DIGIT <- .BASE 1>> <L? .DIGIT 0>> <RETURN 0>)>
	<RETURN .DIGIT>>

<ROUTINE POWER (BASE EXPONENT)
	<COND (<G? .EXPONENT 0>
		<RETURN <* .BASE <POWER .BASE <- .EXPONENT 1>>>>
	)(ELSE
		<RETURN 1>
	)>>

<ROUTINE TO-INTEGER (START LENGTH "OPT" BASE "AUX" NUMBER CHARACTER SIGN)
	<COND (<NOT .BASE> <SET BASE 10>)>
	<SET SIGN 1>
	<SET NUMBER 0>
	<DO (I 1 .LENGTH)
		<SET CHARACTER <GETB ,READBUF <+ .START .I>>>
		<COND (<OR
			<AND <G=? .CHARACTER !\0> <L=? .CHARACTER !\9>>
			<AND <G? .BASE 10> <L=? .BASE 36>
				<OR 
					<AND <G=? .CHARACTER !\A> <L=? .CHARACTER !\Z>>
					<AND <G=? .CHARACTER !\a> <L=? .CHARACTER !\z>>
				>
			>>
			<SET NUMBER <+ .NUMBER <* <GET-DIGIT .CHARACTER .BASE> <POWER .BASE <- .LENGTH .I>>>>>
		)(<AND <EQUAL? .I 1> <EQUAL? .CHARACTER !\- !\+>>
			<COND (<EQUAL? .CHARACTER !\->
				<SET SIGN -1>
			)>
		)(ELSE
			<RETURN 0>
		)>
	>
	<RETURN <* .SIGN .NUMBER>>>

; "Guild routines"
; ---------------------------------------------------------------------------------------------

<CONSTANT TEXT-GUILD "Guild">
<CONSTANT TEXT-GUILD-NONE "You have not made any investments!">
<CONSTANT TEXT-GUILD-BROKE "You do not have enough money!">

<CONSTANT TEXT-INVESTMENT-LOSE20 "You lost 20%">
<CONSTANT TEXT-INVESTMENT-LOSE10 "You lost 10%">
<CONSTANT TEXT-INVESTMENT-PROFIT10 "You gain a 10% profit!">
<CONSTANT TEXT-INVESTMENT-PROFIT20 "You gain a 20% profit!">
<CONSTANT TEXT-INVESTMENT-PROFIT25 "You gain a 25% profit!">

; "Modified for Over the Blood-Dark Sea"
<ROUTINE CHECK-INVESTMENTS (STORY "AUX" INVESTMENTS ROLL (MODIFIER 0))
	<SET INVESTMENTS <GETP .STORY ,P?INVESTMENTS>>
	<COND (.INVESTMENTS
		<COND (<CHECK-GOD ,GOD-THREE-FORTUNES> <SET MODIFIER 1>)>
		<SET ROLL <RANDOM-EVENT 2 .MODIFIER T>>
		<COND (<L=? .ROLL 4>
			<EMPHASIZE ,TEXT-INVESTMENT-LOSE20 ,TEXT-GUILD>
			<SET .INVESTMENTS <- </ .INVESTMENTS 5>>>
		)(<L=? .ROLL 6>
			<EMPHASIZE ,TEXT-INVESTMENT-LOSE10 ,TEXT-GUILD>
			<SET .INVESTMENTS <- </ .INVESTMENTS 10>>>
		)(<L=? .ROLL 8>
			<EMPHASIZE ,TEXT-INVESTMENT-PROFIT10 ,TEXT-GUILD>
			<SET .INVESTMENTS <+ </ .INVESTMENTS 10>>>
		)(<L=? .ROLL 11>
			<EMPHASIZE ,TEXT-INVESTMENT-PROFIT20 ,TEXT-GUILD>
			<SET .INVESTMENTS <+ </ .INVESTMENTS 5>>>
		)(ELSE
			<EMPHASIZE ,TEXT-INVESTMENT-PROFIT25 ,TEXT-GUILD>
			<SET .INVESTMENTS <+ </ .INVESTMENTS 4>>>
		)>
		<COND (<L? .INVESTMENTS 0> <SET .INVESTMENTS 0>)>
		<PUTP .STORY ,P?INVESTMENTS .INVESTMENTS>
	)(ELSE
		<EMPHASIZE "You have no investments here!" ,TEXT-GUILD>
	)>>

<ROUTINE GUILD-ACTIVITY ("OPT" STORY (INVEST T) "AUX" KEY MONEY NUMBER PROPERTY FEE)
	<COND (<NOT .STORY> <SET STORY ,HERE>)>
	<COND (.INVEST
		<SET PROPERTY ,P?INVESTMENTS>
	)(ELSE
		<SET PROPERTY ,P?MONEY>
	)>
	<REPEAT ()
		<SET MONEY <GETP .STORY .PROPERTY>>
		<CRLF>
		<TELL "Current ">
		<COND (.INVEST
			<TELL "investments: " N .MONEY CR>
		)(ELSE
			<TELL "banked money: " N .MONEY CR>
		)>
		<CRLF>
		<HLIGHT ,H-BOLD>
		<TELL "1">
		<HLIGHT 0>
		<COND (.INVEST
			<TELL " - Invest (in multiples of 100 " D ,CURRENCY ")" CR>
		)(ELSE
			<TELL " - Deposit " D ,CURRENCY CR>
		)>
		<HLIGHT ,H-BOLD>
		<TELL "2">
		<HLIGHT 0>
		<TELL " - Withdraw ">
		<COND (.INVEST
			<TELL "investments" CR>
		)(ELSE
			<TELL D ,CURRENCY " (Guild charges 10%)" CR>
		)>
		<HLIGHT ,H-BOLD>
		<TELL "0">
		<HLIGHT 0>
		<TELL " - Bye" CR>
		<TELL "You are currently carrying: " N ,MONEY " " D ,CURRENCY "." CR>
		<TELL "Select what to do next: ">
		<REPEAT ()
			<SET KEY <INPUT 1>>
			<COND (<EQUAL? .KEY !\0 !\1 !\2> <RETURN>)>
		>
		<COND (<EQUAL? .KEY !\1>
			<CRLF>
			<COND (<OR <AND .INVEST <G=? ,MONEY 100>> <NOT .INVEST>>
				<REPEAT ()
					<COND (.INVEST
						<SET NUMBER <GET-NUMBER "How much will you invest" 0 ,MONEY>>
					)(ELSE
						<SET NUMBER <GET-NUMBER "How much will you deposit" 0 ,MONEY>>
					)>
					<COND (<G? .NUMBER 0>
						<COND (<AND .INVEST <OR <L? .NUMBER 100> <G? <MOD .NUMBER 100> 0>>>
							<EMPHASIZE "Only amounts that are multiples of 100 are accepted!">
							<PRESS-A-KEY>
						)(ELSE
							<CRLF>
							<TELL ,TEXT-SURE>
							<COND (<YES?>
								<PUTP .STORY .PROPERTY <+ .MONEY .NUMBER>>
								<SETG MONEY <- ,MONEY .NUMBER>>
								<EMPHASIZE ,TEXT-EXCELLENT ,TEXT-GUILD>
								<UPDATE-STATUS-LINE>
								<PRESS-A-KEY>
								<RETURN>
							)>
						)>
					)(ELSE
						<RETURN>
					)>
				>
			)(.INVEST
				<CRLF>
				<EMPHASIZE ,TEXT-GUILD-BROKE ,TEXT-GUILD>
			)>
		)(<EQUAL? .KEY !\2>
			<COND (<G? .MONEY 0>
				<CRLF>
				<REPEAT ()
					<SET NUMBER <GET-NUMBER "How much will you withdraw" 0 .MONEY>>
					<COND (<G? .NUMBER 0>
						<CRLF>
						<TELL ,TEXT-SURE>
						<COND (<YES?>
							<PUTP .STORY .PROPERTY <- .MONEY .NUMBER>>
							<SETG MONEY <+ ,MONEY .NUMBER>>
							<COND (<NOT .INVEST>
								<SET FEE </ .NUMBER 10>>
								<COND (<L? .FEE 0> <SET FEE 1>)>
								<COST-MONEY .FEE>
							)>
							<COND (.INVEST
								<EMPHASIZE "Please consider investing again in the future!" ,TEXT-GUILD>
							)(ELSE
								<EMPHASIZE "Please consider banking with us again in the future!" ,TEXT-GUILD>
							)>
							<UPDATE-STATUS-LINE>
							<PRESS-A-KEY>
						)>
					)>
					<RETURN>
				>
			)(ELSE
				<EMPHASIZE ,TEXT-GUILD-NONE ,TEXT-GUILD>
				<PRESS-A-KEY>
			)>
		)(<EQUAL? .KEY !\0>
			<CRLF>
			<TELL CR ,TEXT-SURE>
			<COND (<YES?>
				<EMPHASIZE ,TEXT-NEXT-TIME ,TEXT-GUILD>
				<RETURN>
			)(ELSE
				<EMPHASIZE ,TEXT-EXCELLENT ,TEXT-GUILD>
			)>
		)>
		<COND (<L? ,MONEY 100>
			<EMPHASIZE "Thank you for doing business with us!" ,TEXT-GUILD>
			<RETURN>
		)>
	>>

; "Harbour Master routines"
; ---------------------------------------------------------------------------------------------

<CONSTANT SHIPS-LIST <PLTABLE SHIP-BARQUE SHIP-BRIGANTINE SHIP-GALLEON>>

<OBJECT CARGO-FURS
	(DESC "Furs")
	(TYPE 1)
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT CARGO-GRAINS
	(DESC "Grains")
	(TYPE 2)
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT CARGO-METALS
	(DESC "Metals")
	(TYPE 3)
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT CARGO-MINERALS
	(DESC "Minerals")
	(TYPE 4)
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT CARGO-SPICES
	(DESC "Spices")
	(TYPE 5)
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT CARGO-TEXTILES
	(DESC "Textiles")
	(TYPE 6)
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<OBJECT CARGO-TIMBER
	(DESC "Timber")
	(TYPE 7)
	(QUANTITY 1)
	(FLAGS TAKEBIT)>

<CONSTANT CARGO-LIST <PLTABLE CARGO-FURS CARGO-GRAINS CARGO-METALS CARGO-MINERALS CARGO-SPICES CARGO-TEXTILES CARGO-TIMBER>>

<CONSTANT BUY-SELL-CARGO-MENU <LTABLE "Buy goods" "Sell goods">>
<CONSTANT BUY-SELL-UPGRADE-MENU <LTABLE "Buy ship" "Sell ship" "Upgrade ship">>

<CONSTANT TEXT-NO-SHIPS "You don't own any ships!">
<CONSTANT TEXT-SHIP-NOT-OWNER "You don't own that ship!">

<CONSTANT HARBOUR-MASTER-MENU <LTABLE "Go to the shipyard" "Book a passage" "View ship manifest" "Visit the market" "Set sail">>
<CONSTANT TEXT-HARBOUR-MASTER "Harbour Master">

<ROUTINE BOOK-PASSAGE (PASSAGES PRICES DESTINATIONS "AUX" KEY COUNT CHOICE DESTINATION)
	<SET COUNT <GET .PASSAGES 0>>
	<SET DESTINATION NONE>
	<REPEAT ()
		<EMPHASIZE "You can buy a one-way passage on a ship to the following destinations:">
		<PRINT-MENU .PASSAGES F F !\0 ,TEXT-GO-BACK .PRICES>
		<TELL "Select destination:">
		<REPEAT ()
			<SET KEY <INPUT 1>>
			<COND (<OR <EQUAL? .KEY !\0> <AND <G=? .KEY !\1> <L=? .KEY <+ .COUNT !\0>>>> <RETURN>)>
		>
		<CRLF>
		<COND (<EQUAL? .KEY !\0>
			<TELL CR ,TEXT-SURE>
			<COND (<YES?>
				<SET DESTINATION NONE>
				<RETURN>
			)>
		)(ELSE
			<CRLF>
			<SET CHOICE <- .KEY !\0>>
			<COND (<G=? ,MONEY <GET .PRICES .CHOICE>>
				<TELL "Book a passage to ">
				<HLIGHT ,H-BOLD>
				<TELL <GET .PASSAGES .CHOICE>>
				<HLIGHT 0>
				<COND (<G? <GET .PRICES .CHOICE> 0>
					<TELL " for " N <GET .PRICES .CHOICE> " " D ,CURRENCY "?">
				)(ELSE
					<TELL "?">
				)>
				<COND (<YES?>
					<COND (<G? <GET .PRICES .CHOICE> 0>
						<COST-MONEY <GET .PRICES .CHOICE> ,TEXT-PAID>
					)>
					<SET DESTINATION <GET .DESTINATIONS .CHOICE>>
					<RETURN>
				)>
			)(ELSE
				<CRLF>
				<HLIGHT ,H-BOLD>
				<TELL "You cannot afford to book a passage to " <GET .PASSAGES .CHOICE> ,EXCLAMATION-CR>
				<HLIGHT 0>
			)>
		)>
	>
	<RETURN .DESTINATION>>

<ROUTINE BUY-CARGO (BUY-PRICES "AUX" (LIMIT 3))
	<COND (.BUY-PRICES
		<COND (,CURRENT-SHIP
			<SET LIMIT <GETP ,CURRENT-SHIP ,P?CAPACITY>>
		)>
		<MERCHANT ,CARGO-LIST .BUY-PRICES ,CARGO F .LIMIT>
	)>>

<ROUTINE BUY-SELL-CARGO (BUY-PRICES SELL-PRICES "AUX" KEY)
	<REPEAT ()
		<EMPHASIZE "Market">
		<PRINT-MENU ,BUY-SELL-CARGO-MENU F F !\0 ,TEXT-GO-BACK>
		<TELL "What do you want to do?">
		<REPEAT ()
			<SET KEY <INPUT 1>>
			<COND (<EQUAL? .KEY !\0 !\1 !\2> <RETURN>)>
		>
		<COND (<EQUAL? .KEY !\0>
			<CRLF>
			<TELL CR ,TEXT-SURE>
			<COND (<YES?> <RETURN>)>
		)(<EQUAL? .KEY !\1>
			<CRLF>
			<BUY-CARGO .BUY-PRICES>
		)(<EQUAL? .KEY !\2>
			<CRLF>
			<COND (<G? <COUNT-CONTAINER ,CARGO> 0>
				<SELL-CARGO .SELL-PRICES>
			)(ELSE
				<EMPHASIZE "You have nothing to sell!">
			)>
		)>
	>>

<ROUTINE BUY-SELL-UPGRADE-SHIP (BUY-PRICES SELL-PRICES UPGRADE-PRICES CARGO-PRICES DOCK "AUX" KEY)
	<REPEAT ()
		<EMPHASIZE "Shipyard">
		<PRINT-MENU ,BUY-SELL-UPGRADE-MENU F F !\0 ,TEXT-GO-BACK>
		<TELL "What do you want to do?">
		<REPEAT ()
			<SET KEY <INPUT 1>>
			<COND (<EQUAL? .KEY !\0 !\1 !\2 !\3> <RETURN>)>
		>
		<COND (<EQUAL? .KEY !\0>
			<CRLF>
			<TELL CR ,TEXT-SURE>
			<COND (<YES?> <RETURN>)>
		)(<EQUAL? .KEY !\1>
			<CRLF>
			<BUY-SHIP .BUY-PRICES .DOCK>
		)(<EQUAL? .KEY !\2>
			<CRLF>
			<SELL-SHIP .SELL-PRICES .CARGO-PRICES .DOCK>
		)(<EQUAL? .KEY !\3>
			<CRLF>
			<COND (<G? <COUNT-CONTAINER ,SHIPS> 0>
				<UPGRADE-SHIP .DOCK .UPGRADE-PRICES>
			)(ELSE
				<EMPHASIZE ,TEXT-NO-SHIPS>
			)>
		)>
	>>

<ROUTINE BUY-SHIP (BUY-PRICES "OPT" DOCK "AUX" KEY ITEM)
	<REPEAT ()
		<EMPHASIZE "Shipyard">
		<PRINT-MENU ,SHIPS-LIST T T !\0 ,TEXT-GO-BACK .BUY-PRICES>
		<COND (<G? <COUNT-CONTAINER ,SHIPS> 0>
			<DESCRIBE-PLAYER-SHIPS>
			<CRLF>
		)>
		<TELL "You are carrying " N ,MONEY " " D ,CURRENCY ,PERIOD-CR>
		<TELL "Which ship shall you buy?">
		<REPEAT ()
			<SET KEY <INPUT 1>>
			<COND (<EQUAL? .KEY !\0 !\1 !\2 !\3> <RETURN>)>
		>
		<COND (<EQUAL? .KEY !\0>
			<CRLF>
			<TELL CR ,TEXT-SURE>
			<COND (<YES?> <RETURN>)>
		)(ELSE
			<SET ITEM <- .KEY !\0>>
			<COND (<IN? <GET ,SHIPS-LIST .ITEM> ,SHIPS>
				<CRLF>
				<EMPHASIZE "You already own that ship!">
			)(<G=? ,MONEY <GET .BUY-PRICES .ITEM>>
				<CRLF>
				<TELL CR "Buy a " D <GET ,SHIPS-LIST .ITEM> "?">
				<COND (<YES?>
					<COST-MONEY <GET .BUY-PRICES .ITEM> ,TEXT-PAID>
					<MOVE <GET ,SHIPS-LIST .ITEM> ,SHIPS>
					<STORY-SET-DOCK .DOCK <GET ,SHIPS-LIST .ITEM> F>
					<COND (<NOT ,CURRENT-SHIP> <SETG CURRENT-SHIP <GET ,SHIPS-LIST .ITEM>>)>
					<CRLF>
					<TELL "You bought a ">
					<PRINT-ITEM <GET ,SHIPS-LIST .ITEM> T>
					<TELL ,PERIOD-CR>
					<UPDATE-STATUS-LINE>
				)>
			)(ELSE
				<CRLF>
				<EMPHASIZE "You can't afford that ship!">
			)>
		)>
	>>

<ROUTINE SELL-ALL-CARGO (CARGO-PRICES "OPT" CONTAINER "AUX" ITEM TYPE PROFIT QUANTITY)
	<COND (<NOT .CONTAINER> <SET .CONTAINER ,CARGO>)>
	<COND (<G? <COUNT-CONTAINER .CONTAINER> 0>
		<SET PROFIT 0>
		<SET ITEM <FIRST? .CONTAINER>>
		<REPEAT ()
			<COND (<NOT .ITEM> <RETURN>)>
			<SET TYPE <GETP .ITEM ,P?TYPE>>
			<COND (<G? .TYPE 0>
				<SET QUANTITY <GETP .ITEM ,P?QUANTITY>>
				<SET PROFIT <+ .PROFIT <* .QUANTITY <GET .CARGO-PRICES .TYPE>>>>
			)>
			<SET ITEM <NEXT? .ITEM>>
		>
		<COND (<G? .PROFIT 0>
			<CRLF>
			<TELL "You sold: ">
			<PRINT-CONTAINER .CONTAINER>
			<RESET-CONTAINER .CONTAINER>
			<GAIN-MONEY .PROFIT>
		)>
	)>>

<ROUTINE SELL-CARGO (SELL-PRICES)
	<COND (.SELL-PRICES
		<MERCHANT ,CARGO-LIST .SELL-PRICES ,CARGO T>
	)>>

<ROUTINE SELL-SHIP (SELL-PRICES CARGO-PRICES DOCK "AUX" KEY ITEM)
	<REPEAT ()
		<EMPHASIZE "You can sell your ships at these prices" "Shipyard">
		<PRINT-MENU ,SHIPS-LIST T T !\0 ,TEXT-GO-BACK .SELL-PRICES>
		<COND (<G? <COUNT-CONTAINER ,SHIPS> 0>
			<DESCRIBE-PLAYER-SHIPS>
			<CRLF>
		)>
		<TELL "Which ship will you sell?">
		<REPEAT ()
			<SET KEY <INPUT 1>>
			<COND (<EQUAL? .KEY !\0 !\1 !\2 !\3> <RETURN>)>
		>
		<COND (<EQUAL? .KEY !\0>
			<CRLF>
			<TELL CR ,TEXT-SURE>
			<COND (<YES?> <RETURN>)>
		)(ELSE
			<SET ITEM <- .KEY !\0>>
			<COND (<NOT <IN? <GET ,SHIPS-LIST .ITEM> ,SHIPS>>
				<CRLF>
				<EMPHASIZE ,TEXT-SHIP-NOT-OWNER>
			)(<N=? <GETP <GET ,SHIPS-LIST .ITEM> ,P?DOCKED> .DOCK>
				<CRLF>
				<EMPHASIZE "That ship is not docked here!">
			)(ELSE
				<CRLF>
				<TELL CR "Sell " T <GET ,SHIPS-LIST .ITEM> "?">
				<COND (<YES?>
					<REMOVE <GET ,SHIPS-LIST .ITEM>>
					<COND (<EQUAL? ,CURRENT-SHIP <GET ,SHIPS-LIST .ITEM>>
						<SETG CURRENT-SHIP NONE>
					)>
					<CRLF>
					<TELL "You sold the ">
					<PRINT-ITEM <GET ,SHIPS-LIST .ITEM> T>
					<TELL ,PERIOD-CR>
					<GAIN-MONEY <GET .SELL-PRICES .ITEM>>
					<COND (<L=? <COUNT-CONTAINER ,SHIPS> 0> <SELL-ALL-CARGO .CARGO-PRICES>)>
					<PUTP <GET ,SHIPS-LIST .ITEM> ,P?CONDITION ,CONDITION-POOR>
					<UPDATE-STATUS-LINE>
				)>
			)>
		)>
	>>

<ROUTINE UPGRADE-SHIP (UPGRADE-PRICES DOCK "AUX" CONDITION KEY UPGRADES ITEM)
	<SET UPGRADES <LTABLE 0 0 0>>
	<REPEAT ()
		<DO (I 1 3)
			<COND (<IN? <GET ,SHIPS-LIST .I> ,SHIPS>
				<SET CONDITION <GETP <GET ,SHIPS-LIST .I> ,P?CONDITION>>
				<COND (<N=? .CONDITION ,CONDITION-EXCELLENT>
					<COND (<L=? .CONDITION <GET .UPGRADE-PRICES 0>>
						<PUT .UPGRADES .I <GET .UPGRADE-PRICES <+ .CONDITION 1>>>
					)(ELSE
						<PUT .UPGRADES .I 0>
					)>
				)(ELSE
					<PUT .UPGRADES .I 0>
				)>
			)(ELSE
				<PUT .UPGRADES .I 0>
			)>
		>
		<EMPHASIZE "You can upgrade ships at the following prices" "Shipyard">
		<PRINT-MENU ,SHIPS-LIST T T !\0 ,TEXT-GO-BACK .UPGRADES>
		<COND (<G? <COUNT-CONTAINER ,SHIPS> 0>
			<DESCRIBE-PLAYER-SHIPS>
			<CRLF>
		)>
		<TELL "You are carrying " N ,MONEY " " D ,CURRENCY ,PERIOD-CR>
		<TELL "Which ship shall you upgrade?">
		<REPEAT ()
			<SET KEY <INPUT 1>>
			<COND (<EQUAL? .KEY !\0 !\1 !\2 !\3> <RETURN>)>
		>
		<COND (<EQUAL? .KEY !\0>
			<CRLF>
			<TELL CR ,TEXT-SURE>
			<COND (<YES?>
				<RETURN>
			)>
		)(ELSE
			<CRLF>
			<SET .ITEM <- .KEY !\0>>
			<COND (<IN? <GET ,SHIPS-LIST .ITEM> ,SHIPS>
				<COND (<N=? <GETP <GET ,SHIPS-LIST .ITEM> ,P?DOCKED> .DOCK>
					<EMPHASIZE "That shipped is not docked here!">
				)(<EQUAL? <GET .UPGRADES .ITEM> 0>
					<EMPHASIZE "That ship can no longer be upgraded!">
				)(<G=? ,MONEY <GET .UPGRADES .ITEM>>
					<CRLF>
					<TELL "Upgrade " T <GET ,SHIPS-LIST .ITEM> "?">
					<COND (<YES?>
						<CRLF>
						<SET CONDITION <GETP <GET ,SHIPS-LIST .ITEM> ,P?CONDITION>>
						<COND (<G=? .CONDITION ,CONDITION-EXCELLENT>
							<EMPHASIZE "This ship can no longer be upgraded!">
						)(ELSE
							<INC .CONDITION>
							<PUTP <GET ,SHIPS-LIST .ITEM> ,P?CONDITION .CONDITION>
							<TELL "You upgraded the ">
							<PRINT-ITEM <GET ,SHIPS-LIST .ITEM> T>
							<TELL ,PERIOD-CR>
							<COST-MONEY <GET .UPGRADES .ITEM> ,TEXT-PAID>
							<UPDATE-STATUS-LINE>
						)>
					)>
				)(ELSE
					<EMPHASIZE "You can't afford to upgrade this ship!">
				)>
			)(ELSE
				<EMPHASIZE ,TEXT-SHIP-NOT-OWNER>
			)>
		)>
	>>

<ROUTINE VALIDATE-CARGO (SELL-PRICES "AUX" CAPACITY CARGO)
	<COND (<NOT ,CURRENT-SHIP> <RETURN>)>
	<SET CAPACITY <GETP ,CURRENT-SHIP ,P?CAPACITY>>
	<SET CARGO <COUNT-CONTAINER ,CARGO>>
	<COND (<G? .CARGO .CAPACITY>
		<EMPHASIZE "Your cargo has exceeded the maximum capacity of your designated ship!">
		<CRLF>
		<TELL "Sell the excess cargo?">
		<COND (<YES?>
			<STORY-LOSE-CARGO <- .CARGO .CAPACITY>>
			<SELL-ALL-CARGO .SELL-PRICES ,LOST-STUFF>
			<RTRUE>
		)>
		<RFALSE>
	)>
	<RTRUE>>

<ROUTINE VIEW-SHIP-MANIFEST ("AUX" LIST COUNT SHIP KEY)
	<COND (<L=? <COUNT-CONTAINER ,SHIPS> 0> <RETURN>)>
	<SET LIST <LTABLE NONE NONE NONE>>
	<REPEAT ()
		<EMPHASIZE "Ship manifest">
		<SET COUNT 0>
		<DO (I 1 3)
			<SET SHIP <GET ,SHIPS-LIST .I>>
			<COND (<IN? .SHIP ,SHIPS>
				<INC .COUNT>
				<PUT .LIST .COUNT .SHIP>
				<HLIGHT ,H-BOLD>
				<TELL N .COUNT>
				<HLIGHT 0>
				<TELL " [">
				<COND (<EQUAL? ,CURRENT-SHIP .SHIP>
					<HLIGHT ,H-BOLD>
					<TELL "X">
					<HLIGHT 0>
				)(ELSE
					<TELL " ">
				)>
				<TELL "] - ">
				<PRINT-ITEM <GET .LIST .COUNT> F>
				<CRLF>
			)>
		>
		<HLIGHT ,H-BOLD>
		<TELL "C">
		<HLIGHT 0>
		<TELL " - View Cargo" CR>
		<HLIGHT ,H-BOLD>
		<TELL "0">
		<HLIGHT 0>
		<TELL " - Back" CR>
		<TELL "Select primary ship: ">
		<REPEAT ()
			<SET KEY <INPUT 1>>
			<COND (<OR <EQUAL? .KEY !\0 !\C !\c> <AND <G=? .KEY !\1> <L=? .KEY <+ .COUNT !\0>> <N=? ,CURRENT-LOCATION ,LOCATION-OCEAN>>> <RETURN>)>
		>
		<CRLF>
		<COND (<EQUAL? .KEY !\0>
			<TELL CR ,TEXT-SURE>
			<COND (<YES?>
				<RETURN>
			)>
		)(<EQUAL? .KEY !\C !\c>
			<CRLF>
			<DESCRIBE-PLAYER-SHIPS>
			<PRESS-A-KEY>
		)(ELSE
			<COND (<N=? ,CURRENT-LOCATION ,LOCATION-OCEAN>
				<SET KEY <- .KEY !\0>>
				<COND (<EQUAL? ,CURRENT-SHIP <GET .LIST .KEY>>
					<SETG CURRENT-SHIP NONE>
				)(ELSE
					<SETG CURRENT-SHIP <GET .LIST .KEY>>
				)>
			)>
		)>
		<UPDATE-STATUS-LINE>
	>>

; "Shack routines"
; ---------------------------------------------------------------------------------------------

<CONSTANT CACHE-MENU <LTABLE "Leave/Take your possessions.">>
<CONSTANT TEXT-SHACK "You can leave possessions and money here to save having to carry them around with you. You can also rest here safely, and recover any Stamina points you have lost.">
<CONSTANT STORAGE-MENU <LTABLE "Leave/Take your possessions." "Leave/Withdraw money.">>
<CONSTANT STORAGE-MENU-MONEY <LTABLE "Leave some your money here." "Take the money that was kept here.">>
<CONSTANT STORAGE-MENU-POSSESSIONS <LTABLE "Leave some of your possessions here." "Take the  items that are kept here.">>

<ROUTINE PROCESS-POSSESSIONS (FROM TO MESSAGE "OPT" (LEAVE F) "AUX" ITEMS KEY CHOICE QUANTITY)
	<REPEAT ()
		<SET ITEMS <COUNT-CONTAINER .FROM>>
		<COND (<L=? .ITEMS 0> <RETURN>)>
		<CRLF>
		<HLIGHT ,H-BOLD>
		<COND (.LEAVE
			<TELL "You are carrying:">
		)(ELSE
			<TELL D .FROM>
		)>
		<HLIGHT 0>
		<CRLF>
		<PRINT-CONTAINER-MENU .FROM !\0 ,TEXT-BACK>
		<TELL "Choose what items to " .MESSAGE>
		<COND (.LEAVE
			<TELL " at ">
			<HLIGHT ,H-BOLD>
			<TELL D .TO>
			<HLIGHT 0>
			<TELL ": ">
		)(ELSE
			<TELL " from ">
			<HLIGHT ,H-BOLD>
			<TELL T .FROM>
			<HLIGHT 0>
			<TELL ": ">
		)>
		<REPEAT ()
			<SET .KEY <INPUT 1>>
			<COND (
				<OR
					<EQUAL? .KEY !\0>
					<AND <G=? .KEY !\1> <L=? .KEY !\9> <L=? <- .KEY !\0> .ITEMS>>
					<AND <G=? .KEY !\A> <L=? .KEY !\J> <L=? <+ <- .KEY !\A> 10> .ITEMS>>
					<AND <G=? .KEY !\a> <L=? .KEY !\j> <L=? <+ <- .KEY !\a> 10> .ITEMS>>
				>
				<RETURN>
			)>
		>
		<CRLF>
		<COND (<EQUAL? .KEY !\0>
			<RETURN>
		)(<OR <AND <G=? .KEY !\1> <L=? .KEY !\9> <L=? <- .KEY !\0> .ITEMS>> <AND <G=? .KEY !\A> <L=? .KEY !\J> <L=? <+ <- .KEY !\A> 10> .ITEMS>> <AND <G=? .KEY !\a> <L=? .KEY !\j> <L=? <+ <- .KEY !\a> 10> .ITEMS>>>
			<COND (<AND <G=? .KEY !\1> <L=? .KEY !\9> <L=? <- .KEY !\0> .ITEMS>>
				<SET CHOICE <- .KEY !\0>>
			)(<AND <G=? .KEY !\A> <L=? .KEY !\J> <L=? <+ <- .KEY !\A> 10> .ITEMS>>
				<SET CHOICE <+ <- .KEY !\A> 10>>
			)(<AND <G=? .KEY !\a> <L=? .KEY !\j> <L=? <+ <- .KEY !\a> 10> .ITEMS>>
				<SET CHOICE <+ <- .KEY !\a> 10>>
			)>
			<CRLF>
			<PRINT-CAP-STR .MESSAGE>
			<TELL " ">
			<HLIGHT ,H-BOLD>
			<PRINT-ITEM <GET-ITEM .CHOICE .FROM> T>
			<HLIGHT 0>
			<COND (.LEAVE
				<TELL " at ">
				<HLIGHT ,H-BOLD>
				<TELL T .TO "?">
			)(ELSE
				<TELL " from ">
				<HLIGHT ,H-BOLD>
				<TELL T .FROM "?">
			)>
			<HLIGHT 0>
			<COND (<YES?>
				<COND (.LEAVE
					<MOVE <GET-ITEM .CHOICE .FROM> .TO>	
				)(ELSE
					<COND (<EQUAL? .TO ,PLAYER>
						<COND (<G=? <COUNT-CONTAINER .TO> ,LIMIT-POSSESSIONS>
							<EMPHASIZE "You are already carrying too many items!">
						)(ELSE
							<SET QUANTITY <GETP <GET-ITEM .CHOICE .FROM> ,P?QUANTITY>>
							<COND (<G? .QUANTITY 1>
								<COND (<G? <+ <COUNT-CONTAINER .TO> .QUANTITY> ,LIMIT-POSSESSIONS>
									<CRLF>
									<TELL "Taking the ">
									<PRINT-ITEM <GET-ITEM .CHOICE .FROM> T>
									<TELL " will exceed the " N ,LIMIT-POSSESSIONS " possessions limit" ,EXCLAMATION-CR>
								)(ELSE
									<MOVE <GET-ITEM .CHOICE .FROM> .TO>
								)>
							)(ELSE
								<MOVE <GET-ITEM .CHOICE .FROM> .TO>
							)>
						)>
					)>
				)>
			)>
		)>
	>>

<ROUTINE PROCESS-HOUSE (STORY HOUSE "AUX" ROLL)
	<SET ROLL <RANDOM-EVENT 2 0 T>>
	<COND (<L=? .ROLL 9>
		<COND (<G? <COUNT-CONTAINER .HOUSE> 0>
			<EMPHASIZE "Everything just as you left it.">
		)(ELSE
			<EMPHASIZE ,NOTHING-HAPPENS>
		)>
	)(ELSE
		<EMPHASIZE "A fire destroyed your possessions!">
		<RESET-CONTAINER .HOUSE>
	)>>

<ROUTINE PROCESS-SHACK (STORY SHACK "OPT" FATAL CODEWORD JUMP "AUX" ROLL)
	<SET ROLL <RANDOM-EVENT 2 0 T>>
	<COND (<L=? .ROLL 6>
		<COND (<G? <COUNT-CONTAINER .SHACK> 0>
			<EMPHASIZE "Everything is safe.">
		)(ELSE
			<EMPHASIZE ,NOTHING-HAPPENS>
		)>
	)(<L=? .ROLL 8>
		<COND (<G? <GETP .SHACK ,P?MONEY> 0>
			<EMPHASIZE "A thief has taken any money left here!">
			<PUTP .SHACK ,P?MONEY 0>
		)(ELSE
			<EMPHASIZE "The thief did not find any money here!">
		)>
	)(<L=? .ROLL 10>
		<COND (.FATAL
			<EMPHASIZE "Fire has destroyed the shack and its contents!">
			<COND (.CODEWORD <DELETE-CODEWORD .CODEWORD>)>
			<RESET-CONTAINER .SHACK>
			<GAIN-MONEY <GETP .SHACK ,P?MONEY>>
			<PUTP .SHACK ,P?MONEY 0>
			<RTRUE>
		)(ELSE
			<EMPHASIZE "Raiders have stolen its contents!">
			<RESET-CONTAINER .SHACK>
			<RTRUE>
		)>
	)(ELSE
		<EMPHASIZE "Squatters!">
		<COND (.JUMP <STORY-JUMP .JUMP>)>
		<RTRUE>
	)>
	<RFALSE>>

<ROUTINE STORAGE-MONEY (STORY STORAGE "AUX" KEY NUMBER MONEY)
	<REPEAT ()
		<CRLF>
		<HLIGHT ,H-BOLD>
		<TELL D .STORAGE>
		<HLIGHT 0>
		<CRLF>
		<PRINT-MENU ,STORAGE-MENU-MONEY F F !\0 ,TEXT-BACK>
		<SET .MONEY <GETP .STORAGE ,P?MONEY>>
		<COND (<G? .MONEY 0>
			<TELL "There are ">
			<HLIGHT ,H-BOLD>
			<TELL N .MONEY>
			<HLIGHT 0>
			<TELL " " D ,CURRENCY " kept here at ">
			<HLIGHT ,H-BOLD>
			<TELL T .STORAGE ,PERIOD-CR>
			<HLIGHT 0>
		)>
		<TELL "You are carrying " N ,MONEY " " D ,CURRENCY ": ">
		<REPEAT ()
			<SET KEY <INPUT 1>>
			<COND (<EQUAL? .KEY !\0 !\1 !\2> <RETURN>)>
		>
		<CRLF>
		<COND (<EQUAL? .KEY !\0>
			<RETURN>
		)(<EQUAL? .KEY !\1>
			<COND (<G? ,MONEY 0>
				<SET NUMBER <GET-NUMBER "How much will you leave here" 0 ,MONEY>>
				<COND (<G? .NUMBER 0>
					<PUTP .STORAGE ,P?MONEY <+ .MONEY .NUMBER>>
					<COST-MONEY .NUMBER "left">
				)>
			)(ELSE
				<CRLF>
				<HLIGHT ,H-BOLD>
				<TELL "You are not carrying any " D, CURRENCY ,EXCLAMATION-CR>
				<HLIGHT 0>
				<PRESS-A-KEY>
			)>
		)(<EQUAL? .KEY !\2>
			<COND (<G? .MONEY 0>
				<SET NUMBER <GET-NUMBER "How much will you withdraw" 0 .MONEY>>
				<COND (<G? .NUMBER 0>
					<PUTP .STORAGE ,P?MONEY <- .MONEY .NUMBER>>
					<GAIN-MONEY .NUMBER>
				)>
			)(ELSE
				<EMPHASIZE "There is nothing to withdraw here!">
				<PRESS-A-KEY>
			)>
		)>
	>>

<ROUTINE STORAGE-POSSESSIONS (STORY STORAGE "AUX" KEY)
	<REPEAT ()
		<CRLF>
		<HLIGHT ,H-BOLD>
		<TELL D .STORAGE>
		<HLIGHT 0>
		<CRLF>
		<PRINT-MENU ,STORAGE-MENU-POSSESSIONS F F !\0 ,TEXT-BACK>
		<DESCRIBE-INVENTORY-MAIN>
		<TELL "What will you do next?">
		<REPEAT ()
			<SET KEY <INPUT 1>>
			<COND (<EQUAL? .KEY !\0 !\1 !\2> <RETURN>)>
		>
		<CRLF>
		<COND (<EQUAL? .KEY !\0>
			<RETURN>
		)(<EQUAL? .KEY !\1>
			<COND (<G? <COUNT-CONTAINER ,PLAYER> 0>
				<PROCESS-POSSESSIONS ,PLAYER .STORAGE "leave" T>
			)(ELSE
				<EMPHASIZE "You are not carrying anything!">
				<PRESS-A-KEY>
			)>
		)(<EQUAL? .KEY !\2>
			<COND (<G? <COUNT-CONTAINER .STORAGE> 0>
				<PROCESS-POSSESSIONS .STORAGE ,PLAYER  "take">
			)(ELSE
				<EMPHASIZE "Nothing is being kept here!">
				<PRESS-A-KEY>
			)>
		)>
	>>

<ROUTINE VISIT-STORAGE (STORY STORAGE "OPT" (FATAL F) (CODEWORD NONE) (JUMP NONE) "AUX" KEY)
	<COND (<L? ,STAMINA ,MAX-STAMINA> <GAIN-STAMINA <- ,MAX-STAMINA ,STAMINA>>)>
	<UPDATE-STATUS-LINE>
	<COND (<FSET? .STORAGE ,SHACKBIT>
		<COND (<PROCESS-SHACK .STORY .STORAGE .FATAL .CODEWORD .JUMP> <RETURN>)>
	)(<FSET? .STORAGE ,HOUSEBIT>
		<PROCESS-HOUSE .STORY .STORAGE>
	)>
	<PRESS-A-KEY>
	<REPEAT ()
		<CRLF>
		<HLIGHT ,H-BOLD>
		<TELL D .STORAGE>
		<HLIGHT 0>
		<CRLF>
		<PRINT-MENU ,STORAGE-MENU F F !\0 "You're done here">
		<TELL "What do you want to do?">
		<REPEAT ()
			<SET KEY <INPUT 1>>
			<COND (<EQUAL? .KEY !\0 !\1 !\2 !\0> <RETURN>)>
		>
		<CRLF>
		<COND (<EQUAL? .KEY !\0>
			<CRLF>
			<TELL ,TEXT-SURE>
			<COND(<YES?>
				<CRLF>
				<TELL "You leave your ">
				<HLIGHT ,H-BOLD>
				<TELL D .STORAGE>
				<HLIGHT 0>
				<TELL ,PERIOD-CR>
				<RETURN>
			)>
		)(<EQUAL? .KEY !\1>
			<STORAGE-POSSESSIONS .STORY .STORAGE>
		)(<EQUAL? .KEY !\2>
			<STORAGE-MONEY .STORY .STORAGE>
		)>
	>>

; "Inns, Tavern"
; ---------------------------------------------------------------------------------------------

<ROUTINE VISIT-INN ("OPT" (STORY NONE) (FEE 1) (GAIN 1) "AUX" (DAYS 0) (DIFFERENCE 0) (VISITS))
	<COND (<NOT .STORY> <SET STORY ,HERE>)>
	<COND (<L? ,STAMINA ,MAX-STAMINA>
		<SET DIFFERENCE <- ,MAX-STAMINA ,STAMINA>>
		<COND (<G=? ,MONEY .FEE>
			<REPEAT ()
				<CRLF>
				<TELL "It costs " N .FEE " per day to regain " N .GAIN " stamina" ,PERIOD-CR>
				<SET DAYS <GET-NUMBER "How many days will you spend here" 0 .DIFFERENCE>>
				<COND (<G? .DAYS 0>
					<COND (<G=? ,MONEY <* .DAYS .FEE>>
						<GAIN-STAMINA <* .DAYS .GAIN>>
						<COST-MONEY <* .DAYS .FEE> ,TEXT-PAID>
						<SET VISITS <GETP .STORY ,P?VISITS>>
						<SET VISITS <+ .VISITS .DAYS>>
						<PUTP .STORY ,P?VISITS .VISITS>
						<RETURN>
					)(ELSE
						<EMPHASIZE "You can't afford that!">
					)>
				)(ELSE
					<EMPHASIZE "You decide not to rest here.">
					<RETURN>
				)>
			>
		)(ELSE
			<EMPHASIZE "You cannot afford to rest here.">
		)>
	)(ELSE
		<EMPHASIZE "You are not injured and do not need to recover.">
	)>>

<ROUTINE VISIT-TAVERN ("OPT" (STORY NONE) (FEE 1) "AUX" (DAYS 0) (VISITS) (ROLL))
	<COND (<NOT .STORY> <SET STORY ,HERE>)>
	<COND (<L? ,STAMINA ,MAX-STAMINA>
		<COND (<G=? ,MONEY .FEE>
			<REPEAT ()
				<CRLF>
				<TELL "It costs " N .FEE " per day to get a bed here" ,PERIOD-CR>
				<SET DAYS <GET-NUMBER "How many days will you spend here" 0 100>>
				<COND (<G? .DAYS 0>
					<COND (<G=? ,MONEY <* .DAYS .FEE>>
						<DO (I 1 .DAYS)
							<SET VISITS <GETP .STORY ,P?VISITS>>
							<INC .VISITS>
							<PUTP .STORY ,P?VISITS .VISITS>
							<COST-MONEY .FEE ,TEXT-PAID>
							<CRLF>
							<TELL "Day " N .I "...">
							<SET ROLL <ROLL-DICE 1>>
							<HLIGHT ,H-BOLD>
							<COND (<L=? .ROLL 1>
								<TELL "Dysentery" ,EXCLAMATION-CR>
								<HLIGHT 0>
								<LOSE-STAMINA 1 ,DIED-GREW-WEAKER .STORY>
							)(<L=? .ROLL 2>
								<PREVENT-DOOM .STORY>
								<TELL "No gain or loss of Stamina" ,PERIOD-CR>
								<HLIGHT 0>
							)(ELSE
								<PREVENT-DOOM .STORY>
								<TELL "A good rest" ,EXCLAMATION-CR>
								<COND (<L? ,STAMINA ,MAX-STAMINA> <GAIN-STAMINA 1>)>
							)>
							<COND (<IS-ALIVE>
								<COND (<G=? ,STAMINA ,MAX-STAMINA>
									<PREVENT-DOOM .STORY>
									<RETURN>
								)(ELSE
									<CRLF>
									<TELL "Do you wish to continue your stay at the tavern?">
									<COND (<NOT <YES?>>
										<COND (<IS-ALIVE> <PREVENT-DOOM .STORY>)>
										<RETURN>
									)>
								)>
							)(ELSE
								<RETURN>
							)>
						>
						<RETURN>
					)(ELSE
						<EMPHASIZE "You can't afford that!">
					)>
				)(ELSE
					<EMPHASIZE "You decide not to rest here.">
					<PREVENT-DOOM .STORY>
					<RETURN>
				)>
			>
		)(ELSE
			<EMPHASIZE "You cannot afford to rest here.">
			<PREVENT-DOOM .STORY>
		)>
	)(ELSE
		<EMPHASIZE "You are not injured and do not need to recover.">
		<PREVENT-DOOM .STORY>
	)>>

; "Temple Routines"
; ---------------------------------------------------------------------------------------------

<ROUTINE BECOME-INITIATE (FEE WORSHIP)
	<COND (<NOT ,GOD>
		<COND (<G=? ,MONEY .FEE>
			<CRLF>
			<TELL ,TEXT-BECOME-INITIATE>
			<TELL " of " D .WORSHIP "?">
			<COND (<YES?>
				<COST-MONEY .FEE ,TEXT-PAID>
				<SETG GOD .WORSHIP>
				<UPDATE-STATUS-LINE>
			)>
		)(ELSE
			<CRLF>
			<HLIGHT ,H-BOLD>
			<TELL "You cannot afford to become an initiate of " D .WORSHIP " at this time" ,EXCLAMATION-CR>
			<HLIGHT 0>
		)>
	)(ELSE
		<CRLF>
		<HLIGHT ,H-BOLD>
		<TELL "You are already an initiate of " D ,GOD ,EXCLAMATION-CR>
		<HLIGHT 0>
	)>>

<ROUTINE BECOME-INITIATE-TYRNAI ("AUX" COMBAT)
	<SET COMBAT <GETP ,CURRENT-CHARACTER ,P?COMBAT>>
	<COND (<NOT ,GOD>
		<COND (<G=? .COMBAT 6>
			<CRLF>
			<TELL "Become an Initiate of ">
			<HLIGHT ,H-BOLD>
			<TELL D ,GOD-TYRNAI>
			<HLIGHT 0>
			<TELL " (COMBAT: ">
			<HLIGHT ,H-BOLD>
			<TELL N .COMBAT>
			<HLIGHT 0>
			<TELL ")?">
			<COND (<YES?>
				<SETG GOD ,GOD-TYRNAI>
				<CRLF>
				<HLIGHT ,H-BOLD>
				<TELL "You have become an Initiate of " D ,GOD ,PERIOD-CR>
				<HLIGHT 0>
			)>
		)(ELSE
			<CRLF>
			<TELL "You cannot become an Initiate of ">
			<HLIGHT ,H-BOLD>
			<TELL D ,GOD-TYRNAI>
			<HLIGHT 0>
			<TELL " at this time. Your combat is score is ">
			<HLIGHT ,H-BOLD>
			<TELL N .COMBAT>
			<HLIGHT 0>
			<TELL ", lower than the required.">
		)>
	)(ELSE
		<CRLF>
		<HLIGHT ,H-BOLD>
		<TELL "You are already an Initiate of " D ,GOD ,EXCLAMATION-CR>
		<HLIGHT 0>
	)>>

<ROUTINE GOD-CURE (FEE DISCOUNT INITIATE FLAG "OPT" FLAG2)
	<COND (<CHECK-GOD .INITIATE> <SET FEE .DISCOUNT>)>
	<CURE-AILMENTS .FEE .FLAG .FLAG2>>

<ROUTINE PURCHASE-BLESSING (FEE DISCOUNT INITIATE BLESSING)
	<COND (<NOT .BLESSING> <RETURN>)>
	<COND (<AND .INITIATE <CHECK-GOD .INITIATE>> <SET FEE .DISCOUNT>)>
	<COND (<CHECK-BLESSING .BLESSING>
		<CRLF>
		<TELL "You already have the ">
		<PRINT-ITEM .BLESSING T>
		<TELL ,EXCLAMATION-CR>
	)(<G=? ,MONEY .FEE>
		<CRLF>
		<TELL "Purchase this blessing for " N .FEE " " D ,CURRENCY "?">
		<COND (<YES?>
			<COST-MONEY .FEE ,TEXT-PAID>
			<GAIN-BLESSING .BLESSING>
		)>
	)(ELSE
		<EMPHASIZE "You cannot afford this blessing at this time.">
	)>>

<ROUTINE PURCHASE-RESURRECTION (FEE DISCOUNT INITIATE RESURRECTION "OPT" STORY)
	<COND (<NOT .RESURRECTION> <RETURN>)>
	<COND (<NOT .INITIATE> <RETURN>)>
	<COND (<CHECK-GOD .INITIATE> <SET FEE .DISCOUNT>)>
	<COND (,RESURRECTION-ARRANGEMENTS
		<CRLF>
		<TELL "You already have the resurrection arrangement: ">
		<PRINT-ITEM ,RESURRECTION-ARRANGEMENTS T>
		<TELL ,EXCLAMATION-CR>
		<COND (<G=? ,MONEY .FEE>
			<CRLF>
			<TELL "Do you wish to cancel this and make a new arrangement?">
			<COND (<YES?>
				<COST-MONEY .FEE ,TEXT-PAID>
				<SETG RESURRECTION-ARRANGEMENTS .RESURRECTION>
				<EMPHASIZE "You have made resurrection arrangements at this temple.">
				<COND (.STORY <PUTP .RESURRECTION ,P?CONTINUE .STORY>)>
			)>
		)(ELSE
			<EMPHASIZE "... and you cannot afford to make a new arrangement at this time.">
		)>
	)(<G=? ,MONEY .FEE>
		<CRLF>
		<TELL "Make resurrection arrangements at this temple for " N .FEE " " D ,CURRENCY "?">
		<COND (<YES?>
			<COST-MONEY .FEE ,TEXT-PAID>
			<SETG RESURRECTION-ARRANGEMENTS .RESURRECTION>
			<EMPHASIZE "You have made resurrection arrangements at this temple.">
		)>
	)(ELSE
		<EMPHASIZE "You cannot afford to make resurrection arrangements at this time.">
	)>>

<ROUTINE RENOUNCE-WORSHIP (FEE WORSHIP "AUX" RESURRECTION)
	<COND (,GOD
		<COND (<CHECK-GOD .WORSHIP>
			<COND (<G=? ,MONEY .FEE>
				<CRLF>
				<TELL "Renounce the worship of " D .WORSHIP "?">
				<COND (<YES?>
					<COND (<G? .FEE 0> <COST-MONEY .FEE ,TEXT-PAID>)>
					<SETG GOD NONE>
					<SET RESURRECTION <GETP .WORSHIP ,P?RESURRECTION>>
					<COND (.RESURRECTION
						<COND (<EQUAL? .RESURRECTION ,RESURRECTION-ANY>
							<EMPHASIZE "You lose all outstanding resurrection arrangements!">
							<SETG RESURRECTION-ARRANGEMENTS NONE>
						)(<EQUAL? ,RESURRECTION-ARRANGEMENTS .RESURRECTION>
							<EMPHASIZE "You've lost resurrection arrangements made at this temple!">
							<SETG RESURRECTION-ARRANGEMENTS NONE>
						)>
					)>
					<UPDATE-STATUS-LINE>
				)>
			)(ELSE
				<EMPHASIZE "You cannot afford to pay the compensation of the priesthood!">
			)>
		)(ELSE
			<CRLF>
			<HLIGHT ,H-BOLD>
			<TELL "You are not an initiate of " D .WORSHIP ,EXCLAMATION-CR>
			<HLIGHT 0>
		)>
	)(ELSE
		<EMPHASIZE "You are not an initiate of any god!">
	)>>

; "Markets"
; ---------------------------------------------------------------------------------------------

; "Smogmaw Market"
; ---------------------------------------------------------------------------------------------

<CONSTANT CHOICES-SMOGMAW-BUY <LTABLE "Buy armours/weapons (without COMBAT bonus)" "Buy weapons (with COMBAT bonus)" "Buy other items" TEXT-BACK>>

<ROOM SMOGMAW-MARKET-BUY
	(DESC "086 Smogmaw Market")
	(CHOICES CHOICES-SMOGMAW-BUY)
	(DESTINATIONS <PLTABLE SMOGMAW-BUY-ARMOURS SMOGMAW-BUY-WEAPONS SMOGMAW-BUY-OTHERS STORY086>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<ROOM SMOGMAW-BUY-ARMOURS
	(DESC "086 Merchant - Selling")
	(EVENTS SMOGMAW-BUYING-ARMOURS)
	(CONTINUE SMOGMAW-MARKET-BUY)
	(FLAGS LIGHTBIT)>

<ROOM SMOGMAW-BUY-WEAPONS
	(DESC "086 Merchant - Selling")
	(EVENTS SMOGMAW-BUYING-WEAPONS)
	(CONTINUE SMOGMAW-MARKET-BUY)
	(FLAGS LIGHTBIT)>

<ROOM SMOGMAW-BUY-OTHERS
	(DESC "086 Merchant - Selling")
	(EVENTS SMOGMAW-BUYING-OTHERS)
	(CONTINUE SMOGMAW-MARKET-BUY)
	(FLAGS LIGHTBIT)>

<ROUTINE SMOGMAW-BUYING-ARMOURS ()
	<MERCHANT <PLTABLE LEATHER-ARMOUR RING-MAIL AXE BATTLE-AXE MACE SPEAR STAFF SWORD> <PLTABLE 40 150 40 40 40 40 40 40>>>

<ROUTINE SMOGMAW-BUYING-WEAPONS ()
	<MERCHANT <PLTABLE AXE1 BATTLE-AXE1 MACE1 SPEAR1 STAFF1 SWORD1 AXE2 BATTLE-AXE2 MACE2 SPEAR2 STAFF2 SWORD2> <PLTABLE 200 200 200 200 200 200 450 450 450 450 450 450>>>

<ROUTINE SMOGMAW-BUYING-OTHERS ()
	<MERCHANT <PLTABLE COMPASS CROSS-STAFF SEXTANT LOCKPICKS HOLY-SYMBOL ROPE LANTERN PARROT PARROT-FUNGUS> <PLTABLE 400 800 1200 250 200 40 140 75 150>>>

<CONSTANT CHOICES-SMOGMAW-SELL <LTABLE "Sell armours/weapons (without COMBAT bonus)" "Sell weapons (+1 COMBAT)" "Sell weapons (+2 COMBAT)" "Sell weapons (+3 COMBAT)" "Sell other items"  TEXT-BACK>>

<ROOM SMOGMAW-MARKET-SELL
	(DESC "086 Smogmaw Market")
	(CHOICES CHOICES-SMOGMAW-SELL)
	(DESTINATIONS <PLTABLE SMOGMAW-SELL-ARMOURS SMOGMAW-SELL-WEAPONS1 SMOGMAW-SELL-WEAPONS2 SMOGMAW-SELL-WEAPONS3 SMOGMAW-SELL-OTHERS STORY086>)
	(TYPES SIX-CHOICES)
	(FLAGS LIGHTBIT)>

<ROOM SMOGMAW-SELL-ARMOURS
	(DESC "086 Merchant - Buying")
	(EVENTS SMOGMAW-SELLING-ARMOURS)
	(CONTINUE SMOGMAW-MARKET-SELL)
	(FLAGS LIGHTBIT)>

<ROOM SMOGMAW-SELL-WEAPONS1
	(DESC "086 Merchant - Buying")
	(EVENTS SMOGMAW-SELLING-WEAPONS1)
	(CONTINUE SMOGMAW-MARKET-SELL)
	(FLAGS LIGHTBIT)>

<ROOM SMOGMAW-SELL-WEAPONS2
	(DESC "086 Merchant buying weapons")
	(EVENTS SMOGMAW-SELLING-WEAPONS2)
	(CONTINUE SMOGMAW-MARKET-SELL)
	(FLAGS LIGHTBIT)>

<ROOM SMOGMAW-SELL-WEAPONS3
	(DESC "086 Merchant - Buying")
	(EVENTS SMOGMAW-SELLING-WEAPONS3)
	(CONTINUE SMOGMAW-MARKET-SELL)
	(FLAGS LIGHTBIT)>

<ROOM SMOGMAW-SELL-OTHERS
	(DESC "086 Merchant - Buying")
	(EVENTS SMOGMAW-SELLING-OTHERS)
	(CONTINUE SMOGMAW-MARKET-SELL)
	(FLAGS LIGHTBIT)>

<ROUTINE SMOGMAW-SELLING-ARMOURS ()
	<MERCHANT <PLTABLE LEATHER-ARMOUR RING-MAIL CHAIN-MAIL AXE BATTLE-AXE MACE SPEAR STAFF SWORD> <PLTABLE 35 100 150 35 35 35 35 35 35> ,PLAYER T>>

<ROUTINE SMOGMAW-SELLING-WEAPONS1 ()
	<MERCHANT <PLTABLE AXE1 BATTLE-AXE1 MACE1 SPEAR1 STAFF1 SWORD1> <PLTABLE 175 175 175 175 175 175> ,PLAYER T>>

<ROUTINE SMOGMAW-SELLING-WEAPONS2 ()
	<MERCHANT <PLTABLE AXE2 BATTLE-AXE2 MACE2 SPEAR2 STAFF2 SWORD2> <PLTABLE 375 375 375 375 375 375> ,PLAYER T>>

<ROUTINE SMOGMAW-SELLING-WEAPONS3 ()
	<MERCHANT <PLTABLE AXE3 BATTLE-AXE3 MACE3 SPEAR3 STAFF3 SWORD3> <PLTABLE 750 750 750 750 750 750> ,PLAYER T>>

<ROUTINE SMOGMAW-SELLING-OTHERS ("AUX" (HAS-PIRATES-HEAD F))
	<COND (<CHECK-ITEM ,PIRATE-CAPTAINS-HEAD> <SET HAS-PIRATES-HEAD T>)>
	<SETG SOLD-PIRATES-HEAD F>
	<MERCHANT <PLTABLE COMPASS CROSS-STAFF SEXTANT LOCKPICKS MARINERS-RUTTIER SELENIUM-ORE HOLY-SYMBOL ROPE LANTERN FRETWORK-KEY PARROT PARROT-FUNGUS PIRATE-CAPTAINS-HEAD> <PLTABLE 320 640 1000 180 200 350 100 25 100 1000 25 120 75> ,PLAYER T>
	<COND (.HAS-PIRATES-HEAD
		<COND (<CHECK-ITEM ,PIRATE-CAPTAINS-HEAD>
			<SETG SOLD-PIRATES-HEAD F>
		)(ELSE
			<SETG SOLD-PIRATES-HEAD T>
		)>
	)>>

; "Copper Island Market"
; ---------------------------------------------------------------------------------------------

<CONSTANT CHOICES-COPPER-BUY <LTABLE "Buy armours/weapons" "Buy weapons (with COMBAT bonus)" "Buy other items" TEXT-BACK>>

<ROOM COPPER-ISLAND-BUY
	(DESC "297 Copper Island Market")
	(CHOICES CHOICES-COPPER-BUY)
	(DESTINATIONS <PLTABLE COPPER-BUY-ARMOURS COPPER-BUY-WEAPONS COPPER-BUY-OTHERS STORY297>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<ROOM COPPER-BUY-ARMOURS
	(DESC "297 Merchant - Selling")
	(EVENTS COPPER-BUYING-ARMOURS)
	(CONTINUE COPPER-ISLAND-BUY)
	(FLAGS LIGHTBIT)>

<ROOM COPPER-BUY-WEAPONS
	(DESC "297 Merchant - Selling")
	(EVENTS COPPER-BUYING-WEAPONS)
	(CONTINUE COPPER-ISLAND-BUY)
	(FLAGS LIGHTBIT)>

<ROOM COPPER-BUY-OTHERS
	(DESC "297 Merchant - Selling")
	(EVENTS COPPER-BUYING-OTHERS)
	(CONTINUE COPPER-ISLAND-BUY)
	(FLAGS LIGHTBIT)>

<ROUTINE COPPER-BUYING-ARMOURS ()
	<MERCHANT <PLTABLE LEATHER-ARMOUR RING-MAIL CHAIN-MAIL AXE BATTLE-AXE MACE SPEAR STAFF SWORD> <PLTABLE 60 120 240 50 50 50 50 50 50>>>

<ROUTINE COPPER-BUYING-WEAPONS ()
	<MERCHANT <PLTABLE AXE1 BATTLE-AXE1 MACE1 SPEAR1 STAFF1 SWORD1> <PLTABLE 250 250 250 250 250 250>>>

<ROUTINE COPPER-BUYING-OTHERS ()
	<MERCHANT <PLTABLE COMPASS CROSS-STAFF SEXTANT LANTERN> <PLTABLE 500 900 1300 80>>>

<ROOM COPPER-ISLAND-SELL
	(DESC "297 Copper Island Market")
	(CHOICES CHOICES-COPPER-SELL)
	(DESTINATIONS <PLTABLE COPPER-SELL-ARMOURS COPPER-SELL-WEAPONS1 COPPER-SELL-WEAPONS2 COPPER-SELL-OTHERS STORY297>)
	(TYPES FIVE-CHOICES)
	(FLAGS LIGHTBIT)>

<ROOM COPPER-SELL-ARMOURS
	(DESC "297 Merchant - Buying")
	(EVENTS COPPER-SELLING-ARMOURS)
	(CONTINUE COPPER-ISLAND-SELL)
	(FLAGS LIGHTBIT)>

<ROOM COPPER-SELL-WEAPONS1
	(DESC "297 Merchant - Buying")
	(EVENTS COPPER-SELLING-WEAPONS1)
	(CONTINUE COPPER-ISLAND-SELL)
	(FLAGS LIGHTBIT)>

<ROOM COPPER-SELL-WEAPONS2
	(DESC "297 Merchant - Buying")
	(EVENTS COPPER-SELLING-WEAPONS2)
	(CONTINUE COPPER-ISLAND-SELL)
	(FLAGS LIGHTBIT)>

<CONSTANT CHOICES-COPPER-SELL <LTABLE "Sell armours/magic/weapons" "Sell weapons (+1 COMBAT)" "Sell weapons (+2 COMBAT)" "Sell other items"  TEXT-BACK>>

<ROOM COPPER-SELL-OTHERS
	(DESC "297 Merchant - Buying")
	(EVENTS COPPER-SELLING-OTHERS)
	(CONTINUE COPPER-ISLAND-SELL)
	(FLAGS LIGHTBIT)>

<ROUTINE COPPER-SELLING-ARMOURS ()
	<MERCHANT <PLTABLE LEATHER-ARMOUR RING-MAIL CHAIN-MAIL AXE BATTLE-AXE MACE SPEAR STAFF SWORD AMBER-WAND> <PLTABLE 45 90 180 40 40 40 40 40 40 300> ,PLAYER T>>

<ROUTINE COPPER-SELLING-WEAPONS1 ()
	<MERCHANT <PLTABLE AXE1 BATTLE-AXE1 MACE1 SPEAR1 STAFF1 SWORD1> <PLTABLE 200 200 200 200 200 200> ,PLAYER T>>

<ROUTINE COPPER-SELLING-WEAPONS2 ()
	<MERCHANT <PLTABLE AXE2 BATTLE-AXE2 MACE2 SPEAR2 STAFF2 SWORD2> <PLTABLE 400 400 400 400 400 400> ,PLAYER T>>

<ROUTINE COPPER-SELLING-OTHERS ()
	<MERCHANT <PLTABLE COMPASS CROSS-STAFF SEXTANT LANTERN SELENIUM-ORE> <PLTABLE 400 700 1100 40 700> ,PLAYER T>>

; "Vervayens Market"
; ---------------------------------------------------------------------------------------------

<CONSTANT FREE-ITEMS <PLTABLE AXE BATTLE-AXE MACE SPEAR STAFF SWORD LEATHER-ARMOUR CANDLE ROPE>>
<CONSTANT GOT-FREE <LTABLE F F F F F F F F F>>
<GLOBAL SOLD-FREE F>

; "Checks if an item was received for free"
<ROUTINE GOTTEN-FREE (ITEM "AUX" COUNT)
	<COND (.ITEM
		<SET COUNT <GET ,FREE-ITEMS 0>>
		<DO (I 1 .COUNT)
			<COND (<EQUAL? .ITEM <GET ,FREE-ITEMS .I>>
				<PUT ,GOT-FREE .I T>
			)>
		>
	)>>

; "resets list"
<ROUTINE RESET-GOT-FREE ("AUX" COUNT)
	<SET COUNT <GET ,FREE-ITEMS 0>>
	<DO (I 1 .COUNT) <PUT ,GOT-FREE .I F>>
	<SETG SOLD-FREE F>>

; "Checks if an item gotten for free was sold"
<ROUTINE CHECK-SOLD-FREE (ITEM "AUX" COUNT)
	<COND (.ITEM
		<SET COUNT <GET ,FREE-ITEMS 0>>
		<DO (I 1 .COUNT)
			<COND (<EQUAL? .ITEM <GET ,FREE-ITEMS .I>>
				<COND (<GET ,GOT-FREE .I> <SETG SOLD-FREE T>)>
			)>
		>
	)>>

<CONSTANT CHOICES-VERVAYENS-BUY <LTABLE "Buy armours" "Buy weapons" "Buy other items" TEXT-BACK>>

<ROOM VERVAYENS-MARKET-BUY
	(DESC "318 Vervayens Market")
	(CHOICES CHOICES-VERVAYENS-BUY)
	(DESTINATIONS <PLTABLE VERVAYENS-BUY-ARMOURS VERVAYENS-BUY-WEAPONS VERVAYENS-BUY-OTHERS STORY318>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<ROOM VERVAYENS-BUY-ARMOURS
	(DESC "318 Merchant - Selling")
	(EVENTS VERVAYENS-BUYING-ARMOURS)
	(CONTINUE VERVAYENS-MARKET-BUY)
	(FLAGS LIGHTBIT)>

<ROOM VERVAYENS-BUY-WEAPONS
	(DESC "318 Merchant - Selling")
	(EVENTS VERVAYENS-BUYING-WEAPONS)
	(CONTINUE VERVAYENS-MARKET-BUY)
	(FLAGS LIGHTBIT)>

<ROOM VERVAYENS-BUY-OTHERS
	(DESC "318 Merchant - Selling")
	(EVENTS VERVAYENS-BUYING-OTHERS)
	(CONTINUE VERVAYENS-MARKET-BUY)
	(FLAGS LIGHTBIT)>

<ROUTINE VERVAYENS-BUYING-ARMOURS ()
	<MERCHANT <PLTABLE LEATHER-ARMOUR RING-MAIL CHAIN-MAIL> <PLTABLE -1 80 150>>>

<ROUTINE VERVAYENS-BUYING-WEAPONS ()
	<MERCHANT <PLTABLE AXE BATTLE-AXE MACE SPEAR STAFF SWORD AXE1 BATTLE-AXE1 MACE1 SPEAR1 STAFF1 SWORD1> <PLTABLE -1 -1 -1 -1 -1 -1 180 180 180 180 180 180>>>

<ROUTINE VERVAYENS-BUYING-OTHERS()
	<MERCHANT <PLTABLE CANDLE ROPE LANTERN> <PLTABLE -1 -1 75>>>

<CONSTANT CHOICES-VERVAYENS-SELL <LTABLE "Sell armours" "Sell weapons" "Sell weapons (+1 COMBAT)" "Sell weapons (+2 COMBAT)" "Sell weapons (+3 COMBAT)" "Sell other items" TEXT-BACK>>

<ROOM VERVAYENS-MARKET-SELL
	(DESC "318 Vervayens Market")
	(CHOICES CHOICES-VERVAYENS-SELL)
	(DESTINATIONS <PLTABLE VERVAYENS-SELL-ARMOURS VERVAYENS-SELL-WEAPONS VERVAYENS-SELL-WEAPONS1 VERVAYENS-SELL-WEAPONS2 VERVAYENS-SELL-WEAPONS3 VERVAYENS-SELL-OTHERS STORY318>)
	(TYPES SEVEN-CHOICES)
	(FLAGS LIGHTBIT)>

<ROOM VERVAYENS-SELL-ARMOURS
	(DESC "318 Merchant - Buying")
	(EVENTS VERVAYENS-SELLING-ARMOURS)
	(CONTINUE VERVAYENS-MARKET-SELL)
	(FLAGS LIGHTBIT)>

<ROOM VERVAYENS-SELL-WEAPONS
	(DESC "318 Merchant - Buying")
	(EVENTS VERVAYENS-SELLING-WEAPONS)
	(CONTINUE VERVAYENS-MARKET-SELL)
	(FLAGS LIGHTBIT)>

<ROOM VERVAYENS-SELL-WEAPONS1
	(DESC "318 Merchant - Buying")
	(EVENTS VERVAYENS-SELLING-WEAPONS1)
	(CONTINUE VERVAYENS-MARKET-SELL)
	(FLAGS LIGHTBIT)>

<ROOM VERVAYENS-SELL-WEAPONS2
	(DESC "318 Merchant - Buying")
	(EVENTS VERVAYENS-SELLING-WEAPONS2)
	(CONTINUE VERVAYENS-MARKET-SELL)
	(FLAGS LIGHTBIT)>

<ROOM VERVAYENS-SELL-WEAPONS3
	(DESC "318 Merchant - Buying")
	(EVENTS VERVAYENS-SELLING-WEAPONS3)
	(CONTINUE VERVAYENS-MARKET-SELL)
	(FLAGS LIGHTBIT)>

<ROOM VERVAYENS-SELL-OTHERS
	(DESC "318 Merchant - Buying")
	(EVENTS VERVAYENS-SELLING-OTHERS)
	(CONTINUE VERVAYENS-MARKET-SELL)
	(FLAGS LIGHTBIT)>

<ROUTINE VERVAYENS-SELLING-ARMOURS ()
	<MERCHANT <PLTABLE LEATHER-ARMOUR RING-MAIL CHAIN-MAIL SPLINT-ARMOUR PLATE-ARMOUR HEAVY-PLATE> <PLTABLE 40 80 150 300 700 1000> ,PLAYER T>>

<ROUTINE VERVAYENS-SELLING-WEAPONS ()
	<MERCHANT <PLTABLE AXE BATTLE-AXE MACE SPEAR STAFF SWORD> <PLTABLE 40 40 40 40 40 40> ,PLAYER T>>

<ROUTINE VERVAYENS-SELLING-WEAPONS1 ()
	<MERCHANT <PLTABLE AXE1 BATTLE-AXE1 MACE1 SPEAR1 STAFF1 SWORD1> <PLTABLE 180 180 180 180 180 180> ,PLAYER T>>

<ROUTINE VERVAYENS-SELLING-WEAPONS2 ()
	<MERCHANT <PLTABLE AXE2 BATTLE-AXE2 MACE2 SPEAR2 STAFF2 SWORD2> <PLTABLE 280 280 280 280 280 280> ,PLAYER T>>

<ROUTINE VERVAYENS-SELLING-WEAPONS3 ()
	<MERCHANT <PLTABLE AXE3 BATTLE-AXE3 MACE3 SPEAR3 STAFF3 SWORD3> <PLTABLE 400 400 400 400 400 400> ,PLAYER T>>

<ROUTINE VERVAYENS-SELLING-OTHERS ()
	<MERCHANT <PLTABLE CANDLE ROPE LANTERN> <PLTABLE 1 30 75> ,PLAYER T>>

; "Shaman's Hut"
; ---------------------------------------------------------------------------------------------

<CONSTANT CHOICES-SHAMANS-BUY <LTABLE "Buy magic items" "Buy other items" TEXT-BACK>>

<ROOM SHAMANS-HUT-BUY
	(DESC "332 Shaman's Hut")
	(CHOICES CHOICES-SHAMANS-BUY)
	(DESTINATIONS <PLTABLE SHAMANS-BUY-MAGIC SHAMANS-BUY-OTHERS STORY332>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<ROOM SHAMANS-BUY-MAGIC
	(DESC "332 Shaman - Selling")
	(EVENTS SHAMANS-BUYING-MAGIC)
	(CONTINUE SHAMANS-HUT-BUY)
	(FLAGS LIGHTBIT)>

<ROOM SHAMANS-BUY-OTHERS
	(DESC "332 Shaman - Selling")
	(EVENTS SHAMANS-BUYING-OTHERS)
	(CONTINUE SHAMANS-HUT-BUY)
	(FLAGS LIGHTBIT)>

<ROUTINE SHAMANS-BUYING-MAGIC ()
	<MERCHANT <PLTABLE AMBER-WAND EBONY-WAND COBALT-WAND SELENIUM-WAND> <PLTABLE 500 1000 2000 4000>>>

<ROUTINE SHAMANS-BUYING-OTHERS ()
	<MERCHANT <PLTABLE HYDRA-TOOTH WITCH-HAND SPECTRAL-VEIL> <PLTABLE 1250 300 500>>>

<CONSTANT CHOICES-SHAMANS-SELL <LTABLE "Sell magic items" "Sell other items" TEXT-BACK>>

<ROOM SHAMANS-HUT-SELL
	(DESC "332 Shaman's Hut")
	(CHOICES CHOICES-SHAMANS-SELL)
	(DESTINATIONS <PLTABLE SHAMANS-SELL-MAGIC SHAMANS-SELL-OTHERS STORY332>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<ROOM SHAMANS-SELL-MAGIC
	(DESC "332 Shaman - Buying")
	(EVENTS SHAMANS-SELLING-MAGIC)
	(CONTINUE SHAMANS-HUT-SELL)
	(FLAGS LIGHTBIT)>

<ROOM SHAMANS-SELL-OTHERS
	(DESC "332 Shaman - Buying")
	(EVENTS SHAMANS-SELLING-OTHERS)
	(CONTINUE SHAMANS-HUT-SELL)
	(FLAGS LIGHTBIT)>

<ROUTINE SHAMANS-SELLING-MAGIC ()
	<MERCHANT <PLTABLE AMBER-WAND EBONY-WAND COBALT-WAND SELENIUM-WAND CELESTIUM-WAND> <PLTABLE 300 700 1500 3000 4500> ,PLAYER T>>

<ROUTINE SHAMANS-SELLING-OTHERS ()
	<MERCHANT <PLTABLE FAERY-MEAD SILVER-HORSESHOE HYDRA-TOOTH FOUR-LEAF-CLOVER WITCH-HAND SCROLL-OF-EBRON SEA-GREEN-LENS SPECTRAL-VEIL SELENIUM-ORE> <PLTABLE 400 200 750 100 150 350 100 200 600> ,PLAYER T>>

; "Flotilla market"
; ---------------------------------------------------------------------------------------------

<ROOM FLOTILLA-BUY
	(DESC "480 Gypsies - Selling")
	(EVENTS FLOTILLA-BUYING-OTHER)
	(CONTINUE STORY480)
	(FLAGS LIGHTBIT)>

<ROUTINE FLOTILLA-BUYING-OTHER ()
	<MERCHANT <PLTABLE ROPE LANTERN CANDLE WATER-FLASK CORAL-RED-TRESSES GOLDEN-KATANA SMOULDER-FISH CROSS-STAFF VIOLIN PARROT FISHING-HOOK BOARS-TUSK GREEN-GEM> <PLTABLE 30 75 10 25 1000 10000 110 700 90 200 5 150 575>>>

<ROOM FLOTILLA-SELL
	(DESC "480 Gypsies - Buying")
	(EVENTS FLOTILLA-SELLING-OTHER)
	(CONTINUE STORY480)
	(FLAGS LIGHTBIT)>

<ROUTINE FLOTILLA-SELLING-OTHER ()
	<MERCHANT <PLTABLE ROPE LANTERN CANDLE WATER-FLASK CORAL-RED-TRESSES GOLDEN-KATANA SMOULDER-FISH CROSS-STAFF VIOLIN PARROT FISHING-HOOK BOARS-TUSK GREEN-GEM> <PLTABLE 20 60 5 20 500 3000 90 500 50 90 2 75 100> ,PLAYER T>>

; "Instructions"
; ---------------------------------------------------------------------------------------------

<CONSTANT INSTRUCTIONS-HEADER "|HOW TO USE THIS E-ADVENTURE|">
<CONSTANT INSTRUCTIONS-TEXT "Fabled Lands: Over the Blood-Dark sea is a digital gamebook -- an interactive game where the choices that you make correspond to numbered sections in the game. In moving through these sections you are creating a unique story for your adventuring persona.||You will begin your adventure by choosing a pre-generated character or a profession (see below)with the ability scores and Stamina that correspond to that profession at 1st Rank.||ABILITIES|---------||You have six abilities. Your initial score in each ability is decided by your choice of profession. Ability scores range from 1 (low ability) to 6 (a high level of ability). Ability scores will change during your adventure but can never be lower than 1 or higher than 12.||CHARISMA the knack of befriending people|COMBAT the skill of fighting|MAGIC the art of casting spells|SANCTITY the gift of divine power and wisdom|SCOUTING the techniques of tracking and wilderness lore|THIEVERY the talent for stealth and lock picking||STAMINA|-------||Stamina is lost when you get hurt. Keep track of your Stamina score throughout your travels and adventures. You must guard against your Stamina score dropping to zero, because if it does you are dead.||Lost Stamina can be recovered by various means, but your Stamina cannot go above its initial score until you advance in Rank.||You start with 16 Stamina points.||RANK|----||You start at 1st Rank. By completing quests and overcoming enemies, you will have the chance to go up in Rank.||You will be told during the course of your adventures when you are entitled to advance in Rank. Characters of higher Rank are tougher, luckier and generally better able to deal with trouble.||POSSESSIONS|-----------||You can carry up to twelve possessions on your person. All characters begin with 16 Shards in cash and the following possessions:||* sword|* leather jerkin (Defence +1)||Remember that you are limited to carrying a total of 12 items, so if you get more than this you'll have to cross something off your inventory or find somewhere to store extra items. There is no limit to how much money you can carry.||DEFENCE|-------||Your Defence score is equal to:||* your COMBAT score|* plus your RANK|* plus the bonus for the armour you're wearing (if any)||Every suit of armour you find will have a Defence bonus listed for it. The higher the bonus, the better the armour. You can carry several suits of armour if you wish -- but because you can wear only one at a time, you only get the Defence bonus of the best armour you are carrying.||To start with, it is just your COMBAT score plus 2 (because you are 1st Rank and have +1 DEFENSE).||It will be updated if you get better armour or increase in Rank or COMBAT ability.||ADDITIONAL HELP|---------------||During action selection and in other parts of the game, pressing '?' brings up a list of additional command keys.">
<CONSTANT INSTRUCTIONS-PROFESSIONS "PROFESSIONS||Every adventurer has some strengths and some weaknesses. Your choice of profession determines your initial scores in the six abilities.">

<ROUTINE INSTRUCTIONS ()
	<HLIGHT ,H-BOLD>
	<TELL ,INSTRUCTIONS-HEADER>
	<HLIGHT 0>
	<CRLF>
	<TELL ,INSTRUCTIONS-TEXT>
	<CRLF>>

<CONSTANT HELP-TEXT "P - Display player information (abilities, items, codewords)|U - Use or drop an item from your inventory|R - Restore progress from a saved file|S - Save current progress to a file|Q - quit the game">

<ROUTINE DISPLAY-HELP ()
	<CRLF>
	<HLIGHT ,H-BOLD>
	<TELL "Additional Command Keys:">
	<HLIGHT 0>
	<CRLF>
	<TELL CR ,HELP-TEXT>
	<CRLF>>

; "Story"
; ---------------------------------------------------------------------------------------------

; "Flags"

<GLOBAL SOLD-PIRATES-HEAD F>

; "reset routines"

<ROUTINE RESET-CARGO-GOODS ()
	<PUTP ,CARGO-FURS ,P?QUANTITY 1>
	<PUTP ,CARGO-GRAINS ,P?QUANTITY 1>
	<PUTP ,CARGO-METALS ,P?QUANTITY 1>
	<PUTP ,CARGO-MINERALS ,P?QUANTITY 1>
	<PUTP ,CARGO-SPICES ,P?QUANTITY 1>
	<PUTP ,CARGO-TEXTILES ,P?QUANTITY 1>
	<PUTP ,CARGO-TIMBER ,P?QUANTITY 1>>

<ROUTINE RESET-GEAR ()
	<FSET ,CHAIN-MAIL ,WORNBIT>
	<PUTP ,AXE ,P?QUANTITY 1>
	<PUTP ,AXE1 ,P?QUANTITY 1>
	<PUTP ,AXE2 ,P?QUANTITY 1>
	<PUTP ,AXE3 ,P?QUANTITY 1>
	<PUTP ,BATTLE-AXE ,P?QUANTITY 1>
	<PUTP ,BATTLE-AXE1 ,P?QUANTITY 1>
	<PUTP ,BATTLE-AXE2 ,P?QUANTITY 1>
	<PUTP ,BATTLE-AXE3 ,P?QUANTITY 1>
	<PUTP ,ENCHANTED-SPEAR ,P?QUANTITY 1>
	<PUTP ,ENCHANTED-SWORD ,P?QUANTITY 1>
	<PUTP ,MACE ,P?QUANTITY 1>
	<PUTP ,MACE1 ,P?QUANTITY 1>
	<PUTP ,MACE2 ,P?QUANTITY 1>
	<PUTP ,MACE3 ,P?QUANTITY 1>
	<PUTP ,MAGIC-SPEAR ,P?QUANTITY 1>
	<PUTP ,PICKAXE2 ,P?QUANTITY 1>
	<PUTP ,SPEAR ,P?QUANTITY 1>
	<PUTP ,SPEAR1 ,P?QUANTITY 1>
	<PUTP ,SPEAR2 ,P?QUANTITY 1>
	<PUTP ,SPEAR3 ,P?QUANTITY 1>
	<PUTP ,STAFF ,P?QUANTITY 1>
	<PUTP ,STAFF1 ,P?QUANTITY 1>
	<PUTP ,STAFF2 ,P?QUANTITY 1>
	<PUTP ,STAFF3 ,P?QUANTITY 1>
	<PUTP ,SWORD ,P?QUANTITY 1>
	<PUTP ,SWORD1 ,P?QUANTITY 1>
	<PUTP ,SWORD2 ,P?QUANTITY 1>
	<PUTP ,SWORD3 ,P?QUANTITY 1>
	<PUTP ,CHAIN-MAIL ,P?QUANTITY 1>
	<PUTP ,HEAVY-PLATE ,P?QUANTITY 1>
	<PUTP ,LEATHER-ARMOUR ,P?QUANTITY 1>
	<PUTP ,PLATE-ARMOUR ,P?QUANTITY 1>
	<PUTP ,RING-MAIL ,P?QUANTITY 1>
	<PUTP ,SPLINT-ARMOUR ,P?QUANTITY 1>>

<ROUTINE RESET-OBJECTS ()
	<PUTP ,MONEY-BAG ,P?MONEY 500>
	<PUTP ,BOARS-TUSK ,P?QUANTITY 1>
	<PUTP ,CANDLE ,P?QUANTITY 1>
	<PUTP ,CORAL-RED-TRESSES ,P?QUANTITY 1>
	<PUTP ,FAERY-MEAD ,P?QUANTITY 1>
	<PUTP ,FISHING-HOOK ,P?QUANTITY 1>
	<PUTP ,FOUR-LEAF-CLOVER ,P?QUANTITY 1>
	<PUTP ,GREEN-GEM ,P?QUANTITY 1>
	<PUTP ,HYDRA-TOOTH ,P?QUANTITY 1>
	<PUTP ,INK-SAC ,P?QUANTITY 1>
	<PUTP ,LANTERN ,P?QUANTITY 1>
	<PUTP ,PARROT ,P?QUANTITY 1>
	<PUTP ,PARROT-FUNGUS ,P?QUANTITY 1>
	<PUTP ,SEA-GREEN-LENS ,P?QUANTITY 1>
	<PUTP ,SELENIUM-ORE ,P?QUANTITY 1>
	<PUTP ,SILVER-HORSESHOE ,P?QUANTITY 1>
	<PUTP ,SMOULDER-FISH ,P?QUANTITY 1>
	<PUTP ,SPECTRAL-VEIL ,P?QUANTITY 1>
	<PUTP ,VERDIGRIS-KEY ,P?QUANTITY 1>
	<PUTP ,WATER-FLASK ,P?QUANTITY 1>
	<PUTP ,WITCH-HAND ,P?QUANTITY 1>
	<RESET-CARGO-GOODS>
	<RESET-GEAR>
	<RESET-POTIONS>>

<ROUTINE RESET-POTIONS ()
	<PUTP ,POTION-OF-COMELINESS ,P?QUANTITY 1>
	<PUTP ,POTION-OF-GODLINESS ,P?QUANTITY 1>
	<PUTP ,POTION-OF-INTELLECT ,P?QUANTITY 1>
	<PUTP ,POTION-OF-NATURE ,P?QUANTITY 1>
	<PUTP ,POTION-OF-STEALTH ,P?QUANTITY 1>
	<PUTP ,POTION-OF-STRENGTH ,P?QUANTITY 1>
	<PUTP ,POTION-OF-HEALING ,P?QUANTITY 1>
	<PUTP ,POTION-OF-RESTORATION ,P?QUANTITY 1>>

<ROUTINE RESET-STORY ()
	<RESET-GOT-FREE>
	<SETG SOLD-PIRATES-HEAD F>
	<SETG LOST-SHARDS 0>
	<RESET-ODDS 2 0 ,STORY079>
	<RESET-ODDS 2 0 ,STORY108>
	<RESET-ODDS 1 0 ,STORY142>
	<RESET-ODDS 2 0 ,STORY186>
	<RESET-ODDS 2 0 ,STORY194>
	<RESET-ODDS 2 0 ,STORY268>
	<RESET-ODDS 2 0 ,STORY324>
	<RESET-ODDS 1 0 ,STORY384>
	<RESET-ODDS 2 0 ,STORY403>
	<RESET-ODDS 2 0 ,STORY418>
	<RESET-ODDS 1 0 ,STORY465>
	<PUT <GETP ,STORY052 ,P?REQUIREMENTS> 1 0>
	<PUT <GET <GETP ,STORY391 ,P?REQUIREMENTS> 1> 2 14>
	<PUT <GET <GETP ,STORY510 ,P?REQUIREMENTS> 1> 3 0>
	<PUTP ,STORY006 ,P?DOOM T>
	<PUTP ,STORY007 ,P?DOOM T>
	<PUTP ,STORY010 ,P?DOOM T>
	<PUTP ,STORY029 ,P?DOOM T>
	<PUTP ,STORY037 ,P?DOOM T>
	<PUTP ,STORY067 ,P?DOOM T>
	<PUTP ,STORY073 ,P?DOOM T>
	<PUTP ,STORY085 ,P?DOOM T>
	<PUTP ,STORY103 ,P?DOOM T>
	<PUTP ,STORY113 ,P?DOOM T>
	<PUTP ,STORY126 ,P?DOOM T>
	<PUTP ,STORY147 ,P?DOOM T>
	<PUTP ,STORY162 ,P?DOOM T>
	<PUTP ,STORY165 ,P?DOOM T>
	<PUTP ,STORY199 ,P?DOOM T>
	<PUTP ,STORY201 ,P?DOOM T>
	<PUTP ,STORY206 ,P?DOOM T>
	<PUTP ,STORY211 ,P?DOOM T>
	<PUTP ,STORY212 ,P?DOOM T>
	<PUTP ,STORY214 ,P?DOOM T>
	<PUTP ,STORY225 ,P?DOOM T>
	<PUTP ,STORY249 ,P?DOOM T>
	<PUTP ,STORY253 ,P?DOOM T>
	<PUTP ,STORY269 ,P?DOOM T>
	<PUTP ,STORY284 ,P?DOOM T>
	<PUTP ,STORY286 ,P?DOOM T>
	<PUTP ,STORY288 ,P?DOOM T>
	<PUTP ,STORY308 ,P?DOOM T>
	<PUTP ,STORY314 ,P?DOOM T>
	<PUTP ,STORY326 ,P?DOOM T>
	<PUTP ,STORY356 ,P?DOOM T>
	<PUTP ,STORY361 ,P?DOOM T>
	<PUTP ,STORY367 ,P?DOOM T>
	<PUTP ,STORY369 ,P?DOOM T>
	<PUTP ,STORY372 ,P?DOOM T>
	<PUTP ,STORY392 ,P?DOOM T>
	<PUTP ,STORY400 ,P?DOOM T>
	<PUTP ,STORY426 ,P?DOOM T>
	<PUTP ,STORY441 ,P?DOOM T>
	<PUTP ,STORY457 ,P?DOOM T>
	<PUTP ,STORY474 ,P?DOOM T>
	<PUTP ,STORY486 ,P?DOOM T>
	<PUTP ,STORY501 ,P?DOOM T>>

; "endings"
<CONSTANT BAD-ENDING "Your adventure ends here.|">
<CONSTANT GOOD-ENDING "Further adventure awaits.|">
<CONSTANT ENDING-CITIES-GOLD-GLORY "Further adventures await at Fabled Lands 2: Cities of Gold and Glory.|">
<CONSTANT ENDING-CITY-IN-CLOUDS "Further adventures await at Fabled Lands 11: The City in the Clouds.|">
<CONSTANT ENDING-COURT-HIDDEN-FACES "Further adventures await at Fabled Lands 5: The Court of Hidden Faces.|">
<CONSTANT ENDING-ISLE-THOUSAND-SPIRES "Further adventures await at Fabled Lands 9: The Isle of a Thousand Spires.|">
<CONSTANT ENDING-INTO-THE-UNDERWORLD "Further adventures await at Fabled Lands 12: Into the Underworld.|">
<CONSTANT ENDING-LEGIONS-OF-LABYRINTH "Further adventures await at Fabled Lands 11: Legions of the Labyrinth.|">
<CONSTANT ENDING-LORDS-RISING-SUN "Further adventures await at Fabled Lands 6: Lords of the Rising Sun.|">
<CONSTANT ENDING-LONE-LEVEL-SANDS "Further adventures await at Fabled Lands 8: The Lone and Level Sands.|">
<CONSTANT ENDING-PLAINS-HOWLING-DARKNESS "Further adventures await at Fabled Lands 4: The Plains of Howling Darkness.|">
<CONSTANT ENDING-WAR-TORN-KINGDOM "Further adventures await at Fabled Lands 1: The War-Torn Kingdom.|">
<CONSTANT ENDING-SERPENT-KINGS-DOMAIN "Further adventures await at Fabled Lands 7: The Serpent King's Domain.|">

; "Text constants"
; ---------------------------------------------------------------------------------------------

<CONSTANT DIED-IN-COMBAT "You died in combat">
<CONSTANT DIED-OF-HUNGER "You starved to death">
<CONSTANT DIED-GREW-WEAKER "You grew weaker and eventually died">
<CONSTANT DIED-FROM-INJURIES "You died from your injuries">
<CONSTANT DIED-FROM-COLD "You eventually freeze to death">
<CONSTANT NOTHING-HAPPENS "Nothing happens.">

<CONSTANT HAVE-A "You have a">
<CONSTANT HAVE-AN "You have an">
<CONSTANT HAVE-THE "You have the">
<CONSTANT HAVE-CODEWORD "You have the codeword">
<CONSTANT HAVE-NEITHER "You have neither">
<CONSTANT HAVE-TITLE "You have the title">
<CONSTANT IF-NOT "If not">
<CONSTANT OTHERWISE "Otherwise">
<CONSTANT YOU-ARE-A "You are a">
<CONSTANT YOU-ARE-AN "You are an">

<CONSTANT TEXT-AFFLICTED "afflicted">
<CONSTANT TEXT-BACK "Back">
<CONSTANT TEXT-BYE "Bye">
<CONSTANT TEXT-CURSED "cursed">
<CONSTANT TEXT-EXCELLENT "Excellent!">
<CONSTANT TEXT-GO-BACK "Go back">
<CONSTANT TEXT-GOODBYE "Goodbye!">
<CONSTANT TEXT-INFECTED "infected">
<CONSTANT TEXT-NEXT-TIME "See you next time!">
<CONSTANT TEXT-PAID "paid">
<CONSTANT TEXT-POISONED "poisoned">
<CONSTANT TEXT-RANDOM-EVENT "Random Event">
<CONSTANT TEXT-STORM "Storm">
<CONSTANT TEXT-SURE "Are you sure?">
<CONSTANT TEXT-USED "used">
<CONSTANT TEXT-UNEVENTFUL "An uneventful voyage">
<CONSTANT TEXT-YOU-CAN "You can:">
<CONSTANT TEXT-YOU-CAN-GO "You can go:">

; "ABILITY roll text constants"
<CONSTANT TEXT-ROLL-COMBAT "Make a COMBAT roll">
<CONSTANT TEXT-ROLL-CHARISMA "Make a CHARISMA roll">
<CONSTANT TEXT-ROLL-MAGIC "Make a MAGIC roll">
<CONSTANT TEXT-ROLL-SANCTITY "Make a SANCTITY roll">
<CONSTANT TEXT-ROLL-SCOUTING "Make a SCOUTING roll">
<CONSTANT TEXT-ROLL-THIEVERY "Make a THIEVERY roll">

; "Temple text constants"
<CONSTANT TEXT-BECOME-INITIATE "Become an Initiate">
<CONSTANT TEXT-LEAVE-TEMPLE "Leave the temple">
<CONSTANT TEXT-RENOUNCE-WORSHIP "Renounce worship">
<CONSTANT TEXT-RESURRECTION-ARRANGEMENTS "Make Resurrection Arrangements">
<CONSTANT TEXT-SEEK-BLESSING "Seek a blessing">

; "frequent choices lists"
<CONSTANT CHOICES-COMBAT <LTABLE TEXT-ROLL-COMBAT>>
<CONSTANT CHOICES-CHARISMA <LTABLE TEXT-ROLL-CHARISMA>>
<CONSTANT CHOICES-MAGIC <LTABLE TEXT-ROLL-MAGIC>>
<CONSTANT CHOICES-SANCTITY <LTABLE TEXT-ROLL-SANCTITY>>
<CONSTANT CHOICES-SCOUTING <LTABLE TEXT-ROLL-SCOUTING>>
<CONSTANT CHOICES-THIEVERY <LTABLE TEXT-ROLL-THIEVERY>>

<CONSTANT CHOICES-CODEWORD <LTABLE HAVE-CODEWORD IF-NOT>>
<CONSTANT CHOICES-HAVE-NOT <LTABLE HAVE-A IF-NOT>>
<CONSTANT CHOICES-PROFESSION <LTABLE YOU-ARE-A OTHERWISE>>
<CONSTANT CHOICES-RANDOM <LTABLE TEXT-RANDOM-EVENT>>

; "frequent choice types"
<CONSTANT ONE-ABILITY <PLTABLE R-TEST-ABILITY>>
<CONSTANT ONE-CODEWORD <PLTABLE R-CODEWORD R-NONE>>
<CONSTANT ONE-GAIN <PLTABLE R-GAIN-CODEWORD R-NONE>>
<CONSTANT ONE-ITEM <PLTABLE R-ITEM R-NONE>>
<CONSTANT ONE-MONEY <PLTABLE R-MONEY R-NONE>>
<CONSTANT ONE-PROFESSION <PLTABLE R-PROFESSION R-NONE>>
<CONSTANT ONE-RANDOM <PLTABLE R-RANDOM>>
<CONSTANT TWO-ABILITY <PLTABLE R-TEST-ABILITY R-TEST-ABILITY>>

<ROUTINE STORY-GAIN-CARGO (CARGO "OPT" (UNITS 1) "AUX" CAPACITY COUNT)
	<COND (,CURRENT-SHIP
		<COND (<IN? .CARGO ,CARGO>
			<PUTP .CARGO ,P?QUANTITY <+ <GETP .CARGO ,P?QUANTITY> .UNITS>>
		)(ELSE
			<PUTP .CARGO ,P?QUANTITY .UNITS>
			<MOVE .CARGO ,CARGO>
		)>
		<SET CAPACITY <GETP ,CURRENT-SHIP ,P?CAPACITY>>
		<SET COUNT <COUNT-CONTAINER ,CARGO>>
		<COND (<G? .COUNT .CAPACITY>
			<STORY-LOSE-CARGO .CAPACITY>
		)>
	)>>

<ROUTINE STORY-LOSE-BLESSING ("OPT" MAX "AUX" COUNT)
	<COND (<NOT <ASSIGNED? MAX>> <SET MAX 1>)>
	<SET COUNT <COUNT-CONTAINER ,BLESSINGS>>
	<COND (<L=? .COUNT .MAX>
		<RESET-CARGO>
	)(ELSE
		<LOSE-STUFF ,BLESSINGS ,LOST-STUFF "blessing" <- .COUNT .MAX> ,RESET-BLESSINGS>
	)>>

<ROUTINE STORY-LOSE-CARGO ("OPT" MAX "AUX" COUNT)
	<COND (<NOT <ASSIGNED? MAX>> <SET MAX 1>)>
	<SET COUNT <COUNT-CONTAINER ,CARGO>>
	<COND (<L=? .COUNT .MAX>
		<RESET-CARGO>
	)(ELSE
		<LOSE-STUFF ,CARGO ,LOST-STUFF "cargo" <- .COUNT .MAX> ,RESET-CARGO>
	)>>

<CONSTANT TEXT-DROWNED "You drowned!">
<CONSTANT TEXT-SWEPT-MIRACULOUSLY "You are swept miraculously to the shore">
<CONSTANT TEXT-SHIPWRECK "Helpless in the grip of the storm, the vessel cracks apart. The seawater rushes into the broken shell of the hull, dragging you down. The screams of your crewmen are drowned out by the howl of the storm.||They are lost forever. You can think of nothing not but saving yourself.">

<ROUTINE STORY-SET-DOCK (DOCK "OPT" SHIP (CHECK T))
	<COND (<NOT .SHIP> <SET SHIP ,CURRENT-SHIP>)>
	<COND (.SHIP
		<COND (.CHECK
			<COND (<NOT <GETP .SHIP ,P?DOCKED>> <PUTP .SHIP ,P?DOCKED .DOCK>)>
		)(ELSE
			<PUTP .SHIP ,P?DOCKED .DOCK>
		)>
	)>>

<ROUTINE STORY-SET-SAIL ("OPT" SHIP)
	<COND (<NOT .SHIP> <SET SHIP ,CURRENT-SHIP>)>
	<COND (.SHIP <PUTP .SHIP ,P?DOCKED NONE>)>>

<ROUTINE STORY-SHIPWRECK (STORY "OPT" JUMP-DROWNED JUMP-SURVIVE TEXT-SURVIVE "AUX" (RANK 1) ROLL LOSS)
	<PUTP .STORY ,P?DOOM T>
	<SET RANK <GET-RANK ,CURRENT-CHARACTER>>
	<SET ROLL <RANDOM-EVENT 2>>
	<COND (<G? .ROLL .RANK>
		<EMPHASIZE ,TEXT-DROWNED>
		<COND (.JUMP-DROWNED <STORY-JUMP .JUMP-DROWNED>)>
	)(ELSE
		<STORY-LOSE-SHIP>
		<CRLF>
		<COND (.TEXT-SURVIVE
			<TELL .TEXT-SURVIVE>
		)(ELSE
			<TELL ,TEXT-SWEPT-MIRACULOUSLY>
		)>
		<TELL ,PERIOD-CR>
		<SET LOSS <RANDOM-EVENT 2 0 T>>
		<LOSE-STAMINA .LOSS ,DIED-GREW-WEAKER .STORY>
		<COND (<AND <IS-ALIVE> .JUMP-SURVIVE> <STORY-JUMP .JUMP-SURVIVE>)>
	)>>

<ROUTINE STORY-LOSE-EVERYTHING ("OPT" (VERBOSE T))
	<COND (.VERBOSE
		<EMPHASIZE "You've lost all your money and possessions.">
	)>
	<RESET-POSSESSIONS>
	<SETG MONEY 0>
	<UPDATE-STATUS-LINE>>

<ROUTINE STORY-LOSE-SHIP ()
	<COND (,CURRENT-SHIP
		<RESET-CARGO>
		<REMOVE ,CURRENT-SHIP>
		<SETG CURRENT-SHIP NONE>
	)>
	<UPDATE-STATUS-LINE>>

<ROUTINE STORY-RESET-CREW ("OPT" CONDITION SHIP)
	<COND (<NOT .SHIP> <SET SHIP ,CURRENT-SHIP>)>
	<COND (<NOT .CONDITION> <SET .CONDITION ,CONDITION-GOOD>)>
	<COND (.SHIP <PUTP .SHIP ,P?CONDITION .CONDITION>)>>

<ROUTINE STORY-ROLL-RANK (STORY "OPT" (MODIFIER 0) "AUX" ROLL (RANK 1))
	<SET ROLL <RANDOM-EVENT 2 .MODIFIER T>>
	<SET RANK <GET-RANK ,CURRENT-CHARACTER>>
	<COND (<G? .ROLL .RANK> <STORY-JUMP .STORY>)>>

<ROOM STORY-CITIES-GOLD-GLORY
	(DESC "Cities of Gold and Glory")
	(VICTORY ENDING-CITIES-GOLD-GLORY)
	(FLAGS LIGHTBIT)>

<ROOM STORY-CITY-IN-CLOUDS
	(DESC "The City in the Clouds")
	(VICTORY ENDING-CITY-IN-CLOUDS)
	(FLAGS LIGHTBIT)>

<ROOM STORY-COURT-HIDDEN-FACES
	(DESC "The Court of Hidden Faces")
	(VICTORY ENDING-COURT-HIDDEN-FACES)
	(FLAGS LIGHTBIT)>

<ROOM STORY-INTO-THE-UNDERWORLD
	(DESC "Into the Underworld")
	(VICTORY ENDING-INTO-THE-UNDERWORLD)
	(FLAGS LIGHTBIT)>

<ROOM STORY-ISLE-THOUSAND-SPIRES
	(DESC "The Isle of a Thousand Spires")
	(VICTORY ENDING-ISLE-THOUSAND-SPIRES)
	(FLAGS LIGHTBIT)>

<ROOM STORY-LEGIONS-OF-LABYRINTH
	(DESC "Legions of the Labyrinth")
	(VICTORY ENDING-LEGIONS-OF-LABYRINTH)
	(FLAGS LIGHTBIT)>

<ROOM STORY-LONE-LEVEL-SANDS
	(DESC "The Lone and Level Sands")
	(VICTORY ENDING-LONE-LEVEL-SANDS)
	(FLAGS LIGHTBIT)>

<ROOM STORY-LORDS-RISING-SUN
	(DESC "Lords of the Rising Sun")
	(VICTORY ENDING-LORDS-RISING-SUN)
	(FLAGS LIGHTBIT)>

<ROOM STORY-PLAINS-HOWLING-DARKNESS
	(DESC "The Plains of Howling Darkness")
	(VICTORY ENDING-PLAINS-HOWLING-DARKNESS)
	(FLAGS LIGHTBIT)>

<ROOM STORY-SERPENT-KINGS-DOMAIN
	(DESC "The Serpent King's Domain")
	(VICTORY ENDING-SERPENT-KINGS-DOMAIN)
	(FLAGS LIGHTBIT)>

<ROOM STORY-WAR-TORN-KINGDOM
	(DESC "The War-Torn Kingdom")
	(VICTORY ENDING-WAR-TORN-KINGDOM)
	(FLAGS LIGHTBIT)>

; "Locations in Over the Blood-Dark Sea"
; ---------------------------------------------------------------------------------------------

<CONSTANT MINE-FOREMAN-BUY <PLTABLE 0 200 575 0 950 250 350>>
<CONSTANT MINE-FOREMAN-SELL <PLTABLE 0 180 550 0 900 220 300>>

<ROOM STORY-MINE-FOREMAN
	(DESC "038 Mine Foreman")
	(EVENTS STORY-FOREMAN-EVENTS)
	(CONTINUE STORY038)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY-FOREMAN-EVENTS ()
	<BUY-SELL-CARGO ,MINE-FOREMAN-BUY ,MINE-FOREMAN-SELL>>

<CONSTANT SMOGMAW-GOODS-BUY <PLTABLE 300 250 850 750 400 250 180>>
<CONSTANT SMOGMAW-GOODS-SELL <PLTABLE 220 200 800 700 320 200 160>>

<ROOM STORY-SMOGMAW-GOODS
	(DESC "054 Smogmaw (Buy/Sell Cargo)")
	(EVENTS STORY-SMOGMAW-EVENTS)
	(CONTINUE STORY054)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY-SMOGMAW-EVENTS ()
	<BUY-SELL-CARGO ,SMOGMAW-GOODS-BUY ,SMOGMAW-GOODS-SELL>>

; "Over the Blood-Dark Sea"
; ---------------------------------------------------------------------------------------------

<CONSTANT TEXT001 "You are alone in an open boat waiting for death.||How your life has changed since the day that you set out from your homeland across the Unbounded Ocean! You had signed on aboard a ship in the hope of visiting a dozen ports, seeing a thousand wonders. But calamity overtook your voyage in the first week, when pirates swooped down upon the vessel. You and a handful of shipmates managed to get the cutter down into the water and were making off, but some of the pirates leapt down from the rail right in your midst. The fighting was hard. You remember little of it now, but when it was over the boat was awash with blood and you were the only one left alive. Of your own ship and the pirates' there was no sign -- the current had carried you out of sight of any living thing.||Best not to think how you've survived since then. At the mercy of the wind and the currents, you have been swept steadily westwards into regions completely unknown to you. Drinking water has been your biggest problem -- you've had to rely on rain and there has been none for days. Your body is weak, your spirits low. Then, just as death seems ready to draw his boat alongside, you see something that kindles new hope. White clouds. Birds turning high above. The grey hump of land on the horizon!||Steering towards the shore, you feel the cutter lurch as it enters rough water. The wind whips up plumes of spindrift and breakers pound the cliffs. The tiller is yanked out of your hands. The little boat is spun around, out of control, and goes plunging towards the coast.||You leap clear at the last second. There is the snap of timber, the roaring crescendo of the waves -- and then silence as you go under. Striking out wildly, you try to swim clear, then suddenly a wave catches you and flings you contemptuously on to the beach.||You are battered and bedraggled, but alive. Now your adventures can begin.">

<ROOM STORY001
	(IN ROOMS)
	(DESC "001")
	(LOCATION LOCATION-OCEAN)
	(STORY TEXT001)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY709 STORY505 STORY714 STORY313 STORY151>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 4 6 7 9 12> NONE>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT002 "You find two important references to the Innis Shoals. The first, in a book on navigation, reads: \"These islands form an effective barrier to the western sea, being ringed with treacherous reefs and racked by constant storms. Only a skilled pilot can bring a ship safely through.\"||The other book deals with matters of religion: \"A numinous essence is thought to pervade the air of this region. For this reason, the archipelago has long been accounted as a holy place and many a hermit has made his home here.\"||All in all, the Innis Shoals hardly sound the place for a holiday. Unless you're a religious maniac, that is.">

<ROOM STORY002
	(IN ROOMS)
	(DESC "002")
	(STORY TEXT002)
	(CONTINUE STORY368)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT003 "You are sailing a little way south-east of Starspike Island, on the edge of the Sea of Hydras.">
<CONSTANT CHOICES003 <LTABLE "Go north" "Go south (The Serpent King's Domain)" "Go east" "Go west" "To Starspike Island">>

<ROOM STORY003
	(IN ROOMS)
	(DESC "003")
	(LOCATION LOCATION-HYDRA)
	(STORY TEXT003)
	(CHOICES CHOICES003)
	(DESTINATIONS <PLTABLE STORY172 STORY-SERPENT-KINGS-DOMAIN STORY136 STORY302 STORY192>)
	(TYPES FIVE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT004 "A great white bell of canvas stretches overhead, gathering in the wind as a fisherman's net catches a shoal.||\"We're making good progress,\" observes the helmsman. \"Let's hope this breeze doesn't freshen into a gale, though.\"">
<CONSTANT CHOICES004 <LTABLE TEXT-RANDOM-EVENT>>

<ROOM STORY004
	(IN ROOMS)
	(DESC "004")
	(STORY TEXT004)
	(CHOICES CHOICES004)
	(DESTINATIONS <PLTABLE <PLTABLE STORY491 STORY024>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 6 12> <LTABLE TEXT-STORM "A safe voyage">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT005 "You return to the ship and waste no time getting under way.||The helmsman stifles a yawn. \"You know, skipper, I felt quite drowsy on the island,\" he says. \"The sea breeze is waking me up. though.\"">
<CONSTANT CHOICES005 <LTABLE "Steer north" "Steer south" "Steer east" "Steer west">>

<ROOM STORY005
	(IN ROOMS)
	(DESC "005")
	(STORY TEXT005)
	(EVENTS STORY005-EVENTS)
	(CHOICES CHOICES005)
	(DESTINATIONS <PLTABLE STORY281 STORY117 STORY153 STORY370>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY005-EVENTS ()
	<DELETE-CODEWORD ,CODEWORD-COSY>>

<ROOM STORY006
	(IN ROOMS)
	(DESC "006")
	(STORY TEXT-SHIPWRECK)
	(EVENTS STORY006-EVENTS)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY006-EVENTS ()
	<STORY-SHIPWRECK ,STORY006 ,STORY123 ,STORY026>>

<CONSTANT TEXT007 "The stowaway is an assassin who bursts from hiding and runs at you brandishing a long curved knife. \"Nivram the Wizard sends his regards, scum!\" he rants.">

<ROOM STORY007
	(IN ROOMS)
	(DESC "007")
	(STORY TEXT007)
	(EVENTS STORY007-EVENTS)
	(CONTINUE STORY078)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY007-EVENTS ()
	<COMBAT-MONSTER ,MONSTER-ASSASSIN 8 10 8>
	<COND (<CHECK-COMBAT ,MONSTER-ASSASSIN ,STORY010 0 ,DAGGER>
		<GAIN-MONEY 10>
	)>>

<CONSTANT TEXT008 "The sun is setting by the time you retrace the priest tracks to a dank cave. A figure in grey robes waits for you. The jewelled rings on his long fingers only serve to make his flesh look still more like ivory.||\"I welcome all who land upon my shore,\" he says in an eerie drone. \"It matters not to me what's port's your home, since now you'll dwell here too for evermore, and feed my veins with blood I'll call my own.\"||Panic and anger send one of the crew mad. He charges up the cave brandishing his knife. He is only a little fat fellow, and you never thought to hear him utter such screams of hatred. The vampire disembowels him at one stroke, laying him open from gorge to groin. Yellow fat spills out with blood and bile and half-digested breakfast. The vampire laps it all up.">

<ROOM STORY008
	(IN ROOMS)
	(DESC "008")
	(STORY TEXT008)
	(CHOICES CHOICES-MAGIC)
	(DESTINATIONS <PLTABLE STORY028 STORY046>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-MAGIC 14>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT009 "You sail into the coastal waters of Sorcerers' Isle. Here the sea foam takes on an odd pearly glow by moonlight, and strange songs can be heard across the darkling waters.">
<CONSTANT CHOICES009 <LTABLE "Put into Dweomer harbour" "Sail around the island" "Steer out on to the open sea">>

<ROOM STORY009
	(IN ROOMS)
	(DESC "009")
	(LOCATION LOCATION-SORCERERS)
	(STORY TEXT009)
	(CHOICES CHOICES009)
	(DESTINATIONS <PLTABLE STORY152 STORY182 STORY122>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT010 "It is getting harder to breathe.">
<CONSTANT TEXT010-CONTINUED "You fling open the door to find a large chest containing platinum coins to the value of 400 Shards. \"We got the treasure, now let's be getting out of here!\" urges one of your men">
<CONSTANT CHOICES010 <LTABLE "Take a look along the passage" "Return to the ship">>

<ROOM STORY010
	(IN ROOMS)
	(DESC "010")
	(STORY TEXT010)
	(EVENTS STORY010-EVENTS)
	(CHOICES CHOICES010)
	(DESTINATIONS <PLTABLE STORY029 STORY308>)
	(TYPES TWO-CHOICES)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY010-EVENTS ()
	<COND (,RUN-ONCE
		<COND (<NOT <CHECK-CODEWORD ,CODEWORD-CALCIUM>>
			<LOSE-STAMINA 3 ,DIED-GREW-WEAKER ,STORY010>
		)>
	)>
	<COND (<IS-ALIVE>
		<CONTINUE-TEXT ,TEXT010-CONTINUED>
		<COND (,RUN-ONCE <GAIN-MONEY 400>)>
	)>>

<CONSTANT TEXT011 "Using grapnels you climb with several crewmen to the level of the tunnel. It is jet black, drinking in the sunlight.">
<CONSTANT CHOICES011 <LTABLE "Continue into tunnel" "Use magic" "No source of light">>

<ROOM STORY011
	(IN ROOMS)
	(DESC "011")
	(STORY TEXT011)
	(CHOICES CHOICES011)
	(DESTINATIONS <PLTABLE STORY178 STORY178 STORY196>)
	(REQUIREMENTS <PLTABLE <PLTABLE CANDLE LANTERN> PROFESSION-MAGE NONE>)
	(TYPES <PLTABLE R-ANY R-PROFESSION R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT012 "\"Lucky it turned out to be pretty old,\" remarks the bosun. \"A younger one would have been tough to beat.\"||Leaning against a tree to get your breath back, you merely throw him a withering glare.||A trail winds up the hillside towards the middle of the island. One of the men sees you glance along it and says, \"Shouldn't we be setting sail, captain?\"">
<CONSTANT CHOICES012 <LTABLE "Explore further inland" "Return to the ship">>

<ROOM STORY012
	(IN ROOMS)
	(DESC "012")
	(STORY TEXT012)
	(CHOICES CHOICES012)
	(DESTINATIONS <PLTABLE STORY031 STORY125>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT013 "Your vessel is more or less due south of Metriciens. The lookout reports no sight of land in any direction.">
<CONSTANT CHOICES013 <LTABLE "Steer north (Cities of Gold and Glory)" "Steer south" "Steer east" "Steer west">>

<ROOM STORY013
	(IN ROOMS)
	(DESC "013")
	(STORY TEXT013)
	(CHOICES CHOICES013)
	(DESTINATIONS <PLTABLE STORY-CITIES-GOLD-GLORY STORY504 STORY402 STORY200>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT014 "The ghost resists your best efforts to dispel it. It is intent on returning to its home port of Smogmaw, and its curse means that you cannot put in at any other port on the way. You must now sail directly for Smogmaw; when you get there, the ghost will leave your ship.">

<ROOM STORY014
	(IN ROOMS)
	(DESC "014")
	(STORY TEXT014)
	(CONTINUE STORY078)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT015 "\"What's your game?\" says the priestess with a handsome smile.||\"Pardon me?\"||\"Your game.\" She fans the cards. \"Maingauche, Black Death, Stake the Vampire... How about Cudgel?\"||The two of you play several fiercely contested rounds of the game Cudgel, said to be popular among pit fighters in Trefoille.">

<ROOM STORY015
	(IN ROOMS)
	(DESC "015")
	(STORY TEXT015)
	(EVENTS STORY015-EVENTS)
	(CONTINUE STORY072)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY015-EVENTS ("AUX" ROLL)
	<SET ROLL <RANDOM-EVENT 2 0 T>>
	<SETG LOST-SHARDS 0>
	<COND (<L=? .ROLL 5>
		<SETG LOST-SHARDS <ROLL-DICE 2>>
		<STORY-JUMP ,STORY052>
	)(<L=? .ROLL 7>
		<SETG LOST-SHARDS <ROLL-DICE 1>>
		<STORY-JUMP ,STORY052>
	)(<L=? .ROLL 9>
		<GAIN-MONEY <ROLL-DICE 1>>
	)(ELSE
		<GAIN-MONEY <ROLL-DICE 2>>
	)>>

<CONSTANT TEXT016 "You can take their three swords and the 107 Shards they have in their money pouches. One of them also had a mariner's ruttier tucked into his breeches; he clearly won't have any use for it now.">

<ROOM STORY016
	(IN ROOMS)
	(DESC "016")
	(STORY TEXT016)
	(EVENTS STORY016-EVENTS)
	(CONTINUE STORY044)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY016-EVENTS ()
	<TAKE-QUANTITIES ,SWORD "swords" "How many of the swords will you take" 3>
	<GAIN-MONEY 107>
	<KEEP-ITEM ,MARINERS-RUTTIER>
	<DELETE-CODEWORD ,CODEWORD-CHURCH>>

<CONSTANT TEXT017 "A few days out from Smogmaw the Tidy Sum is overhauled by your own ship. It is with enormous relief that you see the faces of your loyal lads at the rail.||\"Ahoy, you have our skipper!\" calls your first mate to the Sokaran captain. \"Heave to, if you please.\"||The Sokarans don't want a fight. You are paid 150 Shards in compensation and returned to your ship. \"A tidy sum,\" you remark with a smile to the captain as you leave his vessel.">

<ROOM STORY017
	(IN ROOMS)
	(DESC "017")
	(STORY TEXT017)
	(EVENTS STORY017-EVENTS)
	(CONTINUE STORY282)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY017-EVENTS ()
	<GAIN-MONEY 150>
	<STORY-SET-SAIL ,CURRENT-SHIP>>

<CONSTANT TEXT018 "The temple of Badogor is just a hut set in a clearing some distance from town. You enter to be instantly assailed by a horde of cultists whose teeth are as sharp as knife-points.">
<CONSTANT CHOICES018 <LTABLE "Fight your way to safety">>

<ROOM STORY018
	(IN ROOMS)
	(DESC "018")
	(STORY TEXT018)
	(CHOICES CHOICES018)
	(DESTINATIONS <PLTABLE <PLTABLE STORY037 STORY123>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-COMBAT 17>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT019 "The crew amuse themselves by throwing apple cores at a shoal of glider crabs. \"Look lively, you swabs!\" you say to them. \"I'll soon find you chores if you're idle.\"||They return to their duties with alacrity. \"What heading shall I steer, cap'n?\" asks the helmsman.">
<CONSTANT CHOICES019 <LTABLE "Go west" "Go north" "Go east" "Go south">>

<ROOM STORY019
	(IN ROOMS)
	(DESC "019")
	(STORY TEXT019)
	(EVENTS STORY-SET-SAIL)
	(CHOICES CHOICES019)
	(DESTINATIONS <PLTABLE STORY630 STORY081 STORY004 STORY227>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT020 "Did you sell anything at the market that you had previously obtained there for free?">

<ROOM STORY020
	(IN ROOMS)
	(DESC "020")
	(STORY TEXT020)
	(EVENTS STORY020-EVENTS)
	(CONTINUE STORY335)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY020-EVENTS ()
	<COND (,SOLD-FREE <STORY-JUMP ,STORY372>)>
	<RESET-GOT-FREE>>

<CONSTANT TEXT021 "\"Let's steer clear of Uttaku,\" suggests the first mate with a fearful glance westwards. \"The Uttakin are rank fiends who merely wear the outer guise of men.'\"">

<ROOM STORY021
	(IN ROOMS)
	(DESC "021")
	(STORY TEXT021)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY236 STORY109 STORY039>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 5 7 12> <LTABLE "Hags in sieves" "A fearsome waterspout" "An uneventful journey">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT022 "\"A Shard for your thoughts,\" you say to the first mate when you find him gazing dourly out across the waves.||\"Far to the south, men say, there's a pit that goes right through the world. In its black depths you can see the stars.\"||You laugh to make light of his mood. \"Well, what of it? Why so glum?\"||\"Don't you know the old saying? Battle not with monsters lest ye become a monster; and if you gaze into the abyss, the abyss also gazes into you.\" He turns away from the rail. \"What course, captain?\"">
<CONSTANT CHOICES022 <LTABLE "Go north" "Go south" "Go east" "Go west">>

<ROOM STORY022
	(IN ROOMS)
	(DESC "022")
	(STORY TEXT022)
	(CHOICES CHOICES022)
	(DESTINATIONS <PLTABLE STORY170 STORY079 STORY468 STORY040>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT023 "One of the crew goes mad and hurls himself from the rigging crying, \"Hydras! Hydras! Cut off a head and two more shall take its place!\"||You have his broken body wrapped in a sail and commended to the gods of the sea. Death aboard ship is always a bad omen.">

<ROOM STORY023
	(IN ROOMS)
	(DESC "023")
	(STORY TEXT023)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY083 STORY041 STORY574 STORY105>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 5 7 10 12> <LTABLE TEXT-STORM "Brooding quiet" "Haunted" "A mysterious island">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT024 "You pore over your charts until late into the night trying to decide where to set your course.">
<CONSTANT CHOICES024 <LTABLE "Steer west" "Steer east" "Steer south" "Steer north">>

<ROOM STORY024
	(IN ROOMS)
	(DESC "024")
	(BACKGROUND STORY024-BACKGROUND)
	(STORY TEXT024)
	(CHOICES CHOICES024)
	(DESTINATIONS <PLTABLE STORY042 STORY303 STORY263 STORY119>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY024-BACKGROUND ()
	<COND (<CHECK-TITLE ,TITLE-SAVIOUR-VERVAYENS> <RETURN ,STORY169>)>
	<RETURN ,STORY024>>

; "TO-DO: track if candle was used in mines and adjust this section"
<ROOM STORY025
	(IN ROOMS)
	(DESC "025")
	(EVENTS STORY025-EVENTS)
	(CONTINUE STORY317)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY025-EVENTS ()
	<REMOVE-ITEM ,CANDLE ,TEXT-USED F T>>

<CONSTANT TEXT026 "You are swept ashore at the mouth of a wide river. Staggering towards trails of smoke that are rising from beyond a copse of olive-green tropical palms, you arrive at a settlement of many thatched-roof shacks raised on stilts at the river's edge. It is the depot town of Smogmaw, on the great southern continent.">

<ROOM STORY026
	(IN ROOMS)
	(DESC "026")
	(LOCATION LOCATION-SMOGMAW)
	(STORY TEXT026)
	(CONTINUE STORY044)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT027 "The causeway ends in a massive iron door set into the cliff face. It is studded with huge irregular moonstones that look like chunks of frozen milk. You could not possible open this door on your own.">

<ROOM STORY027
	(IN ROOMS)
	(DESC "027")
	(STORY TEXT027)
	(EVENTS STORY027-EVENTS)
	(CONTINUE STORY005)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY027-EVENTS ()
	<CODEWORD-JUMP ,CODEWORD-COSY ,STORY084>>

<CONSTANT TEXT028 "The vampire speaks in rhyming couplets. Knowing that verse has magic of its own, you know that you might be able to confound it by replying in the same fashion. Vampires are sly and vicious, but easily baffled.">
<CONSTANT CHOICES028 <LTABLE "Attempt to speak in verse" "Try something else">>

<ROOM STORY028
	(IN ROOMS)
	(DESC "028")
	(STORY TEXT028)
	(CHOICES CHOICES028)
	(DESTINATIONS <PLTABLE STORY065 STORY046>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT029-BREATHING "You have difficulty breathing.">
<CONSTANT TEXT029-CONTINUED "You step into a large dark hold. Your eyes have no time to adjust to the gloom before a translucent creature with many frail tentacles comes drifting forwards to exude a gobbet of grey vapour in your face.||\"Don't breathe it in, captain!\" yells one of your men.">
<CONSTANT CHOICES029 <LTABLE "Inhale" "Exhale">>

<ROOM STORY029
	(IN ROOMS)
	(DESC "029")
	(EVENTS STORY029-EVENTS)
	(CHOICES CHOICES029)
	(DESTINATIONS <PLTABLE STORY047 STORY067>)
	(TYPES TWO-CHOICES)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY029-EVENTS ()
	<COND (,RUN-ONCE
		<COND (<CHECK-CODEWORD ,CODEWORD-CALCIUM>
			<PREVENT-DOOM ,STORY029>
		)(ELSE
			<CRLF>
			<TELL ,TEXT029-BREATHING>
			<TELL ,PERIOD-CR>
			<LOSE-STAMINA 4 ,DIED-GREW-WEAKER ,STORY029>
		)>
	)>
	<CONTINUE-TEXT ,TEXT029-CONTINUED>>

<CONSTANT TEXT030 "The closer you get to the uncharted island, the greater your amazement. \"Is it a natural island or a man-made thing?\" wonders the mate.||You can understand why he's baffled: what lies ahead of you is a disk of jet black marble almost half a kilometre across. It rises to a height of a good hundred metres above the water. From high in the smooth black cliffs, sunlight picks out the edges of a tunnel.">
<CONSTANT CHOICES030 <LTABLE "Ascend to the tunnel" "Sail away">>

<ROOM STORY030
	(IN ROOMS)
	(DESC "030")
	(LOCATION LOCATION-UNMARKED)
	(STORY TEXT030)
	(CHOICES CHOICES030)
	(DESTINATIONS <PLTABLE STORY011 STORY048>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT031 "You climb up the path, which is gentle at first but gets steadily steeper. It is afternoon before you have reached the peak in the centre of the island. None of your men has had the stamina to keep up, so you are alone as you gaze out over the garden of foliage to where a toy ship crewed by ants bobs gently in a pond.||Three ancient trees stand behind you. With a rustling of long leaves, they seem to speak to you: \"If you taste death, it's here you'll be reborn. But heed our warning: three times only can we give you fresh life.\"||The trees fall silent.||You go back to your ship.">

<ROOM STORY031
	(IN ROOMS)
	(DESC "031")
	(STORY TEXT031)
	(EVENTS STORY031-EVENTS)
	(CONTINUE STORY125)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY031-EVENTS ()
	<SETG RESURRECTION-ARRANGEMENTS ,RESURRECTION-ISLAND-REBIRTH>
	<EMPHASIZE "Upon death, you will now be resurrected on the Island of Rebirth.">>

<CONSTANT TEXT032 "You pore over the charts, reckoning your position to lie dead south of Knucklebones Point.">
<CONSTANT CHOICES032 <LTABLE "Head for Sorcerers' Isle" "Steer a course for the Unnumbered Isles" "Head north to the mainland (Cities of Gold and Glory)" "Go eastwards">>

<ROOM STORY032
	(IN ROOMS)
	(DESC "032")
	(STORY TEXT032)
	(CHOICES CHOICES032)
	(DESTINATIONS <PLTABLE STORY504 STORY205 STORY-CITIES-GOLD-GLORY STORY077>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT033 "The crew falls ill.">
<CONSTANT TEXT033-CONTINUED "Otherwise, the ship drifts untended until you are well enough to handle it -- by which time you are in unknown waters.">

<ROOM STORY033
	(IN ROOMS)
	(DESC "033")
	(STORY TEXT033)
	(EVENTS STORY033-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY058 STORY170 STORY-ISLE-THOUSAND-SPIRES STORY370 STORY040>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 4 6 7 9 12> NONE>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY033-EVENTS ()
	<COND (<CHECK-BLESSING ,BLESSING-IMMUNITY-POISON-DISEASE>
		<DELETE-BLESSING ,BLESSING-IMMUNITY-POISON-DISEASE>
		<STORY-JUMP ,STORY116>
	)(ELSE
		<CONTINUE-TEXT ,TEXT033-CONTINUED>
	)>>

<CONSTANT TEXT034 "\"What shall we play?\" wonders the priestess, pressing the pack of cards against her lower lip. \"Ah, yes, how about a sedate game of Paying the Devil?\"">

<ROOM STORY034
	(IN ROOMS)
	(DESC "034")
	(STORY TEXT034)
	(EVENTS STORY034-EVENTS)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY034-EVENTS ("AUX" ROLL)
	<REPEAT ROLL-AGAIN ()
		<SET ROLL <RANDOM-EVENT 2 0 T>>
		<COND (<L=? .ROLL 6>
			<LOSE-MONEY <ROLL-DICE 1>>
			<STORY-JUMP ,STORY052>
			<RETURN>
		)(<EQUAL? .ROLL 7>
			<AGAIN .ROLL-AGAIN>
		)(<L=? .ROLL 12>
			<GAIN-MONEY <ROLL-DICE 1>>
			<STORY-JUMP ,STORY111>
			<RETURN>
		)>
	>>

<CONSTANT TEXT035 "They look up at you with eyes made bleary by drink.||\"It's our old skipper,\" says Mister Haywood, your erstwhile midshipman.||\"Strike me blind!\" says Fryer, once your trusted first mate. \"I never thought to see you this side of hell.\"">
<CONSTANT CHOICES035 <LTABLE "Threaten them" "Greet them amicably" "Preach at them">>

<ROOM STORY035
	(IN ROOMS)
	(DESC "035")
	(STORY TEXT035)
	(CHOICES CHOICES035)
	(DESTINATIONS <PLTABLE STORY053 STORY130 STORY166>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT036 "You rise rapidly from being an ordinary sailor to the rank of trusty midshipman. Eventually, after many months, the captain agrees to give you your freedom. \"You deserve it,\" he says. \"Where shall I put you ashore? How about Old Sokar?\" You notice he disdains to use its new name, Marlock City.">
<CONSTANT CHOICES036 <LTABLE "Disembark at Copper Island" "Disembark at Dweomer" "Disembark at Old Sokar (The War-Torn Kingdom)">>

<ROOM STORY036
	(IN ROOMS)
	(DESC "036")
	(STORY TEXT036)
	(CHOICES CHOICES036)
	(DESTINATIONS <PLTABLE STORY099 STORY100 STORY-WAR-TORN-KINGDOM>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT037 "That was one of the hardest fights of your life.">

<ROOM STORY037
	(IN ROOMS)
	(DESC "037")
	(STORY TEXT037)
	(EVENTS STORY037-EVENTS)
	(CONTINUE STORY044)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY037-EVENTS ("AUX" ROLL)
	<LOSE-STAMINA <ROLL-DICE 1> ,DIED-FROM-INJURIES ,STORY037>
	<COND (<IS-ALIVE>
		<SET ROLL <RANDOM-EVENT 2 0 T>>
		<COND (<G? .ROLL <GET-ABILITY-SCORE ,CURRENT-CHARACTER ,ABILITY-COMBAT>>
			<UPGRADE-ABILITY ,ABILITY-COMBAT 1>
		)>
	)>>

<CONSTANT TEXT038 "Perhaps you expected a rugged fellow with arms like anchor cables, but the mine foreman is just a dapper businessmen in an ermine robe. He quotes prices for the various goods that interest him. These prices are for entire Cargo Units. You cannot carry this large a quantity in person, but what ever you buy will be loaded on to your ship if you have one docked here.">
<CONSTANT CHOICES038 <LTABLE "Do business with the mine foreman (Buy/Sell cargo)" "You have completed your business with the mine foreman">>

<ROOM STORY038
	(IN ROOMS)
	(DESC "038")
	(STORY TEXT038)
	(CHOICES CHOICES038)
	(DESTINATIONS <PLTABLE STORY-MINE-FOREMAN STORY317>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT039 "You are halfway between the Innis Shoals and Braelak, the Sorcerers' Isle.">
<CONSTANT CHOICES039 <LTABLE "Go west" "Head for the mainland (The Court of Hidden Faces)" "Go east" "Steer south for open ocean">>

<ROOM STORY039
	(IN ROOMS)
	(DESC "039")
	(STORY TEXT039)
	(CHOICES CHOICES039)
	(DESTINATIONS <PLTABLE STORY058 STORY-COURT-HIDDEN-FACES STORY129 STORY170>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT040 "The wind freshens and veers to blow from the north-east. You must be careful, or your ship could be blown onto the reefs fringing the Innis archipelago.">

<ROOM STORY040
	(IN ROOMS)
	(DESC "040")
	(STORY TEXT040)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY-ISLE-THOUSAND-SPIRES STORY059 STORY551>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 4 8 12> <LTABLE "Blown off course" "A peaceful voyage" "A vision in the sunset">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT041 "You are sailing some way off the coast of Ankon Konu. Exotic Akatsurai lies far to the north-east; strange Dangor , the forbidden city, is to the south-east across Gashmuru Gulf.">
<CONSTANT CHOICES041 <LTABLE "Follow the coast west" "Follow the coast east" "Put in towards shore (The Serpent King's Domain)" "Steer due north" "Strike out for Akatsurai">>

<ROOM STORY041
	(IN ROOMS)
	(DESC "041")
	(STORY TEXT041)
	(CHOICES CHOICES041)
	(DESTINATIONS <PLTABLE STORY337 STORY060 STORY-SERPENT-KINGS-DOMAIN STORY136 STORY098>)
	(TYPES FIVE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT042 "You are in the very middle of the great ocean.">

<ROOM STORY042
	(IN ROOMS)
	(DESC "042")
	(STORY TEXT042)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY061 STORY193>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 8 12> <LTABLE "Nothing of note" "A storm brewing">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT043 "You have not gone far along the avenue before you begin to be overcome by tiredness. The stone slabs beside the avenue suddenly look as inviting as feather beds.">
<CONSTANT CHOICES043 <LTABLE "Stay awake" TEXT-ROLL-MAGIC>>

<ROOM STORY043
	(IN ROOMS)
	(DESC "043")
	(STORY TEXT043)
	(CHOICES CHOICES043)
	(DESTINATIONS <PLTABLE STORY062 <PLTABLE STORY062 STORY582>>)
	(REQUIREMENTS <PLTABLE CODEWORD-CHILL <PLTABLE ABILITY-MAGIC 13>>)
	(TYPES <PLTABLE R-CODEWORD R-TEST-ABILITY>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT044 "Smogmaw is a ramshackle town populated by a human stew of traders, thieves, adventurers, pirates, and fierce natives from upriver. All are drawn here by one common motive -- greed.||They hope that by trade or crime they will become rich at the expense of others.">

<CONSTANT SMOGMAW-CHOICES
	<LTABLE
		"Visit the market"
		"Buy or sell cargo"
		"Go to the quayside"
		"Enter a tavern"
		"Return to your shack"
		"Explore the town"
		"Look for a temple"
		"Leave Smogmaw"
	>>

<CONSTANT SMOGMAW-DESTINATIONS
	<PLTABLE
		STORY086
		STORY054
		STORY071
		STORY314
		STORY074
		STORY258
		STORY128
		STORY134
	>>

<CONSTANT SMOGMAW-REQUIREMENTS
	<PLTABLE
		NONE
		NONE
		NONE
		NONE
		CODEWORD-SMOGMAW
		NONE
		NONE
		NONE
	>>

<CONSTANT SMOGMAW-TYPES
	<PLTABLE
		R-NONE
		R-NONE
		R-NONE
		R-NONE
		R-CODEWORD
		R-NONE
		R-NONE
		R-NONE
	>>

<ROOM STORY044
	(IN ROOMS)
	(DESC "044")
	(LOCATION LOCATION-SMOGMAW)
	(STORY TEXT044)
	(EVENTS STORY044-EVENTS)
	(CHOICES SMOGMAW-CHOICES)
	(DESTINATIONS SMOGMAW-DESTINATIONS)
	(REQUIREMENTS SMOGMAW-REQUIREMENTS)
	(TYPES SMOGMAW-TYPES)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY044-EVENTS ()
	<COND (<AND <NOT <CHECK-CODEWORD ,CODEWORD-SMOGMAW>> <G=? ,MONEY 20>>
		<CRLF>
		<TELL "Purchase a shack at Smogmaw for 20 " D ,CURRENCY "?">
		<COND (<YES?>
			<EMPHASIZE "You purchased a shack at Smogmaw.">
			<COST-MONEY 20 ,TEXT-PAID>
			<GAIN-CODEWORD ,CODEWORD-SMOGMAW>
			<GAIN-STORAGE ,SHACK-SMOGMAW>
		)>
	)>>

<CONSTANT TEXT045 "The men rise and stagger back to the beach like narcoleptics. They move as if lead weights were tied to their feet. It is all they can do to keep their eyes open. Only when they emerge from the trees on to the balmy stretch of shore and behold the open seas do they start to recover from their drowsiness.">

<ROOM STORY045
	(IN ROOMS)
	(DESC "045")
	(STORY TEXT045)
	(CONTINUE STORY005)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT046 "The vampire stands crouched over the body of your poor dead crewman. As the sunlight drains away, it gives an exultant peal of laughter and cries: \"The cooling balm of night anoints the world!\"">
<CONSTANT CHOICES046 <LTABLE "Attack the fiend" "Drive it off with holy words">>

<ROOM STORY046
	(IN ROOMS)
	(DESC "046")
	(STORY TEXT046)
	(CHOICES CHOICES046)
	(DESTINATIONS <PLTABLE STORY085 STORY141>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT047 "The vapour constricts your lungs and throat so that your voice goes up half an octave.">

<ROOM STORY047
	(IN ROOMS)
	(DESC "047")
	(STORY TEXT047)
	(EVENTS STORY047-EVENTS)
	(CONTINUE STORY067)
	(CODEWORDS <PLTABLE CODEWORD-CALCIUM>)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY047-EVENTS ()
	<COND (,IS-MALE
		<LOSE-ABILITY ,ABILITY-CHARISMA 1>
	)>>

<CONSTANT TEXT048 "You sail away from the strange artificial island. \"Mark it on the charts, mister,\" you tell the navigator.">
<CONSTANT CHOICES048 <LTABLE "Go south (The Serpent King's Domain)" "Go east" "Go north" "Go west">>

<ROOM STORY048
	(IN ROOMS)
	(DESC "048")
	(LOCATION LOCATION-OCEAN)
	(STORY TEXT048)
	(EVENTS STORY048-EVENTS)
	(CHOICES CHOICES048)
	(DESTINATIONS <PLTABLE STORY-SERPENT-KINGS-DOMAIN STORY227 STORY630 STORY153>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY048-EVENTS ()
	<COND (<CHECK-CODEWORD ,CODEWORD-CALLID>
		<DELETE-CODEWORD ,CODEWORD-CALLID>
		<STORY-JUMP ,STORY717>
	)>>

<ROOM STORY049
	(IN ROOMS)
	(DESC "049")
	(VISITS 0)
	(BACKGROUND STORY049-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY049-BACKGROUND ()
	<COND (<CHECK-VISITS-MORE ,STORY049 1> <RETURN ,STORY007>)>
	<RETURN ,STORY340>>

<CONSTANT TEXT050 "\"The unknown lands,\" replies your first mate when you ask him what lies south of here. \"Ankon-Konu.\"">
<CONSTANT CHOICES050 <LTABLE "Head south" "Head north" "Head west" "Head east">>

<ROOM STORY050
	(IN ROOMS)
	(DESC "050")
	(STORY TEXT050)
	(CHOICES CHOICES050)
	(DESTINATIONS <PLTABLE STORY630 STORY301 STORY009 STORY205>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT051 "The cabin boy has been found lying in the bilge of the ship with his head bashed in. A belaying pin was found nearby. Possible suspects for the crime include the second mate, who regularly lost money to the lad at dice, and the sailmaster, who was known to dislike him.||How will you deal with the incident?">
<CONSTANT CHOICES051 <LTABLE "Accuse the second mate" "Accuse the sailmaster" "Try looking for clues" "Do nothing">>

<ROOM STORY051
	(IN ROOMS)
	(DESC "051")
	(STORY TEXT051)
	(CHOICES CHOICES051)
	(DESTINATIONS <PLTABLE STORY536 STORY707 STORY499 STORY554>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT052 "The priestess waits to collect her winnings.">
<CONSTANT CHOICES052 <LTABLE "Pay her what you owe" "Can't or won't pay">>

<ROOM STORY052
	(IN ROOMS)
	(DESC "052")
	(STORY TEXT052)
	(EVENTS STORY052-EVENTS)
	(CHOICES CHOICES052)
	(DESTINATIONS <PLTABLE STORY072 STORY091>)
	(REQUIREMENTS <LTABLE 0 NONE>)
	(TYPES <PLTABLE R-MONEY R-NONE>)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY052-EVENTS ()
	<COND (,RUN-ONCE
		<COND (<G? ,LOST-SHARDS 0>
			<PUT <GETP ,STORY052 ,P?REQUIREMENTS> 1 ,LOST-SHARDS>
			<SETG LOST-SHARDS 0>
		)>
	)>>

<ROOM STORY053
	(IN ROOMS)
	(DESC "053")
	(BACKGROUND STORY053-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY053-BACKGROUND ()
	<COND (<CHECK-DOCKED ,DOCK-SMOGMAW> <RETURN ,STORY092>)>
	<RETURN ,STORY073>>

<CONSTANT TEXT054 "Unlike the ramshackle buildings that make up much of the town, the warehouses are stoutly constructed from heavy logs. Not even a spider could squeeze between those mighty timbers -- much less even the stealthiest and slipperiest of thieves.||\"Spices are the principle commodity of the Feathered Lands,\" a merchant tells you. (You must look as if you're just off the boat.)">
<CONSTANT CHOICES054 <LTABLE "Do business here in Smogmaw (Buy/Sell cargo)" "Your business is finished here">>

<ROOM STORY054
	(IN ROOMS)
	(DESC "054")
	(LOCATION LOCATION-SMOGMAW)
	(STORY TEXT054)
	(CHOICES CHOICES054)
	(DESTINATIONS <PLTABLE STORY-SMOGMAW-GOODS STORY044>)
	(TYPES TWO-CHOICES)
	(CODEWORDS <PLTABLE CODEWORD-CATALYST>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT055 "The weather turns colder. At night there is hoarfrost on the shrouds. \"What lies in these grey waters?\" you ask the navigator.||He frowns. \"Merfolk with tails of hard horn. Creatures like great scorpions or lobsters, bigger than tar barrels. Spirits of death and cold moonlight.\"||You hold up your hand. \"I get the picture, thank you.\"">

<ROOM STORY055
	(IN ROOMS)
	(DESC "055")
	(STORY TEXT055)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY283 STORY699>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 8 12> <LTABLE "No encounter" "A mysterious island">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROOM STORY056
	(IN ROOMS)
	(DESC "056")
	(VISITS 0)
	(BACKGROUND STORY056-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY056-BACKGROUND ()
	<COND (<CHECK-VISITS-MORE ,STORY056 1> <RETURN ,STORY094>)>
	<RETURN ,STORY075>>

<CONSTANT TEXT057 "You put in at an uncharted island. The beach looks a good place to spend a few days resting under the palm trees while your crew get in supplies of fruit and fresh water.">

<ROOM STORY057
	(IN ROOMS)
	(DESC "057")
	(VISITS 0)
	(STORY TEXT057)
	(EVENTS STORY057-EVENTS)
	(CONTINUE STORY133)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY057-EVENTS ()
	<COND (<L? ,STAMINA ,MAX-STAMINA>
		<GAIN-STAMINA <ROLL-DICE 1>>
	)>
	<COND (<CHECK-VISITS-MORE ,STORY057 1> <STORY-JUMP ,STORY171>)>>

<CONSTANT TEXT058 "A harsh wind rips down out of the north, scattering ice crystals like dust on the decks.||\"Yon wind comes off the far mountains,\" says the ship's carpenter, a widely travelled man. \"This snow may be from the boughs of the Icicle Woods, or perhaps from the shores of the Rimewater itself.\"||He shivers and stamps off below deck to fetch a tot of warm mulled wine.">

<ROOM STORY058
	(IN ROOMS)
	(DESC "058")
	(STORY TEXT058)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY299 STORY336 STORY078 STORY348>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 4 6 8 12> <LTABLE "A ghost in the rigging" "Lords of Uttaku" "Nothing of note" "An uninvited passenger">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT059 "At the southern tip of the Innis Shoals lie the Straits of Alvir, by which you can gain passage to the great western ocean.">
<CONSTANT CHOICES059 <LTABLE "Go west through the Shoals (The Isle of a Thousand Spires)" "Steer along the Straits of Alvir" "Go east" "Go north">>

<ROOM STORY059
	(IN ROOMS)
	(DESC "059")
	(STORY TEXT059)
	(CHOICES CHOICES059)
	(DESTINATIONS <PLTABLE STORY-ISLE-THOUSAND-SPIRES STORY399 STORY079 STORY096>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT060 "You reckon your position to be at the southern edge of the Sea of Hydras. To the south east lies Gashmuru Gulf -- and beyond, Dangor and the Forbidden Realm.">
<CONSTANT CHOICES060 <LTABLE "Go south-east (The City in the Clouds)" "Go north-west" "Go east (Lords of the Rising Sun)" "Go north" "Go south-west (The Serpent King's Domain)">>

<ROOM STORY060
	(IN ROOMS)
	(DESC "060")
	(LOCATION LOCATION-HYDRA)
	(STORY TEXT060)
	(CHOICES CHOICES060)
	(DESTINATIONS <PLTABLE STORY-CITY-IN-CLOUDS STORY023 STORY-LORDS-RISING-SUN STORY098 STORY-SERPENT-KINGS-DOMAIN>)
	(TYPES FIVE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT061 "An island appears as a dun-coloured smudge hovering mirage-like on the rim of the sea.||\"Copper Island,\" says the helmsman. \"Shall I take her into dock, captain?\"">
<CONSTANT CHOICES061 <LTABLE "Put in at Copper Island" "Sail on">>

<ROOM STORY061
	(IN ROOMS)
	(DESC "061")
	(STORY TEXT061)
	(CHOICES CHOICES061)
	(DESTINATIONS <PLTABLE STORY553 STORY019>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT CHOICES062 <LTABLE HAVE-CODEWORD "Press on along the avenue" "Return to the beach">>

<ROOM STORY062
	(IN ROOMS)
	(DESC "062")
	(CHOICES CHOICES062)
	(DESTINATIONS <PLTABLE STORY082 STORY102 STORY005>)
	(REQUIREMENTS <PLTABLE CODEWORD-COSY NONE NONE>)
	(TYPES <PLTABLE R-CODEWORD R-NONE R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT063 "Several books agree that mermaids can be individually charming, but when encountered in large numbers should be regarded as a grave threat.||\"The collective noun is a Threnody of Mermaids,\" asserts one source, \"and few who hear their song can resist its dread allure. According to popular belief, a troubadour who learned the song used it to cause all the inhabitants of Gutrein, a town in Old Harkuna, to abandon their homes and follow him. The town remains empty to this day.\"||The book goes on to say that mermaids are most frequently encountered to the south of the Ruby River estuary.">

<ROOM STORY063
	(IN ROOMS)
	(DESC "063")
	(STORY TEXT063)
	(CONTINUE STORY368)
	(CODEWORDS <PLTABLE CODEWORD-CYNOSURE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT064 "You cannot sail the ship alone, nor would it be wise to venture further inland without your crew to back you up. You go back to the beach, where at least there are provisions enough to sustain you for a few weeks.||A storm hits the island only a few days later. You shelter under palm trees until morning, when you discover that your fine ship has been wrecked. All you are able to salvage is a broken plank or two.||As luck would have it, a mercantile barque puts in at the island before your supplies are quite exhausted.||\"We are bound for Ringhorn,\" the captain tells you. \"You're welcome to come along.\"">
<CONSTANT CHOICES064 <LTABLE "Travel with them to Ringhorn (Cities of Gold and Glory)" "Stay on the island">>

<ROOM STORY064
	(IN ROOMS)
	(DESC "064")
	(STORY TEXT064)
	(EVENTS STORY064-EVENTS)
	(CHOICES CHOICES064)
	(DESTINATIONS <PLTABLE STORY-CITIES-GOLD-GLORY STORY177>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY064-EVENTS ()
	<STORY-LOSE-SHIP>>

<CONSTANT TEXT065 "The vampire furrows its bald white brow, perplexed to hear you speaking in verse. It looks like a cat that has caught sight of itself in a mirror. Each time it speaks, you reply with a line that rhymes -- and all the time you are slowly retreating down the beach to the rowboat.">

<ROOM STORY065
	(IN ROOMS)
	(DESC "065")
	(STORY TEXT065)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY085 STORY041>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 9 100> <LTABLE "The vampire attacks" "It watches you depart">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT066 "The sea heaps up. White foam from breaking waves begins to be blown in streaks. \"This is near a gale!\" says the mate.">

<ROOM STORY066
	(IN ROOMS)
	(DESC "066")
	(STORY TEXT066)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY213 STORY155 STORY429>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 5 8 12> <LTABLE "A storm hits" "The gale blows over" "Suddenly becalmed">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT067 "Spluttering, you strike out at the creature but it drifts off into the bowels of the ship. Your two crewmen are so spooked by now that they refuse to stay, and you realize it would be unwise to linger on your own. Feeling as if hundreds of eyes are watching you through hidden peepholes, you hurry back to the deck.">

<ROOM STORY067
	(IN ROOMS)
	(DESC "067")
	(STORY TEXT067)
	(EVENTS STORY067-EVENTS)
	(CONTINUE STORY308)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY067-EVENTS ()
	<COND (<CHECK-CODEWORD ,CODEWORD-CALCIUM>
		<PREVENT-DOOM ,STORY067>
	)(ELSE
		<LOSE-STAMINA 4 ,DIED-GREW-WEAKER ,STORY067> 
	)>>

<CONSTANT TEXT068 "The man strides right up to the side of your vessel and hails you as casually as if he were standing on the quayside at Wishport.">

<ROOM STORY068
	(IN ROOMS)
	(DESC "068")
	(VISITS 0)
	(STORY TEXT068)
	(EVENTS STORY068-EVENTS)
	(CONTINUE STORY617)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY068-EVENTS ()
	<COND (<CHECK-VISITS-MORE ,STORY068 1> <STORY-JUMP ,STORY635>)>>

<CONSTANT TEXT069 "You step out from the interior of one of the trees as though emerging from an egg.||Your problem now is how to get off the island.">

<ROOM STORY069
	(IN ROOMS)
	(DESC "069")
	(VISITS 0)
	(BACKGROUND STORY069-BACKGROUND)
	(STORY TEXT069)
	(CONTINUE STORY177)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY069-BACKGROUND ()
	<COND (<CHECK-VISITS-MORE 2> <SETG RESURRECTION-ARRANGEMENTS NONE>)>
	<RETURN ,STORY069>>

<CONSTANT TEXT070 "The mate's knife flashes -- a splash of sticky blood, and the witch falls croaking into the sea to sink like a stone. Something flops to the deck. Her hand. It resembles an old white crab.">

<ROOM STORY070
	(IN ROOMS)
	(DESC "070")
	(STORY TEXT070)
	(EVENTS STORY070-EVENTS)
	(CONTINUE STORY039)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY070-EVENTS ()
	<KEEP-ITEM ,WITCH-HAND>>

<CONSTANT TEXT071 "You can set sail -- either on to the open ocean or up the wide Nozama river.">
<CONSTANT CHOICES071 <LTABLE "Put to sea" "Sail upriver (The Serpent King's Domain)" "Remain in Smogmaw">>

<ROOM STORY071
	(IN ROOMS)
	(DESC "071")
	(CHOICES CHOICES071)
	(DESTINATIONS <PLTABLE STORY320 STORY-SERPENT-KINGS-DOMAIN STORY044>)
	(REQUIREMENTS <PLTABLE DOCK-SMOGMAW NONE NONE>)
	(TYPES <PLTABLE R-DOCKED R-NONE R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT072 "The priestess stretches like a cat, making no effort to stifle a yawn. \"If you'll excuse me, it is time for my siesta.\" She lies back on the divan and closes her eyes. You quietly withdraw from the temple.">

<ROOM STORY072
	(IN ROOMS)
	(DESC "072")
	(STORY TEXT072)
	(CONTINUE STORY044)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT073 "Luckily they are drunk to the point of staggering, and you can fight one after the other instead of all at once.">
<CONSTANT TEXT073-BLOWS "You are struck with a final flurry of blows inflicting some damage!">

<ROOM STORY073
	(IN ROOMS)
	(DESC "073")
	(STORY TEXT073)
	(EVENTS STORY073-EVENTS)
	(CONTINUE STORY016)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY073-EVENTS ("AUX" COMBAT-SCORES DEFENSE-SCORES STAMINA-SCORES)
	<SET COMBAT-SCORES <LTABLE 6 5 5>>
	<SET DEFENSE-SCORES <LTABLE 9 7 7>>
	<SET STAMINA-SCORES <LTABLE 9 5 6>>
	<CRLF>
	<TELL "Try to run off?">
	<COND (<YES?>
		<CONTINUE-TEXT ,TEXT073-BLOWS>
		<LOSE-STAMINA <ROLL-DICE 2> ,DIED-FROM-INJURIES ,STORY073>
		<COND (<IS-ALIVE> <STORY-JUMP ,STORY044>)>
	)(ELSE
		<DO (I 1 3)
			<PUTP ,STORY073 ,P?DOOM T>
			<COMBAT-MONSTER ,MONSTER-MUTINEER <GET .COMBAT-SCORES .I> <GET .DEFENSE-SCORES .I> <GET .STAMINA-SCORES .I>>
			<COND (<NOT <CHECK-COMBAT ,MONSTER-MUTINEER ,STORY073>> <RETURN>)>
		>
	)>>

<CONSTANT TEXT074 "The shack consists of a bamboo hut raised above the ground on stout poles to protect it from flooding. The roof is palm thatch. It is simple but comfortable.||You can rest here if injured. You can also leave money and possessions here to save having to carry them around with you.">

<ROOM STORY074
	(IN ROOMS)
	(DESC "074")
	(LOCATION LOCATION-SMOGMAW)
	(STORY TEXT074)
	(EVENTS STORY074-EVENTS)
	(CONTINUE STORY044)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY074-EVENTS ()
	<VISIT-STORAGE ,STORY074 ,SHACK-SMOGMAW T ,CODEWORD-SMOGMAW ,STORY113>>

<CONSTANT TEXT075 "The bottle contains a map of Bazalek, which is a small isle in the waters near Disaster Bay.">

<ROOM STORY075
	(IN ROOMS)
	(DESC "075")
	(STORY TEXT075)
	(CONTINUE STORY352)
	(ITEMS <PLTABLE MAP-OF-BAZALEK>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT076 "The girl takes the heart-shaped locket and turns, disappearing into the undergrowth. You quickly scramble up the rock and search around, but she has gone leaving no trace.||Your first mate calls to tell you they have loaded the rowboat with fresh water and coconuts. It is time to be off.">

<ROOM STORY076
	(IN ROOMS)
	(DESC "076")
	(STORY TEXT076)
	(EVENTS STORY076-EVENTS)
	(CONTINUE STORY171)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY076-EVENTS ()
	<RETURN-ITEM ,HEART-SHAPED-LOCKET T>
	<GAIN-MONEY 450>>

<CONSTANT TEXT077 "The crewmen seem nervous. The Kingdom of the Reavers is not many leagues to the south-west, and as a consequence pirates abound in these waters.">

<ROOM STORY077
	(IN ROOMS)
	(DESC "077")
	(STORY TEXT077)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY268 STORY322 STORY437>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 6 8 12> <LTABLE "Pirates as feared" "Luck is with you" "Something worse">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT078 "You are at sea close to the great port city of Aku. Westwards lie the first bleak rocky islands of the Innis Shoals.">
<CONSTANT CHOICES078 <LTABLE "Head for Aku (The Court of Hidden Faces)" "Go west (The Isle of a Thousand Spires)" "Go east" "Strike out south">>

<ROOM STORY078
	(IN ROOMS)
	(DESC "078")
	(STORY TEXT078)
	(CHOICES CHOICES078)
	(DESTINATIONS <PLTABLE STORY-COURT-HIDDEN-FACES STORY-ISLE-THOUSAND-SPIRES STORY021 STORY096>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT079 "A southerly breeze stirs the sails. Standing at the rail with head tilted back, you bask in the warm sunshine. Is it your imagination, or can you really detect the scent of exotic spices and swaying palm trees carried on the wind?">

<ROOM STORY079
	(IN ROOMS)
	(DESC "079")
	(STORY TEXT079)
	(EVENTS STORY079-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY186 STORY168 STORY352 STORY056>>)
	(REQUIREMENTS <LTABLE <LTABLE 2 0 <PLTABLE 4 6 9 100> <LTABLE "Catamarans" "An electric storm" "A quiet voyage" "A bottle drifts by">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY079-EVENTS ()
	<COND (<CHECK-GOD ,GOD-THREE-FORTUNES>
		<RESET-ODDS 2 1 ,STORY079>
	)(ELSE
		<RESET-ODDS 2 0 ,STORY079>
	)>>

<CONSTANT TEXT080 "Dead men whose bones are crusted with barnacle creep over the rail at night and carry off half your crewmen. You only discover the cause of the disappearances when you question a sailor who had been locked up in the brig for some minor offence. He saw the barnacle men carrying out their ghastly business through a knothole in the brig door. You have no doubt he's telling the truth; his hair has turned pure white.">

<ROOM STORY080
	(IN ROOMS)
	(DESC "080")
	(STORY TEXT080)
	(EVENTS STORY080-EVENTS)
	(CONTINUE STORY321)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY080-EVENTS ()
	<STORY-RESET-CREW ,CONDITION-POOR ,CURRENT-SHIP>>

<CONSTANT TEXT081 "A strong breeze flutters the sails. The crewmen go about their chores merrily, scrambling through the rigging like carefree monkeys.||\"Five bells,\" intones the mate.">

<ROOM STORY081
	(IN ROOMS)
	(DESC "081")
	(STORY TEXT081)
	(EVENTS STORY081-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY354 STORY101>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 5 12> <LTABLE "Pirates" "An uneventful journey">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY081-EVENTS ()
	<COND (,RUN-ONCE
		<COND (<L? ,STAMINA ,MAX-STAMINA> <GAIN-STAMINA 1>)>
	)>>

<CONSTANT TEXT082 "The men start to yawn. \"Great gods, I feel sleepy!\" announces the bosun, rubbing his eyes.||\"Me, too,\" agrees the quartermaster. \"Like I'd been poleaxed.\"||Despite your stern orders, they go to lie down on the stone slabs.||\"Ah, this is a comfy couch,\" murmurs the bosun as he shuts his eyes. \"Permit us to take just a quick nap, skipper.\"">

<ROOM STORY082
	(IN ROOMS)
	(DESC "082")
	(STORY TEXT082)
	(CHOICES CHOICES-CODEWORD)
	(DESTINATIONS <PLTABLE STORY323 STORY305>)
	(REQUIREMENTS <PLTABLE CODEWORD-CERUMEN NONE>)
	(TYPES ONE-CODEWORD)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT083 "The sky is the colour of burning sulphur. Thunder rumbles the heavens, making your crewmen quail. \"The wrath of the gods is upon us!\" shrieks the bosun. \"Say your final prayers, lads!\"">

<ROOM STORY083
	(IN ROOMS)
	(DESC "083")
	(STORY TEXT083)
	(EVENTS STORY083-EVENTS)
	(CHOICES CHOICES-STORM-FURY)
	(DESTINATIONS <PLTABLE <PLTABLE STORY103 STORY581 STORY060>>)
	(REQUIREMENTS STORY-STORM-REQUIREMENTS)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY083-EVENTS ()
	<STORM-AT-SEA ,STORY083 ,STORY060>>

<ROOM STORY084
	(IN ROOMS)
	(DESC "084")
	(VISITS 0)
	(BACKGROUND STORY084-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY084-BACKGROUND ()
	<DELETE-CODEWORD ,CODEWORD-COSY>
	<COND (<CHECK-VISITS-MORE ,STORY084 1> <RETURN ,STORY433>)>
	<RETURN ,STORY104>>

<CONSTANT TEXT085 "The vampire screeches like an angry owl and lashes out with its long white talons.||\"Go on, skipper, we're right behind you,\" says the first mate nervously.">
<CONSTANT TEXT085-ATTACK "The vampire gets a final attack as you run off, inflicting some damage!">

<ROOM STORY085
	(IN ROOMS)
	(DESC "085")
	(STORY TEXT085)
	(EVENTS STORY085-EVENTS)
	(CONTINUE STORY195)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY085-EVENTS ()
	<CRLF>
	<TELL "Retreat?">
	<COND (<YES?>
		<CONTINUE-TEXT ,TEXT085-ATTACK>
		<LOSE-STAMINA <ROLL-DICE 1> ,DIED-FROM-INJURIES ,STORY085>
		<COND (<IS-ALIVE> <STORY-JUMP ,STORY041>)>
	)(ELSE
		<COMBAT-MONSTER ,MONSTER-VAMPIRE 15 18 18>
		<CHECK-COMBAT ,MONSTER-VAMPIRE ,STORY085>
	)>>

<CONSTANT TEXT086 "Smogmaw market comprises a row of flimsy grass-roofed huts where goods are laid out on straw mats.">
<CONSTANT CHOICES086 <LTABLE "Buy armours/weapons/other items" "Sell armours/weapons/other items" "Leave the market">>

<ROOM STORY086
	(IN ROOMS)
	(DESC "086")
	(LOCATION LOCATION-SMOGMAW)
	(STORY TEXT086)
	(CHOICES CHOICES086)
	(DESTINATIONS <PLTABLE SMOGMAW-MARKET-BUY SMOGMAW-MARKET-SELL STORY167>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT087 "A small boat comes sailing out of a clear horizon. Its single passenger is a bare-chested man in black breeches who leaps aboard with the lithe grace of a big cat.">
<CONSTANT CHOICES087 <LTABLE "Challenge the fellow" "Order him seized" "Offer hospitality">>

<ROOM STORY087
	(IN ROOMS)
	(DESC "087")
	(STORY TEXT087)
	(EVENTS STORY087-EVENTS)
	(CHOICES CHOICES087)
	(DESTINATIONS <PLTABLE STORY235 STORY197 STORY217>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY087-EVENTS ()
	<DELETE-CODEWORD ,CODEWORD-CERTAIN>>

<CONSTANT TEXT088 "There is ample fruit and even a little game, in the form of flightless weasel-birds. The trick lies in knowing what is safe to eat and what is toxic.">

<ROOM STORY088
	(IN ROOMS)
	(DESC "088")
	(STORY TEXT088)
	(CHOICES CHOICES-SCOUTING)
	(DESTINATIONS <PLTABLE <PLTABLE STORY144 STORY162>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-SCOUTING 12>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT089 "The witch promises to mend her ways. \"No more vile hocus pocus for me,\" she vows. But the next day she is gone like a ghost, and the helmsman reports that he does not recognize these waters. You have been played for a sucker">

<ROOM STORY089
	(IN ROOMS)
	(DESC "089")
	(STORY TEXT089)
	(CONTINUE STORY190)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT090 "\"I hope you're well-versed in outdoor survival,\" mutters an old man, displaying the stump of the leg that he lost to a crocodile.">
<CONSTANT CHOICES090 <LTABLE "Follow the coast east (The Serpent King's Domain)" "Follow the coast west (The Serpent King's Domain)" "South-west into the jungle (The Serpent King's Domain)" "South-east into the jungle (The Serpent King's Domain)" "Follow the riverbank (The Serpent King's Domain)" "Remain in Smogmaw">>

<ROOM STORY090
	(IN ROOMS)
	(DESC "090")
	(STORY TEXT090)
	(CHOICES CHOICES090)
	(DESTINATIONS <PLTABLE STORY-SERPENT-KINGS-DOMAIN STORY-SERPENT-KINGS-DOMAIN STORY-SERPENT-KINGS-DOMAIN STORY-SERPENT-KINGS-DOMAIN STORY-SERPENT-KINGS-DOMAIN STORY044>)
	(TYPES SIX-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT091 "The gleam that comes suddenly into her eyes, combined with the sweat glistening on her throat, makes her look feverish and wild. \"The goddesses will ensure your account is settled,\" she says before sinking wearily back on the divan.||You leave the temple under a curse. From now on you can use only one die when making any ability roll. This curse will last until you visit the temple of the Three Fortunes in Metriciens, whereupon it will be lifted.">

<ROOM STORY091
	(IN ROOMS)
	(DESC "091")
	(STORY TEXT091)
	(EVENTS STORY091-EVENTS)
	(CONTINUE STORY044)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY091-EVENTS ()
	<AFFLICTED-WITH ,CURSE-THREE-FORTUNES>>

<CONSTANT TEXT092 "The three mutineers are terrified that you will call your current crewmen to back you up. \"I've got a few barnacles need scraping of my new ship's keel, Mister Burkitt,\" you tell your one-time cabin boy with a crooked smile.||He and his shipmates get up quickly. \"Good to see you're well, skipper. No hard feelings, eh?\" they mutter, pressing a purse with 40 Shards into you hand.||You watch the three men hurry off. You doubt if you'll see them again.">

<ROOM STORY092
	(IN ROOMS)
	(DESC "092")
	(STORY TEXT092)
	(EVENTS STORY092-EVENTS)
	(CONTINUE STORY314)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY092-EVENTS ()
	<GAIN-MONEY 40>
	<DELETE-CODEWORD ,CODEWORD-CHURCH>>

<CONSTANT TEXT093 "\"Hear that melody, captain?\" asks the mate, his expression a mixture of fear and longing. \"It is the song of the mermaids.\"||It is an unearthly sound, beautiful but somehow terrible. Men must feel this way when, having drawn their last breath, they gaze on the lovely face of a Valkyrie.">

<ROOM STORY093
	(IN ROOMS)
	(DESC "093")
	(STORY TEXT093)
	(CHOICES CHOICES-CODEWORD)
	(DESTINATIONS <PLTABLE STORY131 STORY149>)
	(REQUIREMENTS <PLTABLE CODEWORD-CYNOSURE NONE>)
	(TYPES ONE-CODEWORD)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT094 "The bottle contains a treasure map. \"A bloomin' funny thing to find in a bottle,\" is all the bosun has to say when he sees it.||The helmsman is more helpful. \"See this stretch of coastline? It might indicate the Sea of Hydras.\"||\"No,\" says the first mate with a dour shake of his head. \"It's the straits near Teleos, I'm sure of it.\"">

<ROOM STORY094
	(IN ROOMS)
	(DESC "094")
	(STORY TEXT094)
	(CONTINUE STORY352)
	(ITEMS <PLTABLE TREASURE-MAP>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT095 "The girl stamps her foot petulantly and disappears in a thick blast of roiling black smoke.">
<CONSTANT TEXT095-CONTINUED "You open the locket and immediately there is an unearthly howl and something indistinct flies up past you into the sky. A musty scent hangs in the air. Inside the locket is a picture of a bald man with piercing green eyes.">
<CONSTANT CHOICES095 <LTABLE HAVE-CODEWORD "If not, it is now time to leave the island">>

<ROOM STORY095
	(IN ROOMS)
	(DESC "095")
	(STORY TEXT095)
	(EVENTS STORY095-EVENTS)
	(CHOICES CHOICES095)
	(DESTINATIONS <PLTABLE STORY115 STORY171>)
	(REQUIREMENTS <PLTABLE CODEWORD-DANGLE NONE>)
	(TYPES ONE-CODEWORD)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY095-EVENTS ()
	<TAKE-ITEM ,HEART-SHAPED-LOCKET>
	<GAIN-MONEY 450>
	<GAIN-CODEWORD ,CODEWORD-CITRUS>
	<CONTINUE-TEXT ,TEXT095-CONTINUED>>

<CONSTANT TEXT096 "The charts show that you are east of the Innis Shoals, roughly halfway between Uttaku and the great southern continent of Ankon-Konu.">

<ROOM STORY096
	(IN ROOMS)
	(DESC "096")
	(STORY TEXT096)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY033 STORY116 STORY068>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 5 9 12> <LTABLE "Sickness among the crew" TEXT-UNEVENTFUL "A man walking on the water">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT097 "The stowaway is a beautiful girl with blue eyes and long golden hair. She tells you her name is Athanasia and she is the daughter of a prince. \"I ran away to sea rather than be married off to my cousin Zolteg, who in many ways resembles a wart-hog,\" she explains.||In return for letting her join your crew, she teaches you some lovely songs.">

<ROOM STORY097
	(IN ROOMS)
	(DESC "097")
	(STORY TEXT097)
	(EVENTS STORY097-EVENTS)
	(CONTINUE STORY078)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY097-EVENTS ("AUX" ROLL)
	<SET ROLL <RANDOM-EVENT 2 0 T>>
	<COND (<G? .ROLL <CALCULATE-ABILITY ,CURRENT-CHARACTER ,ABILITY-CHARISMA>>
		<UPGRADE-ABILITY ,ABILITY-CHARISMA 1>
	)>>

<CONSTANT TEXT098 "You have reached a torrid clime where the sun beats down mercilessly by day, warping the dry timbers of the ship and turning the ocean into a dark, heaving, fathomless cauldron.">

<ROOM STORY098
	(IN ROOMS)
	(DESC "098")
	(STORY TEXT098)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY183 STORY118 STORY647>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 5 8 12> <LTABLE "A vessel adrift" "All's quiet" "Monsters of the deep">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT099 "Copper Island is a bleak rocky wilderness. In the lee of the great mountains lies the town of Brazen, a community of dusty slate-roofed houses whose only decoration takes the form of ornamental copper drainpipes.">
<CONSTANT CHOICES099 <LTABLE "Visit the market" "Go up to the mines" "Find a tavern" "Look for a temple" "Leave town">>

<ROOM STORY099
	(IN ROOMS)
	(DESC "099")
	(LOCATION LOCATION-COPPER)
	(STORY TEXT099)
	(EVENTS STORY099-EVENTS)
	(CHOICES CHOICES099)
	(DESTINATIONS <PLTABLE STORY297 STORY317 STORY334 STORY347 STORY495>)
	(TYPES FIVE-CHOICES)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY099-EVENTS ()
	<STORY-SET-DOCK ,DOCK-COPPER ,CURRENT-SHIP>>

<CONSTANT TEXT100 "You are on a broad platform of polished basalt that extends into the sea. The city of Dweomer lies some way inland, along a paved avenue with stone sentinels on either side.">
<CONSTANT CHOICES100 <LTABLE "Put to sea" "Acquire a ship" "Arrange passage to the mainland" "Go along the avenue to Dweomer">>

<ROOM STORY100
	(IN ROOMS)
	(DESC "100")
	(LOCATION LOCATION-DWEOMER)
	(STORY TEXT100)
	(CHOICES CHOICES100)
	(DESTINATIONS <PLTABLE STORY122 STORY406 STORY564 STORY175>)
	(REQUIREMENTS <PLTABLE DOCK-DWEOMER NONE NONE NONE>)
	(TYPES <PLTABLE R-DOCKED R-NONE R-NONE R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT101 "\"See those myriad islands?\" says the navigator, pointing to numerous rocky shores scattered in the east beyond a pall of haze.||You nod. \"The Unnumbered Isles. We're due south of Old Sokar - or Marlock City, as it is now called.\"">
<CONSTANT CHOICES101 <LTABLE "Go west" "Go east" "Go north" "Go south">>

<ROOM STORY101
	(IN ROOMS)
	(DESC "101")
	(STORY TEXT101)
	(CHOICES CHOICES101)
	(DESTINATIONS <PLTABLE STORY205 STORY119 STORY077 STORY042>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT102 "With each step your eyelids are getting heavier. You yawn and stretch, feeling utterly weary. Those stone couches look so comfortable.">
<CONSTANT CHOICES102 <LTABLE "Stay awake" TEXT-ROLL-MAGIC>>

<ROOM STORY102
	(IN ROOMS)
	(DESC "102")
	(STORY TEXT102)
	(CHOICES CHOICES102)
	(DESTINATIONS <PLTABLE STORY027 <PLTABLE STORY027 STORY582>>)
	(REQUIREMENTS <PLTABLE CODEWORD-CHILL <PLTABLE ABILITY-MAGIC 18>>)
	(TYPES <PLTABLE R-CODEWORD R-TEST-ABILITY>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT103-ROCKY "You are swept miraculously towards a rocky shore.">

<ROOM STORY103
	(IN ROOMS)
	(DESC "103")
	(STORY TEXT-SHIPWRECK)
	(EVENTS STORY103-EVENTS)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY103-EVENTS ()
	<STORY-SHIPWRECK ,STORY103 ,STORY123 ,STORY-SERPENT-KINGS-DOMAIN ,TEXT103-ROCKY>>

<CONSTANT TEXT104 "The combined strength of all your men is just enough to push the iron doors open. Within lies a hidden valley entirely surrounded by high cliffs -- a paradise of bubbling brooks, emerald lawns, fruit trees and scented flowers. Strewn all around are gold, silver and gems as plentiful as pebbles in a merchant's garden. With wild cries of delight, your men stuff their pockets with all they can carry.||You yourself pick up jewels worth 5000 Shards. The air here is so clean and fresh.||A cold breeze shakes the boughs of the trees. Leaves fall, curling on the grass.||\"We've let Time into Paradise,\" reckons the mate. \"Let's not linger here.\"">

<ROOM STORY104
	(IN ROOMS)
	(DESC "104")
	(STORY TEXT104)
	(EVENTS STORY104-EVENTS)
	(CONTINUE STORY005)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY104-EVENTS ()
	<GAIN-MONEY 5000>
	<COND (<L? ,STAMINA ,MAX-STAMINA>
		<EMPHASIZE "Your stamina has fully recovered.">
		<SETG STAMINA ,MAX-STAMINA>
		<UPDATE-STATUS-LINE>
	)(ELSE
		<UPGRADE-STAMINA <ROLL-DICE 1>>
	)>>

<ROOM STORY105
	(IN ROOMS)
	(DESC "105")
	(VISITS 0)
	(BACKGROUND STORY105-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY105-BACKGROUND ()
	<COND (<CHECK-VISITS-MORE ,STORY105 1> <RETURN ,STORY159>)>
	<RETURN ,STORY338>>

<CONSTANT TEXT106 "The helmsman goes mad in the middle of the night, possibly as a result of smoking tobacco mixed with mauve lotus. By the time anyone notices, he has had plenty of time to work mischief.">

<ROOM STORY106
	(IN ROOMS)
	(DESC "106")
	(STORY TEXT106)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY024 STORY124 STORY212>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 1 0 <PLTABLE 2 4 6> <LTABLE "Lost at sea" "Out of drinking water" "Run aground">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT107 "\"Land ahoy!\" cries the lookout. It is Fiddler's Green, the island gifted to you by the herald of the sea gods.">
<CONSTANT CHOICES107 <LTABLE "Put in at the island" "Sail on">>

<ROOM STORY107
	(IN ROOMS)
	(DESC "107")
	(STORY TEXT107)
	(CHOICES CHOICES107)
	(DESTINATIONS <PLTABLE STORY143 STORY125>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT108 "You tie bundles of saplings together using rope made of plaited palm leaves Hollow gourds help to provide buoyancy. Commending your soul to the gods, you push the little raft out from shore and climb aboard. It is not so much like sailing as swimming with the aid of a float.">

<ROOM STORY108
	(IN ROOMS)
	(DESC "108")
	(STORY TEXT108)
	(EVENTS STORY108-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY123 STORY158 STORY180>>)
	(REQUIREMENTS <LTABLE <LTABLE 2 0 <PLTABLE 5 8 100> <LTABLE "The raft sinks" "Picked up at sea" "You reach land">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY108-EVENTS ()
	<COND (<CHECK-GOD ,GOD-MOLHERN>
		<RESET-ODDS 2 2 ,STORY108>
	)(ELSE
		<RESET-ODDS 2 0 ,STORY108>
	)>>

<CONSTANT TEXT109 "An unexplained waterspout erupts from the surface of the sea, carrying your vessel high up into the sky. The sailors cringe in dismay and cling to the rigging for safety.||\"Gods above!\" cries the cook as he sees the clouds go past. \"We're airborne!\"||The mate clutches his throat. \"It's getting hard to breathe...\" he says before slumping to the deck.">
<CONSTANT CHOICES109 <LTABLE "You are not affected" OTHERWISE>>

<ROOM STORY109
	(IN ROOMS)
	(DESC "109")
	(STORY TEXT109)
	(CHOICES CHOICES109)
	(DESTINATIONS <PLTABLE STORY127 STORY123>)
	(REQUIREMENTS <PLTABLE CODEWORD-CALCIUM NONE>)
	(TYPES ONE-CODEWORD)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT110 "Several skippers have loaded their cargoes and are ready to depart for ports in the north. You can get passage to Dweomer, Yellowport or Metriciens, for 35 Shards in each case. There is also a merchant who intends to go upriver to trade with the natives of the interior; he will take you along for 5 Shards. Alternatively, you could buy a ship of your own.">
<CONSTANT CHOICES110 <LTABLE "Pay the fare to Yellowport" "Pay the fare to Dweomer" "Pay the fare to Metriciens" "Accompany the merchant upriver (The Serpent King's Domain)" "Buy a ship" "Stay in Smogmaw">>

<ROOM STORY110
	(IN ROOMS)
	(DESC "110")
	(STORY TEXT110)
	(CHOICES CHOICES110)
	(DESTINATIONS <PLTABLE STORY224 STORY242 STORY260 STORY-SERPENT-KINGS-DOMAIN STORY712 STORY044>)
	(REQUIREMENTS <PLTABLE 35 35 35 5 NONE NONE>)
	(TYPES <PLTABLE R-MONEY R-MONEY R-MONEY R-MONEY R-NONE R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT111 "The priestess asks you if you wish to become an initiate of the Three Fortunes.">

<ROOM STORY111
	(IN ROOMS)
	(DESC "111")
	(STORY TEXT111)
	(EVENTS STORY111-EVENTS)
	(CONTINUE STORY256)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY111-EVENTS ()
	<COND (<CHECK-GOD ,GOD-THREE-FORTUNES>
		<STORY-JUMP ,STORY044>
	)(ELSE
		<BECOME-INITIATE 0 ,GOD-THREE-FORTUNES>
		<COND (<NOT <CHECK-GOD ,GOD-THREE-FORTUNES>>
			<STORY-JUMP ,STORY044>
		)>
	)>>

<CONSTANT TEXT112 "Your former crewmen soon back down when they see two burly natives in feather cloaks and full warpaint getting up to stand beside you.||\"This is the friend of Moon of Evening,\" says one of the natives, shaking his spear at the frightened mutineers. \"You cause trouble and you will sleep with the piranhas!\"||The three hurry off. \"They won't come in here again,\" says the other native.">

<ROOM STORY112
	(IN ROOMS)
	(DESC "112")
	(STORY TEXT112)
	(EVENTS STORY112-EVENTS)
	(CONTINUE STORY314)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY112-EVENTS ()
	<DELETE-CODEWORD ,CODEWORD-CHURCH>>

<CONSTANT TEXT113 "The squatters cannot see why they shouldn't use your property while you're away at sea. A vigorous two-fisted argument soon sets them straight, but you get a bloody nose and a black eye in the process of evicting them. You throw them in the mud at the side of the river before striding back to your shack.">

<ROOM STORY113
	(IN ROOMS)
	(DESC "113")
	(STORY TEXT113)
	(EVENTS STORY113-EVENTS)
	(CONTINUE STORY074)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY113-EVENTS ()
	<LOSE-STAMINA <ROLL-DICE 1> ,DIED-FROM-INJURIES ,STORY113>>

<CONSTANT TEXT114 "You are taken before the Reaver King in his grim fortress which stands at the back of the secluded cove where the pirates have their base. Many a captain in the world's navies would pay dearly to know the location of this place, the secret harbour from which the dread Reavers swoop out to prey on passing ships.">

<ROOM STORY114
	(IN ROOMS)
	(DESC "114")
	(LOCATION LOCATION-REAVER)
	(STORY TEXT114)
	(CHOICES CHOICES-CODEWORD)
	(DESTINATIONS <PLTABLE STORY473 STORY233>)
	(REQUIREMENTS <PLTABLE CODEWORD-CUTLASS NONE>)
	(TYPES ONE-CODEWORD)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT115 "The portrait is of your old foe Kaschuv the Deathless. He'll have to choose another soubriquet now you've found and released his soul from the magic locket in which he kept it secure.||The first mate calls to tell you the supplies are stowed aboard. It is time to set sail.">

<ROOM STORY115
	(IN ROOMS)
	(DESC "115")
	(STORY TEXT115)
	(CONTINUE STORY171)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT116 "The mate joins you at the rail and the two of you watch the sun sink beyond the rocky peaks of the Innis archipelago.||\"What lies there in the west?\" wonders the mate. \"Are you for finding out, skipper? Say the word and I'll set a course for the Sea of Stilts.\"">
<CONSTANT CHOICES116 <LTABLE "Travel west (The Isle of a Thousand Spires)" "Go south" "Go north" "Head east">>

<ROOM STORY116
	(IN ROOMS)
	(DESC "116")
	(STORY TEXT116)
	(CHOICES CHOICES116)
	(DESTINATIONS <PLTABLE STORY-ISLE-THOUSAND-SPIRES STORY040 STORY058 STORY370>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT117 "The grey bulk of an island can be seen to the north. \"Why is it called the Sleeping Isle?\" you hear the cabin boy ask the first mate.||\"Why, lad, it's because a curse puts anyone who goes ashore off to sleep for a hundred years,\" is the mate's reply.">

<ROOM STORY117
	(IN ROOMS)
	(DESC "117")
	(STORY TEXT117)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY496 STORY135 STORY465>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 5 9 12> <LTABLE "A flying horseman" TEXT-UNEVENTFUL "The Kraken wakes">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT118 "The lookout spots an island off the starboard bow. Nothing is recorded on the charts for this region, but perhaps that isn't surprising. Few ships return from the dread Sea of Hydras.">
<CONSTANT CHOICES118 <LTABLE "Explore the island" "Sail on">>

<ROOM STORY118
	(IN ROOMS)
	(DESC "118")
	(LOCATION LOCATION-HYDRA)
	(STORY TEXT118)
	(CHOICES CHOICES118)
	(DESTINATIONS <PLTABLE STORY413 STORY278>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT119 "You have a good day's sailing, but at dusk a heavy gloom swathes the sunset in a welter of bloody reds, golds, charcoal grey and livid purple. It looks like a bruise in the western sky.||\"Let's hope that's no harbinger of a storm,\" says the mate.">

<ROOM STORY119
	(IN ROOMS)
	(DESC "119")
	(STORY TEXT119)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY213 STORY137 STORY533>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 4 7 12> <LTABLE "Worsening weather" "A quiet night" "A ship's lanterns">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROOM STORY120
	(IN ROOMS)
	(DESC "120")
	(VISITS 0)
	(BACKGROUND STORY120-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY120-BACKGROUND ()
	<COND (<CHECK-VISITS-MORE ,STORY120 1> <RETURN ,STORY350>)>
	<RETURN ,STORY097>>

<CONSTANT TEXT121 "You look up into two pairs of eyes that glitter like onyx. There is a rustling sound, a snake-like hiss, and then you dimly hear these words: \"This one is stricken like the others, my sister...\"||A terrible spell prevents you from moving a muscle. There is a sense of days and nights flitting past in less than a heartbeat. You must summon your fading concentration to shrug off the spell before it is too late.">

<ROOM STORY121
	(IN ROOMS)
	(DESC "121")
	(STORY TEXT121)
	(CHOICES CHOICES-MAGIC)
	(DESTINATIONS <PLTABLE <PLTABLE STORY713 STORY522>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-MAGIC 14>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT122 "You are sailing away from Braelak, the Sorcerers' Isle">
<CONSTANT CHOICES122 <LTABLE "Go north" "Go south" "Go east" "Go west">>

<ROOM STORY122
	(IN ROOMS)
	(DESC "122")
	(LOCATION LOCATION-OCEAN)
	(STORY TEXT122)
	(CHOICES CHOICES122)
	(DESTINATIONS <PLTABLE STORY200 STORY244 STORY504 STORY129>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT123 "You are dead.">

<ROOM STORY123
	(IN ROOMS)
	(DESC "123")
	(STORY TEXT123)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT124 "With no water in the barrels, you have little hope of surviving to reach dry land. You ask your officers to propose a course of action. The first mate recommends you set course for Dweomer and trust to stringent rationing. The navigator thinks you should circle in these waters looking for an island.">
<CONSTANT CHOICES124 <LTABLE "Head for Dweomer" "Search for an island">>

<ROOM STORY124
	(IN ROOMS)
	(DESC "124")
	(STORY TEXT124)
	(CHOICES CHOICES124)
	(DESTINATIONS <PLTABLE STORY142 STORY160>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT125 "The sea, which for many days now has been a rich mauve-blue, now begins to take on a rusty colour.||\"It is silt from the Nozama estuary,\" says the navigator. \"The same stuff that gives Lake Firewater its blood-tinged hue.\"">
<CONSTANT CHOICES125 <LTABLE "Steer south to Smogmaw" "Steer north" "Steer west" "Steer east">>

<ROOM STORY125
	(IN ROOMS)
	(DESC "125")
	(LOCATION LOCATION-OCEAN)
	(STORY TEXT125)
	(EVENTS STORY-SET-SAIL)
	(CHOICES CHOICES125)
	(DESTINATIONS <PLTABLE STORY266 STORY004 STORY227 STORY302>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT126 "You kneel in the sand for days, eating and drinking nothing, until starvation makes strange visions dance before your eyes. Every moment is spent in prayer. The demands of the flesh are first ignored, then forgotten, as you pin all your hopes on divine intervention.">

<ROOM STORY126
	(IN ROOMS)
	(DESC "126")
	(STORY TEXT126)
	(EVENTS STORY126-EVENTS)
	(CONTINUE STORY177)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY126-EVENTS ()
	<COND (<CHECK-GOD ,GOD-ALVIR-VALMIR>
		<PREVENT-DOOM ,STORY126>
		<CRLF>
		<COND (<TEST-ABILITY ,CURRENT-CHARACTER ,ABILITY-SANCTITY 17>
			<STORY-JUMP ,STORY198>
		)(ELSE
			<STORY-JUMP ,STORY123>
		)>
	)(ELSE
		<CONTINUE-TEXT "Your prayers are completely in vain, and finally you give up the attempt.">
		<LOSE-STAMINA 3 ,DIED-OF-HUNGER ,STORY126>
	)>>

<CONSTANT TEXT127 "The entire ship's company sinks into a coma. Unlike you, they cannot breathe the thin air up here. You must do something before they are all dead.">
<CONSTANT CHOICES127 <LTABLE "Use sorcery to save them" "Dive into the sea" "Climb down the side of the ship">>

<ROOM STORY127
	(IN ROOMS)
	(DESC "127")
	(STORY TEXT127)
	(CHOICES CHOICES127)
	(DESTINATIONS <PLTABLE STORY145 STORY199 STORY219>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT128 "You see an old man wading ankle-deep in mud as he crosses from one tavern to another. His reason for not using the boardwalks is that dogs use them too -- \"The mud is more sanitary!\" he explains.||Regarding your enquiry about Smogmaw's temples, he mentions four: \"There is the shrine to Alvir and Valmir, the temple of the Three Fortunes, a shrine to Glimbinki the Plumed One, and somewhere there's a fane sacred to Badogor.\"||\"Who?\"||He puts his finger to his lips. \"Sssh. The Unspoken One.\"">
<CONSTANT CHOICES128 <LTABLE "Visit the temple of the Three Fortunes" "Visit the shrine of Alvir and Valmir" "Visit Glimbinki's shrine" "Look for Badogor's fane" "Consider your other options">>

<ROOM STORY128
	(IN ROOMS)
	(DESC "128")
	(STORY TEXT128)
	(CHOICES CHOICES128)
	(DESTINATIONS <PLTABLE STORY146 STORY503 STORY259 STORY333 STORY044>)
	(TYPES FIVE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT129 "Green sea flashes under trails of frothy white; looking north, you have the coast in sight.||The mate's gaze is fixed, not on land, but on the deep swelling waves. \"How many skulls gaze up from the ocean bed?\" he wonders. \"How many sunken hulks, weed-choked and silent, lie rotting on the wet sands? Ah, it's always when we're nearly home that my fancies turn morbid.\"">

<ROOM STORY129
	(IN ROOMS)
	(DESC "129")
	(STORY TEXT129)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY381 STORY475 STORY273>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 6 11 12> <LTABLE "The High King's banner" "Plain sailing" "An uncanny awakening">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT130 "You sit down and start drinking with them. Your aim is to lull their suspicions until they are soundly drunk and then make a reckoning for their crime.">

<ROOM STORY130
	(IN ROOMS)
	(DESC "130")
	(STORY TEXT130)
	(CHOICES CHOICES-CHARISMA)
	(DESTINATIONS <PLTABLE <PLTABLE STORY148 STORY073>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-CHARISMA 11>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT131 "You order your men below and tell them to secure the hatches, knowing that the mermaid's singing will otherwise draw them to their doom.||\"But what about the wheel, skipper?\" asks the helmsman. \"If I leave it untended who knows where we'll end up?\"||He has a point. If you have a length of rope you could lash yourself to the wheel. Otherwise you'll have to go below with the others or stay on deck and take your chances.">
<CONSTANT CHOICES131 <LTABLE "Tie yourself to the wheel" "Go below with the crew" "Remain on deck">>

<ROOM STORY131
	(IN ROOMS)
	(DESC "131")
	(STORY TEXT131)
	(CHOICES CHOICES131)
	(DESTINATIONS <PLTABLE STORY353 STORY439 STORY149>)
	(REQUIREMENTS <PLTABLE ROPE NONE NONE>)
	(TYPES <PLTABLE R-ITEM R-NONE R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT132 "It is with mounting excitement that you recognize this island as the one marked on the map.||Digging at the spot marked, you find a chest containing a handsome haul.">

<ROOM STORY132
	(IN ROOMS)
	(DESC "132")
	(STORY TEXT132)
	(EVENTS STORY132-EVENTS)
	(CONTINUE STORY150)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY132-EVENTS ("AUX" ROLL REWARDS-MONEY REWARDS-ITEMS)
	<SET REWARDS-MONEY <LTABLE 100 400 200 300 1000 200>>
	<SET REWARDS-ITEMS <LTABLE SWORD3 COMPASS PLATE-ARMOUR EBONY-WAND CANDLE PIRATE-CAPTAINS-HEAD>>
	<SET ROLL <RANDOM-EVENT 1 0 T>>
	<GAIN-MONEY <GET .REWARDS-MONEY .ROLL>>
	<TAKE-ITEM <GET .REWARDS-ITEMS .ROLL>>
	<REMOVE-ITEM ,TREASURE-MAP ,TEXT-USED T T>>

<CONSTANT TEXT133 "You find a half-buried chest under a stand of trees at the back of a beach of ash-grey sand. Inside is treasure worth 450 Shards and a heart-shaped locket.||Just as you are about to open the locket, you hear a voice calling you and look up to see a beautiful girl wearing garlands of flowers. She reaches down from the rock on which she's standing and asks you to return the locket to her.">
<CONSTANT CHOICES133 <LTABLE "Give it to her" "Refuse">>

<ROOM STORY133
	(IN ROOMS)
	(DESC "133")
	(STORY TEXT133)
	(EVENTS STORY133-EVENTS)
	(CHOICES CHOICES133)
	(DESTINATIONS <PLTABLE STORY076 STORY095>)
	(REQUIREMENTS <PLTABLE HEART-SHAPED-LOCKET NONE>)
	(TYPES ONE-ITEM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY133-EVENTS ()
	<GAIN-MONEY 450>
	<TAKE-ITEM ,HEART-SHAPED-LOCKET>
	<COND (<NOT <CHECK-ITEM ,HEART-SHAPED-LOCKET>> <STORY-JUMP ,STORY076>)>>

<CONSTANT TEXT134 "If you have a ship docked at Smogmaw you can either put to sea or sail upriver. Alternatively you may be able to hire passage aboard a merchant ship. In either case you will need to go to the quayside. It is also possible to travel on from here on foot, of course, but you are warned that the hinterland consists of wild jungle and dangerous marshes.">
<CONSTANT CHOICES134 <LTABLE "Go to the quayside" "Travel overland" "Remain in Smogmaw">>

<ROOM STORY134
	(IN ROOMS)
	(DESC "134")
	(STORY TEXT134)
	(CHOICES CHOICES134)
	(DESTINATIONS <PLTABLE STORY071 STORY090 STORY044>)
	(REQUIREMENTS <PLTABLE DOCK-SMOGMAW NONE NONE>)
	(TYPES <PLTABLE R-DOCKED R-NONE R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT135 "Your current position is south of the Sleeping Isle. The bottom edges of your charts show a fancifully drawn morass of swampland and rank jungle -- the unexplored continent of Ankon-Konu.">
<CONSTANT CHOICES135 <LTABLE "Go west" "Go east" "Go north" "Go south (The Lone and Level Sands)">>

<ROOM STORY135
	(IN ROOMS)
	(DESC "135")
	(STORY TEXT135)
	(CHOICES CHOICES135)
	(DESTINATIONS <PLTABLE STORY079 STORY153 STORY468 STORY-LONE-LEVEL-SANDS>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT136 "The ocean stretches as far as the eye can see. It is tranquil, but there is something ominous about the silence.">

<ROOM STORY136
	(IN ROOMS)
	(DESC "136")
	(STORY TEXT136)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY139 STORY154 STORY292>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 4 8 12> <LTABLE "A hurricane" "A quiet voyage" "Treachery aboard!">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT137 "You are at sea south of Sokara, at a point roughly on the same longitude as Trefoille. You consider your next course.">
<CONSTANT CHOICES137 <LTABLE "South" "North" "East" "West">>

<ROOM STORY137
	(IN ROOMS)
	(DESC "137")
	(STORY TEXT137)
	(CHOICES CHOICES137)
	(DESTINATIONS <PLTABLE STORY004 STORY066 STORY246 STORY081>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT138 "Drifting in light fog, you are startled by the sound of ripping canvas and splintered wood. The ship lurches to a dead halt, then begins to turn about. The cause is almost unbelievable: an anchor, dangling from above the fog bank, has lodged against the forecastle! As you watch, a spindly fellow with violet skin comes scrambling down and tries to work the anchor free.">
<CONSTANT CHOICES138 <LTABLE "Order the violet man seized" "Let him do his work and depart">>

<ROOM STORY138
	(IN ROOMS)
	(DESC "138")
	(STORY TEXT138)
	(CHOICES CHOICES138)
	(DESTINATIONS <PLTABLE STORY251 STORY228>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT139 "The sky turns sulphur-grey. Thunderheads pile up on the horizon like vengeful gods. Lightning flickers like burning pitch on the world's rim. \"It's the end!\" shrieks the bosun. \"Say your prayers, lads!\"">

<ROOM STORY139
	(IN ROOMS)
	(DESC "139")
	(STORY TEXT139)
	(EVENTS STORY139-EVENTS)
	(CHOICES CHOICES-HURRICANE-STRIKES)
	(DESTINATIONS <PLTABLE <PLTABLE STORY157 STORY581 STORY098>>)
	(REQUIREMENTS STORY-HURRICANE-REQUIREMENTS)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY139-EVENTS ()
	<STORM-AT-SEA ,STORY139 ,STORY154>>

<CONSTANT TEXT140 "Whether you beg for mercy or vow vengeance, it is all the same to these merciless Reavers. You are thrown into the sea.">

<ROOM STORY140
	(IN ROOMS)
	(DESC "140")
	(STORY TEXT140)
	(CHOICES CHOICES-SCOUTING)
	(DESTINATIONS <PLTABLE <PLTABLE STORY195 STORY085>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-SCOUTING 15>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT141 "You hold out your hand and begin to chant prayers of great power.||\"That's it, skipper,\" says the first mate encouragingly, \"give the wight a bit of holy hellfire!\"">

<ROOM STORY141
	(IN ROOMS)
	(DESC "141")
	(STORY TEXT141)
	(CHOICES CHOICES-SANCTITY)
	(DESTINATIONS <PLTABLE <PLTABLE STORY195 STORY085>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-SANCTITY 15>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT142 "This will be a test of you ingenuity, leadership and survival skills.">

<ROOM STORY142
	(IN ROOMS)
	(DESC "142")
	(STORY TEXT142)
	(EVENTS STORY142-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY123 STORY152>>)
	(REQUIREMENTS <LTABLE <LTABLE 1 0 <PLTABLE 7 100> <LTABLE "Overcome by thirst" "You reach Dweomer">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY142-EVENTS ("AUX" (DICE 1) (MODIFIER 0))
	<COND (<CHECK-PROFESSION ,PROFESSION-WAYFARER> <SET DICE 2>)>
	<SET MODIFIER <GET-RANK ,CURRENT-CHARACTER>>
	<RESET-ODDS .DICE .MODIFIER ,STORY142>>


<ROOM STORY143
	(IN ROOMS)
	(DESC "143")
	(VISITS 0)
	(BACKGROUND STORY143-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY143-BACKGROUND ()
	<COND (<CHECK-VISITS-MORE ,STORY143 1> <RETURN ,STORY161>)>
	<RETURN ,STORY179>>

<CONSTANT TEXT144 "A new dawn brings another chance of rescue.">

<ROOM STORY144
	(IN ROOMS)
	(DESC "144")
	(STORY TEXT144)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY177 STORY198 STORY218>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 9 10 12> <LTABLE "An empty horizon" "A merchantman" "Pirates">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT145 "Should you try to slow your crew's breathing so that they can survive longer, or go for broke and try cancelling out the waterspout altogether? You must rely on your experience in such matters to guide you.">

<ROOM STORY145
	(IN ROOMS)
	(DESC "145")
	(STORY TEXT145)
	(CHOICES CHOICES-MAGIC)
	(DESTINATIONS <PLTABLE <PLTABLE STORY163 STORY181>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-MAGIC 14>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT146 "The temple of the Three Fortunes is an oval house with a triple-peaked thatched roof. The priestess is a young woman who is lounging on a jewelled divan, being fanned by two slave boys.">

<ROOM STORY146
	(IN ROOMS)
	(DESC "146")
	(STORY TEXT146)
	(EVENTS STORY146-EVENTS)
	(CONTINUE STORY274)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY146-EVENTS ()
	<COND (<CHECK-GOD ,GOD-THREE-FORTUNES> <STORY-JUMP ,STORY256>)>>

<CONSTANT TEXT147 "You swim out to the shrine of the sea gods.">
<CONSTANT TEXT147-BLESSING "You touch the obelisk and receive a blessing of Safety from Storms.">
<CONSTANT TEXT147-NOTHING "You touch the obelisk. Nothing happens.">
<CONSTANT CHOICES147 <LTABLE "Swim back">>

<ROOM STORY147
	(IN ROOMS)
	(DESC "147")
	(STORY TEXT147)
	(EVENTS STORY147-EVENTS)
	(CHOICES CHOICES147)
	(DESTINATIONS <PLTABLE <PLTABLE STORY044 STORY165>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-SCOUTING 11>>)
	(TYPES ONE-ABILITY)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY147-EVENTS ("AUX" ROLL)
	<COND (,RUN-ONCE
		<SET ROLL <RANDOM-EVENT 1 0 T>>
		<COND (<EQUAL? .ROLL 1>
			<EMPHASIZE "A crocodile snaps at you!">
			<LOSE-STAMINA <ROLL-DICE 1> ,DIED-FROM-INJURIES ,STORY147>
		)(<EQUAL? .ROLL 2>
			<PREVENT-DOOM ,STORY147>
			<EMPHASIZE "You lose your purse!">
			<SETG MONEY 0>
		)(ELSE
			<PREVENT-DOOM ,STORY147>
			<EMPHASIZE "You reach the shrine without incident.">
		)>
		<UPDATE-STATUS-LINE>
		<COND (<IS-ALIVE>
			<COND (<CHECK-BLESSING ,BLESSING-SAFETY-FROM-STORMS>
				<CONTINUE-TEXT ,TEXT147-NOTHING>
			)(ELSE
				<CONTINUE-TEXT ,TEXT147-BLESSING>
				<GAIN-BLESSING ,BLESSING-SAFETY-FROM-STORMS>
			)>
		)>
	)>>

<CONSTANT TEXT148 "Eventually they are sleeping like babes -- like babes who have put away three bottles of the local firewater, that is. You carry them to the quayside and sell them to a slaver out of Port Kunrir. The total profit for the evening comes to a thoroughly satisfying 407 Shards.">

<ROOM STORY148
	(IN ROOMS)
	(DESC "148")
	(STORY TEXT148)
	(EVENTS STORY148-EVENTS)
	(CONTINUE STORY044)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY148-EVENTS ()
	<GAIN-MONEY 407>
	<DELETE-CODEWORD ,CODEWORD-CHURCH>>

<CONSTANT TEXT149 "All who hear the mermaids' song are drawn to their doom. Your only hope lies in the possibility that you are tone deaf.">
<CONSTANT TEXT149-TROUBADOUR "There is no chance of this since you are a Troubadour.">

<ROOM STORY149
	(IN ROOMS)
	(DESC "149")
	(STORY TEXT149)
	(EVENTS STORY149-EVENTS)
	(CONTINUE STORY-INTO-THE-UNDERWORLD)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY149-EVENTS ()
	<COND (<CHECK-PROFESSION ,PROFESSION-TROUBADOUR>
		<CONTINUE-TEXT ,TEXT149-TROUBADOUR>
	)(<EQUAL? <RANDOM-EVENT 2 0 T> 2>
		<CONTINUE-TEXT "You are tone deaf.">
		<STORY-JUMP ,STORY300>
		<RETURN>
	)>
	<GAIN-CODEWORD ,CODEWORD-CERUMEN>>

<CONSTANT TEXT150 "There is not much food to be had on the island, but your crew gather some shellfish and someone succeeds in bringing down a seagull with a slingshot. That night you dine on your first fresh stew in weeks.">

<ROOM STORY150
	(IN ROOMS)
	(DESC "150")
	(STORY TEXT150)
	(EVENTS STORY150-EVENTS)
	(CONTINUE STORY278)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY150-EVENTS ()
	<COND (<L? ,STAMINA ,MAX-STAMINA> <GAIN-STAMINA <ROLL-DICE 1>>)>>

<CONSTANT TEXT151 "You have been washed up in a small harbour. Many fishing boats painted in gay colours lie on the tide-streaked mud. A pretty town of white-washed cottages stretches steeply up from the quayside towards high cliffs.||You climb the harbour steps and explore the streets. You soon discover that the place is under a curse, as all the villagers stand frozen like statues.">
<CONSTANT CHOICES151 <LTABLE "Take a boat to sea" "Ascend the cliffs" "Pray for guidance" "Rest in one of the houses" "Leave the town">>

<ROOM STORY151
	(IN ROOMS)
	(DESC "151")
	(LOCATION LOCATION-DWEOMER)
	(STORY TEXT151)
	(CHOICES CHOICES151)
	(DESTINATIONS <PLTABLE STORY411 STORY540 STORY467 STORY524 STORY449>)
	(TYPES FIVE-CHOICES)
	(FLAGS LIGHTBIT)>

<ROOM STORY152
	(IN ROOMS)
	(DESC "152")
	(BACKGROUND STORY152-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY152-BACKGROUND ()
	<STORY-SET-DOCK ,DOCK-DWEOMER ,CURRENT-SHIP>
	<RETURN ,STORY100>>

<CONSTANT TEXT153 "By day you sail on lavender waves under a vault of azure and gold. By night the sails gleam dazzlingly white in the rays of the moon, and each star finds its twin in the dark ocean depths.">

<ROOM STORY153
	(IN ROOMS)
	(DESC "153")
	(STORY TEXT153)
	(EVENTS STORY153-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY239 STORY171 STORY057>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 5 6 12> <LTABLE "A flock of birds" "An uneventful journey" "Landfall">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY153-EVENTS ()
	<COND (<AND ,RUN-ONCE <L? ,STAMINA ,MAX-STAMINA>> <GAIN-STAMINA 1>)>>

<CONSTANT TEXT154 "You are crossing the Sea of Hydras, a stretch of water with a baleful reputation. The crewmen go about their tasks in uneasy silence, hardly daring to draw breath lest they attract calamitous misfortune.">
<CONSTANT CHOICES154 <LTABLE "Go south" "Go north-east (Lords of the Rising Sun)" "Go north (Lords of the Rising Sun)" "Go south-east" "Go west">>

<ROOM STORY154
	(IN ROOMS)
	(DESC "154")
	(LOCATION LOCATION-HYDRA)
	(STORY TEXT154)
	(CHOICES CHOICES154)
	(DESTINATIONS <PLTABLE STORY023 STORY-LORDS-RISING-SUN STORY-LORDS-RISING-SUN STORY098 STORY337>)
	(TYPES FIVE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT155 "Despite the overcast sky, you think you have a good estimate of your position.||\"We are due south of Yellowport,\" you tell the navigator, who looks back at you dubiously. \"Set your bearing accordingly.\"">
<CONSTANT CHOICES155 <LTABLE "Go north (The War-Torn Kingdom)" "Go south" "Go east" "Go west">>

<ROOM STORY155
	(IN ROOMS)
	(DESC "155")
	(STORY TEXT155)
	(CHOICES CHOICES155)
	(DESTINATIONS <PLTABLE STORY-WAR-TORN-KINGDOM STORY246 STORY055 STORY077>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT156 "You approach the Island of Fire. It comprises a broad mountain of volcanic origin rimmed by fertile plains. Islanders wave to you from the water's edge.">
<CONSTANT CHOICES156 <LTABLE "Put in at the island" "Continue on to open ocean">>

<ROOM STORY156
	(IN ROOMS)
	(DESC "156")
	(STORY TEXT156)
	(CHOICES CHOICES156)
	(DESTINATIONS <PLTABLE STORY461 STORY479>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT157 "Helpless in the hurricane's grip, your vessel is torn apart. Water rushes into the broken shell of the hull, dragging you down. The screams of your crewmen are lost in the roar of the storm. Your ship and crew are lost. So are your money and possessions. You can think of nothing now but saving yourself.">
<CONSTANT TEXT157-CONTINUED "You manage to stay alive by clinging to a broken spar. On the point of death, with your vision blurring, you see a ship. Seawater fills your mouth as you try to cry out; all you manage is a feeble groan. The ship seems to jump closer in rapid flickering movements as you drift in and out of consciousness. At last you feel yourself being hauled aboard.||You wake on a pallet below deck. You start to sit up, but you are still too weak after your ordeal.||\"Save your strength,\" says a voice out of the gloom. \"You'll need it. The life of a slave is harsh indeed.\"||You discover that you have been picked up by an Uttakin slave ship. The slavers will only agree to release you if you can pay a ransom of 300 Shards.">
<CONSTANT CHOICES157 <LTABLE "Pay the ransom (Cities of Gold and Glory)" "Can't or won't pay (The Court of Hidden Faces)">>

<ROOM STORY157
	(IN ROOMS)
	(DESC "157")
	(STORY TEXT157)
	(EVENTS STORY157-EVENTS)
	(CHOICES CHOICES157)
	(DESTINATIONS <PLTABLE STORY-CITIES-GOLD-GLORY STORY-COURT-HIDDEN-FACES>)
	(REQUIREMENTS <PLTABLE 300 NONE>)
	(TYPES <PLTABLE R-MONEY R-NONE>)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY157-EVENTS ()
	<COND (,RUN-ONCE
		<STORY-LOSE-SHIP>
		<STORY-LOSE-EVERYTHING F>
		<UPDATE-STATUS-LINE>
		<COND (<G? <RANDOM-EVENT 2 0 T> <GET-RANK ,CURRENT-CHARACTER>>
			<EMPHASIZE "You drowned.">
			<STORY-JUMP ,STORY123>
		)>
	)>>

<CONSTANT TEXT158 "Somehow you manage to keep your head above water. You swim until your limbs feel as though they are caught in a net. You struggle on, mortally weak but determined not to give up.||A ship heaves into view. You raise your arm and give a feeble cry. By some miracle you are spotted, and the ship steers towards you. You are hauled aboard, wrapped in blankets, and given a bowl of hot soup.||To your immense relief, you have been rescued by merchants from Metriciens.||\"We are bound for Dweomer and then home,\" they say. \"We'll drop you off wherever you like.\"">
<CONSTANT CHOICES158 <LTABLE "Get off at Dweomer" "Continue on to Metriciens (Cities of Gold and Glory)">>

<ROOM STORY158
	(IN ROOMS)
	(DESC "158")
	(STORY TEXT158)
	(CHOICES CHOICES158)
	(DESTINATIONS <PLTABLE STORY100 STORY-CITIES-GOLD-GLORY>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT159 "The island is a tropical paradise. You decide to treat your crew to a week of rest and relaxation.">

<ROOM STORY159
	(IN ROOMS)
	(DESC "159")
	(STORY TEXT159)
	(EVENTS STORY159-EVENTS)
	(CONTINUE STORY041)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY159-EVENTS ("AUX" ROLL (CONDITION 0))
	<COND (,CURRENT-SHIP <SET CONDITION <GETP ,CURRENT-SHIP ,P?CONDITION>>)>
	<SET ROLL <RANDOM-EVENT 2 <GET-RANK ,CURRENT-CHARACTER> T>>
	<COND (<L=? .ROLL 6>
		<EMPHASIZE "The crew maroons you!">
		<STORY-JUMP ,STORY177>
		<RETURN>
	)(<L=? .ROLL 9>
		<EMPHASIZE "Indiscipline!">
		<DEC .CONDITION>
	)(<L=? .ROLL 11>
		<EMPHASIZE "Invigoration!">
		<INC .CONDITION>
	)(ELSE
		<EMPHASIZE "Inspiration!">
		<SET .CONDITION <+ .CONDITION 2>>
	)>
	<COND (<L? .CONDITION ,CONDITION-POOR> <SET CONDITION ,CONDITION-POOR>)>
	<COND (<G? .CONDITION ,CONDITION-EXCELLENT> <SET CONDITION ,CONDITION-EXCELLENT>)>
	<STORY-RESET-CREW .CONDITION ,CURRENT-SHIP>>

<CONSTANT TEXT160 "All you can do is trust to luck.">

<ROOM STORY160
	(IN ROOMS)
	(DESC "160")
	(STORY TEXT160)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY123 STORY030>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 6 12> <LTABLE "Overcome by thirst" "An island lies ahead">>>)
	(TYPES ONE-RANDOM)
	(CODEWORDS CODEWORD-CALLID)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT161 "Fiddler's Green is an isle of perfect peace and contentment, where brooks gurgle through delightful woodland and there are wide lawns where you can bask all day in the sun.">

<ROOM STORY161
	(IN ROOMS)
	(DESC "161")
	(LOCATION LOCATION-FIDDLER)
	(STORY TEXT161)
	(EVENTS STORY161-EVENTS)
	(CONTINUE STORY125)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY161-EVENTS ()
	<COND (<L? ,STAMINA ,MAX-STAMINA> <SETG STAMINA ,MAX-STAMINA>)>
	<COND (,CURRENT-SHIP
		<COND (<EQUAL? <GETP ,CURRENT-SHIP ,P?CONDITION> ,CONDITION-POOR>
			<PUTP ,CURRENT-SHIP ,P?CONDITION ,CONDITION-AVERAGE>
		)>
	)>>

<CONSTANT TEXT162 "You begin to suffer from stomach cramps followed by bouts of nausea. Perhaps it was those berries you picked?">
<CONSTANT TEXT162-BLESSING "You wake the next morning feeling fine.">

<ROOM STORY162
	(IN ROOMS)
	(DESC "162")
	(STORY TEXT162)
	(EVENTS STORY162-EVENTS)
	(CONTINUE STORY144)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY162-EVENTS ()
	<COND (<CHECK-BLESSING ,BLESSING-IMMUNITY-POISON-DISEASE>
		<DELETE-BLESSING  ,BLESSING-IMMUNITY-POISON-DISEASE>
		<CONTINUE-TEXT ,TEXT162-BLESSING>
		<PREVENT-DOOM ,STORY162>
	)(ELSE
		<LOSE-STAMINA <ROLL-DICE 1> ,DIED-GREW-WEAKER ,STORY162>
	)>>

<CONSTANT TEXT163 "There's no way you can cancel the waterspout with a spell -- not in time to save the crew, anyway. You put them into a deep slumber to buy time, then consider your next course.">
<CONSTANT CHOICES163 <LTABLE "Dive into the sea" "Climb down the side of the ship">>

<ROOM STORY163
	(IN ROOMS)
	(DESC "163")
	(VISITS 0)
	(STORY TEXT163)
	(CHOICES CHOICES163)
	(DESTINATIONS <PLTABLE STORY199 STORY219>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT164 "Sailing away from the Unnumbered Isles after diverse adventures.">
<CONSTANT CHOICES164 <LTABLE "Steer westwards" "Steer north towards the mainland" "Steer south for Ankon-Konu" "Steer east">>

<ROOM STORY164
	(IN ROOMS)
	(DESC "164")
	(LOCATION LOCATION-OCEAN)
	(STORY TEXT164)
	(EVENTS STORY-SET-SAIL)
	(CHOICES CHOICES164)
	(DESTINATIONS <PLTABLE STORY504 STORY402 STORY042 STORY081>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT165 "You are swept away by the current and eventually carried back to the bank. By this time you are bruised and weary and you have got several mouthfuls of foul muddy water.">

<ROOM STORY165
	(IN ROOMS)
	(DESC "165")
	(STORY TEXT165)
	(EVENTS STORY165-EVENTS)
	(CONTINUE STORY044)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY165-EVENTS ()
	<LOSE-STAMINA 2 ,DIED-GREW-WEAKER ,STORY165>
	<COND (<IS-ALIVE>
		<COND (<CHECK-BLESSING ,BLESSING-IMMUNITY-POISON-DISEASE>
			<EMPHASIZE "You did not get sick with malaria.">
			<DELETE-BLESSING ,BLESSING-IMMUNITY-POISON-DISEASE>
		)(ELSE
			<AFFLICTED-WITH ,DISEASE-MALARIA>
		)>
	)>>

<CONSTANT TEXT166 "You seek to shame them by pointing out their shortcomings in comparison with the great and noble deeds of the gods.">

<ROOM STORY166
	(IN ROOMS)
	(DESC "166")
	(STORY TEXT166)
	(CHOICES CHOICES-SANCTITY)
	(DESTINATIONS <PLTABLE <PLTABLE STORY184 STORY073>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-SANCTITY 15>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<ROOM STORY167
	(IN ROOMS)
	(DESC "167")
	(BACKGROUND STORY167-BACKGROUND)
	(FLAGS LIGHTBIT)>

; "TO-DO: Verify if flag needs to be reset on story 185"
<ROUTINE STORY167-BACKGROUND ()
	<COND (,SOLD-PIRATES-HEAD <RETURN ,STORY185>)>
	<RETURN ,STORY044>>

<CONSTANT TEXT168 "Lightning unfolds like vast snapping banners across a sky filled with wind-tossed clouds.">
<CONSTANT TEXT168-CONTINUED "Splinters of lightning fall from the sky and leap along the spars.">

<ROOM STORY168
	(IN ROOMS)
	(DESC "168")
	(STORY TEXT168)
	(EVENTS STORY168-EVENTS)
	(CONTINUE STORY123)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY168-EVENTS ("AUX" ROLL (MODIFIER 0))
	<COND (<CHECK-BLESSING ,BLESSING-SAFETY-FROM-STORMS>
		<DELETE-BLESSING ,BLESSING-SAFETY-FROM-STORMS>
		<STORY-JUMP ,STORY352>
	)(ELSE
		<CONTINUE-TEXT ,TEXT168-CONTINUED>
		<COND (<CHECK-ITEM ,COPPER-ORE> <SET MODIFIER 1>)>
		<SET ROLL <RANDOM-EVENT 2 .MODIFIER T>>
		<COND (<L=? .ROLL 4>
			<EMPHASIZE "The mainmast topples!">
			<STORY-JUMP ,STORY212>
		)(<L=? .ROLL 10>
			<STORY-RESET-CREW ,CONDITION-POOR ,CURRENT-SHIP>
			<EMPHASIZE "Several sailors lost!">
			<STORY-JUMP ,STORY135>
		)(ELSE
			<EMPHASIZE "Struck by lightning!">
		)>
	)>>

<CONSTANT TEXT169 "You put in at the island where you are regarded as a great hero. Seeing your return, fishermen turn their boats back to the quay and call their wives and children to prepare a feast in your honour.">
<CONSTANT CHOICES169 <LTABLE "Go to the market" "Talk to the wise woman" "Rest at home" "Upgrade your crew" "Set sail">>

<ROOM STORY169
	(IN ROOMS)
	(DESC "169")
	(LOCATION LOCATION-VERVAYENS)
	(STORY TEXT169)
	(EVENTS STORY169-EVENTS)
	(CHOICES CHOICES169)
	(DESTINATIONS <PLTABLE STORY318 STORY390 STORY335 STORY349 STORY298>)
	(TYPES FIVE-CHOICES)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY169-EVENTS ()
	<STORY-SET-DOCK  ,DOCK-VERVAYENS ,CURRENT-SHIP>>

<CONSTANT TEXT170 "\"Ah, this is the life!\" you hear the cabin boy telling himself. \"One day I'll be as rich as the captain, and then I'll buy my own ship.\"||You put a hand on his shoulder, startling him out of his reverie. \"In the meantime, lad, you'd better see to your chores,\" you growl at him. \"Else we'll hear the ship's cat purring before the day is done.\"">

<ROOM STORY170
	(IN ROOMS)
	(DESC "170")
	(STORY TEXT170)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY237 STORY188 STORY659>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 5 8 12> <LTABLE "A magical wind" "An uneventful journey" "Murder most foul">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT171 "You estimate your position to be a little way north of the estuary of the Great River that cleaves across Ankon-Konu, separating the western desert and mountains from the thick foetid jungles of the east.||\"What course, captain?\" asks the mate.">
<CONSTANT CHOICES171 <LTABLE "North" "South (The Lone and Level Sands)" "East" "West">>

<ROOM STORY171
	(IN ROOMS)
	(DESC "171")
	(STORY TEXT171)
	(EVENTS STORY-SET-SAIL)
	(CHOICES CHOICES171)
	(DESTINATIONS <PLTABLE STORY244 STORY-LONE-LEVEL-SANDS STORY189 STORY468>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT172 "Three things take no notice of men's lives: Fate, the weather and the tides. Against Fate and storms, man may contend; but the sea's ferocity only Heaven can forfend.">

<ROOM STORY172
	(IN ROOMS)
	(DESC "172")
	(STORY TEXT172)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY629 STORY190 STORY611>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 6 9 12> <LTABLE "Lost cargo" "An uneventful passage" "Yellow plague">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT173 "A windy day with white clouds flying, flung spray and blown spume and the seagulls wheeling overhead -- what more could a ship's captain ask for?">

<ROOM STORY173
	(IN ROOMS)
	(DESC "173")
	(STORY TEXT173)
	(EVENTS STORY173-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY191 STORY325>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 8 12> <LTABLE "A quiet voyage" "Trouble aboard">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY173-EVENTS ()
	<COND (<AND ,RUN-ONCE <L? ,STAMINA ,MAX-STAMINA>> <GAIN-STAMINA 1>)>>

<CONSTANT TEXT174 "Huge guns boom in the black battlefield that the sky has become. The sailors go white with fear. \"It's no mere storm,\" screeches the bosun. \"It's the final battle of the gods! It's Armageddon!\"">

<ROOM STORY174
	(IN ROOMS)
	(DESC "174")
	(VISITS 0)
	(STORY TEXT174)
	(EVENTS STORY174-EVENTS)
	(CHOICES CHOICES-TITANIC-FURY)
	(DESTINATIONS <PLTABLE <PLTABLE STORY212 STORY670 STORY227>>)
	(REQUIREMENTS STORY-STORM-REQUIREMENTS)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY174-EVENTS ()
	<STORM-AT-SEA ,STORY174 ,STORY209>>

<CONSTANT TEXT175 "The avenue between Dweomer and the harbour is a metalled road lined with fanciful statues. Looking inland, you can see the gleam of blue light emanating from a dense wood.">
<CONSTANT CHOICES175 <LTABLE "Head towards the wood" "Go into the city" "Go to the harbour">>

<ROOM STORY175
	(IN ROOMS)
	(DESC "175")
	(LOCATION LOCATION-DWEOMER)
	(STORY TEXT175)
	(CHOICES CHOICES175)
	(DESTINATIONS <PLTABLE STORY697 STORY571 STORY100>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT176 "You emerge from your cabin to find all hands on deck and the ship speeding ahead under a full press of sail. It is with some astonishment that you see another vessel far astern.||\"They're pirates, skipper,\" says the mate. \"Been on our tail since the end of the last watch, but I think we can outrun them.\"||\"I should have been woken up at once!\" you tell him severely.">
<CONSTANT CHOICES176 <LTABLE "Continue to run from the pirates" "Drop sail and turn to face them">>

<ROOM STORY176
	(IN ROOMS)
	(DESC "176")
	(STORY TEXT176)
	(CHOICES CHOICES176)
	(DESTINATIONS <PLTABLE STORY194 STORY214>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT177 "The island appears to have sufficient food and fresh water to sustain you, but it will not be like living in the lap of luxury.">
<CONSTANT CHOICES177 <LTABLE "Try to survive off the land" "Set to work building a raft" "Pray for deliverance">>

<ROOM STORY177
	(IN ROOMS)
	(DESC "177")
	(STORY TEXT177)
	(CHOICES CHOICES177)
	(DESTINATIONS <PLTABLE STORY088 STORY108 STORY126>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT178 "The tunnel winds in a spiral towards the centre of the black island.||\"It must be a fort,\" says one of your crewmen.||\"Not built by human hand,\" says another, pointing to strange lines etched into the walls. They seem to show squat crab-men with many stalk-like eyes striding belligerently across the decks of ships, but it is hard to be sure in the dim light.||A black stone door with an opal panel in the middle blocks the way ahead. To open it you will need a sea-green lens.">
<CONSTANT CHOICES178 <LTABLE "Open the door" "Return the way you came">>

<ROOM STORY178
	(IN ROOMS)
	(DESC "178")
	(STORY TEXT178)
	(EVENTS STORY178-EVENTS)
	(CHOICES CHOICES178)
	(DESTINATIONS <PLTABLE STORY216 STORY196>)
	(REQUIREMENTS <PLTABLE SEA-GREEN-LENS NONE>)
	(TYPES ONE-ITEM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY178-EVENTS ()
	<COND (,RUN-ONCE
		<COND (<NOT <CHECK-PROFESSION ,PROFESSION-MAGE>>
			<COND (<CHECK-ITEM ,CANDLE>
				<REMOVE-ITEM ,CANDLE ,TEXT-USED F T>
			)>
		)>
	)>>

<CONSTANT TEXT179 "With your own eyes you have seen Fiddler's Green -- a myth spoken of by every seaman.">

<ROOM STORY179
	(IN ROOMS)
	(DESC "179")
	(LOCATION LOCATION-FIDDLER)
	(STORY TEXT179)
	(EVENTS STORY179-EVENTS)
	(CONTINUE STORY161)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY179-EVENTS ()
	<COND (<OR <CHECK-PROFESSION ,PROFESSION-MAGE> <CHECK-PROFESSION ,PROFESSION-TROUBADOUR> <CHECK-PROFESSION ,PROFESSION-WAYFARER>>
		<COND (<G? <RANDOM-EVENT 2 0 T> <GET-RANK ,CURRENT-CHARACTER>>
			<GAIN-RANK 1>
			<UPGRADE-STAMINA <ROLL-DICE 1>>
		)>
	)(ELSE
		<EMPHASIZE "The beauty of Fiddler's Green leaves you unmoved.">
	)>>

<CONSTANT TEXT180 "The raft finally breaks apart, but not before it has carried you to a stretch of shoreline. You have no idea where you might be, but at least you have reached the mainland. Or have you?">

<ROOM STORY180
	(IN ROOMS)
	(DESC "180")
	(STORY TEXT180)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY026 STORY505 STORY238 STORY313>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 1 0 <PLTABLE 2 3 5 6> NONE>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT181 "You waste precious minutes fumbling with a spell that is far beyond your ability. Meanwhile, the crew choke silently to death in the rarefied atmosphere. Realizing there is nothing you can do here, you lower yourself from the side and drop down into the sea.">

<ROOM STORY181
	(IN ROOMS)
	(DESC "181")
	(STORY TEXT181)
	(CONTINUE STORY199)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT182 "On the south of the island you find a sheltered bay surrounded by high mist-cloaked crags.||\"This would make a good anchorage, skipper,\" says the first mate.">
<CONSTANT CHOICES182 <LTABLE "Drop anchor here" "Continue around the island to Dweomer" "Sail away from the island">>

<ROOM STORY182
	(IN ROOMS)
	(DESC "182")
	(STORY TEXT182)
	(CHOICES CHOICES182)
	(DESTINATIONS <PLTABLE STORY220 STORY151 STORY122>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT183 "The vessel is listing badly and not worth salvaging, but you send a party across to see if she has any cargo.">

<ROOM STORY183
	(IN ROOMS)
	(DESC "183")
	(VISITS 0)
	(STORY TEXT183)
	(EVENTS STORY183-EVENTS)
	(CONTINUE STORY202)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY183-EVENTS ()
	<COND (<CHECK-VISITS-MORE ,STORY183 1> <STORY-JUMP ,STORY221>)>>

<CONSTANT TEXT184 "They begin to weep bitterly and repent their crime. You are so moved by their renewed pledges of loyalty that you forgive them for stranding you on the island.">

<ROOM STORY184
	(IN ROOMS)
	(DESC "184")
	(STORY TEXT184)
	(EVENTS STORY184-EVENTS)
	(CONTINUE STORY314)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY184-EVENTS ("AUX" SHIP CONDITION)
	<SET SHIP <CHECK-DOCKED ,DOCK-SMOGMAW>>
	<COND (.SHIP
		<CONTINUE-TEXT "They are seasoned seamen, so this increases the crew quality.">
		<SET CONDITION <GETP .SHIP ,P?CONDITION>>
		<COND (<N=? .CONDITION ,CONDITION-EXCELLENT> <INC .CONDITION>)>
		<STORY-RESET-CREW .CONDITION .SHIP>
	)>
	<DELETE-CODEWORD ,CODEWORD-CHURCH>>

<CONSTANT TEXT185 "Half the inhabitants of Smogmaw are pirates or the friends of pirates. No doubt the trophy you just sold was recognized by someone, because as you are walking past a row of shanties you are struck in the neck by a poisoned dart.">

<ROOM STORY185
	(IN ROOMS)
	(DESC "185")
	(STORY TEXT185)
	(EVENTS STORY185-EVENTS)
	(CONTINUE STORY123)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY185-EVENTS ()
	<COND (<CHECK-BLESSING ,BLESSING-IMMUNITY-POISON-DISEASE>
		<DELETE-BLESSING ,BLESSING-IMMUNITY-POISON-DISEASE>
		<STORY-JUMP ,STORY044>
	)(ELSE
		<EMPHASIZE "You can do nothing to save yourself.">
	)>>

<CONSTANT TEXT186 "The catamarans are packed with raiders from the coast of Ankon-Konu. They cannot hope to take your ship, but they will try to leap aboard and carry off a few prisoners.">

<ROOM STORY186
	(IN ROOMS)
	(DESC "186")
	(STORY TEXT186)
	(EVENTS STORY186-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY123 STORY206 STORY352>>)
	(REQUIREMENTS <LTABLE <LTABLE 2 0 <PLTABLE 3 12 100> <LTABLE "An arrow impales your eye" "The raiders retreat at last" "You drive them off with ease">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY186-EVENTS ()
	<COND (<CHECK-PROFESSION ,PROFESSION-WARRIOR>
		<RESET-ODDS 3 0 ,STORY186>
	)(ELSE
		<RESET-ODDS 2 0 ,STORY186>
	)>>

<CONSTANT TEXT187 "The irascible college cook bars your way. \"I don't want any scholars in my kitchen!\" he thunders.||To pacify him you could offer a smoulder fish (if you have one) or else rely on your natural charm.">
<CONSTANT CHOICES187 <LTABLE "Offer a smoulder fish" TEXT-ROLL-CHARISMA>>

<ROOM STORY187
	(IN ROOMS)
	(DESC "187")
	(BACKGROUND STORY187-BACKGROUND)
	(STORY TEXT187)
	(CHOICES CHOICES187)
	(DESTINATIONS <PLTABLE STORY243 <PLTABLE STORY261 STORY279>>)
	(REQUIREMENTS <PLTABLE SMOULDER-FISH <PLTABLE ABILITY-CHARISMA 12>>)
	(TYPES <PLTABLE R-ITEM R-TEST-ABILITY>)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY187-BACKGROUND ()
	<COND (<CHECK-CODEWORD ,CODEWORD-CACOGAST> <RETURN ,STORY225>)>
	<RETURN ,STORY187>>

<CONSTANT TEXT188 "You study your charts, reckoning your position to lie due south of the estuary of the Ruby River. Far to the east on this latitude lies the Island of Fire.">
<CONSTANT CHOICES188 <LTABLE "Steer south" "Go west" "Head north" "Travel east">>

<ROOM STORY188
	(IN ROOMS)
	(DESC "188")
	(STORY TEXT188)
	(CHOICES CHOICES188)
	(DESTINATIONS <PLTABLE STORY370 STORY096 STORY021 STORY208>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT189 "A strong tropical wind strains the sails. \"Best we strike the top-sail,\" says the mate. \"If a storm hits we're in danger of capsizing.\"">

<ROOM STORY189
	(IN ROOMS)
	(DESC "189")
	(STORY TEXT189)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY174 STORY209 STORY106>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 4 8 12> <LTABLE TEXT-STORM "Nothing of note" "Madness">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT190 "Ringed about with desolate shores, the sea keeps up its eternal whisperings. It puts the mate, who is normally an irascible red-faced drunkard, in wistful mood. \"Often when at home,\" he says, \"tiring of laughter and song, I take myself to a deserted bay and listen for the sea-nymphs' flutes that herald the tide.\"||\"You're a poet!\" says the navigator admiringly.||The mate glares at him, jerked back to his usual foul mood. \"There's no call for insults, mister! Look alive -- we need a new course, you swab.\"">
<CONSTANT CHOICES190 <LTABLE "Go east (Lords of the Rising Son)" "Go west" "Go north" "Go south">>

<ROOM STORY190
	(IN ROOMS)
	(DESC "190")
	(VISITS 0)
	(STORY TEXT190)
	(CHOICES CHOICES190)
	(DESTINATIONS <PLTABLE STORY-LORDS-RISING-SUN STORY156 STORY173 STORY337>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT191 "Out of a grey dawn, the tall peaks of an island show like a blood-rimmed saw against the sky. It is Dragon Island.">
<CONSTANT CHOICES191 <LTABLE "Go east to the island (Lords of the Rising Sun)" "Go west" "Go north" "Strike south for open seas">>

<ROOM STORY191
	(IN ROOMS)
	(DESC "191")
	(STORY TEXT191)
	(CHOICES CHOICES191)
	(DESTINATIONS <PLTABLE STORY-LORDS-RISING-SUN STORY210 STORY055 STORY172>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT192 "Starspike Island is a breath-taking sight: from its centre a slender mountain rises straight up into the sky. Its pinnacle is lost far beyond the clouds. \"It's said to be higher than Sky Mountain in Sokara,\" says one of your crewmen.">
<CONSTANT CHOICES192 <LTABLE "Put in at the island" "Sail off">>

<ROOM STORY192
	(IN ROOMS)
	(DESC "192")
	(LOCATION LOCATION-STARSPIKE)
	(STORY TEXT192)
	(CHOICES CHOICES192)
	(DESTINATIONS <PLTABLE STORY704 STORY230>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT193 "The daylight is suddenly blotted out by vast clouds that spread like pools of ink across the sky. Lighting forms an incessant web from horizon to horizon, and the thunder is like being inside a great bronze bell. You bellow orders but they are only lost on the wind. The crew stare all around, limp with fear. Only luck can save you now.">
<CONSTANT CHOICES193 <LTABLE "The storm hits with full force. Rain rattles against the juddering canvas; waves lash the deck.">>

<ROOM STORY193
	(IN ROOMS)
	(DESC "193")
	(STORY TEXT193)
	(EVENTS STORY193-EVENTS)
	(CHOICES CHOICES193)
	(DESTINATIONS <PLTABLE <PLTABLE STORY249 STORY670 STORY081>>)
	(REQUIREMENTS STORY-STORM-REQUIREMENTS)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY193-EVENTS ()
	<STORM-AT-SEA ,STORY193 ,STORY061>>

<ROOM STORY194
	(IN ROOMS)
	(DESC "194")
	(EVENTS STORY194-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY214 STORY061>>)
	(REQUIREMENTS <LTABLE <LTABLE 2 0 <PLTABLE 5 100> <LTABLE "The pirates overtake you" "You outrun them">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY194-EVENTS ("AUX" (MODIFIER 0) (CONDITION 0))
	<SET MODIFIER <GET-RANK ,CURRENT-CHARACTER>>
	<COND (,CURRENT-SHIP
		<SET CONDITION <GETP ,CURRENT-SHIP ,P?CONDITION>>
		<COND (<EQUAL? .CONDITION ,CONDITION-AVERAGE>
			<INC .MODIFIER>
		)(<EQUAL? .CONDITION ,CONDITION-AVERAGE>
			<SET MODIFIER <+ .MODIFIER 2>>
		)(<EQUAL? .CONDITION ,CONDITION-EXCELLENT>
			<SET MODIFIER <+ .MODIFIER 3>>
		)>
	)>
	<RESET-ODDS 2 .MODIFIER ,STORY194>>

<CONSTANT TEXT195 "The creature throws up its bloodless hands, utters a terrible howl, and vanishes like smoke on the wind. The echoes of its final cry are a long time in dying away.||\"Whew!\" says the bosun in a trembling voice. \"Good job we got it before moonrise, or its strength would've doubled.\"">
<CONSTANT CHOICES195 <LTABLE "Explore its lair" "Sail away right now">>

<ROOM STORY195
	(IN ROOMS)
	(DESC "195")
	(STORY TEXT195)
	(CHOICES CHOICES195)
	(DESTINATIONS <PLTABLE STORY215 STORY041>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT196 "You return to the ship and sail away.">

<ROOM STORY196
	(IN ROOMS)
	(DESC "196")
	(STORY TEXT196)
	(EVENTS STORY196-EVENTS)
	(CONTINUE STORY048)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY196-EVENTS ()
	<COND (<CHECK-CODEWORD ,CODEWORD-CALLID>
		<DELETE-CODEWORD ,CODEWORD-CALLID>
		<STORY-JUMP ,STORY717>
	)>>

<CONSTANT TEXT197 "Your master at arms leaps at the stranger, only to end up flat on his back across the deck. The carpenter, a burly tavern brawler, fares no better.||\"Do you send your minions to fight me then?\" roars the stranger. \"I expected better of a ship's captain!\"">
<CONSTANT CHOICES197 <LTABLE "Fight him yourself" "Tell him to calm down">>

<ROOM STORY197
	(IN ROOMS)
	(DESC "197")
	(STORY TEXT197)
	(CHOICES CHOICES197)
	(DESTINATIONS <PLTABLE STORY235 STORY217>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT198 "You are picked up by merchants from Yellowport who come ashore to replenish their supplies. They are amazed to find a human being living here.||\"We are bound for Imperial Chambara, then hope to do some trading in the south,\" they say. \"Would you like to be dropped off anywhere, or will you stay aboard till we get home?\"">
<CONSTANT CHOICES198 <LTABLE "Disembark at Chambara (Lords of the Rising Sun)" "Ask to be dropped off at Smogmaw" "Continue on to Yellowport (The War-Torn Kingdom)">>

<ROOM STORY198
	(IN ROOMS)
	(DESC "198")
	(STORY TEXT198)
	(CHOICES CHOICES198)
	(DESTINATIONS <PLTABLE STORY-LORDS-RISING-SUN STORY044 STORY-WAR-TORN-KINGDOM>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT199 "You strike the water with enough force to knock the wind out of you.">
<CONSTANT TEXT199-CONTINUED "The current steadily carries you away from the waterspout atop which your old ship will float forever in the clouds. You drift for hours until picked up by a warship out of Port Kunrir. \"We'll drop you off at the Faceless King's court,\" says the captain. \"Good. I can arrange passage home from there.\"||He laughs. \"I doubt it! Slaves aren't allowed quite that degree of freedom.\"">

<ROOM STORY199
	(IN ROOMS)
	(DESC "199")
	(STORY TEXT199)
	(EVENTS STORY199-EVENTS)
	(CONTINUE STORY-COURT-HIDDEN-FACES)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY199-EVENTS ()
	<LOSE-STAMINA <RANDOM 3> ,DIED-FROM-INJURIES ,STORY199>
	<CONTINUE-TEXT ,TEXT199-CONTINUED>>

<CONSTANT TEXT200 "\"We're making better headway now,\" announces the mate. \"Let's just hope that we don't run afoul of the weather.\"">

<ROOM STORY200
	(IN ROOMS)
	(DESC "200")
	(STORY TEXT200)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY654 STORY544 STORY311 STORY711>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 3 5 8 12> <LTABLE "Pirates" TEXT-STORM TEXT-UNEVENTFUL "Lights under the waves">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT201 "By dawn you have managed to overhaul two of the pirate ships, but the first presses on relentlessly, steadily gaining on your less manoeuvrable vessel. Pulling alongside, they cast grappling hooks and come swarming aboard.">

<ROOM STORY201
	(IN ROOMS)
	(DESC "201")
	(STORY TEXT201)
	(EVENTS STORY201-EVENTS)
	(CONTINUE STORY307)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY201-EVENTS ("AUX" ROLL (DICE 2) (MODIFIER -2) (CONDITION 0))
	<COND (<CHECK-PROFESSION ,PROFESSION-WARRIOR> <SET DICE 3>)>
	<COND (,CURRENT-SHIP
		<SET CONDITION <GETP ,CURRENT-SHIP ,P?CONDITION>>
		<COND (<EQUAL? .CONDITION ,CONDITION-POOR>
			<SET MODIFIER -2>
		)(<EQUAL? .CONDITION ,CONDITION-AVERAGE>
			<SET MODIFIER 0>
		)(<EQUAL? .CONDITION ,CONDITION-GOOD>
			<SET MODIFIER 2>
		)(ELSE
			<SET MODIFIER 3>
		)>
	)>
	<PREVENT-DOOM ,STORY201>
	<SET ROLL <RANDOM-EVENT .DICE .MODIFIER T>>
	<COND (<L=? .ROLL 3>
		<EMPHASIZE "Calamity! You are killed!">
		<STORY-JUMP ,STORY123>
	)(<L=? .ROLL 8>
		<EMPHASIZE "Crushing defeat!">
		<LOSE-STAMINA <ROLL-DICE 2> ,DIED-FROM-INJURIES ,STORY201>
		<COND (<IS-ALIVE> <STORY-JUMP ,STORY435>)>
	)(<L=? .ROLL 12>
		<EMPHASIZE "Forced to give in!">
		<LOSE-STAMINA <ROLL-DICE 1> ,DIED-FROM-INJURIES ,STORY201>
		<COND (<IS-ALIVE> <STORY-JUMP ,STORY416>)>
	)(<L=? .ROLL 16>
		<EMPHASIZE "The pirates withdraw!">
		<STORY-JUMP ,STORY101>
	)(ELSE
		<EMPHASIZE "Outright victory!">
	)>>

<CONSTANT TEXT202 "The captain's log contains some interesting accounts of his travels across the Great Steppes. You are particularly interested in a detailed description of a tomb he found. \"It is only possible to gain entrance when the gods are not looking,\" the captain has written in his log. \"We were unable to penetrate to the heart of the tomb, but returned to the ship with much booty from the outer chambers.\"">

<ROOM STORY202
	(IN ROOMS)
	(DESC "202")
	(STORY TEXT202)
	(CONTINUE STORY221)
	(CODEWORDS <PLTABLE CODEWORD-CHEOPS>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT203 "The three mutineers leave after a while, each clutching a bottle of strong spirit. You follow them through the maze of boardwalks and low-eaved shacks.">

<ROOM STORY203
	(IN ROOMS)
	(DESC "203")
	(STORY TEXT203)
	(CHOICES CHOICES-SCOUTING)
	(DESTINATIONS <PLTABLE <PLTABLE STORY222 STORY044>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-SCOUTING 14>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT204 "By night you dream of a frightful fiend with flesh the colour of cold clay, only to wake with a shiver and find it was no dream. The fiend holds aside the curtain of your bunk in one taloned hand, leaning forward with black mouth agape. You can smell its seaweed breath; its eyes are like dull pearls in the candlelight.">

<ROOM STORY204
	(IN ROOMS)
	(DESC "204")
	(STORY TEXT204)
	(CHOICES CHOICES-CODEWORD)
	(DESTINATIONS <PLTABLE STORY223 STORY241>)
	(REQUIREMENTS <PLTABLE CODEWORD-CULL NONE>)
	(TYPES ONE-CODEWORD)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT205 "You have entered the waters around the Unnumbered Isles. Somewhere in this reef-strewn archipelago is the stronghold of the Reavers. They rule like barbarian lords over the poor crofters of the isles.">

<ROOM STORY205
	(IN ROOMS)
	(DESC "205")
	(STORY TEXT205)
	(CHOICES CHOICES-CODEWORD)
	(DESTINATIONS <PLTABLE STORY545 STORY563>)
	(REQUIREMENTS <PLTABLE CODEWORD-CHANCE NONE>)
	(TYPES ONE-CODEWORD)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT206 "As the raiders leap back to their catamarans and veer away, it is left to you to count the cost of victory.">

<ROOM STORY206
	(IN ROOMS)
	(DESC "206")
	(STORY TEXT206)
	(EVENTS STORY206-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY352 STORY124 STORY599>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 1 0 <PLTABLE 2 4 6> <LTABLE "The raiders left empty-handed" "They took all your fresh water" "The crew blames your poor leadership">>>)
	(TYPES ONE-RANDOM)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY206-EVENTS ()
	<COND (,RUN-ONCE
		<LOSE-STAMINA <ROLL-DICE 2> ,DIED-FROM-INJURIES ,STORY206>
	)>>

<CONSTANT TEXT207 "The Master's lodgings are in a fine, old, stone house at the back of a lawn just inside the college gates. His lugubrious butler Mantel admits you into a study that smells of old books, pipe smoke and armchair leather.||\"Who's this?\" demands the Master, looking up from his chair.||\"One of the students, I'm afraid, sir,\" says Mantel.">

<ROOM STORY207
	(IN ROOMS)
	(DESC "207")
	(STORY TEXT207)
	(CHOICES CHOICES-CHARISMA)
	(DESTINATIONS <PLTABLE <PLTABLE STORY560 STORY578>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-CHARISMA 14>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT208 "\"See that blue glow along the horizon?\" says the navigator. \"It's the witchlight that flickers over Braelak Isle.\"">

<ROOM STORY208
	(IN ROOMS)
	(DESC "208")
	(STORY TEXT208)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY422 STORY226>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 5 12> <LTABLE "A tempest" "Nothing of note">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT209 "\"Land ahoy!\" shouts the lookout from the crow's nest.||\"That's strange,\" says the navigator, consulting his charts. \"There's no island marked.\"">
<CONSTANT CHOICES209 <LTABLE "Investigate the island" "Sail on">>

<ROOM STORY209
	(IN ROOMS)
	(DESC "209")
	(STORY TEXT209)
	(CHOICES CHOICES209)
	(DESTINATIONS <PLTABLE STORY030 STORY048>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT210 "The deep and dark blue ocean rolls on around your bows, churned by a freshening wind.">

<ROOM STORY210
	(IN ROOMS)
	(DESC "210")
	(STORY TEXT210)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY138 STORY228 STORY619>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 4 8 12> <LTABLE "A flying ship" "Nothing" "An exotic vessel">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT211 "The serpent raises its heavy head and gives vent to a sibilant
snarl. Acid drips from its fangs as it snaps at you.||Lying in the shade has left it quite torpid, so you could easily run off rather than fight it.">

<ROOM STORY211
	(IN ROOMS)
	(DESC "211")
	(VISITS 0)
	(STORY TEXT211)
	(EVENTS STORY211-EVENTS)
	(CONTINUE STORY012)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY211-EVENTS ()
	<CRLF>
	<TELL "Fight the Serpent (COMBAT: 7, DEFENSE: 8, STAMINA: 10)?">
	<COND (<YES?>
		<COMBAT-MONSTER ,MONSTER-SERPENT 7 8 10>
		<CHECK-COMBAT ,MONSTER-SERPENT ,STORY211>
	)(ELSE
		<EMPHASIZE "You run back to the ship.">
		<PREVENT-DOOM ,STORY211>
		<STORY-JUMP ,STORY125>
	)>>

<CONSTANT TEXT212 "The ship cracks open and seawater rushes into the broken shell of the hull. The screams of your crewmen are drowned out by the surge of the waves.">
<CONSTANT TEXT212-WHITE "You are swept mysteriously to a beach of white sand fringed with feathery palms.">

<ROOM STORY212
	(IN ROOMS)
	(DESC "212")
	(STORY TEXT212)
	(EVENTS STORY212-EVENTS)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY212-EVENTS ()
	<STORY-SHIPWRECK ,STORY212 ,STORY123 ,STORY-SERPENT-KINGS-DOMAIN ,TEXT212-WHITE>>

<CONSTANT TEXT213 "The sky turns black and spits lightning. Your crew grow fearful. \"Lay her a-hold!\" cries the bosun in panic. \"Bestir yourselves, lads, or we're done for!\"">
<CONSTANT CHOICES213 <LTABLE "Storm hits with titanic fury, throwing vast fists of water up from the sea to batter your ship's frail timbers.">>

<ROOM STORY213
	(IN ROOMS)
	(DESC "213")
	(STORY TEXT213)
	(EVENTS STORY213-EVENTS)
	(CHOICES CHOICES213)
	(DESTINATIONS <PLTABLE <PLTABLE STORY249 STORY231 STORY246>>)
	(REQUIREMENTS STORY-STORM-REQUIREMENTS)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY213-EVENTS ()
	<STORM-AT-SEA ,STORY213 ,STORY155>>

<CONSTANT TEXT214 "You close with the pirate vessel. At close quarters you see the attackers waiting with drawn swords at the rail. They are an odd mix of tall Uttakin, velvet-coated Golnirans, Sokarans with broad pale faces and savage natives of the Feathered Lands. All are alike in one respect, however: the naked hate that shines from their eyes. As the ships come together, they leap aboard with a wild battle-cry.">

<ROOM STORY214
	(IN ROOMS)
	(DESC "214")
	(STORY TEXT214)
	(EVENTS STORY214-EVENTS)
	(CONTINUE STORY232)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY214-EVENTS ("AUX" ROLL (DICE 2) (MODIFIER -2) (CONDITION 0))
	<COND (<CHECK-PROFESSION ,PROFESSION-WARRIOR> <SET DICE 3>)>
	<COND (,CURRENT-SHIP
		<SET CONDITION <GETP ,CURRENT-SHIP ,P?CONDITION>>
		<COND (<EQUAL? .CONDITION ,CONDITION-POOR>
			<SET MODIFIER -2>
		)(<EQUAL? .CONDITION ,CONDITION-AVERAGE>
			<SET MODIFIER 0>
		)(<EQUAL? .CONDITION ,CONDITION-GOOD>
			<SET MODIFIER 2>
		)(ELSE
			<SET MODIFIER 3>
		)>
	)>
	<PREVENT-DOOM ,STORY214>
	<SET ROLL <RANDOM-EVENT .DICE .MODIFIER T>>
	<COND (<L=? .ROLL 3>
		<EMPHASIZE "Calamity! You are killed!">
		<STORY-JUMP ,STORY123>
	)(<L=? .ROLL 8>
		<EMPHASIZE "Crushing defeat!">
		<LOSE-STAMINA <ROLL-DICE 2> ,DIED-FROM-INJURIES ,STORY214>
		<COND (<IS-ALIVE> <STORY-JUMP ,STORY140>)>
	)(<L=? .ROLL 12>
		<EMPHASIZE "Forced to give in!">
		<LOSE-STAMINA <ROLL-DICE 1> ,DIED-FROM-INJURIES ,STORY214>
		<COND (<IS-ALIVE> <STORY-JUMP ,STORY250>)>
	)(<L=? .ROLL 16>
		<EMPHASIZE "The pirates withdraw!">
		<STORY-JUMP ,STORY245>
	)(ELSE
		<EMPHASIZE "Outright victory!">
	)>>

<CONSTANT TEXT215 "Inside the cave is a stone sarcophagus that smells of brimstone and ammonia. Strewn around it, spotted with bat droppings and gobbets of rancid gristle, are piles of gold plate, coin and jewellery. Rubies sparkle like drops of black blood in the rays of the rising moon. Emeralds gleam like myriad cats' eyes. Sapphires are strewn about like crystalline petals.||The total value of the haul is 6000 Shards.">

<ROOM STORY215
	(IN ROOMS)
	(DESC "215")
	(STORY TEXT215)
	(EVENTS STORY215-EVENTS)
	(CONTINUE STORY041)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY215-EVENTS ()
	<GAIN-MONEY 6000>>

<CONSTANT TEXT216 "You present the sea-green lens to the door panel and it slides up. Beyond is a circular courtyard open to the sky with a marble fountain in the middle.||\"Blow me if we aren't smack in the bloomin' middle of the place!\" says the master at arms.">

<ROOM STORY216
	(IN ROOMS)
	(DESC "216")
	(VISITS 0)
	(STORY TEXT216)
	(EVENTS STORY216-EVENTS)
	(CONTINUE STORY270)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY216-EVENTS ()
	<COND (<CHECK-VISITS-MORE ,STORY216 1> <STORY-JUMP ,STORY252>)>>

<CONSTANT TEXT217 "\"Your talk of peace insults me!\" rages the bare-chested stranger. His fist lashes out, giving you such a strong buffet in the face that your knees buckle and blackness drops over you like a great wave. By the time your crew can bring you round, the stranger has sailed off in his boat.">

<ROOM STORY217
	(IN ROOMS)
	(DESC "217")
	(STORY TEXT217)
	(EVENTS STORY217-EVENTS)
	(CONTINUE STORY125)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY217-EVENTS ()
	<DEC ,MAX-STAMINA>
	<COND (<G? ,STAMINA ,MAX-STAMINA> <SETG STAMINA ,MAX-STAMINA>)>
	<UPDATE-STATUS-LINE>>

<CONSTANT TEXT218 "Pirates find you when they come ashore to bury some treasure. Their captain fondles your hair and smirks.||\"Young and healthy enough,\" he says. \"You're bound for the slave pens, my friend, unless you can muster a ransom of 150 Shards.\"">
<CONSTANT CHOICES218 <LTABLE "Agree to the ransom (Cities of Gold and Glory)" "Can't or won't pay">>

<ROOM STORY218
	(IN ROOMS)
	(DESC "218")
	(STORY TEXT218)
	(CHOICES CHOICES218)
	(DESTINATIONS <PLTABLE STORY-CITIES-GOLD-GLORY STORY472>)
	(REQUIREMENTS <PLTABLE 150 NONE>)
	(TYPES ONE-MONEY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT219 "Dangling on a long rope usually used for keelhauling, you manage to get down to the top of the waterspout. From there you swim down to the sea bed, where you discover a rusty wheel beside a wide vent. Could this be the source of the waterspout?||With the last breath in your lungs, you turn the wheel until the vent closes and the torrent of water is cut off. Then you bob back to the surface to find your ship drifting safely on the waves once more. Your crew gratefully hauls you aboard with loud cheers.||\"A strange experience,\" you say to the first mate.||He waves his hand to make light of the matter. \"Oh, a seafarer sees many strange things. Let me tell you about the time...\"||And so you sail on.">

<ROOM STORY219
	(IN ROOMS)
	(DESC "219")
	(LOCATION LOCATION-OCEAN)
	(STORY TEXT219)
	(CONTINUE STORY039)
	(FLAGS LIGHTBIT)>

<ROOM STORY220
	(IN ROOMS)
	(DESC "220")
	(BACKGROUND STORY220-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY220-BACKGROUND ()
	<STORY-SET-DOCK ,DOCK-SORCERERS ,CURRENT-SHIP>
	<RETURN ,STORY407>>

<CONSTANT TEXT221 "The first mate reports finding no sign of life aboard the ship. \"Looks like she was abandoned all of a sudden, captain,\" he says. \"We found a couple of things you might want.\"">

<ROOM STORY221
	(IN ROOMS)
	(DESC "221")
	(STORY TEXT221)
	(EVENTS STORY221-EVENTS)
	(CONTINUE STORY118)
	(ITEMS <PLTABLE MARINERS-RUTTIER SMOULDER-FISH>)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY221-EVENTS ()
	<STORY-GAIN-CARGO ,CARGO-SPICES 1>>

<CONSTANT TEXT222 "The three of them live in a house that stands on short wooden posts above a tract of mud on the southern fringe of town. You watch them slump in the doorway, where the jutting porch of interleaved pandanus shields them from the sun. The air is filled with gnats and the stench of rotting river weeds.||You can round up some friends to help you exact your revenge. Otherwise you must deal with the mutineers yourself.">
<CONSTANT CHOICES222 <LTABLE HAVE-CODEWORD "Muster some friends" "Attack the three on your own" "Wait till they're asleep" "Forget about them">>

<ROOM STORY222
	(IN ROOMS)
	(DESC "222")
	(STORY TEXT222)
	(CHOICES CHOICES222)
	(DESTINATIONS <PLTABLE STORY240 STORY240 STORY073 STORY148 STORY044>)
	(REQUIREMENTS <PLTABLE CODEWORD-AID DOCK-SMOGMAW NONE NONE NONE>)
	(TYPES <PLTABLE R-CODEWORD R-DOCKED R-NONE R-NONE R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT223 "\"You have not done as I asked,\" whispers the fiend in a voice of dreadful intimacy.||You try to cry out, to call the men on watch to your aid. But the fiend touches your lips with an icy finger. \"Hush,\" it says. \"No need to bother them with our business.\" With the other hand it reaches out and extinguishes the nightlight.">

<ROOM STORY223
	(IN ROOMS)
	(DESC "223")
	(STORY TEXT223)
	(CONTINUE STORY123)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT224 "The ship is the Ichabod, a barque with fading paintwork and weathered timbers. Three days out from Smogmaw she runs into heavy weather.">

<ROOM STORY224
	(IN ROOMS)
	(DESC "224")
	(STORY TEXT224)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY-WAR-TORN-KINGDOM STORY099>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 1 0 <PLTABLE 4 6> <LTABLE "Arrive at Yellowport as planned" "The Ichabod is forced to lay up at Copper Island for repairs">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT225 "Woe betide any scholar to whom the cook has taken a dislike. You are fed a bowl of hot stew which you consume with gusto, but later that evening you suffer stomach pains and are up until dawn retching into a bucket.">

<ROOM STORY225
	(IN ROOMS)
	(DESC "225")
	(STORY TEXT225)
	(EVENTS STORY225-EVENTS)
	(CONTINUE STORY607)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY225-EVENTS ()
	<LOSE-STAMINA <ROLL-DICE 1> ,DIED-GREW-WEAKER ,STORY225>>

<CONSTANT TEXT226 "You are roughly twenty leagues due north of the Sleeping Isle. The helmsman awaits your orders.">
<CONSTANT CHOICES226 <LTABLE "Go east" "Go west" "Go north" "Go south">>

<ROOM STORY226
	(IN ROOMS)
	(DESC "226")
	(STORY TEXT226)
	(CHOICES CHOICES226)
	(DESTINATIONS <PLTABLE STORY009 STORY170 STORY129 STORY281>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT227 "Closing your eyes, you lean back against the mask and enjoy the rise and plunge of the ship as she steers on through warm tropical seas.">

<ROOM STORY227
	(IN ROOMS)
	(DESC "227")
	(STORY TEXT227)
	(EVENTS STORY227-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY248 STORY245 STORY515 STORY176>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 4 7 9 12> <LTABLE TEXT-STORM "Nothing of note" "A castaway" "Pirates">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY227-EVENTS ()
	<COND (<AND ,RUN-ONCE <L? ,STAMINA ,MAX-STAMINA>> <GAIN-STAMINA 1>)>>

<CONSTANT TEXT228 "You are roughly midway between the Isle of Fire and Dragon Island. What course will you tell your men to steer?">
<CONSTANT CHOICES228 <LTABLE "North" "South" "East" "West">>

<ROOM STORY228
	(IN ROOMS)
	(DESC "228")
	(STORY TEXT228)
	(CHOICES CHOICES228)
	(DESTINATIONS <PLTABLE STORY055 STORY172 STORY173 STORY246>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT229 "You give a faltering tongue-tied apology that softens the men's wrath but leaves them openly contemptuous. The first mate, Fryer, takes command and you are set ashore on a deserted island to fend for yourself.||Your ship and cargo are lost forever. Your main problem now is just staying alive.">

<ROOM STORY229
	(IN ROOMS)
	(DESC "229")
	(STORY TEXT229)
	(EVENTS STORY229-EVENTS)
	(CONTINUE STORY177)
	(CODEWORDS <PLTABLE CODEWORD-CHURCH>)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY229-EVENTS ()
	<STORY-LOSE-SHIP>>

<CONSTANT TEXT230 "You set a new course, and eventually even the lofty pinnacle of Starspike Island drops below the horizon.">
<CONSTANT CHOICES230 <LTABLE "Go north" "Go south" "Go east" "Go west">>

<ROOM STORY230
	(IN ROOMS)
	(DESC "230")
	(LOCATION LOCATION-OCEAN)
	(STORY TEXT230)
	(CHOICES CHOICES230)
	(DESTINATIONS <PLTABLE STORY156 STORY337 STORY172 STORY302>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT231 "The ship is swept far out to sea. Men and goods are washed overboard by huge waves that snap your hawsers like twine.||At last the storm blows itself out. You are left drifting in unknown waters.">

<ROOM STORY231
	(IN ROOMS)
	(DESC "231")
	(STORY TEXT231)
	(EVENTS STORY231-EVENTS)
	(CONTINUE STORY321)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY231-EVENTS ("AUX" CONDITION)
	<COND (,CURRENT-SHIP
		<SET CONDITION <GETP ,CURRENT-SHIP ,P?CONDITION>>
		<COND (<G? .CONDITION ,CONDITION-POOR> <DEC .CONDITION>)>
		<PUTP ,CURRENT-SHIP ,P?CONDITION .CONDITION>
	)>
	<STORY-LOSE-CARGO 1>>

<CONSTANT TEXT232 "You help yourself to the pirates' treasure, which amounts to 250 Shards.||Their ship's hold contains 2 Cargo Units of spices, which you can add to your own cargo if your ship has enough room for them.">

<ROOM STORY232
	(IN ROOMS)
	(DESC "232")
	(STORY TEXT232)
	(EVENTS STORY232-EVENTS)
	(CONTINUE STORY245)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY232-EVENTS ("AUX" CAPACITY COUNT NUMBER)
	<GAIN-MONEY 250>
	<COND (,CURRENT-SHIP
		<SET COUNT <COUNT-CONTAINER ,CARGO>>
		<SET CAPACITY <GETP ,CURRENT-SHIP ,P?CAPACITY>>
		<COND (<G? .NUMBER 0>
			<COND (<G? .NUMBER 2> <SET NUMBER 2>)>
			<CRLF>
			<TELL "Take " N .NUMBER " cargo units of spices?">
			<COND (<YES?>
				<STORY-GAIN-CARGO ,CARGO-SPICES .NUMBER>
			)>
		)>
	)>>

<CONSTANT TEXT233 "You are face to face with Amcha One-Eye, the bane of honest merchants throughout the northern lands. If you imagined that he would wear an eye-patch you were mistaken. His sightless eye is kept openly displayed, an unblinking white orb that strikes terror into the hearts of all who must confront him.">

<ROOM STORY233
	(IN ROOMS)
	(DESC "233")
	(STORY TEXT233)
	(CHOICES CHOICES-HAVE-NOT)
	(DESTINATIONS <PLTABLE STORY493 STORY400>)
	(REQUIREMENTS <PLTABLE PIRATE-CAPTAINS-HEAD NONE>)
	(TYPES ONE-ITEM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT234 "A figure composed of glittering green light appears in the air in front of you. Your crewmen fall on their faces in abject fear. You are not so easily cowed, but none the less you make a respectful bow.||\"I recognize you as a worshipper of the Lord and Lady of the Sea,\" says the spectral figure. \"One boon shall I grant you. Choose whether it is life, strength or ease that is your heart's desire.\"">
<CONSTANT CHOICES234 <LTABLE "Choose life" "Choose strength" "Choose ease">>

<ROOM STORY234
	(IN ROOMS)
	(DESC "234")
	(STORY TEXT234)
	(CHOICES CHOICES234)
	(DESTINATIONS <PLTABLE STORY289 STORY309 STORY327>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT235 "\"Good!\" he bellows. \"Good! Yes, by the two gods who rule below -- I'll grapple with you.\"||He stamps the deck with such exuberant ferocity that even the bravest of your men go scurrying for cover.">

<ROOM STORY235
	(IN ROOMS)
	(DESC "235")
	(STORY TEXT235)
	(CHOICES CHOICES-COMBAT)
	(DESTINATIONS <PLTABLE <PLTABLE STORY271 STORY253>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-COMBAT 13>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT236 "Witches come bouncing out across the waves, demonstrating their contempt of nature's laws by riding in worm-eaten coracles that are as leaky as sieves.||\"Blow winds and crack your cheeks!\" they cry, adding an obscene laugh that causes disgust and horror in equal doses.||\"They'll curse us to the ocean deeps,\" moans the bosun in abject fear. \"Do something, captain!\"">

<ROOM STORY236
	(IN ROOMS)
	(DESC "236")
	(STORY TEXT236)
	(CHOICES CHOICES-MAGIC)
	(DESTINATIONS <PLTABLE <PLTABLE STORY254 STORY272>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-MAGIC 15>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT237 "A wind of frightening intensity blows up out of nowhere. \"This weather cannot be natural!\" says the bosun with a shiver.||You round on him. \"You always say that, mister. Where's your evidence?\"||He points all around. \"The sheets of green lightning beyond the clouds. The thick sulphurous dust in the air. The presence of frogs and other unexplained debris in the water all around us.\"||You give a snort. \"Fair enough.\"">
<CONSTANT CHOICES237 <LTABLE "Cancel the supernatural wind">>

<ROOM STORY237
	(IN ROOMS)
	(DESC "237")
	(STORY TEXT237)
	(CHOICES CHOICES237)
	(DESTINATIONS <PLTABLE <PLTABLE STORY188 STORY255>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-MAGIC 15>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT238 "You are washed up on a narrow beach at the back of a bay surrounded by high mist-shrouded peaks. After resting to recover your strength, you pick your way up a series of steep paths until you can get a clear view of the island. To the north lies an expanse of glittering blue forest, so there can be no question where you are -- Braelak, the Sorcerers' Isle. Nearer at hand is a tower built of obsidian blocks.">
<CONSTANT CHOICES238 <LTABLE "Enter the forest" "Go to the tower">>

<ROOM STORY238
	(IN ROOMS)
	(DESC "238")
	(STORY TEXT238)
	(CHOICES CHOICES238)
	(DESTINATIONS <PLTABLE STORY697 STORY426>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT239 "A flock of migrating birds alights to cover every inch of deck, masts and spars. Their plumage is a striking mixture of ebony, scarlet, and metallic green.||\"Queer sort of birds,\" remarks the mate. \"Got almost a wise look to them, wouldn't you say?\"">

<ROOM STORY239
	(IN ROOMS)
	(DESC "239")
	(STORY TEXT239)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <TABLE STORY257 STORY275>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 2 12> NONE>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT240 "With the help of a few strong men you have no trouble settling your score with the three mutineers. It is up to your own conscience what you do with them, but you can rest assured that you will never see them again.">

<ROOM STORY240
	(IN ROOMS)
	(DESC "240")
	(STORY TEXT240)
	(EVENTS STORY240-EVENTS)
	(CONTINUE STORY044)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY240-EVENTS ()
	<DELETE-CODEWORD ,CODEWORD-CHURCH>>

<CONSTANT TEXT241 "\"Pay heed to what I say,\" whispers the fiend in gravid tones. \"Go north to a certain fane that is upon the steppes, and there tell the four winds that Tayang Khan was foully slain at sea.\"||You try twice to find your voice, finally managing to gasp out: \"What if they already know that?\"||But the fiend seems not to understand. It speaks like a sleepwalker, repeating its words until they fade into incoherence. You watch it go as the candle burns down, and your rigid terror gradually gives way to fatigue. In the morning you are hardly sure it happened at all.">

<ROOM STORY241
	(IN ROOMS)
	(DESC "241")
	(STORY TEXT241)
	(CONTINUE STORY022)
	(CODEWORDS <PLTABLE CODEWORD-CULL>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT242 "\"Will we have any trouble reaching Dweomer?\" you ask the skipper of the Taradiddle.||\"Not in this beauty,\" he says proudly. \"Her mast's of prime bluewood, and she always finds her way home.\"||He is right; the voyage is blissfully uneventful.">

<ROOM STORY242
	(IN ROOMS)
	(DESC "242")
	(STORY TEXT242)
	(CONTINUE STORY100)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT243 "The cook is delighted. The fish is rated a great delicacy by the dons of Dweomer. You are rewarded with 200 Shards.">

<ROOM STORY243
	(IN ROOMS)
	(DESC "243")
	(STORY TEXT243)
	(EVENTS STORY243-EVENTS)
	(CONTINUE STORY607)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY243-EVENTS ()
	<GAIN-MONEY 200>
	<GIVE-ITEM ,SMOULDER-FISH T>>

<CONSTANT TEXT244 "\"Can you taste it on the breeze, shipmates?\" you ask the crew.||\"Taste what, captain? The scent of brine?\" asks the mate.||\"No, not brine; it's the smell of sorcery. Braelak is just over the horizon.\"">

<ROOM STORY244
	(IN ROOMS)
	(DESC "244")
	(STORY TEXT244)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY460 STORY262 STORY441>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 4 7 12> <LTABLE "A shooting star" "A quiet day's sailing" "Attacked by night">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT245 "With the navigator's spyglass you survey the tree-fringed cliffs and blazing coral beaches of Ankon-Konu. To the north across leagues of open ocean is Old Sokar, now renamed Marlock City since a coup in Sokara brought General Grieve Marlock to power.">
<CONSTANT CHOICES245 <LTABLE "Go north" "Go south (The Serpent King's Domain)" "Go east" "Go west">>

<ROOM STORY245
	(IN ROOMS)
	(DESC "245")
	(STORY TEXT245)
	(CHOICES CHOICES245)
	(DESTINATIONS <PLTABLE STORY042 STORY-SERPENT-KINGS-DOMAIN STORY263 STORY189>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT246 "The days are fair and sunny, the nights star-brimmed. Your ship skips like a cloud across waves the colour of ink.">

<ROOM STORY246
	(IN ROOMS)
	(DESC "246")
	(STORY TEXT246)
	(EVENTS STORY246-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY665 STORY264 STORY569>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 5 8 12> <LTABLE "A vision in moonlight" "A quiet day's sailing" "Traders from Mithdrak">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY246-EVENTS ()
	<COND (<AND ,RUN-ONCE <L? ,STAMINA ,MAX-STAMINA>> <GAIN-STAMINA 1>)>>

<CONSTANT TEXT247 "You find a book that contains so many terrifying stories that you doubt if you'll ever sleep soundly again. It leaves you so scared that you have to wait for the librarian to come looking for you.||\"Great tomes of fear!\" he declares. \"Your hair has turned white.\"">

<ROOM STORY247
	(IN ROOMS)
	(DESC "247")
	(STORY TEXT247)
	(EVENTS STORY247-EVENTS)
	(CONTINUE STORY368)
	(CODEWORDS <PLTABLE CODEWORD-CHILL>)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY247-EVENTS ()
	<LOSE-ABILITY ,ABILITY-CHARISMA 1>>

<CONSTANT TEXT248 "The sky turns black and spits lightning. Your crewmen grow fearful.||\"Lay her a-hold!\" cries the bosun in panic. \"Bestir yourselves, lads, or we're done for!\"">
<CONSTANT CHOICES248 <LTABLE "The storm hits with titanic fury, throwing vast fists of water up from the sea to batter your ship's frail timbers.">>

<ROOM STORY248
	(IN ROOMS)
	(DESC "248")
	(STORY TEXT248)
	(EVENTS STORY248-EVENTS)
	(CHOICES CHOICES248)
	(DESTINATIONS <PLTABLE <PLTABLE STORY212 STORY670 STORY263>>)
	(REQUIREMENTS STORY-STORM-REQUIREMENTS)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY248-EVENTS ()
	<STORM-AT-SEA ,STORY248 ,STORY245>>

<CONSTANT TEXT249 "The hull breaks into splinters and seawater gushes into the hold. Shuddering like a wounded beast, the ship begins to sink. The terrified cries of your crewmen are lost in the crash of the waves closing over your head. Your ship and crew are lost. You can think of nothing now but saving yourself.">
<CONSTANT TEXT249-GRIM "You are swept miraculously towards a grim surf-lashed shore ringed with jagged reefs.">

<ROOM STORY249
	(IN ROOMS)
	(DESC "249")
	(STORY TEXT249)
	(EVENTS STORY249-EVENTS)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY249-EVENTS ()
	<STORY-SHIPWRECK ,STORY249 ,STORY123 ,STORY313 ,TEXT249-GRIM>>

<CONSTANT TEXT250 "The pirates take your cargo, all your possessions and your cash. They also seize your ship for themselves.||At least they decide to spare your life -- probably in the hope that you'll earn enough to buy another ship so they can rob you again.||You are put off in Smogmaw.">

<ROOM STORY250
	(IN ROOMS)
	(DESC "250")
	(STORY TEXT250)
	(EVENTS STORY250-EVENTS)
	(CONTINUE STORY044)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY250-EVENTS ()
	<STORY-LOSE-EVERYTHING F>
	<STORY-LOSE-SHIP>>

<CONSTANT TEXT251 "Several sailors grab the stranger and bring him over to you. You ply him with questions, but he has gone limp and begun to gasp for breath. He dies as quickly as a man might drown at six fathoms.||\"What now, skipper?\" says the first mate in an awestruck voice. \"Shall we cut the cable and let their ship go drifting off?\"">
<CONSTANT CHOICES251 <LTABLE "Cut the flying ship's cable" "Take a party of seamen aloft">>

<ROOM STORY251
	(IN ROOMS)
	(DESC "251")
	(STORY TEXT251)
	(CHOICES CHOICES251)
	(DESTINATIONS <PLTABLE STORY228 STORY269>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT252 "Your crewmen take the opportunity to collect some barrels of fresh water from the fountain.||There is nothing else of interest here, so you return to the ship.">

<ROOM STORY252
	(IN ROOMS)
	(DESC "252")
	(STORY TEXT252)
	(EVENTS STORY252-EVENTS)
	(CONTINUE STORY196)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY252-EVENTS ()
	<DELETE-CODEWORD ,CODEWORD-CALLID>>

<CONSTANT TEXT253 "The stranger grabs hold of you, hefts you into the air, and flings you down. You hit the deck with such force that it makes your teeth rattle.">
<CONSTANT CHOICES253 <LTABLE "Grapple your foe" "Tell him there's no need to fight">>

<ROOM STORY253
	(IN ROOMS)
	(DESC "253")
	(STORY TEXT253)
	(EVENTS STORY253-EVENTS)
	(CHOICES CHOICES253)
	(DESTINATIONS <PLTABLE STORY235 STORY217>)
	(TYPES TWO-CHOICES)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY253-EVENTS ()
	<COND (,RUN-ONCE <LOSE-STAMINA <ROLL-DICE 6> ,DIED-IN-COMBAT ,STORY253>)>>

<CONSTANT TEXT254 "You confound the witches by cancelling the spell that keeps their coracles afloat. Your crewmen laugh in relief as they watch the flotilla of vile women sink below the surging grey swell.||The leader of the coven manages to hold her head above water long enough to plead for you to haul her out.">
<CONSTANT CHOICES254 <LTABLE "Drop her a line" "Let her drown">>

<ROOM STORY254
	(IN ROOMS)
	(DESC "254")
	(STORY TEXT254)
	(CHOICES CHOICES254)
	(DESTINATIONS <PLTABLE STORY291 STORY039>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT255 "The wind does not abate for several hours. Somehow you have the uneasy feeling that it has blow you a quite unconscionable distance in that time.||After consulting the stars and his charts, the navigator makes a guess at your current position.">

<ROOM STORY255
	(IN ROOMS)
	(DESC "255")
	(STORY TEXT255)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY228 STORY320 STORY118 STORY648 STORY322 STORY283 STORY352>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 3 4 6 7 9 10 12> NONE>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT256 "The priestess gets to her feet. \"The goddesses have looked on you with favour,\" she says. \"Their breath has filled your sails, their hands sheltered your back, guiding you safely here.\"">
<CONSTANT CHOICES256 <LTABLE "Seek a blessing from the goddesses" "Renounce their worship" "Leave the temple">>

<ROOM STORY256
	(IN ROOMS)
	(DESC "256")
	(STORY TEXT256)
	(CHOICES CHOICES256)
	(DESTINATIONS <PLTABLE STORY293 STORY330 STORY044>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT257 "There are so many birds that, when they rise again into the air, their wings all but blot out the sun. At the same time you feel a strange enchantment creeping over you. But is it harmful, or beneficial?">
<CONSTANT CHOICES257 <LTABLE "Resist the enchantment" "Don't try">>

<ROOM STORY257
	(IN ROOMS)
	(DESC "257")
	(STORY TEXT257)
	(CHOICES CHOICES257)
	(DESTINATIONS <PLTABLE <PLTABLE STORY171 STORY294> STORY294>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-MAGIC 15> NONE>)
	(TYPES <PLTABLE R-TEST-ABILITY R-NONE>)
	(FLAGS LIGHTBIT)>

<ROOM STORY258
	(IN ROOMS)
	(DESC "258")
	(BACKGROUND STORY258-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY258-BACKGROUND ()
	<COND (<CHECK-CODEWORD ,CODEWORD-AID> <RETURN ,STORY276>)>
	<RETURN ,STORY295>>

<CONSTANT TEXT259 "It is easy to pick out Glimbinki's shrine, a tall teepee of interlaced feathers supported by a central totem of hard red wood surmounted by a giant carved beak.">

<ROOM STORY259
	(IN ROOMS)
	(DESC "259")
	(STORY TEXT259)
	(CHOICES CHOICES-CODEWORD)
	(DESTINATIONS <PLTABLE STORY277 STORY296>)
	(REQUIREMENTS <PLTABLE CODEWORD-CUSHAT NONE>)
	(TYPES ONE-CODEWORD)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT260-VILLAIN "The captain is a villain. He takes all your money and maroons you!">
<CONSTANT TEXT260-METRICIENS "You reach Metriciens without incident.">

<ROOM STORY260
	(IN ROOMS)
	(DESC "260")
	(EVENTS STORY260-EVENTS)
	(CONTINUE STORY-CITIES-GOLD-GLORY)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY260-EVENTS ("AUX" ROLL)
	<SET ROLL <RANDOM-EVENT 1 0 T>>
	<COND (<L=? .ROLL 2>
		<SETG MONEY 0>
		<EMPHASIZE ,TEXT260-VILLAIN>
		<STORY-JUMP ,STORY177>
		<UPDATE-STATUS-LINE>
	)(ELSE
		<EMPHASIZE ,TEXT260-METRICIENS>
	)>>

<CONSTANT TEXT261 "The cook relents and lets you sit in a corner of the kitchen. The other scholars are impressed that you managed to charm even the bad-tempered cook, and your reputation soars.">

<ROOM STORY261
	(IN ROOMS)
	(DESC "261")
	(STORY TEXT261)
	(EVENTS STORY261-EVENTS)
	(CONTINUE STORY607)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY261-EVENTS ()
	<COND (<G? <RANDOM-EVENT 1 0 T> <GET-ABILITY-SCORE ,CURRENT-CHARACTER ,ABILITY-CHARISMA>>
		<UPGRADE-ABILITY ,ABILITY-CHARISMA 1>
	)>>

<CONSTANT TEXT262 "To the north lies Braelak, island of sorcerers. Far to the south are the marsh-enclosed ruins of old Tarshesh. Westwards there are the priests of Innis; pirates lurk in the east. Where now?">
<CONSTANT CHOICES262 <LTABLE "Head north" "Head south" "Head east" "Head west">>

<ROOM STORY262
	(IN ROOMS)
	(DESC "262")
	(STORY TEXT262)
	(CHOICES CHOICES262)
	(DESTINATIONS <PLTABLE STORY009 STORY153 STORY630 STORY281>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT263 "An offshore wind brings the scent of strange blossoms, dead vegetation and the stink of malarial swamps.||\"The Weeping Jungle,\" declares the mate gloomily. \"My brother lost his life in that pest-infested wilderness.\"||The quartermaster expresses a sceptical view: \"I heard your brother died in a tavern brawl in Ringhorn.\"||\"Bah!\" The mate stamps off to his cabin. You begin to worry about the crew's morale.">

<ROOM STORY263
	(IN ROOMS)
	(DESC "263")
	(STORY TEXT263)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY612 STORY282 STORY176 STORY483>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 4 8 10 12> <LTABLE "Mutiny!" "A quiet voyage" "Pirates" "Divine intervention?">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT264 "Daybreak casts a net of mist across the water, blurring the horizon. It seems as though you are suspended in an infinite white void.">
<CONSTANT CHOICES264 <LTABLE "Steer north" "Go south" "Travel east" "Head west">>

<ROOM STORY264
	(IN ROOMS)
	(DESC "264")
	(STORY TEXT264)
	(CHOICES CHOICES264)
	(DESTINATIONS <PLTABLE STORY066 STORY156 STORY210 STORY119>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT265 "You can take the crewmen exploring with you or leave them here to gather supplies.">
<CONSTANT TEXT265-CONTINUED "You stroll through light woodland and emerge on a level plain. The grass is as neatly mowned as a lawn. Bees hum drowsily between the flowers. A paved avenue, lined on either side by stone slabs, stretches off across the plain towards grey cliffs in the distance.">
<CONSTANT CHOICES265 <LTABLE "Go on" "Turn back">>

<ROOM STORY265
	(IN ROOMS)
	(DESC "265")
	(STORY TEXT265)
	(EVENTS STORY265-EVENTS)
	(CHOICES CHOICES265)
	(DESTINATIONS <PLTABLE STORY043 STORY005>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY265-EVENTS ()
	<COND (,RUN-ONCE
		<CRLF>
		<TELL "Take the crewmen with you as you explore?">
		<COND (<YES?> <GAIN-CODEWORD ,CODEWORD-COSY>)>
	)>>

<ROOM STORY266
	(IN ROOMS)
	(DESC "266")
	(BACKGROUND STORY266-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY266-BACKGROUND ()
	<STORY-SET-DOCK ,DOCK-SMOGMAW ,CURRENT-SHIP>
	<RETURN ,STORY044>>

<CONSTANT TEXT267 "You help yourself to the pirates' treasure, which amounts to 400 Shards. Their ship's hold contains 1 Cargo Unit of spices, which you can add to your own cargo if your ship has room for it.||Your mate is for taking the pirate captain's head as a gory trophy of your victory.">
<CONSTANT TEXT267-LEADERSHIP "You've gained a rank after your stirring leadership in battle.">

<ROOM STORY267
	(IN ROOMS)
	(DESC "267")
	(STORY TEXT267)
	(EVENTS STORY267-EVENTS)
	(CONTINUE STORY101)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY267-EVENTS ()
	<GAIN-MONEY 400>
	<STORY-GAIN-CARGO ,CARGO-SPICES 1>
	<KEEP-ITEM ,PIRATE-CAPTAINS-HEAD>
	<COND (<G? <RANDOM-EVENT 2 0 T> <GETP ,CURRENT-CHARACTER ,P?RANK>>
		<CONTINUE-TEXT ,TEXT267-LEADERSHIP>
		<GAIN-RANK 1>
		<UPGRADE-STAMINA <ROLL-DICE 1>>
	)>>

<CONSTANT TEXT268 "The first mate comes running to your cabin in the small hours of the morning. \"Pirates, cap'n!\" he gasps. \"Three ships coming in windward of us.\"||You cannot battle three ships at once. You give the orders to put out full sail. You must hope to outrun them.">

<ROOM STORY268
	(IN ROOMS)
	(DESC "268")
	(STORY TEXT268)
	(EVENTS STORY268-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY201 STORY322>>)
	(REQUIREMENTS <LTABLE <LTABLE 2 0 <PLTABLE 6 100> <LTABLE "The pirates overtake you" "You shake them off">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY268-EVENTS ("AUX" MODIFIER CONDITION)
	<SET MODIFIER <GETP ,CURRENT-CHARACTER ,P?RANK>>
	<COND (,CURRENT-SHIP
		<SET CONDITION <GETP ,CURRENT-SHIP ,P?CONDITION>>
		<COND (<EQUAL? .CONDITION ,CONDITION-AVERAGE>
			<INC .MODIFIER>
		)(<EQUAL? .CONDITION ,CONDITION-GOOD>
			<SET MODIFIER <+ .MODIFIER 2>>
		)(<EQUAL? .CONDITION ,CONDITION-EXCELLENT>
			<SET MODIFIER <+ .MODIFIER 3>>
		)>
		<COND (<G? <COUNT-CONTAINER ,CARGO> 0> <DEC .MODIFIER>)>
	)>
	<RESET-ODDS 2 .MODIFIER ,STORY268>>

<CONSTANT TEXT269 "Most are reluctant to go, but you find a pair of doughty fellows from Haggart's Corner who are too simple to understand fear. They follow you up into the rigging, from where you climb up the flying ship's anchor chain.||The deck is empty except for swirls of pearly mist. Glancing down, you can just make out the shadow of you own vessel under the blanket of fog. One of the seamen with you coughs and says, \"The air's perilous thin, skipper. Best shake a leg.\"">
<CONSTANT CHOICES269 <LTABLE "Go back down and be on your way" "Explore below decks">>

<ROOM STORY269
	(IN ROOMS)
	(DESC "269")
	(STORY TEXT269)
	(EVENTS STORY269-EVENTS)
	(CHOICES CHOICES269)
	(DESTINATIONS <PLTABLE STORY228 STORY288>)
	(TYPES TWO-CHOICES)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY269-EVENTS ()
	<COND (,RUN-ONCE
		<COND (<CHECK-CODEWORD ,CODEWORD-CALCIUM>
			<PREVENT-DOOM ,STORY269>
		)(ELSE
			<LOSE-STAMINA 1 ,DIED-GREW-WEAKER ,STORY269>
		)>
	)>>

<CONSTANT TEXT270 "A sacred aura hangs about this place. If you are an initiate of the twin gods of the sea, Alvir and Valmir, then you will be particularly attuned to it.">

<ROOM STORY270
	(IN ROOMS)
	(DESC "270")
	(STORY TEXT270)
	(EVENTS STORY270-EVENTS)
	(CONTINUE STORY252)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY270-EVENTS ()
	<COND (<CHECK-GOD ,GOD-ALVIR-VALMIR> <STORY-JUMP ,STORY234>)>>

<CONSTANT TEXT271 "You send him slamming to the deck, but he bounces up again none the worse for wear. Immediately he clasps his hands behind your neck and you are wrestling again.">

<ROOM STORY271
	(IN ROOMS)
	(DESC "271")
	(STORY TEXT271)
	(CHOICES CHOICES-COMBAT)
	(DESTINATIONS <PLTABLE <PLTABLE STORY290 STORY253>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-COMBAT 14>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT272 "The witches curse your crew with a dreary malaise that renders them useless for all but the simplest chores.||Tittering evilly, the witches skim off across the choppy sea.">

<ROOM STORY272
	(IN ROOMS)
	(DESC "272")
	(STORY TEXT272)
	(EVENTS STORY272-EVENTS)
	(CONTINUE STORY039)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY272-EVENTS ()
	<STORY-RESET-CREW ,CONDITION-POOR ,CURRENT-SHIP>>

<CONSTANT TEXT273 "You wake up. Something is amiss, It takes you a while to realize that you are no longer at sea. In fact, you are not even aboard a ship. Instead you are lying in a bed in one of the rooms at Chard's Inn.||How did you get here? It is a complete mystery. When you ask someone the date, you discover that six months are missing out of your life! Your ship and crew are lost. Some of your possessions and your money is gone too.">

<ROOM STORY273
	(IN ROOMS)
	(DESC "273")
	(STORY TEXT273)
	(EVENTS STORY273-EVENTS)
	(CONTINUE STORY-CITIES-GOLD-GLORY)
	(CODEWORDS <PLTABLE CODEWORD-CLUTCH>)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY273-EVENTS ("AUX" ITEM)
	<STORY-LOSE-SHIP>
	<DO (I 1 6)
		<SET ITEM <GET-ITEM 1 ,PLAYER>>
		<COND (.ITEM <REMOVE-ITEM .ITEM "lost" T T>)>
	>
	<SETG MONEY 0>
	<UPGRADE-ABILITY ,ABILITY-SCOUTING 1>
	<COND (<L? ,STAMINA ,MAX-STAMINA>
		<EMPHASIZE "You have fully recovered from your injuries.">
		<SETG STAMINA ,MAX-STAMINA>
		<UPDATE-STATUS-LINE>
	)>>

<CONSTANT TEXT274 "The priestess holds up her hand before you can speak. \"Peace! Whatever your business, all must her adapt to a slower pace of life. Ah, this accursed heat.\" She indicates her brow, and a slave boy runs forward to lick away the film of sweat.||You are faintly repelled by such decadence, but you try to hide it. \"I have come...\" you begin.||The priestess frowns. \"Have I not said that things are done differently here in Smogmaw? Approach, sit; tell me your business over a game of cards.\"">
<CONSTANT CHOICES274 <LTABLE "Agree to play with her" "Leave the temple">>

<ROOM STORY274
	(IN ROOMS)
	(DESC "274")
	(STORY TEXT274)
	(CHOICES CHOICES274)
	(DESTINATIONS <PLTABLE STORY343 STORY044>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT275 "Mysteriously, when the flock has departed you discover a stowaway sitting on the bowsprit. He peers at everyone suspiciously and utters cawing noises when approached, but after a few days he has recovered his wits enough to speak. \"I dreamt I was flying,\" he says. \"Nor can I tell how I got here.\"||He has some money saved up at home, and rewards you with 50 Shards for dropping him off at your next port of call.">

<ROOM STORY275
	(IN ROOMS)
	(DESC "275")
	(STORY TEXT275)
	(EVENTS STORY275-EVENTS)
	(CONTINUE STORY171)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY275-EVENTS ()
	<GAIN-MONEY 50>>

<CONSTANT TEXT276 "The merchant known as Moon of Evening will never forget how you saved her life. She takes you into her household and embellishes you with body paint and a cloak of feathers. You can also stay here with her family as long as you like.||\"Are you staying in Smogmaw?\" asks Moon of Evening's brother, a handsome fellow known as Dances with Boas. \"I know a merchant who'll take you upriver if you like.\"">
<CONSTANT CHOICES276 <LTABLE "Go with the merchant" "Stay in town for now">>

<ROOM STORY276
	(IN ROOMS)
	(DESC "276")
	(STORY TEXT276)
	(EVENTS STORY276-EVENTS)
	(CHOICES CHOICES276)
	(DESTINATIONS <PLTABLE STORY-SERPENT-KINGS-DOMAIN STORY295>)
	(TYPES TWO-CHOICES)
	(ITEMS <PLTABLE CLOAK-OF-FEATHERS>)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY276-EVENTS ()
	<COND (<L? ,STAMINA ,MAX-STAMINA>
		<SETG STAMINA ,MAX-STAMINA>
		<EMPHASIZE "You have fully recovered from your injuries.">
		<UPDATE-STATUS-LINE>
	)>>

<CONSTANT TEXT277 "\"You have performed a great service for Glimbinki,\" avers the priest. \"In return I will bestow the two blessings that are within my power.\"||These blessings entitle you to reroll a failed attempt at using the ability in question. Each blessing can be used only once. Thanking the priest, you return to town.">

<ROOM STORY277
	(IN ROOMS)
	(DESC "277")
	(STORY TEXT277)
	(EVENTS STORY277-EVENTS)
	(CONTINUE STORY044)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY277-EVENTS ()
	<GAIN-BLESSING ,BLESSING-SCOUTING>
	<GAIN-BLESSING ,BLESSING-MAGIC>>

<CONSTANT TEXT278 "The island is soon left far astern.">
<CONSTANT CHOICES278 <LTABLE "Go north (Lords of the Rising Sun)" "Go south" "Go east (Lords of the Rising Sun)" "Go west">>

<ROOM STORY278
	(IN ROOMS)
	(DESC "278")
	(LOCATION LOCATION-OCEAN)
	(STORY TEXT278)
	(EVENTS STORY278-EVENTS)
	(CHOICES CHOICES278)
	(DESTINATIONS <PLTABLE STORY-LORDS-RISING-SUN STORY060 STORY-LORDS-RISING-SUN STORY136>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY278-EVENTS ()
	<STORY-SET-SAIL ,CURRENT-SHIP>>

<CONSTANT TEXT279 "The cook issues a stream of insults that threatens to turn the air blue. You retreat cowed and shaken.">

<ROOM STORY279
	(IN ROOMS)
	(DESC "279")
	(STORY TEXT279)
	(EVENTS STORY279-EVENTS)
	(CONTINUE STORY607)
	(CODEWORDS <PLTABLE CODEWORD-CACOGAST>)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY279-EVENTS ()
	<LOSE-ABILITY ,ABILITY-CHARISMA 1>>

<CONSTANT TEXT280 "The ghost disappears with a doleful sigh. A wisp of fabric drifts down to the deck. It is a spectral veil.">

<ROOM STORY280
	(IN ROOMS)
	(DESC "280")
	(STORY TEXT280)
	(EVENTS STORY280-EVENTS)
	(CONTINUE STORY078)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY280-EVENTS ()
	<KEEP-ITEM ,SPECTRAL-VEIL>>

<CONSTANT TEXT281 "The first mate breaks open a keg of beer and has all the crew raise their cups to the north. He excuses this by saying: \"We're toasting the High King. It's a time-honoured ritual, Cap'n\"||You smile indulgently. It has been three centuries since the Uttakin swept away the once-glorious realm of the High King, but old traditions die hard.">

<ROOM STORY281
	(IN ROOMS)
	(DESC "281")
	(STORY TEXT281)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY093 STORY300 STORY450>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 5 8 12> <LTABLE "Songs across the waves" "Nothing untoward" "Uttakin slavers">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT282 "You are sailing in warm tropical waters the colour of ink.">
<CONSTANT CHOICES282 <LTABLE HAVE-CODEWORD HAVE-CODEWORD HAVE-CODEWORD "If you have none of those">>

<ROOM STORY282
	(IN ROOMS)
	(DESC "282")
	(STORY TEXT282)
	(CHOICES CHOICES282)
	(DESTINATIONS <PLTABLE STORY341 STORY087 STORY107 STORY125>)
	(REQUIREMENTS <PLTABLE CODEWORD-CORADE CODEWORD-CERTAIN CODEWORD-COVET NONE>)
	(TYPES <PLTABLE R-CODEWORD R-CODEWORD R-CODEWORD R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT283 "You are sailing off the south-eastern promontory of Sokara, known for obscure reasons as Scorpion Bight. To the north lies the Druids' Isle.">
<CONSTANT CHOICES283 <LTABLE "Steer north (The War-Torn Kingdom)" "Steer south" "Steer east (Lords of the Rising Sun)" "Steer west">>

<ROOM STORY283
	(IN ROOMS)
	(DESC "283")
	(STORY TEXT283)
	(CHOICES CHOICES283)
	(DESTINATIONS <PLTABLE STORY-WAR-TORN-KINGDOM STORY173 STORY-LORDS-RISING-SUN STORY066>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT284 "While some of your crew see to repairs aboard ship, you lead a shore party in gathering food and fresh water.">
<CONSTANT TEXT284-FALL "You fall from a coconut palm!">
<CONSTANT TEXT284-STUNG "Stung by a scorpion!">
<CONSTANT TEXT284-REST "You get a good rest.">

<ROOM STORY284
	(IN ROOMS)
	(DESC "284")
	(STORY TEXT284)
	(EVENTS STORY284-EVENTS)
	(CONTINUE STORY304)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY284-EVENTS ("AUX" ROLL)
	<SET ROLL <RANDOM-EVENT 1 0 T>>
	<COND (<L=? .ROLL 2>
		<EMPHASIZE ,TEXT284-FALL>
		<LOSE-STAMINA <ROLL-DICE 1> ,DIED-FROM-INJURIES ,STORY284>
	)(<EQUAL? .ROLL 3>
		<EMPHASIZE ,TEXT284-STUNG>
		<COND (<CHECK-BLESSING ,BLESSING-IMMUNITY-POISON-DISEASE>
			<PREVENT-DOOM ,STORY284>
		)(ELSE
			<LOSE-STAMINA <ROLL-DICE 2> ,DIED-GREW-WEAKER ,STORY284>
		)>
	)(ELSE
		<EMPHASIZE ,TEXT284-REST>
		<COND (<L? ,STAMINA ,MAX-STAMINA> <GAIN-STAMINA 1>)>
		<PREVENT-DOOM ,STORY284>
	)>>

<CONSTANT TEXT285 "A sharp tang is on the air. The sky, thick with iron-coloured clouds, begins to spin slowly like a great inexorable wheel. The heavens are shot though with brimstone flares. The crew stands slack-faced with dismay.||\"It is the fist of Elnir...\" whimpers the bosun. \"He means to punish us for our sins.\"">
<CONSTANT CHOICES285 <LTABLE "The hurricane sweeps down with merciless force.">>

<ROOM STORY285
	(IN ROOMS)
	(DESC "285")
	(STORY TEXT285)
	(EVENTS STORY285-EVENTS)
	(CHOICES CHOICES285)
	(DESTINATIONS <PLTABLE <PLTABLE STORY006 STORY231 STORY337>>)
	(REQUIREMENTS STORY-STORM-REQUIREMENTS)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY285-EVENTS ()
	<STORM-AT-SEA ,STORY285 ,STORY320>>

<CONSTANT TEXT286 "The prow of the oncoming ship looms close. Your men stand ready, braced for impact. It comes, the ship lurches, there is an instant's hesitation as though the Fates held their breath -- then the pirates are aboard. Battle is joined.">

<ROOM STORY286
	(IN ROOMS)
	(DESC "286")
	(STORY TEXT286)
	(EVENTS STORY286-EVENTS)
	(CONTINUE STORY267)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY286-EVENTS ("AUX" ROLL (DICE 2) (MODIFIER -2) (CONDITION 0))
	<COND (<CHECK-PROFESSION ,PROFESSION-WARRIOR> <SET DICE 3>)>
	<COND (,CURRENT-SHIP
		<SET CONDITION <GETP ,CURRENT-SHIP ,P?CONDITION>>
		<COND (<EQUAL? .CONDITION ,CONDITION-POOR>
			<SET MODIFIER -2>
		)(<EQUAL? .CONDITION ,CONDITION-AVERAGE>
			<SET MODIFIER 0>
		)(<EQUAL? .CONDITION ,CONDITION-GOOD>
			<SET MODIFIER 2>
		)(ELSE
			<SET MODIFIER 3>
		)>
	)>
	<PREVENT-DOOM ,STORY286>
	<SET ROLL <RANDOM-EVENT .DICE .MODIFIER T>>
	<COND (<L=? .ROLL 4>
		<EMPHASIZE "Calamity! You are killed!">
		<STORY-JUMP ,STORY123>
	)(<L=? .ROLL 9>
		<EMPHASIZE "Crushing defeat!">
		<LOSE-STAMINA <ROLL-DICE 2> ,DIED-FROM-INJURIES ,STORY286>
		<COND (<IS-ALIVE> <STORY-JUMP ,STORY435>)>
	)(<L=? .ROLL 13>
		<EMPHASIZE "Forced to give in!">
		<LOSE-STAMINA <ROLL-DICE 1> ,DIED-FROM-INJURIES ,STORY286>
		<COND (<IS-ALIVE> <STORY-JUMP ,STORY416>)>
	)(<L=? .ROLL 17>
		<EMPHASIZE "The pirates withdraw!">
		<STORY-JUMP ,STORY101>
	)(ELSE
		<EMPHASIZE "Outright victory!">
	)>>

<CONSTANT TEXT287 "Hardly able to contain your mirth at the thought of the great Reavers being robbed themselves, you help yourself to a few fistfuls of treasure (worth 500 Shards in all) before sneaking back out of their stronghold.">

<ROOM STORY287
	(IN ROOMS)
	(DESC "287")
	(STORY TEXT287)
	(EVENTS STORY287-EVENTS)
	(CHOICES CHOICES-CODEWORD)
	(DESTINATIONS <PLTABLE STORY549 STORY436>)
	(REQUIREMENTS <PLTABLE CODEWORD-CROCUS NONE>)
	(TYPES ONE-CODEWORD)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY287-EVENTS ()
	<COND (,RUN-ONCE <GAIN-MONEY 500>)>>

<CONSTANT TEXT288 "You descend a narrow gangway to a passage with a door to either side. You suspect that the two Golnir men with you are beginning to understand the difference between courage and recklessness.">
<CONSTANT CHOICES288 <LTABLE "Try the left-hand door" "Try the right-hand door" "Advance down the passage" "Return to your ship">>

<ROOM STORY288
	(IN ROOMS)
	(DESC "288")
	(EVENTS STORY288-EVENTS)
	(CHOICES CHOICES288)
	(DESTINATIONS <PLTABLE STORY326 STORY010 STORY029 STORY308>)
	(TYPES FOUR-CHOICES)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY288-EVENTS ()
	<COND (,RUN-ONCE
		<COND (<CHECK-CODEWORD ,CODEWORD-CALCIUM>
			<PREVENT-DOOM ,STORY288>
		)(ELSE
			<EMPHASIZE "You lose more stamina in the rarefied air.">
			<LOSE-STAMINA 2 ,DIED-GREW-WEAKER ,STORY288>
		)>
	)>
	<CONTINUE-TEXT ,TEXT288>>

<CONSTANT TEXT289 "\"Journey towards the rising sun,\" says the herald of the twin gods. \"Before you reach the stars, you will come upon a bay that is guarded by a great serpent. Fight it alone - no man may help you. At the highest point of the island you'll get your boon.\"||The figure dissolves into a cascade of fading green sparks.">

<ROOM STORY289
	(IN ROOMS)
	(DESC "289")
	(STORY TEXT289)
	(CONTINUE STORY252)
	(CODEWORDS <PLTABLE CODEWORD-CORADE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT290 "Again you batter the strange fighter down. Now there is a thin smear of blood at the corner of his mouth and he sounds slightly out of breath as he throws open his arms and says: \"Come, my dear foe, let's embrace. I'll crush your bones to powder!\"">

<ROOM STORY290
	(IN ROOMS)
	(DESC "290")
	(STORY TEXT290)
	(CHOICES CHOICES-COMBAT)
	(DESTINATIONS <PLTABLE <PLTABLE STORY310 STORY253>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-COMBAT 15>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT291 "She climbs up the lifeline like a fat black spider. A claw of a hand reaches up, grey and liver-spotted.||\"Help an old lady, then, my dears,\" she wheezes.||\"Help her be damned!\" snarls the mate, brandishing his flensing knife. \"Let me cut her loose. Drowning's a fair fate for such as her.\"">
<CONSTANT CHOICES291 <LTABLE "Agree to the mate's suggestion" "Pull her up on deck">>

<ROOM STORY291
	(IN ROOMS)
	(DESC "291")
	(STORY TEXT291)
	(CHOICES CHOICES291)
	(DESTINATIONS <PLTABLE STORY070 STORY089>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT292 "Someone must have slipped a sleeping powder in your drink, because you wake late with an aching head. Feeling slightly sick, you go straight to your travelling chest. Your worst fears are confirmed -- all your cash and possessions are gone.">

<ROOM STORY292
	(IN ROOMS)
	(DESC "292")
	(STORY TEXT292)
	(EVENTS STORY292-EVENTS)
	(CHOICES CHOICES-THIEVERY)
	(DESTINATIONS <PLTABLE <PLTABLE STORY312 STORY329>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-THIEVERY 15>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY292-EVENTS ()
	<COND (,RUN-ONCE <STORY-LOSE-EVERYTHING F>)>>

<CONSTANT TEXT293 "It will cost you 30 Shards to buy a blessing. The blessing allows you to reroll any one dice result. This needn't necessarily be an ability roll; you could use it to reroll an encounter result that you don't want. You can have only one Luck blessing at a time, and it will work only once.">

<ROOM STORY293
	(IN ROOMS)
	(DESC "293")
	(STORY TEXT293)
	(EVENTS STORY293-EVENTS)
	(CONTINUE STORY044)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY293-EVENTS ()
	<PURCHASE-BLESSING 30 30 ,GOD-THREE-FORTUNES ,BLESSING-LUCK>>

<CONSTANT TEXT294 "You are transformed into a bird and have no cares other than to soar off with the rest of the flock. After many months, you chance to alight on the deck of a ship and when the other birds fly off you are left behind -- human once more. The captain of the vessel listens to your tale with astonishment, but seems to accept it as true. \"I have heard that the natives of the Weeping Jungle believe that all mankind were birds once.\"||You have not lost your money or possessions, which were transformed with you, but your ship is gone; The captain agrees to drop you off in Smogmaw, unless you would rather pay him 30 Shards to take you back to Dweomer.">
<CONSTANT CHOICES294 <LTABLE "Go to Dweomer" "Disembark at Smogmaw" >>

<ROOM STORY294
	(IN ROOMS)
	(DESC "294")
	(STORY TEXT294)
	(EVENTS STORY294-EVENTS)
	(CHOICES CHOICES294)
	(DESTINATIONS <PLTABLE STORY100 STORY044 >)
	(REQUIREMENTS <PLTABLE 30 NONE>)
	(TYPES ONE-MONEY)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY294-EVENTS ()
	<COND (,RUN-ONCE <STORY-LOSE-SHIP>)>>

<CONSTANT TEXT295 "The streets of Smogmaw are narrow boardwalks, some of them floating on pontoons out over the sluggish yellow river. The air is hot and sticky like watery treacle. At dusk a sparkling haze crawls out from the jungle, giving this place its name: the Misty Estuary.">

<ROOM STORY295
	(IN ROOMS)
	(DESC "295")
	(LOCATION LOCATION-SMOGMAW)
	(STORY TEXT295)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY315 STORY044 STORY332>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 4 9 12> <LTABLE "Press-ganged!" "A pleasant stroll" "A mysterious hut">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT296 "\"How can I offer blessing and the like?\" laments the priest, a stooped little man with a bald pate and, appropriately enough, a hooked beak of a nose.||\"What's the problem?\"||\"The idol of the god was stolen by unscrupulous people of the Macaw Tribe. Until it is returned, there is no divine power here.\"">

<ROOM STORY296
	(IN ROOMS)
	(DESC "296")
	(STORY TEXT296)
	(CHOICES CHOICES-HAVE-NOT)
	(DESTINATIONS <PLTABLE STORY316 STORY044>)
	(REQUIREMENTS <PLTABLE WINGED-IDOL NONE>)
	(TYPES ONE-ITEM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT297 "The market is held in a warren of booths set up in a roofed arcade at the eastern edge of town. If you have a ship and want to load a cargo of copper ore, you should visit the mines.">

<CONSTANT CHOICES297 <LTABLE "Buy armours/weapons/other items" "Sell armours/weapons/magic/other items" "Leave the market">>

<ROOM STORY297
	(IN ROOMS)
	(DESC "297")
	(LOCATION LOCATION-COPPER)
	(STORY TEXT297)
	(CHOICES CHOICES297)
	(DESTINATIONS <PLTABLE COPPER-ISLAND-BUY COPPER-ISLAND-SELL STORY099>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT298 "\"Where to now, skipper?\" asks the helmsman as he takes the ship out of Vervayens harbour.">
<CONSTANT CHOICES298 <LTABLE "Steer north" "Steer south" "Steer west" "Steer east">>

<ROOM STORY298
	(IN ROOMS)
	(DESC "298")
	(LOCATION LOCATION-OCEAN)
	(STORY TEXT298)
	(EVENTS STORY-SET-SAIL)
	(CHOICES CHOICES298)
	(DESTINATIONS <PLTABLE STORY119 STORY263 STORY042 STORY303>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT299 "A shrieking phantom becomes lodged at the top of the main-mast, where it rants and flickers like a ball of lightning. The mate comes to you with his hair on end and pleads for you to exorcize it before the ship is doomed.">

<ROOM STORY299
	(IN ROOMS)
	(DESC "299")
	(STORY TEXT299)
	(CHOICES CHOICES-SANCTITY)
	(DESTINATIONS <PLTABLE <PLTABLE STORY280 STORY014>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-SANCTITY 15>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT300 "Far out at sea with only the stars to guide you, you taste the salty wind and ponder your next course.">
<CONSTANT CHOICES300 <LTABLE "Steer west" "Steer east" "Steer north" "Steer south">>

<ROOM STORY300
	(IN ROOMS)
	(DESC "300")
	(LOCATION LOCATION-OCEAN)
	(STORY TEXT300)
	(CHOICES CHOICES300)
	(DESTINATIONS <PLTABLE STORY370 STORY153 STORY208 STORY468>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT301 "\"Ah!\" cries the cook, emerging from the galley to sniff the fresh salt breeze. \"A life on the open waves -- what king in his palace could hope for better contentment?\"">

<ROOM STORY301
	(IN ROOMS)
	(DESC "301")
	(STORY TEXT301)
	(EVENTS STORY301-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY398 STORY562 STORY011>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 3 5 12> <LTABLE "Pirates" "Storm" "An uneventful voyage">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY301-EVENTS ()
	<COND (<AND ,RUN-ONCE <L? ,STAMINA ,MAX-STAMINA>> <GAIN-STAMINA 1>)>>

<CONSTANT TEXT302 "Balmy nights filled with a million stars are followed by days of tranquil beauty. With a good following wind, the ship ploughs on through waves the colour of amethyst. What could disturb your mood of perfect contentment?">

<ROOM STORY302
	(IN ROOMS)
	(DESC "302")
	(STORY TEXT302)
	(EVENTS STORY302-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY176 STORY501 STORY320 STORY285>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 4 6 9 12> <LTABLE "Pirates" "Flying fish" "Nothing" "A hurricane">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY302-EVENTS ()
	<COND (<AND ,RUN-ONCE <L? ,STAMINA ,MAX-STAMINA>> <GAIN-STAMINA 1>)>>

<CONSTANT TEXT303 "The sun's rim dips, the stars rush out -- at one strife comes the dark. By the stern lamp you can see the helmsman's face gleaming pale and gaunt. Like all the crew, he senses something uncanny on the air.||\"I don't mind admitting it,\" mutters the mate, \"fear sips at the blood of my heart as from a frosted cup.\"||\"Hold steady, mister,\" you tell him. \"We must set a stout example for the crew.\"">

<ROOM STORY303
	(IN ROOMS)
	(DESC "303")
	(STORY TEXT303)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY080 STORY683 STORY428 STORY693>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 5 7 9 12> <LTABLE "Barnacle men" "A dreadful doom" "A skeletal ship" "The Furies descend">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT304 "\"Ah, this is the life,\" declares the bosun as he stretches contentedly in the shade under a palm tree. The exertion in the heat of the afternoon has made you all drowsy.">
<CONSTANT CHOICES304 <LTABLE "Stay awake" TEXT-ROLL-MAGIC "Fall asleep">>

<ROOM STORY304
	(IN ROOMS)
	(DESC "304")
	(STORY TEXT304)
	(CHOICES CHOICES304)
	(DESTINATIONS <PLTABLE STORY005 <PLTABLE STORY005 STORY582> STORY582>)
	(REQUIREMENTS <PLTABLE CODEWORD-CHILL <PLTABLE ABILITY-MAGIC 12> NONE>)
	(TYPES <PLTABLE R-CODEWORD R-TEST-ABILITY R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT305 "They doze off. You shake each man and yell in his ears, but this is an enchanted slumber.">
<CONSTANT CHOICES305 <LTABLE "Wake them">>

<ROOM STORY305
	(IN ROOMS)
	(DESC "305")
	(STORY TEXT305)
	(EVENTS STORY305-EVENTS)
	(CHOICES CHOICES305)
	(DESTINATIONS <PLTABLE <PLTABLE STORY045 STORY064>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-MAGIC 17>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY305-EVENTS ()
	<COND (,RUN-ONCE <DELETE-CODEWORD ,CODEWORD-COSY>)>>

<CONSTANT TEXT306 "The pirates pull alongside and cast grappling hooks to seize your vessel. Within moments they are swarming aboard. You offer them you goods, but plead for the freedom of your crew.">

<ROOM STORY306
	(IN ROOMS)
	(DESC "306")
	(STORY TEXT306)
	(CHOICES CHOICES-CHARISMA)
	(DESTINATIONS <PLTABLE <PLTABLE STORY416 STORY435>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-CHARISMA 15>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT307 "You help yourself to the pirates' treasure, which amounts to 150 Shards. Their ship's hold contains 1 Cargo Unit of furs, which you can add to your own cargo if your ship has room for it. You can also take the pirate captain's head -- such a trophy can fetch a good reward in civilized ports.">

<ROOM STORY307
	(IN ROOMS)
	(DESC "307")
	(STORY TEXT307)
	(EVENTS STORY307-EVENTS)
	(CONTINUE STORY101)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY307-EVENTS ()
	<GAIN-MONEY 150>
	<STORY-GAIN-CARGO ,CARGO-FURS 1>
	<KEEP-ITEM ,PIRATE-CAPTAINS-HEAD>>

<CONSTANT TEXT308-AIR "You vainly struggle for breath in the thin air.">
<CONSTANT TEXT308-SURVIVE "You climb back down to your ship and cut the cable loose before continuing on your way.">

<ROOM STORY308
	(IN ROOMS)
	(DESC "308")
	(EVENTS STORY308-EVENTS)
	(CONTINUE STORY228)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY308-EVENTS ()
	<COND (<CHECK-CODEWORD ,CODEWORD-CALCIUM>
		<PREVENT-DOOM ,STORY309>
	)(ELSE
		<CONTINUE-TEXT ,TEXT308-AIR>
		<LOSE-STAMINA <ROLL-DICE 1> ,DIED-GREW-WEAKER ,STORY308>
	)>
	<CONTINUE-TEXT ,TEXT308-SURVIVE>>

<CONSTANT TEXT309 "\"Sail away from dusk and death,\" says the glowing image. \"Long before you reach the place of many-headed ones you will encounter a grim stranger. Unarmed you must struggle with him, and three times cast him to the deck; then you can demand your boon.\"||The figure vanishes in a spray of wispy green lights.">

<ROOM STORY309
	(IN ROOMS)
	(DESC "309")
	(STORY TEXT309)
	(CONTINUE STORY252)
	(CODEWORDS <PLTABLE CODEWORD-CERTAIN>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT310 "For the third time in a row, you lift the stranger clear off his feet and smash him hard against the deck. This time he raises his hand in submission.||\"Enough. You win,\" he says, staggering to his feet. \"You're the strongest there is.\"||So saying, he jumps back down to his boat and sails off.">

<ROOM STORY310
	(IN ROOMS)
	(DESC "310")
	(STORY TEXT310)
	(EVENTS STORY310-EVENTS)
	(CONTINUE STORY125)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY310-EVENTS ()
	<UPGRADE-STAMINA 5>
	<UPGRADE-ABILITY ,ABILITY-COMBAT 1>>

<CONSTANT TEXT311 "You are on the open ocean somewhere north of Braelak, the Sorcerers' Isle.">
<CONSTANT CHOICES311 <LTABLE "Steer southwards" "Go west" "Go east" "Go north (Cities of Gold and Glory)">>

<ROOM STORY311
	(IN ROOMS)
	(DESC "311")
	(LOCATION LOCATION-OCEAN)
	(STORY TEXT311)
	(EVENTS STORY-SET-SAIL)
	(CHOICES CHOICES311)
	(DESTINATIONS <PLTABLE STORY009 STORY129 STORY301 STORY-CITIES-GOLD-GLORY>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT312 "It takes a thief to catch a thief. During a thorough search of the ship, you discover a secret compartment behind the cook's bunk where there is a large stash of stolen property.||\"My old tobacco pipe!\" cries the bosun. He rolls up his sleeves and advances menacingly on the cook. \"You scurvy swab!\"||Another sailor is appointed as cook, to general approval. For his many crimes both in and out of the galley, the cook is sent to feed the sharks.">

<ROOM STORY312
	(IN ROOMS)
	(DESC "312")
	(STORY TEXT312)
	(CONTINUE STORY154)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT313 "You drag yourself up a beach of large pebbles, strewn with fronds of seaweed. Lying for a few hours in the weak sunshine goes some way to restoring your strength, and you manage to stagger inland to look for signs of habitation. The landscape is desolate and windswept, but you can see a few sheep grazing on the hillsides.">

<ROOM STORY313
	(IN ROOMS)
	(DESC "313")
	(STORY TEXT313)
	(CONTINUE STORY436)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT314 "The tavern is just a wooden hut with curtains of woven pandanus leaves serving as partitions. Customers sit or squat on mats on the floor. The place reeks of sharp liquor and pipe smoke.">

<ROOM STORY314
	(IN ROOMS)
	(DESC "314")
	(VISITS 0)
	(STORY TEXT314)
	(EVENTS STORY314-EVENTS)
	(CONTINUE STORY044)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY314-EVENTS ()
	<VISIT-TAVERN ,STORY314 1>>

<CONSTANT TEXT315 "You lose your way and end up in a quiet spot behind a row of huts, where a half dozen assailants leap at you. Seconds later you are face down in the rank mud and struggling for your liberty.">
<CONSTANT CHOICES315 <LTABLE "Break free and escape">>

<ROOM STORY315
	(IN ROOMS)
	(DESC "315")
	(STORY TEXT315)
	(CHOICES CHOICES315)
	(DESTINATIONS <PLTABLE <PLTABLE STORY044 STORY345>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-COMBAT 13>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT316 "\"This is the very idol of which I spoke!\" cries the priest delightedly.||He takes the winged idol from you and installs it inside the teepee.">

<ROOM STORY316
	(IN ROOMS)
	(DESC "316")
	(STORY TEXT316)
	(EVENTS STORY316-EVENTS)
	(CONTINUE STORY277)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY316-EVENTS ()
	<RETURN-ITEM ,WINGED-IDOL T>
	<GAIN-CODEWORD ,CODEWORD-CUSHAT>
	<COND (<G? <RANDOM-EVENT 2 0 T> <GET-ABILITY-SCORE ,CURRENT-CHARACTER ,ABILITY-SCOUTING>>
		<UPGRADE-ABILITY ,ABILITY-SCOUTING 1>
	)>>

<CONSTANT TEXT317 "The hills of Copper Island are honeycombed with mine workings. Beside a tunnel mouth you see a hut where the mine foreman conducts business.">
<CONSTANT CHOICES317 <LTABLE "Go to see the foreman" "Enter the mines" "Return to Brazen">>

<ROOM STORY317
	(IN ROOMS)
	(DESC "317")
	(LOCATION LOCATION-COPPER)
	(STORY TEXT317)
	(CHOICES CHOICES317)
	(DESTINATIONS <PLTABLE STORY038 STORY394 STORY099>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT318 "On a small island like this there is not much on sale, but at least the villagers fall over themselves to offer you a bargain.||\"Nothing is too good for our saviour!\" declares one old lady with grateful tears in her eyes.">
<CONSTANT CHOICES318 <LTABLE "Buy armours/weapons/other items" "Sell armours/weapons/other items" "Leave the market">>

<ROOM STORY318
	(IN ROOMS)
	(DESC "318")
	(LOCATION LOCATION-VERVAYENS)
	(STORY TEXT318)
	(CHOICES CHOICES318)
	(DESTINATIONS <PLTABLE VERVAYENS-MARKET-BUY VERVAYENS-MARKET-SELL STORY020>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT319 "The nobles are so impressed by your wit and good manners that they make you a gift of a courtier's mask.||\"If you should ever visit our land, this will admit you to the highest social circles,\" they tell you.">

<ROOM STORY319
	(IN ROOMS)
	(DESC "319")
	(STORY TEXT319)
	(CONTINUE STORY078)
	(ITEMS <PLTABLE COURTIERS-MASK>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT320 "You are sailing off the coast of Ankon-Konu just a few leagues north of Smogmaw, the famous trading town that is home to a thousand ne'er-do-wells from all points of the compass.">
<CONSTANT CHOICES320 <LTABLE "South to Smogmaw" "North-east to Starspike Island" "Due north" "West" "East to the Sea of Hydras">>

<ROOM STORY320
	(IN ROOMS)
	(DESC "320")
	(LOCATION LOCATION-OCEAN)
	(STORY TEXT320)
	(EVENTS STORY-SET-SAIL)
	(CHOICES CHOICES320)
	(DESTINATIONS <PLTABLE STORY266 STORY192 STORY303 STORY263 STORY337>)
	(TYPES FIVE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT321 "Your ordeal is over. You resolve to leave these bane-drenched waters with all speed.">
<CONSTANT CHOICES321 <LTABLE "Go north" "Go south" "Go east" "Go west">>

<ROOM STORY321
	(IN ROOMS)
	(DESC "321")
	(STORY TEXT321)
	(CHOICES CHOICES321)
	(DESTINATIONS <PLTABLE STORY119 STORY302 STORY156 STORY004>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT322 "You are south of Marlock City -- or Old Sokar, to give the port its original name, which still appears on most charts. The helmsman asks for a new bearing.">
<CONSTANT CHOICES322 <LTABLE "Steer west" "South" "North (The War-Torn Kingdom)" "East">>

<ROOM STORY322
	(IN ROOMS)
	(DESC "322")
	(STORY TEXT322)
	(CHOICES CHOICES322)
	(DESTINATIONS <PLTABLE STORY402 STORY081 STORY-WAR-TORN-KINGDOM STORY066>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT323 "Obviously a powerful sleep spell permeates this island. You know you can only overcome it by using stronger magic of your own. The song of the mermaids bursts to your lips as a result of sudden inspiration. It has the desired effect -- the men rise from the stone couches and follow you like sleepwalkers along the causeway.">

<ROOM STORY323
	(IN ROOMS)
	(DESC "323")
	(STORY TEXT323)
	(CONTINUE STORY102)
	(FLAGS LIGHTBIT)>

<ROOM STORY324
	(IN ROOMS)
	(DESC "324")
	(EVENTS STORY324-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY286 STORY024>>)
	(REQUIREMENTS <LTABLE <LTABLE 2 0 <PLTABLE 6 100> <LTABLE "The pirates overtake you" "You outrun them">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY324-EVENTS ("AUX" (MODIFIER 0) (CONDITION 0))
	<SET MODIFIER <GETP ,CURRENT-CHARACTER ,P?RANK>>
	<COND (,CURRENT-SHIP
		<SET CONDITION <GETP ,CURRENT-SHIP ,P?CONDITION>>
		<COND (<EQUAL? .CONDITION ,CONDITION-AVERAGE>
			<INC .MODIFIER>
		)(<EQUAL? .CONDITION ,CONDITION-GOOD>
			<SET MODIFIER <+ .MODIFIER 2>>
		)(<EQUAL? .CONDITION ,CONDITION-EXCELLENT>
			<SET MODIFIER <+ .MODIFIER 3>>
		)>
	)>
	<RESET-ODDS 2 .MODIFIER ,STORY324>>

<CONSTANT TEXT325 "The discovery of a rat's skeleton at the bottom of a used beer barrel provokes discontent among the crew. Matters are worsened by the first mate's jocular remark that the rat will have given the beer some flavour. The men become surly.||At seven bells in the forenoon watch, you come on deck to discover the men on duty have broken a keg of black Barony wine out of ship's stores and are blind drunk. The ship has been drifting untended for hours!">

<ROOM STORY325
	(IN ROOMS)
	(DESC "325")
	(STORY TEXT325)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY055 STORY210 STORY172 STORY246 STORY303 STORY-LORDS-RISING-SUN>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 4 6 7 9 11 12> NONE>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT326 "It is getting harder to breathe.">
<CONSTANT TEXT326-CONTINUED "You see three men of violet hue come dashing at you wielding thin rapiers of unearthly metal. Your stout seamen of Golnir are at your side, leaving you to deal with the leader of these alien skyfarers.">
<CONSTANT TEXT326-HIT "They strike at your retreating back, causing some damage.">

<ROOM STORY326
	(IN ROOMS)
	(DESC "326")
	(STORY TEXT326)
	(EVENTS STORY326-EVENTS)
	(CONTINUE STORY339)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY326-EVENTS ()
	<COND (<NOT <CHECK-CODEWORD ,CODEWORD-CALCIUM>> <LOSE-STAMINA 3 ,DIED-GREW-WEAKER ,STORY326>)>
	<COND (<IS-ALIVE>
		<CONTINUE-TEXT ,TEXT326-CONTINUED>
		<CRLF>
		<TELL "Do you wish to give up and flee?">
		<COND (<YES?>
			<CONTINUE-TEXT ,TEXT326-HIT>
			<LOSE-STAMINA <ROLL-DICE 1> ,DIED-FROM-INJURIES ,STORY326>
			<COND (<IS-ALIVE> <STORY-JUMP ,STORY308>)>
		)(ELSE
			<COMBAT-MONSTER ,MONSTER-VIOLET-MAN 9 12 9>
			<CHECK-COMBAT ,MONSTER-VIOLET-MAN ,STORY326>
		)>
	)>>

<CONSTANT TEXT327 "The spectre's face is formed of faint patches of shadow in the green glare. \"From the Nozama to the Grimm, from Hypnos' isle to his black-winged mother's spire -- at the heart of this cross you'll find the contentment you seek.\"||The light flickers, flares briefly, and goes out. You feel as if you have awakened from a dream.">

<ROOM STORY327
	(IN ROOMS)
	(DESC "327")
	(STORY TEXT327)
	(CONTINUE STORY252)
	(CODEWORDS <PLTABLE CODEWORD-COVER>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT328 "The serpent is big, but old and slow. The sailors slaughter it easily, one man holding down its head with the end of an oar, whilst the others slice it up with their swords.||The island appears deserted. You return to the ship and give the order to be under way.">

<ROOM STORY328
	(IN ROOMS)
	(DESC "328")
	(STORY TEXT328)
	(CONTINUE STORY125)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT329 "You search high and low, but the stolen items are nowhere to be found.">

<ROOM STORY329
	(IN ROOMS)
	(DESC "329")
	(STORY TEXT329)
	(EVENTS STORY329-EVENTS)
	(CONTINUE STORY154)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY329-EVENTS ()
	<STORY-LOSE-EVERYTHING F>>

<CONSTANT TEXT330 "You tell the priestess you no longer wish to be an initiate. She utters a long weary sigh and throws her head back in the slumbrous heat. \"Go then.\"||\"Do I not have to pay compensation? That is customary.\"||\"Not here in the tropics. Every exertion only makes a pool for flies to paddle in. I cannot be bothered to rise from my divan to open the strongbox. Now, begone.\"">

<ROOM STORY330
	(IN ROOMS)
	(DESC "330")
	(STORY TEXT330)
	(EVENTS STORY330-EVENTS)
	(CONTINUE STORY044)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY330-EVENTS ()
	<CRLF>
	<COND (<CHECK-GOD ,GOD-THREE-FORTUNES>
		<TELL "You renounce the worship of the ">
		<PRINT-ITEM ,GOD-THREE-FORTUNES T>
		<TELL ,PERIOD-CR>
	)(ELSE
		<TELL "Your are not an initiate of the ">
		<PRINT-ITEM ,GOD-THREE-FORTUNES T>
		<TELL ,EXCLAMATION-CR>
	)>>

<CONSTANT TEXT331 "In one corner you see three of your treacherous former crewmen enjoying a drink. They don't seem to have noticed you. The memory of their mutiny makes your blood seethe.">
<CONSTANT CHOICES331 <LTABLE "Attack them" "Speak to them" "Wait and watch">>

<ROOM STORY331
	(IN ROOMS)
	(DESC "331")
	(STORY TEXT331)
	(CHOICES CHOICES331)
	(DESTINATIONS <PLTABLE STORY344 STORY035 STORY203>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT332 "There is a shaman's hut made of sheaves of straw halfway between the shanties at the edge of the town and the wall of dark foliage that marks the start of the jungle. The shaman will trade magical items if you are interested.">
<CONSTANT CHOICES332 <LTABLE "Buy magic/other items" "Sell magic/other items" "Leave the shaman's hut">>

<ROOM STORY332
	(IN ROOMS)
	(DESC "332")
	(LOCATION LOCATION-SMOGMAW)
	(STORY TEXT332)
	(CHOICES CHOICES332)
	(DESTINATIONS <PLTABLE SHAMANS-HUT-BUY SHAMANS-HUT-SELL STORY044>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<ROOM STORY333
	(IN ROOMS)
	(DESC "333")
	(BACKGROUND STORY333-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY333-BACKGROUND ()
	<COND (<CHECK-TITLE ,TITLE-UNSPEAKABLE-CULTIST> <RETURN ,STORY346>)>
	<RETURN ,STORY018>>

<CONSTANT TEXT334 "The Motherlode Inn offers a pallet and one square meal for 2 Shards a day. Each day you spend here you can recover 1 Stamina point if injured.">

<ROOM STORY334
	(IN ROOMS)
	(DESC "334")
	(VISITS 0)
	(STORY TEXT334)
	(EVENTS STORY334-EVENTS)
	(CONTINUE STORY099)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY334-EVENTS ()
	<VISIT-INN ,STORY334 2 1>>

<CONSTANT TEXT335 "You put your feet up at the house provided for you by the grateful islanders. You can rest here as long as you want, so if injured you can now restore your Stamina to its normal unwounded score. You can also leave money and possessions here to save carrying them around.">
<CONSTANT CHOICES335 <LTABLE "Visit the market" "Consult the wise woman" "Upgrade your crew" "Put to sea">>

<ROOM STORY335
	(IN ROOMS)
	(DESC "335")
	(LOCATION LOCATION-VERVAYENS)
	(STORY TEXT335)
	(EVENTS STORY335-EVENTS)
	(CHOICES CHOICES335)
	(DESTINATIONS <PLTABLE STORY318 STORY390 STORY349 STORY298>)
	(REQUIREMENTS <PLTABLE NONE NONE NONE DOCK-VERVAYENS>)
	(TYPES <PLTABLE R-NONE R-NONE R-NONE R-DOCKED>)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY335-EVENTS ()
	<COND (,RUN-ONCE <VISIT-STORAGE ,STORY335 ,HOUSE-VERVAYENS>)>>

<CONSTANT TEXT336 "A gilded pleasure barge sails by, bearing noblemen from Aku to Metriciens. They pull alongside to converse with you for a short while before proceeding on their way.">

<ROOM STORY336
	(IN ROOMS)
	(DESC "336")
	(STORY TEXT336)
	(CHOICES CHOICES-CHARISMA)
	(DESTINATIONS <PLTABLE <PLTABLE STORY319 STORY078>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-CHARISMA 13>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT337 "\"The Sea of Hydras,\" the navigator says, pointing to the east.||\"Why is it so called?\" asks the cabin boy in a tone of wonder.||The navigator gives a derisive snort of laughter. \"Need you ask?\"">

<ROOM STORY337
	(IN ROOMS)
	(DESC "337")
	(LOCATION LOCATION-HYDRA)
	(STORY TEXT337)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY538 STORY003 STORY556>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 6 9 12> <LTABLE "A ship from distant lands" "An uneventful day's sailing" "An emergency arises">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT338 "You put ashore to take on fresh water. The crewmen are happy to cavort along the wide golden beach and explore the orchid scented jungle -- until the ship's priest comes staggering back with his throat slashed, gurgles \"Iambic pentameter\" and dies at your feet.||\"Pentameter -- that's a sort of ship, like a quinquireme,\" says the first mate. \"Iambic, though? Out of a port called Iambus? Where's that?\"||The rest of the shore party are spooked. They want to leave.">
<CONSTANT CHOICES338 <LTABLE "Set sail at once" "Explore the island">>

<ROOM STORY338
	(IN ROOMS)
	(DESC "338")
	(LOCATION LOCATION-HYDRA)
	(STORY TEXT338)
	(CHOICES CHOICES338)
	(DESTINATIONS <PLTABLE STORY041 STORY008>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT339 "Gasping for breath, your men make a hasty search of the cabin, finding three swords (COMBAT +1) and a fretwork key.||One of the two men is reeling by now. \"I can't stand it much longer, skipper...\" he says.">
<CONSTANT CHOICES339 <LTABLE "Explore further along the passage" "Return to your ship">>

<ROOM STORY339
	(IN ROOMS)
	(DESC "339")
	(VISITS 0)
	(STORY TEXT339)
	(EVENTS STORY339-EVENTS)
	(CHOICES CHOICES339)
	(DESTINATIONS <PLTABLE STORY029 STORY308>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY339-EVENTS ()
	<COND (,RUN-ONCE
		<TAKE-QUANTITIES ,SWORD "swords" "How many of the swords will you take" 3>
		<TAKE-ITEM ,FRETWORK-KEY>
	)>>

<CONSTANT TEXT340 "A search is organized and the stowaway is soon found. He is a little black dwarf with narrow eyes who ducks between your legs, runs up on deck and dives into the sea. As you watch him swim away with surprisingly powerful strokes, the first mate brings bad news: \"He broke a hole in the hull. We're sinking!\"||You have no choice but to abandon ship. You lose your ship and crew; you will never see them again. Clinging to an empty barrel, you are swept away by the current and eventually washed up on an island.">

<ROOM STORY340
	(IN ROOMS)
	(DESC "340")
	(STORY TEXT340)
	(EVENTS STORY340-EVENTS)
	(CONTINUE STORY313)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY340-EVENTS ()
	<STORY-LOSE-SHIP>>

<CONSTANT TEXT341 "You put into a bay on a small uncharted island. Going ashore to replenish your supplies, you come across a huge serpent with skin like tree-bark lying in the shade of the trees. It watches you with cold intensity.||\"Shall we kill it, skipper?\" asks the master of arms.">
<CONSTANT CHOICES341 <LTABLE "Have the men attack it" "Kill it yourself" "Leave without disturbing it">>

<ROOM STORY341
	(IN ROOMS)
	(DESC "341")
	(STORY TEXT341)
	(EVENTS STORY341-EVENTS)
	(CHOICES CHOICES341)
	(DESTINATIONS <PLTABLE STORY328 STORY211 STORY125>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY341-EVENTS ()
	<DELETE-CODEWORD ,CODEWORD-CORADE>>

<CONSTANT TEXT342 "You climb back up the sinkhole and hurry away from the Gorgons' lair. What now?">
<CONSTANT CHOICES342 <LTABLE "Put to sea in one of the fishing boats" "Cross to the other side of the island" "Pray to your god for deliverance">>

<ROOM STORY342
	(IN ROOMS)
	(DESC "342")
	(STORY TEXT342)
	(CHOICES CHOICES342)
	(DESTINATIONS <PLTABLE STORY411 STORY449 STORY467>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT343 "A clap of her hands brings two more slave boys scurrying over with a card table. A second divan is placed for you to recline. Goblets of chilled fruit juice are set beside you.||If you have a deck of marked cards you have the option to use them in the game. Otherwise you will have to play with the priestess's deck.">
<CONSTANT CHOICES343 <LTABLE "Use" "Agree to play with her deck">>

<ROOM STORY343
	(IN ROOMS)
	(DESC "343")
	(STORY TEXT343)
	(CHOICES CHOICES343)
	(DESTINATIONS <PLTABLE STORY015 STORY034>)
	(REQUIREMENTS <PLTABLE DECKED-MARKED-CARDS NONE>)
	(TYPES ONE-ITEM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT344 "You plant yourself beside the mat where they're sitting. \"Get up, you dogs, so I can whip you off to hell.\"||They get unsteadily to their feet, all the worse for drink. \"Aye, aye, skipper,\" says your former mate, Mister Fryer. \"And we'll be happy to take you with us.\"">

<ROOM STORY344
	(IN ROOMS)
	(DESC "344")
	(STORY TEXT344)
	(CHOICES CHOICES-CODEWORD)
	(DESTINATIONS <PLTABLE STORY112 STORY073>)
	(REQUIREMENTS <PLTABLE CODEWORD-AID NONE>)
	(TYPES ONE-CODEWORD)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT345 "You are coshed and dragged aboard a Sokaran merchant ship, the Tidy Sum. By the time you come round the ship has already put to sea. You also discover that the press-gang took all your cash, though at least they left your possessions.">

<ROOM STORY345
	(IN ROOMS)
	(DESC "345")
	(STORY TEXT345)
	(EVENTS STORY345-EVENTS)
	(CHOICES CHOICES-HAVE-NOT)
	(DESTINATIONS <PLTABLE STORY017 STORY036>)
	(REQUIREMENTS <PLTABLE DOCK-SMOGMAW NONE>)
	(TYPES <PLTABLE R-DOCKED R-NONE>)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY345-EVENTS ()
	<COND (,RUN-ONCE
		<SETG MONEY 0>
		<UPDATE-STATUS-LINE>
	)>>

<CONSTANT TEXT346 "The other cultists nod as you enter. \"May His name never be spoken,\" they intone in ritual greeting.||\"Whose name? Shush!\" you reply in the words of the time-honoured catechism.||It is almost time for supper.">
<CONSTANT TEXT346-CONTINUED "After having your loathsome meal, you slip furtively back to town.">

<ROOM STORY346
	(IN ROOMS)
	(DESC "346")
	(STORY TEXT346)
	(EVENTS STORY346-EVENTS)
	(CONTINUE STORY044)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY346-EVENTS ("AUX" (INGREDIENT NONE))
	<COND (<CHECK-ITEM ,PIRATE-CAPTAINS-HEAD>
		<SET INGREDIENT ,PIRATE-CAPTAINS-HEAD>
	)(<CHECK-ITEM ,WITCH-HAND>
		<SET INGREDIENT ,WITCH-HAND>
	)>
	<COND (.INGREDIENT
		<CRLF>
		<TELL "Add the ">
		<PRINT-ITEM .INGREDIENT T>
		<TELL " to the simmering stew?">
		<COND (<YES?> <REMOVE-ITEM .INGREDIENT "added" T T>)>
	)>
	<CONTINUE-TEXT ,TEXT346-CONTINUED>>

<CONSTANT TEXT347 "The only temple in Brazen is consecrated to Molhern. It is a low stone building, artfully fashioned to reflect the style of ancient menhirs.||The priest cannot induct you into the inner mysteries of Molhern's worship. \"I am not senior enough for that, but I can grant blessings.\"">
<CONSTANT CHOICES347 <LTABLE YOU-ARE-AN IF-NOT>>

<ROOM STORY347
	(IN ROOMS)
	(DESC "347")
	(STORY TEXT347)
	(CHOICES CHOICES347)
	(DESTINATIONS <PLTABLE STORY517 STORY498>)
	(REQUIREMENTS <PLTABLE TITLE-ILLUMINATE-MOLHERN NONE>)
	(TYPES <PLTABLE R-TITLE R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT348 "To keep the crew busy you set them to making a thorough inspection of the ship. It is soon discovered that someone has been breaking into the food supplies. You have a stowaway on board.">

<ROOM STORY348
	(IN ROOMS)
	(DESC "348")
	(STORY TEXT348)
	(CHOICES CHOICES-CODEWORD)
	(DESTINATIONS <PLTABLE STORY049 STORY120>)
	(REQUIREMENTS <PLTABLE CODEWORD-BALUSTER NONE>)
	(TYPES ONE-CODEWORD)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT349 "Half the young men of Vervayens are eager to ship with you, so you have no trouble getting a good stock of volunteers. You cannot get better crew than this on such a small island. \"What now, skipper?\" asks your new cabin boy.">
<CONSTANT CHOICES349 <LTABLE "Visit the market" "Consult the wise woman" "Go to your house" "Put to sea">>

<ROOM STORY349
	(IN ROOMS)
	(DESC "349")
	(STORY TEXT349)
	(EVENTS STORY349-EVENTS)
	(CHOICES CHOICES349)
	(DESTINATIONS <PLTABLE STORY318 STORY390 STORY335 STORY298>)
	(REQUIREMENTS <PLTABLE NONE NONE NONE DOCK-VERVAYENS>)
	(TYPES <PLTABLE R-NONE R-NONE R-NONE R-DOCKED>)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY349-EVENTS ("AUX" SHIP CONDITION)
	<COND (,RUN-ONCE
		<SET SHIP <CHECK-DOCKED ,DOCK-VERVAYENS>>
		<COND (.SHIP
			<SET CONDITION <GETP .SHIP ,P?CONDITION>>
			<COND (<EQUAL? .CONDITION ,CONDITION-POOR> <STORY-RESET-CREW ,CONDITION-AVERAGE .SHIP>)>
		)>
	)>>

<CONSTANT TEXT350 "The stowaway is a runaway slave who has spent his whole life at sea. He has no money, but in return for you letting him stay aboard till you reach port he helps teach your crew what he knows of seafaring.">

<ROOM STORY350
	(IN ROOMS)
	(DESC "350")
	(STORY TEXT350)
	(EVENTS STORY350-EVENTS)
	(CONTINUE STORY078)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY350-EVENTS ("AUX" CONDITION)
	<COND (<AND ,RUN-ONCE ,CURRENT-SHIP>
		<SET CONDITION <GETP ,CURRENT-SHIP ,P?CONDITION>>
		<COND (<N=? .CONDITION ,CONDITION-EXCELLENT>
			<INC .CONDITION>
			<STORY-RESET-CREW .CONDITION ,CURRENT-SHIP>
		)>
	)>>

<ROOM STORY351
	(IN ROOMS)
	(DESC "351")
	(VISITS 0)
	(BACKGROUND STORY351-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY351-BACKGROUND ()
	<COND (<CHECK-VISITS-MORE ,STORY351 3>
		<SETG RESURRECTION-ARRANGEMENTS NONE>
		<RETURN ,STORY123>
	)>
	<RETURN ,STORY069>>

<CONSTANT TEXT352 "Looking south, you can see the shoreline of Ankon-Konu as a faint mauve line beneath a sky of cobalt blue.">
<CONSTANT CHOICES352 <LTABLE "Go south (The Lone and Level Sands)" "Go north" "Go east" "Go west">>

<ROOM STORY352
	(IN ROOMS)
	(DESC "352")
	(STORY TEXT352)
	(CHOICES CHOICES352)
	(DESTINATIONS <PLTABLE STORY-LONE-LEVEL-SANDS STORY370 STORY117 STORY040>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT353 "You tie yourself to the wheel and stand steadfast as the sweet singing of the mermaids wafts across the water. It sounds so lovely, so ethereally unattainable, that you have a wild impulse to hurl yourself into the sea and drift down to meet with the maidens on the sea bed. You even find yourself untying the knots, and you have to punch your fingers against the wheel to make them sore and numb so that you cannot get free.||The ordeal is indescribable. It is like hearing the dying song of your true love, like climbing to the verge of paradise only to slip away at the last instant, like the last day of childhood's innocence...||It ends at last. The crewmen come back on deck with ashen faces. The bosun tells you that you are weeping -- you hadn't noticed. He unties the knots and you stagger below, for a while inconsolable.">

<ROOM STORY353
	(IN ROOMS)
	(DESC "353")
	(STORY TEXT353)
	(CONTINUE STORY300)
	(CODEWORDS <PLTABLE CODEWORD-CERUMEN>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT354 "The approaching vessel announces her hostile intent by hoisting the baleful red pennant of the Reavers. Her oars give her a good burst of speed over short distances, and she is soon bearing down on you.">
<CONSTANT CHOICES354 <LTABLE "Make a run for it" "Parley" "Fight it out">>

<ROOM STORY354
	(IN ROOMS)
	(DESC "354")
	(STORY TEXT353)
	(CHOICES CHOICES354)
	(DESTINATIONS <PLTABLE STORY324 STORY306 STORY286>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT355 "The sky is the colour of thunder. From behind the clouds comes the muttering of a great storm. The sailors chatter in fear. \"It is the voice of Elnir,\" says the cook. \"And he ain't inviting us to dance no blessed jig!\"">
<CONSTANT CHOICES355 <LTABLE "The storm hits with titanic fury, tossing huge waves across the deck">>

<ROOM STORY355
	(IN ROOMS)
	(DESC "355")
	(STORY TEXT355)
	(EVENTS STORY355-EVENTS)
	(CHOICES CHOICES355)
	(DESTINATIONS <PLTABLE <PLTABLE STORY486 STORY718 STORY262>>)
	(REQUIREMENTS STORY-STORM-REQUIREMENTS)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY355-EVENTS ()
	<STORM-AT-SEA ,STORY355 ,STORY648>>

<CONSTANT TEXT356 "The strange women come closer and one of them touches your face with her long dry fingers. Immediately her crowing laughter turns to a strangled cry of alarm: \"Warm living flesh! Our powers did not work, my sister--!\"||You take advantage of her surprise to deal her a vicious blow that lays her senseless. Now you have only one of them to fight.">

<ROOM STORY356
	(IN ROOMS)
	(DESC "356")
	(STORY TEXT356)
	(EVENTS STORY356-EVENTS)
	(CONTINUE STORY393)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY356-EVENTS ()
	<COMBAT-MONSTER ,MONSTER-GORGON 4 5 8>
	<CHECK-COMBAT ,MONSTER-GORGON ,STORY356>>

<CONSTANT TEXT357 "Originally there were three gods, those who created the world. These are hardly mentioned in the legends. They are dim, shadowy figures of a primordial age. Even their names bespeak dream-like obscurity: Harkun, He Who Is Like Harkun, and The Third God.||These three having died, their place was taken by powerful demiurges, each with his or her own delineated jurisdiction. Thus there is Tyrnai, overseer of war; Elnir, lord of the sky; irascible Maka, who brings disease and famine if not appeased with sacrifices; Lacuna, lady of the hunt; Nagil, king of the dead; wise Molhern, deity of craftsmen; Sig, who guides the soft footsteps of thieves; the Three Fortunes, goddesses of destiny; and the twin gods Alvir and Valmir, who rule the land under the waves.||Those, at least, are the gods of the northern continent; other countries have their own beliefs. Only a simpleton clings to the concept of one absolute truth.">

<ROOM STORY357
	(IN ROOMS)
	(DESC "357")
	(STORY TEXT357)
	(CONTINUE STORY368)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT358 "On the far side of the cavern you find three copper doors. To open them you will need a verdigris key.">
<CONSTANT CHOICES358 <LTABLE "Open a door" "Turn back">>

<ROOM STORY358
	(IN ROOMS)
	(DESC "358")
	(STORY TEXT358)
	(CHOICES CHOICES358)
	(DESTINATIONS <PLTABLE STORY395 STORY633>)
	(REQUIREMENTS <PLTABLE VERDIGRIS-KEY NONE>)
	(TYPES ONE-ITEM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT359 "\"How about that money I put into your business venture?\" you ask him.||\"Oh yes,\" he says, \"that.\"">

<ROOM STORY359
	(IN ROOMS)
	(DESC "359")
	(STORY TEXT359)
	(EVENTS STORY359-EVENTS)
	(CONTINUE STORY652)
	(FLAGS LIGHTBIT)>

; "TO-DO: Make sure STORY652 has INVESTMENTS property"
<ROUTINE STORY359-EVENTS ()
	<CHECK-INVESTMENTS ,STORY652>>

<CONSTANT TEXT360 "By the time the ship has reversed course, the poor surgeon is no longer in sight. \"He's been swept away to the sea gods' hall,\" says the bosun in a voice of great lament.||\"What will we do without a surgeon?\" says the second mate. \"Now I'll have to wait till we get to Dweomer to get my hair cut.\"||Your confidence in your sailing skills has been badly shaken.">

<ROOM STORY360
	(IN ROOMS)
	(DESC "360")
	(STORY TEXT360)
	(EVENTS STORY360-EVENTS)
	(CONTINUE STORY022)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY360-EVENTS ()
	<LOSE-ABILITY ,ABILITY-SCOUTING 1>>

<CONSTANT TEXT361 "The ship lurches with the impact. Timbers groan and crack. Pirates pour over the rail with a lusty yell, eager on seasoning your decks with blood.">

<ROOM STORY361
	(IN ROOMS)
	(DESC "361")
	(STORY TEXT361)
	(EVENTS STORY361-EVENTS)
	(CONTINUE STORY379)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY361-EVENTS ("AUX" ROLL (DICE 2) (MODIFIER -2) (CONDITION 0))
	<COND (<CHECK-PROFESSION ,PROFESSION-WARRIOR> <SET DICE 3>)>
	<COND (,CURRENT-SHIP
		<SET CONDITION <GETP ,CURRENT-SHIP ,P?CONDITION>>
		<COND (<EQUAL? .CONDITION ,CONDITION-POOR>
			<SET MODIFIER -2>
		)(<EQUAL? .CONDITION ,CONDITION-AVERAGE>
			<SET MODIFIER 0>
		)(<EQUAL? .CONDITION ,CONDITION-GOOD>
			<SET MODIFIER 2>
		)(ELSE
			<SET MODIFIER 3>
		)>
	)>
	<PREVENT-DOOM ,STORY361>
	<SET ROLL <RANDOM-EVENT .DICE .MODIFIER T>>
	<COND (<L=? .ROLL 4>
		<EMPHASIZE "Calamity! You are killed!">
		<STORY-JUMP ,STORY123>
	)(<L=? .ROLL 9>
		<EMPHASIZE "Crushing defeat!">
		<LOSE-STAMINA <ROLL-DICE 2> ,DIED-FROM-INJURIES ,STORY361>
		<COND (<IS-ALIVE> <STORY-JUMP ,STORY435>)>
	)(<L=? .ROLL 13>
		<EMPHASIZE "Forced to give in!">
		<LOSE-STAMINA <ROLL-DICE 1> ,DIED-FROM-INJURIES ,STORY361>
		<COND (<IS-ALIVE> <STORY-JUMP ,STORY416>)>
	)(<L=? .ROLL 17>
		<EMPHASIZE "The pirates withdraw!">
		<STORY-JUMP ,STORY311>
	)(ELSE
		<EMPHASIZE "Outright victory!">
	)>>

<CONSTANT TEXT362 "The moon is a dim patch behind the clouds, as if seen through smoked glass. Sentries patrol the fortress walls.">

<ROOM STORY362
	(IN ROOMS)
	(DESC "362")
	(STORY TEXT362)
	(CHOICES CHOICES-THIEVERY)
	(DESTINATIONS <PLTABLE <PLTABLE STORY690 STORY114>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-THIEVERY 13>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT363 "The Reavers notice the medallion that hangs from your neck. One of them steps forward. His bow to the King is clumsy because his stance is skewed by an old back injury, but he speaks with great eloquence: \"Once a great service was done to me by this seafarer. When sore-pressed by Sokaran warships, the god Sig saw fit to send me a saviour. That saviour, O King, was the one who stands before you now -- one to whom I pledged to give aid whenever it was needed.\"||The King would probably rather torture you to death, but Verin Crookback is highly respected among the Reavers. You are granted your freedom.">

<ROOM STORY363
	(IN ROOMS)
	(DESC "363")
	(STORY TEXT363)
	(CONTINUE STORY656)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT364 "You slam open the door and go marching straight up to Lauria's table. Ignoring her companion, you launch straight into a rant which eloquently expresses your feelings towards her. You don't trouble with niceties; your oaths and curses are such that even the shameless Lauria starts to blush.||Her elderly companion removes his monocle and peers at you in amazement.||\"Look, this just won't do,\" he says.||You turn to give him a piece of your mind too, but you find yourself staring at a treetrunk covered in blue moss--||You look all around. What happened to the tavern? All of a sudden you're in the middle of a dense forest!">

<ROOM STORY364
	(IN ROOMS)
	(DESC "364")
	(STORY TEXT364)
	(CONTINUE STORY697)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT365 "The matter is judged a draw. Neither you nor Talanexor are satisfied, but you must abide by the local duelling code. You stomp off without speaking a word to each other.">

<ROOM STORY365
	(IN ROOMS)
	(DESC "365")
	(STORY TEXT365)
	(CONTINUE STORY571)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT366 "Rocks rain down like cannon shells, but you are safely clear of the island and they only throw up plumes of spray far astern. You hold off the shore until the eruption is spent. After a night turned to hellish twilight by the flaming torrents of lava, the volcano lapses back into peaceful slumber.||\"Jiarosh is content,\" says the shaman. \"We can return and rebuild our homes.\"||Filled with gratitude for your help, the shaman rewards you with a blessing of Safety from Storms.">

<ROOM STORY366
	(IN ROOMS)
	(DESC "366")
	(STORY TEXT366)
	(EVENTS STORY366-EVENTS)
	(CONTINUE STORY479)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY366-EVENTS ()
	<GAIN-BLESSING ,BLESSING-SAFETY-FROM-STORMS>>

<CONSTANT TEXT367 "He is happy to have a companion on his quest. You tell your men to take the ship to Yellowport, where you will join them later. Then you climb up behind him and fly off.||The sea whips past far below, then you are over the coast and speeding north. Glimpsed through wispy cloud, the farms and villages look like toys.||The horse rears -- you don't know why. Realizing he is losing control of his mount, the hero urges it closer to the ground.||You can see the treetops when suddenly you slip from the saddle and fall. You crash through branches; leaves whip across your face. Then you hit the ground.">
<CONSTANT TEXT367-CONTINUED "You look up but there is no sign of the horse or its rider.">

<ROOM STORY367
	(IN ROOMS)
	(DESC "367")
	(STORY TEXT367)
	(EVENTS STORY367-EVENTS)
	(CONTINUE STORY-WAR-TORN-KINGDOM)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY367-EVENTS ()
	<LOSE-STAMINA <ROLL-DICE 2> ,DIED-FROM-INJURIES ,STORY367>
	<CONTINUE-TEXT ,TEXT367-CONTINUED>>

<CONSTANT TEXT368 "The college library contains thousands of dusty tomes. Few of them have been properly catalogued.||\"There's something written about just about anything you could mention,\" says the librarian, sweeping his hand along the stacks.||You peer towards the end of the room -- except that it hasn't got one. \"Er ... the stacks look as if they go on for ever.\" you say.||The librarian nods. \"They do. It's a simple infinity spell.\"">
<CONSTANT CHOICES368 <LTABLE "Find the book you're after">>

<ROOM STORY368
	(IN ROOMS)
	(DESC "368")
	(STORY TEXT368)
	(EVENTS STORY368-EVENTS)
	(CHOICES CHOICES368)
	(DESTINATIONS <PLTABLE <PLTABLE STORY386 STORY607>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-MAGIC 15>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY368-EVENTS ()
	<COND (,RUN-ONCE
		<COND (<G=? ,MONEY 50>
			<EMPHASIZE "You pay the library fees.">
			<COST-MONEY 50 ,TEXT-PAID>
		)(ELSE
			<STORY-JUMP ,STORY607>
		)>
	)>>

<CONSTANT TEXT369 "The forest is inhabited by a malevolent unseen spirit that is slowly leeching your life-energy.||You realize you must muster a burst of effort to break out of the wood before you are lost forever.">

<ROOM STORY369
	(IN ROOMS)
	(DESC "369")
	(STORY TEXT369)
	(EVENTS STORY369-EVENTS)
	(CHOICES CHOICES-SCOUTING)
	(DESTINATIONS <PLTABLE <PLTABLE STORY706 STORY388>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-SCOUTING 17>>)
	(TYPES ONE-ABILITY)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY369-EVENTS ()
	<COND (,RUN-ONCE
		<DO (I 1 6)
			<LOSE-ABILITY .I 1>
		>
		<LOSE-STAMINA <ROLL-DICE 1> ,DIED-GREW-WEAKER ,STORY369>
	)>>

<CONSTANT TEXT370 "The ship drifts along in a gentle wind. The slow creak of the ship's timbers and the fluttering of the sails makes a sound that lulls you off to sleep at night.">

<ROOM STORY370
	(IN ROOMS)
	(DESC "370")
	(STORY TEXT370)
	(EVENTS STORY370-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY204 STORY022 STORY478>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 5 8 12> <LTABLE "Nightmares become real" "An uneventful journey" "Man overboard!">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY370-EVENTS ()
	<COND (<AND ,RUN-ONCE <L? ,STAMINA ,MAX-STAMINA>> <GAIN-STAMINA 1>)>>

<ROOM STORY371
	(IN ROOMS)
	(DESC "371")
	(BACKGROUND STORY371-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY371-BACKGROUND ()
	<REMOVE-ITEM ,SELENIUM-ORE F T>
	<TAKE-ITEM ,SELENIUM-WAND>
	<RETURN ,STORY262>>

<CONSTANT TEXT372 "The villagers are furiously angry at you for taking advantage of their goodwill. You are pelted first with rotten fruit, then with cobblestones prised up from the streets.">
<CONSTANT TEXT372-CONTINUED "You rejoin your ship. The plank is hauled up and you hastily cast off.">

<ROOM STORY372
	(IN ROOMS)
	(DESC "372")
	(STORY TEXT372)
	(EVENTS STORY372-EVENTS)
	(CONTINUE STORY298)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY372-EVENTS ()
	<LOSE-STAMINA <ROLL-DICE 1> ,DIED-FROM-INJURIES ,STORY372>
	<DELETE-TITLE ,TITLE-SAVIOUR-VERVAYENS>>

<CONSTANT TEXT373 "The pirates pull alongside and cast grappling hooks to seize your vessel. Within moments they are swarming aboard. You offer them your goods, but plead for the freedom of your crew.">

<ROOM STORY373
	(IN ROOMS)
	(DESC "373")
	(STORY TEXT373)
	(CHOICES CHOICES-CHARISMA)
	(DESTINATIONS <PLTABLE <PLTABLE STORY431 STORY435>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-CHARISMA 15>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT374 "You forgot you were standing at the end of the headland. You take a step back, lose your footing, and fall to your death on the sharp rocks below.">

<ROOM STORY374
	(IN ROOMS)
	(DESC "374")
	(STORY TEXT374)
	(CONTINUE STORY123)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT375 "The Mannekyn People are a race of small winged folk. Their home is in the high caves of Sky Mountain, but some have taken up residence among humankind. One such is the famous Tekshin, whose tavern is a favourite halt for travellers on the road from Wheatfields to Haggart's Corner.">

<ROOM STORY375
	(IN ROOMS)
	(DESC "375")
	(STORY TEXT375)
	(CONTINUE STORY368)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT376 "There is nothing of interest of the trau's body but a pickaxe (COMBAT +2)">

<ROOM STORY376
	(IN ROOMS)
	(DESC "376")
	(STORY TEXT376)
	(CONTINUE STORY358)
	(ITEMS <PLTABLE PICKAXE2>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT377 "There is a sparkle of green light in the gloom. Bending down, you find a sea-green lens. Who could have dropped that? One of the miners? You drop the sea-green lens into your pocket.">

<ROOM STORY377
	(IN ROOMS)
	(DESC "377")
	(STORY TEXT377)
	(CONTINUE STORY396)
	(ITEMS <PLTABLE SEA-GREEN-LENS>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT378 "The crewmen are too drunk to take any notice of your orders.||\"Shtop bleatin' an' have yourself a lil'l drink!\" declares the cabin boy boldly, brandishing a bottle of wine in your face.||You give him a sound buffet for his impertinence and then try to think what to do. You can't sail the ship single-handed. But what if the Reavers turn up while your crew are in this hopeless state?">
<CONSTANT CHOICES378 <LTABLE "Wait till they sober up" "Leave and travel on foot">>

<ROOM STORY378
	(IN ROOMS)
	(DESC "378")
	(STORY TEXT378)
	(CHOICES CHOICES378)
	(DESTINATIONS <PLTABLE STORY397 STORY417>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT379 "The pirates' treasure comprises 900 Shards. Their ship's hold contains 1 Cargo Unit of textiles, which you can add to your own cargo if you have room for it. Your mate suggests taking the pirate captain's head in case it carries a bounty.">
<CONSTANT TEXT379-LEADERSHIP "You've gained a rank after your stirring leadership in battle.">

<ROOM STORY379
	(IN ROOMS)
	(DESC "379")
	(STORY TEXT379)
	(EVENTS STORY379-EVENTS)
	(CONTINUE STORY311)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY379-EVENTS ()
	<GAIN-MONEY 900>
	<STORY-GAIN-CARGO ,CARGO-TEXTILES 1>
	<KEEP-ITEM ,PIRATE-CAPTAINS-HEAD>
	<COND (<G? <RANDOM-EVENT 2 0 T> <GETP ,CURRENT-CHARACTER ,P?RANK>>
		<CONTINUE-TEXT ,TEXT379-LEADERSHIP>
		<GAIN-RANK 1>
		<UPGRADE-STAMINA <ROLL-DICE 1>>
	)>>

<CONSTANT TEXT380 "You stow away in the hold of one of the pirate ships and wait for her to be put to sea.">
<CONSTANT CHOICES380 <LTABLE "Attempt to avoid being discovered">>

<ROOM STORY380
	(IN ROOMS)
	(DESC "380")
	(STORY TEXT380)
	(CHOICES CHOICES380)
	(DESTINATIONS <PLTABLE <PLTABLE STORY419 STORY114>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-THIEVERY 16>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT381 "A ship comes alongside showing the banner of the High King: a golden starburst on a field of azure blue.||\"Long live the King!\" cries your helmsman, a gruff old Harkunan who at heart is a wild romantic.">

<ROOM STORY381
	(IN ROOMS)
	(DESC "381")
	(STORY TEXT381)
	(CHOICES CHOICES-CODEWORD)
	(DESTINATIONS <PLTABLE STORY676 STORY490>)
	(REQUIREMENTS <PLTABLE CODEWORD-DIAMOND NONE>)
	(TYPES ONE-CODEWORD)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT382 "\"Ah,\" says Lauria as you approach her table. \"I don't think I had the chance to introduce my father the last time you were here...\"||You bow to him. \"Sir.\"||\"Father is the Warden of All Hellions College,\" says Lauria.||You'll get further playing in cool this time. \"Are you aware,\" you ask Lauria, \"that because of you I was whipped half to death? Look, I still bear the scars.\"||\"Please,\" says her father, \"I do not care to have you expose yourself to me over dinner. And in any case, those can hardly be called scars.\"||He traces his finger over your injuries, which heal completely.||\"There,\" says Lauria. \"Now perhaps you'll stop being such a pest.\" But she says it with a smile.">

<ROOM STORY382
	(IN ROOMS)
	(DESC "382")
	(STORY TEXT382)
	(EVENTS STORY382-EVENTS)
	(CONTINUE STORY571)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY382-EVENTS ()
	<SETG STAMINA ,MAX-STAMINA>
	<UPGRADE-ABILITY ,ABILITY-CHARISMA 1>
	<DELETE-CODEWORD ,CODEWORD-ANGER>
	<UPDATE-STATUS-LINE>>

<CONSTANT TEXT383 "Talanexor concedes defeat rather than suffer the full effect of your conjurations. A tribunal finds him guilty of besmirching your good name and orders him to pay you 500 Shards by way of compensation. As he counts out the money he gives you a glowering look and says under his breath: \"You'll lie in your grave before you can spend the last of these coins. See if you can deflect that curse!\"||He turns and strides away.">

<ROOM STORY383
	(IN ROOMS)
	(DESC "383")
	(STORY TEXT383)
	(EVENTS STORY383-EVENTS)
	(CONTINUE STORY571)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY383-EVENTS ()
	<GAIN-MONEY 500>
	<GAIN-CODEWORD ,CODEWORD-CHEESE>>

<CONSTANT TEXT384 "The terrified islanders swarm about your ship. Women and children are put in the hold, and any cargo you had is jettisoned. Others must cling to the rigging or perch on the rail. The extra load makes the ship float alarmingly low in the water.||As you put out from the shore, the volcano is already starting to spit out long fiery torrents of lava. But the danger isn't over yet.">

<ROOM STORY384
	(IN ROOMS)
	(DESC "384")
	(STORY TEXT384)
	(EVENTS STORY384-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY486 STORY366>>)
	(REQUIREMENTS <LTABLE <LTABLE 1 0 <PLTABLE 2 7> <LTABLE "The ship capsizes" "Luck is with you">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY384-EVENTS ("AUX" (MODIFIER 0))
	<COND (,RUN-ONCE <RESET-CARGO>)>
	<COND (,CURRENT-SHIP
		<COND (<EQUAL? ,CURRENT-SHIP ,SHIP-GALLEON>
			<INC .MODIFIER>
		)(<EQUAL? ,CURRENT-SHIP ,SHIP-BARQUE>
			<DEC .MODIFIER>
		)>
	)(ELSE
		<DEC .MODIFIER>
	)>
	<RESET-ODDS 1 .MODIFIER ,STORY384>>

<CONSTANT TEXT385 "You manage to convince the hero that it would be unwise to confront the gods. \"Men have been stricken with madness for such prideful folly,\" you remind him.||He agrees at last. \"In that case I must return to the enchantress who lent me this marvellous steed, back in Atticala. Do you wish to join me?\"||\"What of my ship?\"||\"You go ahead and enjoy yourself, skipper,\" says the first mate. \"We'll meet up with you in Port Skios.\"">
<CONSTANT CHOICES385 <LTABLE "Go with the horseman (Legions of the Labyrinth)" "Decline his offer">>

<ROOM STORY385
	(IN ROOMS)
	(DESC "385")
	(STORY TEXT385)
	(CHOICES CHOICES385)
	(DESTINATIONS <PLTABLE STORY-LEGIONS-OF-LABYRINTH STORY135>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT386 "What are you interested in finding out about?">
<CONSTANT CHOICES386 <LTABLE "The Bluewood" "The key of stars" "Estragon" "The Feathered Lands" "Akatsurai" "The gods" "Ghosts" "Trau" "Mannekyn People" "The Uttakin" "Old Harkuna" "The Innis Shoals" "The city of Dangor" "The Shadar" "The Forest of Larun" "Mermaids">>

<ROOM STORY386
	(IN ROOMS)
	(DESC "386")
	(STORY TEXT386)
	(CHOICES CHOICES386)
	(DESTINATIONS <PLTABLE STORY573 STORY591 STORY609 STORY627 STORY645 STORY357 STORY247 STORY663 STORY375 STORY681 STORY698 STORY002 STORY650 STORY668 STORY542 STORY063>)
	(TYPES <PLTABLE R-NONE R-NONE R-NONE R-NONE R-NONE R-NONE R-NONE R-NONE R-NONE R-NONE R-NONE R-NONE R-NONE R-NONE R-NONE R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT387 "You climb back down the cliff to the beach.">
<CONSTANT CHOICES387 <LTABLE "You have a ship" "If not, you have no option but to climb back up and try to make your way through the Bluewood to Dweomer">>

<ROOM STORY387
	(IN ROOMS)
	(DESC "387")
	(STORY TEXT387)
	(CHOICES CHOICES387)
	(DESTINATIONS <PLTABLE STORY122 STORY407>)
	(REQUIREMENTS <PLTABLE DOCK-SORCERERS NONE>)
	(TYPES <PLTABLE R-DOCKED R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT388 "You look back. The path you came along is not there anymore. You are lost in the Bluewood.">
<CONSTANT CHOICES388 <LTABLE "Find your way out again">>

<ROOM STORY388
	(IN ROOMS)
	(DESC "388")
	(STORY TEXT388)
	(CHOICES CHOICES388)
	(DESTINATIONS <PLTABLE <PLTABLE STORY705 STORY369>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-SCOUTING 15>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT389 "It is possible to forge a powerful wand with this substance, but if the alloy is not prepared using exactly the right mixture then the ore could decay explosively.">
<CONSTANT CHOICES389 <LTABLE "Make the attempt" "Don't attempt it -- Leave well enough alone">>

<ROOM STORY389
	(IN ROOMS)
	(DESC "389")
	(STORY TEXT389)
	(CHOICES CHOICES389)
	(DESTINATIONS <PLTABLE <PLTABLE STORY371 STORY708> STORY262>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-MAGIC 16> NONE>)
	(TYPES <PLTABLE R-TEST-ABILITY R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT390 "The wise woman lives a reclusive existence. Her home is a cave in the cliffs high above the village. The islanders turn to her for medicine, soothsaying and the favour of the gods.||She greets you with a sticky yellow smile and waits for you to fill her hand with silver. For 5 Shards she will give you a blessing of Safety from Storms. You can have only one Safety from Storms blessing at a time, and it will work only once.">

<ROOM STORY390
	(IN ROOMS)
	(DESC "390")
	(STORY TEXT390)
	(EVENTS STORY390-EVENTS)
	(CONTINUE STORY335)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY390-EVENTS ()
	<PURCHASE-BLESSING 5 5 NONE ,BLESSING-SAFETY-FROM-STORMS>>

<CONSTANT TEXT391 "Sailors believe that at times like this it is possible to whistle up a wind.">
<CONSTANT CHOICES391 <LTABLE "See if you have the knack">>

<ROOM STORY391
	(IN ROOMS)
	(DESC "391")
	(STORY TEXT391)
	(EVENTS STORY391-EVENTS)
	(CHOICES CHOICES391)
	(DESTINATIONS <PLTABLE <PLTABLE STORY155 STORY624>>)
	(REQUIREMENTS <LTABLE <LTABLE ABILITY-MAGIC 14>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY391-EVENTS ()
	<COND (<CHECK-GOD ,GOD-ALVIR-VALMIR>
		<PUT <GET <GETP ,STORY391 ,P?REQUIREMENTS> 1> 2 12>
	)(ELSE
		<PUT <GET <GETP ,STORY391 ,P?REQUIREMENTS> 1> 2 14>
	)>>

<CONSTANT TEXT392 "The pirates smash their craft against yours and come scuttling across the boarding ladders like big black spiders.">

<ROOM STORY392
	(IN ROOMS)
	(DESC "392")
	(STORY TEXT392)
	(EVENTS STORY392-EVENTS)
	(CONTINUE STORY412)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY392-EVENTS ("AUX" ROLL (DICE 2) (MODIFIER -2) (CONDITION 0))
	<COND (<CHECK-PROFESSION ,PROFESSION-WARRIOR> <SET DICE 3>)>
	<COND (,CURRENT-SHIP
		<SET CONDITION <GETP ,CURRENT-SHIP ,P?CONDITION>>
		<COND (<EQUAL? .CONDITION ,CONDITION-POOR>
			<SET MODIFIER -2>
		)(<EQUAL? .CONDITION ,CONDITION-AVERAGE>
			<SET MODIFIER 0>
		)(<EQUAL? .CONDITION ,CONDITION-GOOD>
			<SET MODIFIER 2>
		)(ELSE
			<SET MODIFIER 3>
		)>
	)>
	<PREVENT-DOOM ,STORY392>
	<SET ROLL <RANDOM-EVENT .DICE .MODIFIER T>>
	<COND (<L=? .ROLL 4>
		<EMPHASIZE "Calamity! You are killed!">
		<STORY-JUMP ,STORY123>
	)(<L=? .ROLL 9>
		<EMPHASIZE "Crushing defeat!">
		<LOSE-STAMINA <ROLL-DICE 2> ,DIED-FROM-INJURIES ,STORY392>
		<COND (<IS-ALIVE> <STORY-JUMP ,STORY435>)>
	)(<L=? .ROLL 13>
		<EMPHASIZE "Forced to give in!">
		<LOSE-STAMINA <ROLL-DICE 1> ,DIED-FROM-INJURIES ,STORY392>
		<COND (<IS-ALIVE> <STORY-JUMP ,STORY416>)>
	)(<L=? .ROLL 17>
		<EMPHASIZE "The pirates withdraw!">
		<STORY-JUMP ,STORY648>
	)(ELSE
		<EMPHASIZE "Outright victory!">
	)>>

<CONSTANT TEXT393 "With the Gorgons dead, the curse is lifted and the villagers come back to life. When they realize you have rescued them, they swear to honour you for ever.||You are feasted for days on end and can recover any lost Stamina points. Then the villagers come to you and say they have another gift -- a ship, crewed by the young men of the island. They are eager to sail with you and seek adventure.">

<ROOM STORY393
	(IN ROOMS)
	(DESC "393")
	(LOCATION LOCATION-VERVAYENS)
	(STORY TEXT393)
	(EVENTS STORY393-EVENTS)
	(CONTINUE STORY298)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY393-EVENTS ("AUX" CONDITION SHIP)
	<COND (<IN? ,SHIP-BRIGANTINE ,SHIPS>
		<COND (<EQUAL? ,CURRENT-SHIP ,SHIP-BRIGANTINE>
			<SET SHIP ,CURRENT-SHIP>
		)(ELSE
			<SET SHIP ,SHIP-BRIGANTINE>
		)>
		<SET CONDITION <GETP .SHIP ,P?CONDITION>>
		<COND (<L? .CONDITION ,CONDITION-AVERAGE> <STORY-RESET-CREW ,CONDITION-AVERAGE .SHIP>)>
		<STORY-SET-DOCK ,DOCK-VERVAYENS .SHIP F>
	)(ELSE
		<MOVE ,SHIP-BRIGANTINE ,SHIPS>
		<STORY-RESET-CREW ,CONDITION-AVERAGE ,SHIP-BRIGANTINE>
		<STORY-SET-DOCK ,DOCK-VERVAYENS ,SHIP-BRIGANTINE F>
		<COND (<NOT ,CURRENT-SHIP> <SETG CURRENT-SHIP ,SHIP-BRIGANTINE>)>
	)>
	<GAIN-TITLE ,TITLE-SAVIOUR-VERVAYENS>>

<CONSTANT TEXT394 "A tunnel winds down steeply from the mine entrance and then forks in two. Rough steps have been hacked into the floor. The rock is so hard that there is no need for timbers to shore up the roof.">
<CONSTANT CHOICES394 <LTABLE "Go to the surface" "Take the left-hand tunnel" "Take the right-hand tunnel">>

<ROOM STORY394
	(IN ROOMS)
	(DESC "394")
	(STORY TEXT394)
	(CHOICES CHOICES394)
	(DESTINATIONS <PLTABLE STORY025 STORY414 STORY434>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT395 "Now choose which door you will open. Each is a magical portal leading to a distant place.">
<CONSTANT CHOICES395 <LTABLE "The left hand door (The War-Torn Kingdom)" "The middle door (The Plains of Howling Darkness)" "The right-hand door">>

; "TO-DO: Verify if candle was used in sections leading to this"
<ROOM STORY395
	(IN ROOMS)
	(DESC "395")
	(STORY TEXT395)
	(EVENTS STORY395-EVENTS)
	(CHOICES CHOICES395)
	(DESTINATIONS <PLTABLE STORY-WAR-TORN-KINGDOM STORY-PLAINS-HOWLING-DARKNESS STORY415>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY395-EVENTS ()
	<COND (,RUN-ONCE
		<COND (<AND <NOT <CHECK-ITEM ,LANTERN>> <CHECK-ITEM ,CANDLE>>
			<REMOVE-ITEM ,CANDLE ,TEXT-USED F T>
		)>
	)>>

<CONSTANT TEXT396 "You can take a pickaxe and a lump of copper ore. There is nothing else to interest you here.">

<ROOM STORY396
	(IN ROOMS)
	(DESC "396")
	(STORY TEXT396)
	(EVENTS STORY396-EVENTS)
	(CONTINUE STORY394)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY396-EVENTS ()
	<KEEP-ITEM ,PICKAXE>
	<KEEP-ITEM ,COPPER-ORE>>

<CONSTANT TEXT397 "Sure enough, just a few hours later, the door of the tavern flies open and a pack of cutthroats come storming in. Most of your crewmen are in no fit state to fight, but you manage to rally a few of them.">

<ROOM STORY397
	(IN ROOMS)
	(DESC "397")
	(STORY TEXT397)
	(EVENTS STORY397-EVENTS)
	(CONTINUE STORY455)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY397-EVENTS ("AUX" ROLL (DICE 2) (MODIFIER 0) (CONDITION 0))
	<COND (<CHECK-PROFESSION ,PROFESSION-WARRIOR> <SET DICE 3>)>
	<COND (,CURRENT-SHIP
		<SET CONDITION <GETP ,CURRENT-SHIP ,P?CONDITION>>
		<COND (<EQUAL? .CONDITION ,CONDITION-EXCELLENT> <SET MODIFIER 2>)>
	)>
	<SET ROLL <RANDOM-EVENT .DICE .MODIFIER T>>
	<COND (<L=? .ROLL 7>
		<EMPHASIZE "You are killed!">
		<STORY-JUMP ,STORY123>
	)(<L=? .ROLL 12>
		<EMPHASIZE "You are captured!">
		<STORY-JUMP ,STORY454>
	)(ELSE
		<EMPHASIZE "You win!">
	)>>

<CONSTANT TEXT398 "You are close-hauled and making slow progress against a contrary wind when another vessel appears off the port bow. She is bearing hard in, and the crew gasp in dismay as they sight the fluttering red pennants of the Reavers.">
<CONSTANT CHOICES398 <LTABLE "Make a run for it" "Parley" "Fight it out">>

<ROOM STORY398
	(IN ROOMS)
	(DESC "398")
	(STORY TEXT398)
	(CHOICES CHOICES398)
	(DESTINATIONS <PLTABLE STORY418 STORY456 STORY474>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT399 "The narrow Straits of Alvir permit safe passage between the Sea of Stilts and the Violet Ocean, assuming you are a skilled enough mariner to steer your vessel through.">

<ROOM STORY399
	(IN ROOMS)
	(DESC "399")
	(STORY TEXT399)
	(CHOICES CHOICES-SCOUTING)
	(DESTINATIONS <PLTABLE <PLTABLE STORY-ISLE-THOUSAND-SPIRES STORY040>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-SCOUTING 14>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT400 "The Reaver King regards you with a baleful half-smile. \"How proudly you stand there before me. Are you not aware that I hold your fate in my hands?\"||He steps forward as though to embrace you, then suddenly brings his fist up in a vicious punch to the gut. You double up, gasping for breath.">
<CONSTANT TEXT400-CONTINUED "You hear him say: \"The only question is whether to kill you at once or have a little fun first.\"">

<ROOM STORY400
	(IN ROOMS)
	(DESC "400")
	(STORY TEXT400)
	(EVENTS STORY400-EVENTS)
	(CHOICES CHOICES-HAVE-NOT)
	(DESTINATIONS <PLTABLE STORY363 STORY638>)
	(REQUIREMENTS <PLTABLE SILVER-MEDALLION NONE>)
	(TYPES ONE-ITEM)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY400-EVENTS ()
	<COND (,RUN-ONCE <LOSE-STAMINA 1 ,DIED-GREW-WEAKER ,STORY400>)>
	<CONTINUE-TEXT ,TEXT400-CONTINUED>>

<CONSTANT TEXT401 "Lauria goes through a doorway. A few moments later an upstairs light comes on and you see her outlined against the window pane. You glance around to find out the name of the street, but you can hardly see ten paces because of the dense fog.||The light goes out. You wait outside until Lauria must be asleep, then you let yourself into the house and tiptoe upstairs.">

<ROOM STORY401
	(IN ROOMS)
	(DESC "401")
	(STORY TEXT401)
	(CHOICES CHOICES-THIEVERY)
	(DESTINATIONS <PLTABLE <PLTABLE STORY421 STORY514>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-THIEVERY 13>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT402 "\"I don't like it skipper,\" says the pilot, gazing at the charts. \"We're steering betwixt Death and the wine-dark sea.\"||Arrant superstition. You will have none of it.">

<ROOM STORY402
	(IN ROOMS)
	(DESC "402")
	(STORY TEXT402)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY511 STORY580 STORY032 STORY530>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 4 5 8 12> <LTABLE "Pirates" "Storm" "An uneventful voyage" "A ghost ship">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT403 "The ship plunges on as though hauled by sea demons. Indeed, some of your crew even claim to have caught glimpses of such creatures, which they say resemble giant horses with manes of green froth plunging neck-deep through the sea.">

<ROOM STORY403
	(IN ROOMS)
	(DESC "403")
	(LOCATION LOCATION-OCEAN)
	(STORY TEXT403)
	(EVENTS STORY403-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY486 STORY468>>)
	(REQUIREMENTS <LTABLE <LTABLE 2 0 <PLTABLE 6 13> <LTABLE "Abandon ship!" "The tempest passes">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY403-EVENTS ("AUX" (MODIFIER 0))
	<COND (,CURRENT-SHIP
		<COND (<EQUAL? ,CURRENT-SHIP ,SHIP-BARQUE>
			<SET MODIFIER -1>
		)(<EQUAL? ,CURRENT-SHIP ,SHIP-BARQUE>
			<SET MODIFIER 1>
		)>
	)(ELSE
		<SET MODIFIER -1>
	)>
	<RESET-ODDS 2 .MODIFIER ,STORY403>>

<CONSTANT TEXT404 "You raise your arms to the volcano and plead with the god Jiarosh to stay his wrath.">

<ROOM STORY404
	(IN ROOMS)
	(DESC "404")
	(STORY TEXT404)
	(CHOICES CHOICES-SANCTITY)
	(DESTINATIONS <PLTABLE <PLTABLE STORY425 STORY444>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-SANCTITY 14>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT405 "Targdaz's horse flies you back to your castle in a matter of hours.||\"I didn't want to waste the spell,\" he says as it flies off. \"Each time I summon that steed it costs a year of my life.\"||You are more concerned about your ship and crew.">

<ROOM STORY405
	(IN ROOMS)
	(DESC "405")
	(STORY TEXT405)
	(EVENTS STORY405-EVENTS)
	(CONTINUE STORY-COURT-HIDDEN-FACES)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY405-EVENTS ()
	<CRLF>
	<COND (<TEST-ABILITY ,CURRENT-CHARACTER ,ABILITY-CHARISMA 13>
		<EMPHASIZE "The crew followed your orders">
	)(ELSE
		<EMPHASIZE "They sailed off">
		<STORY-LOSE-SHIP>
	)>>

<CONSTANT TEXT406 "There is one ship for sale. She is a barque with a carrying capacity of 1 Cargo Unit; she will cost you 320 Shards.||\"What about the crew?\" you ask the man who is selling her.||\"Men from Marmorek,\" he says. \"Landlubbers everyone of them, but they're willing to learn.\"">

<ROOM STORY406
	(IN ROOMS)
	(DESC "406")
	(LOCATION LOCATION-DWEOMER)
	(BACKGROUND STORY406-BACKGROUND)
	(STORY TEXT406)
	(EVENTS STORY406-EVENTS)
	(CONTINUE STORY100)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY406-BACKGROUND ()
	<COND (<CHECK-ITEM ,SHIPS-DEEDS> <RETURN ,STORY710>)>
	<RETURN ,STORY406>>

<ROUTINE STORY406-EVENTS ()
	<COND (<AND <NOT <IN? ,SHIP-BARQUE ,SHIPS>> <G=? ,MONEY 320>>
		<CRLF>
		<TELL "Buy the ship for 320 " D ,CURRENCY "?">
		<COND (<YES?>
			<COST-MONEY 320 ,TEXT-PAID>
			<MOVE ,SHIP-BARQUE ,SHIPS>
			<STORY-RESET-CREW ,CONDITION-POOR ,SHIP-BARQUE>
			<STORY-SET-DOCK ,DOCK-DWEOMER ,SHIP-BARQUE F>
		)>
	)>>

<CONSTANT TEXT407 "You are at the top of high cliffs swathed in mist. Nearby stands a gloomy tower. Looking north, you are faced by the impenetrable mass of the Bluewood, that trackless forest from whose bourne few travellers return except as mindless shrieking zombies with a ravenous thirst for human blood ...||No, no; that's just an old wives' tale. Or so you tell yourself.">
<CONSTANT CHOICES407 <LTABLE "Venture into the Bluewood" "Go to the tower" "Descend the cliffs">>

<ROOM STORY407
	(IN ROOMS)
	(DESC "407")
	(STORY TEXT407)
	(CHOICES CHOICES407)
	(DESTINATIONS <PLTABLE STORY697 STORY426 STORY387>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<ROOM STORY408
	(IN ROOMS)
	(DESC "408")
	(BACKGROUND STORY408-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY408-BACKGROUND ()
	<COND (<CHECK-ITEM ,WITCH-HAND> <RETURN ,STORY555>)>
	<RETURN ,STORY388>>

<CONSTANT TEXT409 "A chunk of selenium ore is discovered embedded in a coral reef. It is still hot from its fall, causing the sea to hiss each time a wave laps over it.||\"Heaven must be hotter than hell,\" is the bosun's eminently scientific conjecture based on the evidence.">

<ROOM STORY409
	(IN ROOMS)
	(DESC "409")
	(STORY TEXT409)
	(EVENTS STORY409-EVENTS)
	(CONTINUE STORY262)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY409-EVENTS ()
	<TAKE-ITEM ,SELENIUM-ORE>
	<COND (<CHECK-GOD ,GOD-MOLHERN> <STORY-JUMP ,STORY389>)>>

<CONSTANT TEXT410 "The captain rewards you with the contents of his hold: 2 Cargo Units of metals.||\"What will you do now?\" you ask the captain.||He gives a quick bray of exhausted laughter. \"Get my ship into port, sell her, and use the money to buy a tavern. I'll never put to sea again, that's for sure.\"">

<ROOM STORY410
	(IN ROOMS)
	(DESC "410")
	(STORY TEXT410)
	(EVENTS STORY410-EVENTS)
	(CONTINUE STORY137)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY410-EVENTS ()
	<STORY-GAIN-CARGO ,CARGO-METALS 2>>

<CONSTANT TEXT411 "The boats are badly weathered, having been left untended for a long time. You chose the most seaworthy and wait until the tide is in to float her out of the harbour, preferring to cast yourself on the mercy of the sea than risk a night on this eerie island.">

<ROOM STORY411
	(IN ROOMS)
	(DESC "411")
	(STORY TEXT411)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY505 STORY472 STORY430>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 1 0 <PLTABLE 2 4 6> <LTABLE "Wrecked on a beach" "Picked up by pirates" "Reach the mainland">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT412 "The pirates' treasure amounts to 1200 Shards and their ship's hold contains 1 Cargo Unit of spices, which you can add to your own cargo if you have room for it. Your mate also thinks you should take the pirate captain's head as a trophy.">

<ROOM STORY412
	(IN ROOMS)
	(DESC "412")
	(STORY TEXT412)
	(EVENTS STORY412-EVENTS)
	(CONTINUE STORY648)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY412-EVENTS ()
	<GAIN-MONEY 1200>
	<STORY-GAIN-CARGO ,CARGO-SPICES 1>
	<KEEP-ITEM ,PIRATE-CAPTAINS-HEAD>
	<COND (<G? <RANDOM-EVENT 2 0 T> <GETP ,CURRENT-CHARACTER ,P?RANK>>
		<GAIN-RANK 1>
		<UPGRADE-STAMINA <ROLL-DICE 1>>
	)>>

<ROOM STORY413
	(IN ROOMS)
	(DESC "413")
	(BACKGROUND STORY413-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY413-BACKGROUND ()
	<COND (<CHECK-ITEM ,TREASURE-MAP> <RETURN ,STORY132>)>
	<RETURN ,STORY150>>

<CONSTANT TEXT414 "No daylight penetrates this far below ground. In order to proceed you must have a candle, lantern, or other source of light. Otherwise you have no choice but to turn back.">
<CONSTANT CHOICES414 <LTABLE "Proceed along the tunnel" "Turn back">>

<ROOM STORY414
	(IN ROOMS)
	(DESC "414")
	(STORY TEXT414)
	(CHOICES CHOICES414)
	(DESTINATIONS <PLTABLE STORY452 STORY317>)
	(REQUIREMENTS <PLTABLE <PLTABLE CANDLE LANTERN> NONE>)
	(TYPES <PLTABLE R-ANY R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT415 "You emerge from a doorway set in the side of a tree. You now seem to be standing in a forest. The foliage overhead is so thick that you can hardly tell if it is day or night.">

<ROOM STORY415
	(IN ROOMS)
	(DESC "415")
	(STORY TEXT415)
	(CONTINUE STORY697)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT416 "The pirates take your cargo, all your possessions and your cash. They also seize your ship for themselves. They are convinced it is worth leaving you alive, at least.||\"Yes, that way we can prey on you again in the future,\" says their leader with a feral grin. \"Every good fisherman knows to throw some of his catch back!\"||You are put off in Dweomer. As the pirates sail off, you vow revenge.">

<ROOM STORY416
	(IN ROOMS)
	(DESC "416")
	(LOCATION LOCATION-DWEOMER)
	(STORY TEXT416)
	(EVENTS STORY416-EVENTS)
	(CONTINUE STORY100)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY416-EVENTS ()
	<STORY-LOSE-EVERYTHING F>
	<STORY-LOSE-SHIP>>

<ROOM STORY417
	(IN ROOMS)
	(DESC "417")
	(BACKGROUND STORY417-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY417-BACKGROUND ()
	<GAIN-CODEWORD ,CODEWORD-COLOUR>
	<RETURN ,STORY436>>

<ROOM STORY418
	(IN ROOMS)
	(DESC "418")
	(EVENTS STORY418-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY474 STORY013>>)
	(REQUIREMENTS <LTABLE <LTABLE 2 0 <PLTABLE 6 100> <LTABLE "The pirates overtake you" "You outrun them">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY418-EVENTS ("AUX" (MODIFIER 0) (CONDITION 0))
	<SET MODIFIER <GET-RANK ,CURRENT-CHARACTER>>
	<COND (,CURRENT-SHIP
		<SET CONDITION <GETP ,CURRENT-SHIP ,P?CONDITION>>
		<COND (<EQUAL? .CONDITION ,CONDITION-AVERAGE>
			<INC .MODIFIER>
		)(<EQUAL? .CONDITION ,CONDITION-GOOD>
			<SET MODIFIER <+ .MODIFIER 2>>
		)(<EQUAL? .CONDITION ,CONDITION-EXCELLENT>
			<SET MODIFIER <+ .MODIFIER 3>>
		)>
	)>
	<RESET-ODDS 2 .MODIFIER ,STORY418>>

<CONSTANT TEXT419 "After several weeks at sea, the ship puts in at Smogmaw. You wait until the pirates are carousing in town before slipping away, taking with you 50 Shards from their coffers for good measure!">

<ROOM STORY419
	(IN ROOMS)
	(DESC "419")
	(LOCATION LOCATION-SMOGMAW)
	(STORY TEXT419)
	(EVENTS STORY419-EVENTS)
	(CONTINUE STORY044)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY419-EVENTS ()
	<GAIN-MONEY 50>
	<COND (<CHECK-CODEWORD ,CODEWORD-COLOUR> <DELETE-CODEWORD ,CODEWORD-COLOUR>)>>

<CONSTANT TEXT420 "Amcha sleeps in a chamber at the rear of his throne room. He has no personal guards -- that would suggest weakness, and he is a proud man -- but there are regular patrols of sentries around the citadel.">
<CONSTANT CHOICES420 <LTABLE "Sneak in and do the deed without being apprehended">>

<ROOM STORY420
	(IN ROOMS)
	(DESC "420")
	(STORY TEXT420)
	(CHOICES CHOICES420)
	(DESTINATIONS <PLTABLE <PLTABLE STORY585 STORY493>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-THIEVERY 14>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT421 "You could never normally sneak in on a master thief like Lauria, but after a heavy meal of venison and roast parsnips washed down with cider she is sleeping as soundly as a gorged vampire at noonday.">
<CONSTANT CHOICES421 <LTABLE "Rob her" "Kidnap her">>

<ROOM STORY421
	(IN ROOMS)
	(DESC "421")
	(STORY TEXT421)
	(CHOICES CHOICES421)
	(DESTINATIONS <PLTABLE STORY440 STORY459>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT422 "Black clouds boil up suddenly across a clear sky. Within minutes the ship is bucking wildly in an icy gale as sheets of lightning crackle overhead. \"No natural storm could come up so quick,\" says the bosun. \"this is sorcery.\"">
<CONSTANT CHOICES422 <LTABLE "Assuming he's right, you can try to cancel the storm">>

<ROOM STORY422
	(IN ROOMS)
	(DESC "422")
	(STORY TEXT422)
	(CHOICES CHOICES422)
	(DESTINATIONS <PLTABLE <PLTABLE STORY226 STORY403>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-MAGIC 14>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT423 "With a heart full of sadness, you watch your ship drop out of sight beyond the horizon.||Rowing on with dogged perseverance, you wait for the Three Fortunes to deal you another hand.">

<ROOM STORY423
	(IN ROOMS)
	(DESC "423")
	(STORY TEXT423)
	(EVENTS STORY423-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY505 STORY472 STORY430>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 1 0 <PLTABLE 2 4 6> <LTABLE "Wrecked on a beach" "Picked up by pirates" "Reach the mainland">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY423-EVENTS ()
	<COND (,RUN-ONCE <STORY-LOSE-SHIP>)>>

<CONSTANT TEXT424 "The rider is an adventurer from Atticala, the lands that lie across the Sea of Stilts.||\"I am flying to the top of Sky Mountain,\" he declares, \"where I expect to confront the gods themselves!\"">
<CONSTANT CHOICES424 <LTABLE "Ask to go with him" "Advise him not to go" "Bid him farewell">>

<ROOM STORY424
	(IN ROOMS)
	(DESC "424")
	(STORY TEXT424)
	(CHOICES CHOICES424)
	(DESTINATIONS <PLTABLE STORY367 STORY385 STORY135>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT425 "Jiarosh hears and heeds your prayers. The groundshocks die down. The smoke blows away on the wind. All is quiet.||The villagers are jubilant. \"You are a mighty shaman,\" they say. \"Honour us by staying here as our guest.\"">
<CONSTANT CHOICES425 <LTABLE "Stay on the island" "Set to sea">>

<ROOM STORY425
	(IN ROOMS)
	(DESC "425")
	(STORY TEXT425)
	(CHOICES CHOICES425)
	(DESTINATIONS <PLTABLE STORY706 STORY479>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT426 "You peer into the translucent walls of the tower, but it is like looking into a deep green pond. You can make out nothing of what lies within.||Entering, you find a winding staircase which you climb up to a landing. All the way you are beset by tiny stinging creatures.">
<CONSTANT CHOICES426 <LTABLE "Leave the tower" "Press on up the staircase">>

<ROOM STORY426
	(IN ROOMS)
	(DESC "426")
	(STORY TEXT426)
	(EVENTS STORY426-EVENTS)
	(CHOICES CHOICES426)
	(DESTINATIONS <PLTABLE STORY407 STORY680>)
	(TYPES TWO-CHOICES)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY426-EVENTS ()
	<COND (,RUN-ONCE <LOSE-STAMINA <ROLL-DICE 1> ,DIED-FROM-INJURIES ,STORY426>)>>

<CONSTANT TEXT427 "The men raise three cheers as you get hold of the surgeon under one arm and swim back toward the ship. When he has somewhat recovered, the surgeon administers himself a measure of brandy 'for medicinal purposes'.||You are the hero of the hour.">

<ROOM STORY427
	(IN ROOMS)
	(DESC "427")
	(STORY TEXT427)
	(EVENTS STORY427-EVENTS)
	(CONTINUE STORY022)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY427-EVENTS ()
	<COND (<G? <RANDOM-EVENT 2 0 T> <GETP ,CURRENT-CHARACTER ,P?RANK>> <GAIN-RANK 1>)>>

<CONSTANT TEXT428 "The first mate rushes into your cabin one day toward dusk. Deep in calculation over your charts, you barely glance up when he blurts out: \"Captain, an ancient hulk has drifted alongside.\"||\"She's adrift, you say? A derelict?\"||\"No derelict,\" he replies in an agitated voice, \"She has a skeleton crew!\"||\"Hmm.\" You sit back, folding your arms behind you head. \"Perhaps her skipper wants to flesh out his crew with some of our men...\"||\"I think you're right!\" cries the mate, staring past you with wild eyes.||Something is tapping on the window pane -- something that has terrified the mate. You turn to see what it is. A host of ivory faces are leering in through the casement window. It is a skeleton crew indeed! Crashing through the glass, the bony sailors leap among you chittering in ghastly glee.">
<CONSTANT CHOICES428 <LTABLE "Fight them" "Drive them off with prayer" "Cast yourself at their mercy">>

<ROOM STORY428
	(IN ROOMS)
	(DESC "428")
	(STORY TEXT428)
	(CHOICES CHOICES428)
	(DESTINATIONS <PLTABLE STORY539 STORY575 STORY447>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT429 "The wind dies away, leaving the sails sagging. At first the crew jokes about getting a break from duties, but days turn to weeks and the wind does not pick up. All around the sea lies as flat as a mirror. The mood of the crew is grim; many wonder if they will die here, out of sight of land.||You take a drink of water from the barrel on deck. It is the last cupful. Without a wind you are surely doomed. You and your officers could strike out for the mainland in the cutter, but that would mean abandoning the rest of the men.">
<CONSTANT CHOICES429 <LTABLE "Whistle a tune" "Abandon ship in the cutter" "Stay with your crewmen">>

<ROOM STORY429
	(IN ROOMS)
	(DESC "429")
	(STORY TEXT429)
	(CHOICES CHOICES429)
	(DESTINATIONS <PLTABLE STORY391 STORY520 STORY590>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT430 "By the time you arrive in a port you are ankle-deep in water and exhausted from your ordeal. You stumble out of the boat, which goes listing off with the current, and wearily make your way towards the town.">

<ROOM STORY430
	(IN ROOMS)
	(DESC "430")
	(STORY TEXT430)
	(CONTINUE STORY044)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT431 "The pirates take your cargo, your personal belongings and any cash you have on board. To your surprise, they agree to leave you with your ship.||\"In truth, it's not worth the effort of hauling back home,\" remarks the pirate captain acerbically as he goes back aboard his own vessel.||You watch them sail away.">

<ROOM STORY431
	(IN ROOMS)
	(DESC "431")
	(STORY TEXT431)
	(EVENTS STORY431-EVENTS)
	(CONTINUE STORY648)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY431-EVENTS ()
	<STORY-LOSE-EVERYTHING F>
	<RESET-CARGO>>

<CONSTANT TEXT432 "The Gorgons go to their beds only once the moon has set. You peer down at them in the faint lamplight. While they doze, their ophidian tresses sway drowsily on the pillows.">

<ROOM STORY432
	(IN ROOMS)
	(DESC "432")
	(STORY TEXT432)
	(CHOICES CHOICES-SCOUTING)
	(DESTINATIONS <PLTABLE <PLTABLE STORY451 STORY469>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-SCOUTING 10>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT433 "Instead of the idyllic garden you found on your first visit, the place is now a rank wilderness. The lawns have become a waterlogged marsh dotted with fungi. Insects swirl above stagnant ponds and dense weeds have choked the life from the trees. A creeping miasma cloaks out the sunlight. A single breath of this foul air is enough to slay your men.">

<ROOM STORY433
	(IN ROOMS)
	(DESC "433")
	(STORY TEXT433)
	(EVENTS STORY433-EVENTS)
	(CONTINUE STORY123)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY433-EVENTS ()
	<COND (<CHECK-BLESSING ,BLESSING-IMMUNITY-POISON-DISEASE>
		<DELETE-BLESSING ,BLESSING-IMMUNITY-POISON-DISEASE>
		<STORY-JUMP ,STORY064>
	)>>

<CONSTANT TEXT434 "You pass a group of miners on their way back to the surface. They are bony sallow-faced wretches clad in rags. The well-to-do lords who own this mine pay their workers barely more than they need to stay alive.">

<ROOM STORY434
	(IN ROOMS)
	(DESC "434")
	(STORY TEXT434)
	(CHOICES CHOICES-CODEWORD)
	(DESTINATIONS <PLTABLE STORY453 STORY471>)
	(REQUIREMENTS <PLTABLE CODEWORD-CHURCH NONE>)
	(TYPES ONE-CODEWORD)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT435 "The pirates seize you and clap you in iron fetters, then put your own vessel in tow and start the long haul back to the base.||You may still be able to escape from your captors...">

<ROOM STORY435
	(IN ROOMS)
	(DESC "435")
	(STORY TEXT435)
	(EVENTS STORY435-EVENTS)
	(CONTINUE STORY454)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY435-EVENTS ()
	<RESET-CARGO>>

<CONSTANT TEXT436 "You must fend for yourself, surviving on little more than wild berries and cold spring water while you scour the bleak hills.">

<ROOM STORY436
	(IN ROOMS)
	(DESC "436")
	(CHOICES CHOICES-SCOUTING)
	(DESTINATIONS <PLTABLE <PLTABLE STORY546 STORY601>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-SCOUTING 14>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT437 "A pack of hellions erupt out of the sea by night and pelt your vessel with burning pitch. To repulse them you must use a combination of sorcery and holy force.">

<ROOM STORY437
	(IN ROOMS)
	(DESC "437")
	(STORY TEXT437)
	(EVENTS STORY437-EVENTS)
	(CONTINUE STORY-INTO-THE-UNDERWORLD)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY437-EVENTS ("AUX" MAGIC-ROLL SANCTITY-ROLL)
	<CRLF>
	<SET MAGIC-ROLL <TEST-ABILITY ,CURRENT-CHARACTER ,ABILITY-MAGIC 17>>
	<CRLF>
	<SET SANCTITY-ROLL <TEST-ABILITY ,CURRENT-CHARACTER ,ABILITY-SANCTITY 17>>
	<COND (<AND .MAGIC-ROLL .SANCTITY-ROLL>
		<EMPHASIZE "The hellions retreat!">
		<STORY-JUMP ,STORY322>
	)(<OR .MAGIC-ROLL .SANCTITY-ROLL>
		<EMPHASIZE "The ship's aflame!">
		<STORY-JUMP ,STORY249>
	)(ELSE
		<EMPHASIZE "You are carried off to hell!">
	)>>

<CONSTANT TEXT438 "You arrive at the coast to see your own ship riding at anchor. A gang of pirates armed with whips are forcing your own sailors to equip her as a war vessel. Your blood boils at the thought of the Reavers using your ship for their own ends.">
<CONSTANT CHOICES438 <LTABLE "Charge in to rescue your men" "Reconnoitre the island first">>

<ROOM STORY438
	(IN ROOMS)
	(DESC "438")
	(STORY TEXT438)
	(CHOICES CHOICES438)
	(DESTINATIONS <PLTABLE STORY603 STORY655>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT439 "Along with your crew, you cower below decks with your hands over your ears. The ship drifts on untended with no on but Fate at the tiller, and slowly that deathly singing fades into the distance.">

<ROOM STORY439
	(IN ROOMS)
	(DESC "439")
	(STORY TEXT439)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY486 STORY244>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 6 100> <LTABLE "The ship hits a reef" "Adrift in unknown waters">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT440 "You take 250 Shards from her money pouch. It is little enough compensation for all she's put you through in the past. Hearing her moan and turn over in her sleep, you give her the empty money pouch to cuddle. What a grand joke, when the swashbuckling burglar wakes to find she's been robbed!||You quietly let yourself out, pleased to have settled the score after so long.">

<ROOM STORY440
	(IN ROOMS)
	(DESC "440")
	(STORY TEXT440)
	(EVENTS STORY440-EVENTS)
	(CONTINUE STORY675)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY440-EVENTS ()
	<DELETE-CODEWORD ,CODEWORD-ANGER>>

<CONSTANT TEXT441 "Earlier in the day you had to order a lashing for one of the crew because of insubordination. Having escaped from the brig, the wretch comes stealing in on you in the night. If not for a creaky floorboard he would have cut your throat while you slept. As it is, he gets first blow and you must fight him without the benefit of weapon or armour.">

<ROOM STORY441
	(IN ROOMS)
	(DESC "441")
	(STORY TEXT441)
	(EVENTS STORY441-EVENTS)
	(CONTINUE STORY262)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY441-EVENTS ()
	<COMBAT-MONSTER ,MONSTER-RESENTFUL-SAILOR 5 6 3>
	<CHECK-COMBAT ,MONSTER-RESENTFUL-SAILOR ,STORY441 0 NONE 0 F F>>

<CONSTANT TEXT442 "\"It is the god Jiarosh, who dwells inside the mountain!\" shriek the islanders as plumes of thick black smoke start to boil out of the volcano's cone. \"Jiarosh, spare us!\"">
<CONSTANT CHOICES442 <LTABLE "Evacuate the island" "Intercede with the god" "Set sail at once">>

<ROOM STORY442
	(IN ROOMS)
	(DESC "442")
	(STORY TEXT442)
	(CHOICES CHOICES442)
	(DESTINATIONS <PLTABLE STORY384 STORY404 STORY479>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT443 "It is Targdaz, your personal sorcerer.||\"Still gallivanting about on the high seas?\" he says. \"There are much more interesting things afoot back home. I'm on my way there now. Want a ride?\"||\"What about the ship?\"||\"I'm sure these fellows are capable of sailing it to port without you to tell them what to do.\"">
<CONSTANT CHOICES443 <LTABLE "Fly off on Targdaz's horse" "Decline his offer">>

<ROOM STORY443
	(IN ROOMS)
	(DESC "443")
	(STORY TEXT443)
	(CHOICES CHOICES443)
	(DESTINATIONS <PLTABLE STORY405 STORY135>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT444 "Jiarosh, the vulcanian god of the island, regards your entreaties as gross impertinence. He sends forth a spurt of lava and deadly hot gas that incinerates you where you stand.">

<ROOM STORY444
	(IN ROOMS)
	(DESC "444")
	(STORY TEXT444)
	(CONTINUE STORY123)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT445 "These tunnels connect places from all corners of the world. You soon get your bearings. From here you can travel where you wish, emerging by magic through a vent in empty space.">
<CONSTANT CHOICES445
	<LTABLE
		"To Aku (The Court of Hidden Faces)"
		"To Brazen"
		"To Chambara (Lords of the Rising Sun)"
		"To Dangor (The City in the Clouds)"
		"To Dunpala (The Serpent King's Domain)"
		"To Dweomer"
		"To Mithdrak (The Isle of a Thousand Spires)"
		"To Pethumar (The Lone and Level Sands)"
		"To Ringhorn (Cities of Gold and Glory)"
		"To Smogmaw"
		"To Teleos (Legions of the Labyrinth)"
		"To Yarimura (The Plains of Howling Darkness)"
		"To Yellowport (The War-Torn Kingdom)"
	>>

<CONSTANT STORY445-DESTINATIONS
	<PLTABLE
		STORY-COURT-HIDDEN-FACES
		STORY099
		STORY-LORDS-RISING-SUN
		STORY-CITY-IN-CLOUDS
		STORY-SERPENT-KINGS-DOMAIN
		STORY571
		STORY-ISLE-THOUSAND-SPIRES
		STORY-LONE-LEVEL-SANDS
		STORY-CITIES-GOLD-GLORY
		STORY044
		STORY-LEGIONS-OF-LABYRINTH
		STORY-PLAINS-HOWLING-DARKNESS
		STORY-WAR-TORN-KINGDOM
	>>

<CONSTANT STORY445-TYPES
	<PLTABLE
		R-NONE
		R-NONE
		R-NONE
		R-NONE
		R-NONE
		R-NONE
		R-NONE
		R-NONE
		R-NONE
		R-NONE
		R-NONE
		R-NONE
		R-NONE
	>>

<ROOM STORY445
	(IN ROOMS)
	(DESC "445")
	(STORY TEXT445)
	(CHOICES CHOICES445)
	(DESTINATIONS STORY445-DESTINATIONS)
	(TYPES STORY445-TYPES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT446 "The men are horrified at your callousness. \"I thank the gods it wasn't me who fell overboard,\" growls the first mate in a surly fashion.||\"You should say: 'it was not I',\" you point out.||Correcting his grammar only puts him into a darker mood. For the next couple of days, neither he nor anyone else will so much as acknowledge your presence.">

<ROOM STORY446
	(IN ROOMS)
	(DESC "446")
	(STORY TEXT446)
	(CONTINUE STORY677)
	(FLAGS LIGHTBIT)>

<ROOM STORY447
	(IN ROOMS)
	(DESC "447")
	(BACKGROUND STORY447-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY447-BACKGROUND ()
	<COND (<CHECK-TITLE ,TITLE-CHOSEN-NAGIL> <RETURN ,STORY466>)>
	<RETURN ,STORY484>>

<CONSTANT TEXT448 "One of the sailors comes over drenched in blood and hands you a trophy that he hacked from one of the creatures' maws. It is a hydra's tooth.">

<ROOM STORY448
	(IN ROOMS)
	(DESC "448")
	(STORY TEXT448)
	(CONTINUE STORY118)
	(ITEMS <PLTABLE HYDRA-TOOTH>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT449 "You realize that it is too risky to linger here. You scale the cliffs under cover of darkness and find a beach on the far side of the island, where you can make your camp at a safe distance from the cursed village.">

<ROOM STORY449
	(IN ROOMS)
	(DESC "449")
	(STORY TEXT449)
	(CONTINUE STORY177)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT450 "A low prow emerges from a bank of mist close off your starboard bow. As the vessel takes shape, you recognize the bronze shields along the sides that identify it as a slave ship from Uttaku. It heaves ponderously closer -- powered, not by sails, but by huge paddles turned by oxen chained in the bowels of the ship.||\"Normally we could hope to outrun them,\" announces the helmsman. \"But they've come on us right close, and there's hardly a breath of wind for the sails. We'll have to stand and fight.\"||The crew awaits your orders.">
<CONSTANT CHOICES450 <LTABLE "Go alongside and prepare to board" "Ram the Uttakin ship">>

<ROOM STORY450
	(IN ROOMS)
	(DESC "450")
	(STORY TEXT450)
	(CHOICES CHOICES450)
	(DESTINATIONS <PLTABLE STORY523 STORY541>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT451 "You know that the snakes will detect your approach even in darkness, because they can sense your body heat. To counteract this you take a long dip in the ocean until you are shivering with cold. Then you return to slay the Gorgons in their sleep...">

<ROOM STORY451
	(IN ROOMS)
	(DESC "451")
	(STORY TEXT451)
	(CHOICES CHOICES-THIEVERY)
	(DESTINATIONS <PLTABLE <PLTABLE STORY487 STORY506>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-THIEVERY 10>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT452 "To one side of the tunnel is a shaft that has been boarded up. On it is stuck a label which reads: 'Danger. This section of the mines closed on account of spectres. By order of the Mine Supervisor.'">
<CONSTANT CHOICES452 <LTABLE "Break down the boards" "Venture deeper" "Head for the surface">>

<ROOM STORY452
	(IN ROOMS)
	(DESC "452")
	(STORY TEXT452)
	(CHOICES CHOICES452)
	(DESTINATIONS <PLTABLE STORY470 STORY651 STORY025>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT453 "Among the shambling miners you notice one face -- your former helmsman, Gaspar Savaloy. His cheeks, once ruddy and well-larded as any yeoman of Golnir, are now hollow; his formerly ample belly has been lost along with memories of good meals.||\"Mister Savaloy,\" you say. \"Here's a pretty pass, eh?\" It takes a few seconds for recognition to strike. \"Skipper! If it ain't me old skipper what I unjustly abandoned on that isle.\" He starts to sway his head, eyes too parched for tears. \"Help yer old helmsman, skipper.\"||You discover from the mine supervisor that it will cost 30 Shards to pay off Savaloy's indenture.">
<CONSTANT CHOICES453 <LTABLE "Pay to have him free" "Ignore him and walk on">>

<ROOM STORY453
	(IN ROOMS)
	(DESC "453")
	(STORY TEXT453)
	(CHOICES CHOICES453)
	(DESTINATIONS <PLTABLE STORY489 STORY471>)
	(REQUIREMENTS <PLTABLE 30 NONE>)
	(TYPES ONE-MONEY)
	(FLAGS LIGHTBIT)>

<ROOM STORY454
	(IN ROOMS)
	(DESC "454")
	(BACKGROUND STORY454-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY454-BACKGROUND ()
	<GAIN-CODEWORD ,CODEWORD-COLOUR>
	<RETURN ,STORY472>>

<CONSTANT TEXT455 "The tavern is a shambles. Several of your men lie dead in the wreckage. The first mate staggers over and you are horrified to see that one of his eyes has been gouged out in the fighting.||\"Yeah, but you should see the other bloke,\" he quips gamely.||Your men are in no shape to tackle the Reavers now. \"He who fights and runs away, skipper...\" urges the bosun.||You nod in agreement. \"Get back aboard, you swabs. We're setting sail!\"">

<ROOM STORY455
	(IN ROOMS)
	(DESC "455")
	(STORY TEXT455)
	(EVENTS STORY455-EVENTS)
	(CONTINUE STORY164)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY455-EVENTS ()
	<COND (<G? <RANDOM-EVENT 2 0 T> <GETP ,CURRENT-CHARACTER ,P?RANK>>
		<GAIN-RANK 1>
		<UPGRADE-STAMINA <ROLL-DICE 1>>
	)>>

<CONSTANT TEXT456 "The pirates pull alongside and cast grappling hooks to seize your vessel.||Within moments they are swarming aboard. You offer them your goods, but plead for the freedom of your crew.">

<ROOM STORY456
	(IN ROOMS)
	(DESC "456")
	(STORY TEXT456)
	(CHOICES CHOICES-CHARISMA)
	(DESTINATIONS <PLTABLE <PLTABLE STORY416 STORY435>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-CHARISMA 15>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT457 "\"We ought to get under way,\" says the first mate. \"They'll be
back with reinforcements soon.\"||You agree.">

<ROOM STORY457
	(IN ROOMS)
	(DESC "457")
	(EVENTS STORY457-EVENTS)
	(CONTINUE STORY164)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY457-EVENTS ()
	<LOSE-STAMINA <ROLL-DICE 1> ,DIED-FROM-INJURIES ,STORY457>
	<COND (<IS-ALIVE>
		<CONTINUE-TEXT ,TEXT457>
		<KEEP-ITEM ,SWORD2>
		<KEEP-ITEM ,CHAIN-MAIL>
		<DELETE-CODEWORD ,CODEWORD-COLOUR>
	)>>

<CONSTANT TEXT458 "The Reavers have no intention of releasing your ship and crew; slave labour is too valuable.">
<CONSTANT CHOICES458 <LTABLE HAVE-A "Sneak off and rescue your men" "Forget about them and see to your own future">>

<ROOM STORY458
	(IN ROOMS)
	(DESC "458")
	(STORY TEXT458)
	(CHOICES CHOICES458)
	(DESTINATIONS <PLTABLE STORY567 STORY438 STORY476>)
	(REQUIREMENTS <PLTABLE SILVER-MEDALLION NONE NONE>)
	(TYPES <PLTABLE R-ITEM R-NONE R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT459 "Lauria is sleeping like an innocent babe. She barely murmurs in her sleep as you toss her over your shoulder and carry her down to the docks. There you find an Uttakin slaver who is delighted to buy her off you for 150 Shards. \"She has very white skin,\" he says appreciatively.||You nod. \"And a black heart.\"">

<ROOM STORY459
	(IN ROOMS)
	(DESC "459")
	(STORY TEXT459)
	(EVENTS STORY459-EVENTS)
	(CONTINUE STORY100)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY459-EVENTS ()
	<GAIN-MONEY 150>
	<DELETE-CODEWORD ,CODEWORD-ANGER>
	<GAIN-CODEWORD ,CODEWORD-CIVIL>>

<CONSTANT TEXT460 "The lookout reports seeing a meteor plunge out of the sky a few leagues to southward. The first mate thinks it might be worth investigating, but it is not as easy as he thinks. You will have to calculate how far the ship has gone since the meteor fell and then plot a course back.">

<ROOM STORY460
	(IN ROOMS)
	(DESC "460")
	(STORY TEXT460)
	(CHOICES CHOICES-SCOUTING)
	(DESTINATIONS <PLTABLE <PLTABLE STORY409 STORY262>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-SCOUTING 16>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT461 "The fertile slopes of the volcano are covered with lush vegetation. The islanders are pleased to gather round and offer you a feast of fried yams, shellfish stew, barbecued fowl and beer made from pineapple juice.">

<ROOM STORY461
	(IN ROOMS)
	(DESC "461")
	(STORY TEXT461)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY442 STORY706>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 6 12> <LTABLE "The volcano starts to rumble" "The volcano remains dormant">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT462 "It is the wizard Targdaz, whom you freed from imprisonment inside a giant ruby. \"I have come to tell you of a vacant castle in Old Harkuna,\" he says. \"If you'd care to take up residence there I'd be happy to serve as your court sorcerer.\"||\"Fine, but where is it exactly?\"||He throws up his hands. \"I didn't bring a map! It can't be that hard to find.\"||So saying, he flies off.">

<ROOM STORY462
	(IN ROOMS)
	(DESC "462")
	(STORY TEXT462)
	(CONTINUE STORY135)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT463 "You believe that everything points to the bosun as the man responsible for this heinous crime. You order him clapped in irons, but the crew protest that he is a man of unblemished character who would never kill anyone except in an honest brawl.">
<CONSTANT CHOICES463 <LTABLE "Press the matter" "Let it drop">>

<ROOM STORY463
	(IN ROOMS)
	(DESC "463")
	(STORY TEXT463)
	(CHOICES CHOICES463)
	(DESTINATIONS <PLTABLE STORY677 STORY554>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT464 "You walk down into pitch darkness. The scent is of damp loam and ozone. Sorcery is in the very air here, strong enough to make your skin tingle.">
<CONSTANT CHOICES464 <LTABLE "Master the winding paths below the world">>

<ROOM STORY464
	(IN ROOMS)
	(DESC "464")
	(STORY TEXT464)
	(CHOICES CHOICES464)
	(DESTINATIONS <PLTABLE <PLTABLE STORY445 STORY-INTO-THE-UNDERWORLD>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-SCOUTING 17>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT465 "You are gazing over the side when you see a dark shadow rising from the depths. It is huge.||Before you have a chance to shout any warning, colossal tentacles rear up from the water and grapple the ship.">

<ROOM STORY465
	(IN ROOMS)
	(DESC "465")
	(STORY TEXT465)
	(EVENTS STORY465-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY592 STORY610 STORY135>>)
	(REQUIREMENTS <LTABLE <LTABLE 1 0 <LTABLE 9 15 100> <LTABLE "The ship is lost" "You escape in the cutter" "The Kraken departs">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY465-EVENTS ("AUX" (DICE 1) (MODIFIER 0))
	<COND (,CURRENT-SHIP
		<COND (<EQUAL? ,CURRENT-SHIP ,SHIP-BRIGANTINE>
			<SET DICE 2>
		)(<EQUAL? ,CURRENT-SHIP ,SHIP-GALLEON>
			<SET DICE 3>
		)>
	)>
	<SET MODIFIER <GET-RANK ,CURRENT-CHARACTER>>
	<RESET-ODDS .DICE .MODIFIER ,STORY465>>

<CONSTANT TEXT466 "The skeletons have sailed from the Night Country to pay homage to you. Your men are astonished to see them kneel down in your cabin and bow their bald white heads, as docile as page-boys.">

<ROOM STORY466
	(IN ROOMS)
	(DESC "466")
	(VISITS 0)
	(STORY TEXT466)
	(EVENTS STORY466-EVENTS)
	(CONTINUE STORY502)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY466-EVENTS ()
	<COND (<CHECK-VISITS-MORE ,STORY466 1> <STORY-JUMP ,STORY521>)>>

<CONSTANT TEXT467 "You kneel at the end of the headland and concentrate on your prayers. Towards dusk, with the sun a pulsing globe of orange fire on the horizon, you hear a footstep on the rocks behind you.">

<ROOM STORY467
	(IN ROOMS)
	(DESC "467")
	(STORY TEXT467)
	(CHOICES CHOICES-SANCTITY)
	(DESTINATIONS <PLTABLE <PLTABLE STORY485 STORY121>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-SANCTITY 12>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT468 "You reach the coastal waters of the Sleeping Isle.||\"We're going to have to find anchorage here,\" says the first mate when you ask for his report. \"We're in need of fresh supplies and the ship could do with light repairs.\"||You drop anchor in a bay fringed by coconut palms and go ashore in the rowboat. While the men gather supplies, you have the opportunity to explore a little way inland if you wish.">
<CONSTANT CHOICES468 <LTABLE "Explore the island" "Help gather supplies">>

<ROOM STORY468
	(IN ROOMS)
	(DESC "468")
	(STORY TEXT468)
	(CHOICES CHOICES468)
	(DESTINATIONS <PLTABLE STORY265 STORY284>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT469 "You lower yourself to the floor and pad softly over to where the two Gorgons lie sleeping. In that sleep of dreams what death may come ... if only you are stealthy enough.">

<ROOM STORY469
	(IN ROOMS)
	(DESC "469")
	(STORY TEXT469)
	(CHOICES CHOICES-THIEVERY)
	(DESTINATIONS <PLTABLE <PLTABLE STORY487 STORY506>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-THIEVERY 15>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<ROOM STORY470
	(IN ROOMS)
	(DESC "470")
	(VISITS 0)
	(BACKGROUND STORY470-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY470-BACKGROUND ()
	<COND (<CHECK-VISITS-MORE ,STORY470 1> <RETURN ,STORY507>)>
	<RETURN ,STORY488>>

<CONSTANT TEXT471 "No daylight penetrates this far below ground. To proceed you must have a candle, lantern or other source of light. Otherwise you have no choice but to turn back.">
<CONSTANT CHOICES471 <LTABLE "Proceed downwards" "Head for the surface">>

<ROOM STORY471
	(IN ROOMS)
	(DESC "471")
	(STORY TEXT471)
	(CHOICES CHOICES471)
	(DESTINATIONS <PLTABLE STORY509 STORY317>)
	(REQUIREMENTS <PLTABLE <PLTABLE CANDLE LANTERN> NONE>)
	(TYPES <PLTABLE R-ANY R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT472 "You are chained by the pirates and taken inland on one of the Unnumbered Isles. The landscape consists of windswept bluffs under a sky of perpetual racing clouds. A thin cold drizzle comes down in gusts.">

<ROOM STORY472
	(IN ROOMS)
	(DESC "472")
	(STORY TEXT472)
	(EVENTS STORY472-EVENTS)
	(CONTINUE STORY114)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY472-EVENTS ()
	<CRLF>
	<COND (<TEST-ABILITY ,CURRENT-CHARACTER ,ABILITY-SCOUTING 12>
		<GAIN-CODEWORD ,CODEWORD-CHANCE>
	)>>

<CONSTANT TEXT473 "The new Reaver King, Isthmus Jack, is a strutting rogue with a broad bald brow and a beard like shavings of red gold. He has none of Amcha's cold intensity, but behind that cavalier grin you get a feeling of simmering menace.||\"Ah,\" he says, \"you slew my predecessor, I believe?\"">
<CONSTANT CHOICES473 <LTABLE "Admit to killing Amcha" "Deny it">>

<ROOM STORY473
	(IN ROOMS)
	(DESC "473")
	(STORY TEXT473)
	(CHOICES CHOICES473)
	(DESTINATIONS <PLTABLE STORY512 STORY400>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT474 "The pirates ram you, then pour across the rail brandishing their swords. This promises to be a hard fight.">

<ROOM STORY474
	(IN ROOMS)
	(DESC "474")
	(STORY TEXT474)
	(EVENTS STORY474-EVENTS)
	(CONTINUE STORY492)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY474-EVENTS ("AUX" ROLL (DICE 2) (MODIFIER -2) (CONDITION 0))
	<COND (<CHECK-PROFESSION ,PROFESSION-WARRIOR> <SET DICE 3>)>
	<COND (,CURRENT-SHIP
		<SET CONDITION <GETP ,CURRENT-SHIP ,P?CONDITION>>
		<COND (<EQUAL? .CONDITION ,CONDITION-POOR>
			<SET MODIFIER -2>
		)(<EQUAL? .CONDITION ,CONDITION-AVERAGE>
			<SET MODIFIER 0>
		)(<EQUAL? .CONDITION ,CONDITION-GOOD>
			<SET MODIFIER 2>
		)(ELSE
			<SET MODIFIER 3>
		)>
	)>
	<PREVENT-DOOM ,STORY474>
	<SET ROLL <RANDOM-EVENT .DICE .MODIFIER T>>
	<COND (<L=? .ROLL 4>
		<EMPHASIZE "Calamity! You are killed!">
		<STORY-JUMP ,STORY123>
	)(<L=? .ROLL 9>
		<EMPHASIZE "Crushing defeat!">
		<LOSE-STAMINA <ROLL-DICE 2> ,DIED-FROM-INJURIES ,STORY474>
		<COND (<IS-ALIVE> <STORY-JUMP ,STORY435>)>
	)(<L=? .ROLL 13>
		<EMPHASIZE "Forced to give in!">
		<LOSE-STAMINA <ROLL-DICE 1> ,DIED-FROM-INJURIES ,STORY474>
		<COND (<IS-ALIVE> <STORY-JUMP ,STORY416>)>
	)(<L=? .ROLL 17>
		<EMPHASIZE "The pirates withdraw!">
		<STORY-JUMP ,STORY013>
	)(ELSE
		<EMPHASIZE "Outright victory!">
	)>>

<CONSTANT TEXT475 "You are off the coast of Old Harkuna with the Sorcerers' Isle not many leagues to the south-east.">
<CONSTANT CHOICES475 <LTABLE "Steer north" "Steer south" "Steer east" "Steer west" "Make for Ringhorn" "Head for Dweomer">>

<ROOM STORY475
	(IN ROOMS)
	(DESC "475")
	(STORY TEXT475)
	(CHOICES CHOICES475)
	(DESTINATIONS <PLTABLE STORY-COURT-HIDDEN-FACES STORY208 STORY200 STORY021 STORY-COURT-HIDDEN-FACES STORY009>)
	(TYPES SIX-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT476 "You're obliged to fall in with the Reavers, at least for a while. You are given a midshipman's position aboard one of their vessels and told that promotion will depend on how you acquit yourself in this job.">

<ROOM STORY476
	(IN ROOMS)
	(DESC "476")
	(STORY TEXT476)
	(EVENTS STORY476-EVENTS)
	(CONTINUE STORY531)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY476-EVENTS ("AUX" THIEVERY-ROLL SCOUTING-ROLL)
	<CRLF>
	<SET THIEVERY-ROLL <TEST-ABILITY ,CURRENT-CHARACTER ,ABILITY-THIEVERY 14>>
	<CRLF>
	<SET SCOUTING-ROLL <TEST-ABILITY ,CURRENT-CHARACTER ,ABILITY-SCOUTING 14>>
	<COND (<AND .THIEVERY-ROLL .SCOUTING-ROLL>
		<STORY-JUMP ,STORY494>
	)(<OR .THIEVERY-ROLL .SCOUTING-ROLL>
		<STORY-JUMP ,STORY513>
	)>>

<ROOM STORY477
	(IN ROOMS)
	(DESC "477")
	(VISITS 0)
	(BACKGROUND STORY477-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY477-BACKGROUND ()
	<COND (<CHECK-VISITS-MORE ,STORY477 1> <RETURN ,STORY675>)>
	<RETURN ,STORY622>>

<CONSTANT TEXT478 "A gust of wind swings the boom around, knocking the ship's surgeon into the sea. Like most sailors, who prefer the thought of a quick death if their ships should go down, he cannot swim The men crowd along the rail, watching helplessly as he founders in the water.">
<CONSTANT CHOICES478 <LTABLE "Jump in to save the surgeon" "Leave him to drown" "Order the helmsman to put about">>

<ROOM STORY478
	(IN ROOMS)
	(DESC "478")
	(STORY TEXT478)
	(CHOICES CHOICES478)
	(DESTINATIONS <PLTABLE STORY558 STORY446 STORY360>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT479 "You sail away from the Island of Fire. The first mate comes to your cabin to discuss the course you wish to steer.">
<CONSTANT CHOICES479 <LTABLE "Go north" "Go south" "Go east" "Go west">>

<ROOM STORY479
	(IN ROOMS)
	(DESC "479")
	(STORY TEXT479)
	(EVENTS STORY-SET-SAIL)
	(CHOICES CHOICES479)
	(DESTINATIONS <PLTABLE STORY246 STORY192 STORY210 STORY303>)
	(TYPES FOUR-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT480 "A flotilla of mossy pontoons comes drifting across the water towards you. They look like floating gardens. As they get closer you can see people and animals moving between brightly coloured tents on each pontoon. They are the sea gypsies, who live on these large clumps of floating weeds.||As soon as they draw alongside, the gypsies clamber aboard without waiting for permission and start shoving a curious assortment of goods towards you.||\"Best prices on the high seas!\" says one with a cavalier grin.">
<CONSTANT CHOICES480 <LTABLE "Buy items" "Sell items" "You're done buying or selling">>

<ROOM STORY480
	(IN ROOMS)
	(DESC "480")
	(STORY TEXT480)
	(CHOICES CHOICES480)
	(DESTINATIONS <PLTABLE FLOTILLA-BUY FLOTILLA-SELL STORY050>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT481 "You give each man a biscuit from the cabin boy's locker and tell him to swallow it. One of the ordinary seamen, a hulking fellow called Timung, is unable to do so. Guilt has left his mouth too dry.||Later, a gold chain that belonged to the victim is found under Timung's pillow, showing that his motive was simple theft. You have no compunction about casting the villain over board to try his luck in battle with the sharks.">

<ROOM STORY481
	(IN ROOMS)
	(DESC "481")
	(STORY TEXT481)
	(EVENTS STORY481-EVENTS)
	(CONTINUE STORY188)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY481-EVENTS ()
	<COND (<G? <RANDOM-EVENT 2 0 T> <GET-ABILITY-SCORE ,CURRENT-CHARACTER ,ABILITY-THIEVERY>>
		<UPGRADE-ABILITY ,ABILITY-THIEVERY 1>
	)>>

<CONSTANT TEXT482 "\"Few reach this far,\" booms a voice. Startled, you whirl around and peer in all directions, but there is nothing to be seen except the pall of leaves and trees like silent sentinels.||The branches of the plane tree move - sluggish serpents stirred to drowsy life, unfolding to reveal a fissure in the earth.||\"Where does it lead?\" you ask the unseen presence.||\"Anywhere you wish, if you have the science to find your way. But to the unskilled it is only a gateway to hell.\"">
<CONSTANT CHOICES482 <LTABLE "Enter the hole" "Turn back">>

<ROOM STORY482
	(IN ROOMS)
	(DESC "482")
	(STORY TEXT482)
	(CHOICES CHOICES482)
	(DESTINATIONS <PLTABLE STORY464 STORY388>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT483 "At dawn you find you are in the Misty Estuary. The helmsman is at a loss to explain it. \"I could have sworn we were a hundred leagues north of here,\" he says.||You are not one to ignore the suggestions of providence. Since some force has seen fit to bring you here, it may be worth staying a while.">

<ROOM STORY483
	(IN ROOMS)
	(DESC "483")
	(LOCATION LOCATION-SMOGMAW)
	(STORY TEXT483)
	(EVENTS STORY483-EVENTS)
	(CONTINUE STORY044)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY483-EVENTS ()
	<COND (,CURRENT-SHIP <STORY-SET-DOCK ,DOCK-SMOGMAW ,CURRENT-SHIP F>)>>

<CONSTANT TEXT484 "Clutched in bony fingers, you and your men are hauled across to the other ship. Shrouds catch a foetid wind and slowly she picks up speed, leaving your own ship to drift abandoned.||You are pressed into service below decks - a harsh servitude from which not even death can bring deliverance. Each day you watch with horror as your flesh dries up and sloughs away, leaving you a macabre living skeleton.||Nothing can save you from undeath - not even any resurrection you may have arranged.">

<ROOM STORY484
	(IN ROOMS)
	(DESC "484")
	(STORY TEXT484)
	(EVENTS STORY484-EVENTS)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY484-EVENTS ()
	<SETG RESURRECTION-ARRANGEMENTS NONE>>

<CONSTANT TEXT485 "You are dazzled from staring so long in the direction of the setting sun, so that all you can see when you turn is the silhouettes of the two tall women who have come to confront you. Their hair seems to move -- not lightly, as though whipped by the sea breeze, but with the oily sluggishness of snakes.">
<CONSTANT CHOICES485 <LTABLE "Attack them" "Freeze" "Retreat">>

<ROOM STORY485
	(IN ROOMS)
	(DESC "485")
	(STORY TEXT485)
	(CHOICES CHOICES485)
	(DESTINATIONS <PLTABLE STORY685 STORY356 STORY374>)
	(TYPES THREE-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT486 "The ship keels over; timbers warp and split; mere anarchy is loosed upon you. Seawater rushes into the broken shell of the hull drowning out the cries of your crewmen.||You can think of nothing now but saving yourself.">

<ROOM STORY486
	(IN ROOMS)
	(DESC "486")
	(STORY TEXT486)
	(EVENTS STORY486-EVENTS)
	(CONTINUE STORY505)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY486-EVENTS (STORY "AUX" (RANK 1))
	<PUTP ,STORY486 ,P?DOOM F>
	<SET RANK <GET-RANK ,CURRENT-CHARACTER>>
	<COND (<G? <RANDOM-EVENT 2> .RANK>
		<EMPHASIZE ,TEXT-DROWNED>
		<STORY-JUMP ,STORY123>
	)(ELSE
		<STORY-LOSE-SHIP>
		<CRLF>
		<TELL "You are swept miraculously towards a shore of white coral sand" ,PERIOD-CR>
		<LOSE-STAMINA <ROLL-DICE 2> ,DIED-GREW-WEAKER ,STORY486>
	)>>

<CONSTANT TEXT487 "Near their bedside is a dagger which you can add to your list of possessions if you wish. Whether you keep it or not, it is a handy tool with which to do your night's business. The Gorgons' necks are tough and fibrous with almost no blood, and once the heads are hacked off the serpentine coiffure wilts like a tom-up weed.">

<ROOM STORY487
	(IN ROOMS)
	(DESC "487")
	(STORY TEXT487)
	(EVENTS STORY487-EVENTS)
	(CONTINUE STORY393)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY487-EVENTS ()
	<KEEP-ITEM ,DAGGER>>

<CONSTANT TEXT488 "The weight of the air above becomes almost palpable as you descend deep into the ground. A trickle of sweat runs down your spine. Each breath you take tastes hot and stale.||Turning a bend in the passage, you see a sight to harrow your soul. Wreathed in silver light, a group of frightful-visaged spectres are turning slowly in the air, dancing a slow minuet to the mournful tune of an invisible harpsichord.">
<CONSTANT CHOICES488 <LTABLE "Use a" "Banish them with holy words" "Leave before they see you">>

<ROOM STORY488
	(IN ROOMS)
	(DESC "488")
	(STORY TEXT488)
	(CHOICES CHOICES488)
	(DESTINATIONS <PLTABLE STORY525 STORY543 STORY561>)
	(REQUIREMENTS <PLTABLE SPECTRAL-VEIL NONE NONE>)
	(TYPES <PLTABLE R-ITEM R-NONE R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT489 "You go back to the mine office and sign the necessary papers.||Gaspar Savaloy falls on his knees to thank you. You look down in a mixture of contempt and pity as he kisses your boots.||\"A tidy reward for mutiny, wouldn't you say, Mister Savaloy?\"||He cannot look you in the eye. \"I'm shamed, skipper; you've shamed me. But I'll make up all I owe you an' more, you see if I don't. I'm bound for Dweomer, where I'll make good. Then I can pay you back.\"||He scurries off.">

<ROOM STORY489
	(IN ROOMS)
	(DESC "489")
	(STORY TEXT489)
	(CODEWORDS CODEWORD-CANCEL)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT490 "You hail the other ship, asking its crew why they serve a monarch who is long dead.||\"Not dead but sleeping,\" counters the captain. \"We are the keepers of the flame until that time when the Rimewater thaws and our liege-lord shall rise up to sweep the Uttakin into the sea.\"||Your first mate leans over and whispers in your ear. \"Fanatics, by the sound of it, captain.\"||You shrug. \"Who knows?\"||The royalist ship sails off.">

<ROOM STORY490
	(IN ROOMS)
	(DESC "490")
	(STORY TEXT490)
	(CONTINUE STORY475)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT491 "It is as though night has fallen suddenly in the middle of the day. Thunderheads hunch on the horizon like vast brooding crows. Lightning streaks yellow fire across the tortured sky.||\"Doomsday!\" shrieks the bosun. \"Repent or be damned!\"">

<ROOM STORY491
	(IN ROOMS)
	(DESC "491")
	(STORY TEXT491)
	(EVENTS STORY491-EVENTS)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY157 STORY672 STORY042>>)
	(REQUIREMENTS <LTABLE <LTABLE 1 0 <PLTABLE 4 6 19>>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY491-EVENTS ()
	<STORM-AT-SEA ,STORY491 ,STORY024>>

<CONSTANT TEXT492 "The pirates' treasure amounts to 600 Shards. Their ship's hold contains 1 Cargo Unit of metals, which you can add to your own cargo if you have room for it. The mate advises you take the pirate captain's head, which may bring a reward.||It was your leadership that won the day.">

<ROOM STORY492
	(IN ROOMS)
	(DESC "492")
	(STORY TEXT492)
	(EVENTS STORY492-EVENTS)
	(CONTINUE STORY013)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY492-EVENTS ()
	<GAIN-MONEY 600>
	<STORY-GAIN-CARGO ,CARGO-METALS 1>
	<KEEP-ITEM ,PIRATE-CAPTAINS-HEAD>
	<COND (<G? <RANDOM-EVENT 2 0 T> <GETP ,CURRENT-CHARACTER ,P?RANK>>
		<GAIN-RANK 1>
		<UPGRADE-STAMINA <ROLL-DICE 1>>
	)>>

<CONSTANT TEXT493 "The pirates do not stand on ceremony. You are hauled out on to the high terrace of the citadel and impaled on an iron spike. Your body will hang there, staring sightlessly out to sea, until the carrion birds have eaten their fill.">

<ROOM STORY493
	(IN ROOMS)
	(DESC "493")
	(STORY TEXT493)
	(EVENTS STORY493-EVENTS)
	(CONTINUE STORY123)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY493-EVENTS ()
	<COND (<CHECK-CODEWORD ,CODEWORD-COLOUR> <DELETE-CODEWORD ,CODEWORD-COLOUR>)>
	<COND (<CHECK-CODEWORD ,CODEWORD-CROCUS> <DELETE-CODEWORD ,CODEWORD-CROCUS>)>>

<ROOM STORY494
	(IN ROOMS)
	(DESC "494")
	(VISITS 0)
	(BACKGROUND STORY494-BACKGROUND)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY494-BACKGROUND ()
	<COND (<CHECK-VISITS-MORE ,STORY494 1> <RETURN ,STORY639>)>
	<RETURN ,STORY621>>

<CONSTANT TEXT495 "If your ship is docked here you can put to sea. If not, you could pay for passage to either Dweomer or Metriciens, at a cost of 35 Shards in each case. or to Smogmaw for 15 Shards.">
<CONSTANT CHOICES495 <LTABLE "Put to sea" "Pay for passage to Smogmaw" "Pay for passage to Dweomer" "Pay for passage to Metriciens">>

<ROOM STORY495
	(IN ROOMS)
	(DESC "495")
	(STORY TEXT495)
	(CHOICES CHOICES495)
	(DESTINATIONS <PLTABLE STORY019 STORY535 STORY242 STORY260>)
	(REQUIREMENTS <PLTABLE DOCK-COPPER 15 35 35>)
	(TYPES <PLTABLE R-DOCKED R-MONEY R-MONEY R-MONEY>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT496 "The horse, a magnificent white stallion with a mane of silver threads, drops rapidly out of the sky to alight gently on the deck.">
<CONSTANT CHOICES496 <LTABLE HAVE-CODEWORD HAVE-CODEWORD IF-NOT>>

<ROOM STORY496
	(IN ROOMS)
	(DESC "496")
	(STORY TEXT496)
	(CHOICES CHOICES496)
	(DESTINATIONS <PLTABLE STORY462 STORY443 STORY424>)
	(REQUIREMENTS <PLTABLE CODEWORD-DRAGON CODEWORD-EDIFICE NONE>)
	(TYPES <PLTABLE R-CODEWORD R-CODEWORD R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT497 "The mountain turns out to be a hollow rocky shell with steps winding down inside it. You stand at the top and gaze down the deep shaft. A faint sulphurous tang rises on the wind from far below.">
<CONSTANT CHOICES497 <LTABLE "Descend the steps" "Return down the mountainside">>

<ROOM STORY497
	(IN ROOMS)
	(DESC "497")
	(STORY TEXT497)
	(CHOICES CHOICES497)
	(DESTINATIONS <PLTABLE STORY-INTO-THE-UNDERWORLD STORY606>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT498 "A blessing costs 20 Shards if you are an initiate, 40 Shards otherwise. You cannot buy a blessing from Molhem if you already have one.||Molhem's blessing allows you a second attempt at any one failed MAGIC roll. After the second roll (whether successful or not) the blessing is used up.">

<ROOM STORY498
	(IN ROOMS)
	(DESC "498")
	(STORY TEXT498)
	(EVENTS STORY498-EVENTS)
	(CONTINUE STORY099)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY498-EVENTS ()
	<PURCHASE-BLESSING 40 20 ,GOD-MOLHEM ,BLESSING-MAGIC>>

<CONSTANT TEXT499 "There is an old adage: set a thief to catch a thief. Presumably, with a little leeway, the same principle should mean that any crafty rogue can spot the loopholes in a villain's alibi.">

<ROOM STORY499
	(IN ROOMS)
	(DESC "499")
	(STORY TEXT499)
	(CHOICES CHOICES-THIEVERY)
	(DESTINATIONS <PLTABLE <PLTABLE STORY481 STORY463>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-THIEVERY 14>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT500 "The witch's hand casts a spell, animating the head so that it flies from your belt and tries to snap your throat between its teeth.||You must fight the grisly thing.||You cannot flee.">

<ROOM STORY500
	(IN ROOMS)
	(DESC "500")
	(STORY TEXT500)
	(EVENTS STORY500-EVENTS)
	(CONTINUE STORY482)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY500-EVENTS ()
	<COMBAT-MONSTER ,MONSTER-HEAD 7 14 5>
	<COND (<CHECK-COMBAT ,MONSTER-HEAD ,STORY500>
		<LOSE-ITEM ,PIRATE-CAPTAINS-HEAD T>
	)>>

<CONSTANT TEXT501 "You don't even bother to look round when you hear the lookout call, \"Flying fish!\"||A moment later you are hit in the back by a shark that has soared out of the sea on wide fins. Other flying sharks are attacking your crew, who are joining up to deal with them. But you are alone on the poopdeck, and must fight your shark unaided.">

<ROOM STORY501
	(IN ROOMS)
	(DESC "501")
	(STORY TEXT501)
	(EVENTS STORY501-EVENTS)
	(CONTINUE STORY320)
	(DOOM T)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY501-EVENTS ()
	<COMBAT-MONSTER ,MONSTER-FLYING-SHARK 9 10 27>
	<CHECK-COMBAT ,MONSTER-FLYING-SHARK ,STORY501 0 NONE 0 T F>>

<CONSTANT TEXT502 "The jaw of the skeletal captain drops open and a chilling voice issues forth: \"Go to Chompo in Akatsurai. There you will find a clue that will lead you to the tomb of the necromancer Dawatsu Morituri, whom you must set free. This is our dread lord's command.\"||They return to their vessel and sail off.">

<ROOM STORY502
	(IN ROOMS)
	(DESC "502")
	(STORY TEXT502)
	(CONTINUE STORY321)
	(CODEWORDS <PLTABLE CODEWORD-CENOTAPH>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT503 "The shrine consists of nothing more than an obelisk of smooth green stone raised on a sandbank out in the estuary. The priest tells you that to gain a blessing you must swim out to the obelisk.">
<CONSTANT CHOICES503 <LTABLE TEXT-ROLL-SCOUTING "Don't make the attempt">>

<ROOM STORY503
	(IN ROOMS)
	(DESC "503")
	(STORY TEXT503)
	(CHOICES CHOICES503)
	(DESTINATIONS <PLTABLE <PLTABLE STORY147 STORY165> STORY044>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-SCOUTING 11> NONE>)
	(TYPES <PLTABLE R-TEST-ABILITY R-NONE>)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT504 "You sail into the stretch of ocean known as the Sea of Reeds, which lies between Braelak and the Unnumbered Isles.">

<ROOM STORY504
	(IN ROOMS)
	(DESC "504")
	(STORY TEXT504)
	(EVENTS STORY-SET-SAIL)
	(CHOICES CHOICES-RANDOM)
	(DESTINATIONS <PLTABLE <PLTABLE STORY598 STORY480 STORY050 STORY516>>)
	(REQUIREMENTS <PLTABLE <PLTABLE 2 0 <PLTABLE 3 6 8 12> <LTABLE "Storm" "A gypsy caravan?" "An uneventful voyage" "A bank of reeds">>>)
	(TYPES ONE-RANDOM)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT505 "You are on a stretch of shore. Surf pounds on white sand. At the back of the beach is a wall of craggy grey rocks covered with hanging ferns. It is the classic desert island.">

<ROOM STORY505
	(IN ROOMS)
	(DESC "505")
	(STORY TEXT505)
	(CONTINUE STORY177)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT506 "You step softly across the cavern floor. A hiss and spit makes you jump and look over your shoulder, but it is only a damp log gleaming sullenly in the embers of the hearth.||You look back at the beds. With a thrill of alarm you see they are now empty.">

<ROOM STORY506
	(IN ROOMS)
	(DESC "506")
	(STORY TEXT506)
	(CONTINUE STORY121)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT507 "You descend into a small chamber where some boxes are stacked up. Four men who are playing cards by the light of an oil lamp turn to you with startled looks. Before you can say a word, they have drawn cudgels from inside their jerkins and are advancing to do business.">

<ROOM STORY507
	(IN ROOMS)
	(DESC "507")
	(STORY TEXT507)
	(CHOICES CHOICES-COMBAT)
	(DESTINATIONS <PLTABLE <PLTABLE STORY579 STORY597>>)
	(REQUIREMENTS <PLTABLE <PLTABLE ABILITY-COMBAT 13>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT508 "You are wandering through the picturesque cobbled streets of old Dweomer. The place lies under a perpetual shroud of drizzle, except when thick fog billows in off the sea each morning. Narrow latticed windows give glimpses of warm drawing-rooms inside the colleges.">

<ROOM STORY508
	(IN ROOMS)
	(DESC "508")
	(LOCATION LOCATION-DWEOMER)
	(STORY TEXT508)
	(CHOICES CHOICES-CODEWORD)
	(DESTINATIONS <PLTABLE STORY526 STORY687>)
	(REQUIREMENTS <PLTABLE CODEWORD-CANCEL NONE>)
	(TYPES ONE-CODEWORD)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT509 "You continue down the shaft until you reach the rock face, where there are several wheelbarrows stacked with copper ore. No one is working here at the moment, but the next shift will arrive soon.">

<ROOM STORY509
	(IN ROOMS)
	(DESC "509")
	(VISITS 0)
	(STORY TEXT509)
	(EVENTS STORY509-EVENTS)
	(CONTINUE STORY377)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY509-EVENTS ()
	<COND (<CHECK-VISITS-MORE ,STORY509 1> <STORY-JUMP ,STORY396>)>>

<CONSTANT TEXT510 "People come flocking down from the citadel to watch you sail into the bay. There are hundreds of them - not just the crews of the pirate vessels, but their wives and children too. This is a complete community, just like any number of other towns around the world except that their livelihood rests on bare-faced villainy.">
<CONSTANT CHOICES510 <LTABLE "Impress on them that you are not to be trifled with">>

<ROOM STORY510
	(IN ROOMS)
	(DESC "510")
	(STORY TEXT510)
	(EVENTS STORY510-EVENTS)
	(CHOICES CHOICES-CHARISMA)
	(DESTINATIONS <PLTABLE <PLTABLE STORY656 STORY114>>)
	(REQUIREMENTS <LTABLE <LTABLE ABILITY-CHARISMA 15 0>>)
	(TYPES ONE-ABILITY)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY510-EVENTS ("AUX" (MODIFIER 0) ODDS)
	<COND (,CURRENT-SHIP
		<COND (<EQUAL? ,CURRENT-SHIP ,SHIP-GALLEON> <SET MODIFIER <+ .MODIFIER 2>>)>
		<COND (<EQUAL? <GETP ,CURRENT-SHIP ,P?CONDITION> ,CONDITION-EXCELLENT> <INC .MODIFIER>)>
	)>
	<SET ODDS <GET <GETP ,STORY510 ,P?REQUIREMENTS> 1>>
	<PUT .ODDS 3 .MODIFIER>>

<ROOM STORY511
	(IN ROOMS)
	(DESC "511")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY512
	(IN ROOMS)
	(DESC "512")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY513
	(IN ROOMS)
	(DESC "513")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY514
	(IN ROOMS)
	(DESC "514")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY515
	(IN ROOMS)
	(DESC "515")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY516
	(IN ROOMS)
	(DESC "516")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY517
	(IN ROOMS)
	(DESC "517")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY518
	(IN ROOMS)
	(DESC "518")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY519
	(IN ROOMS)
	(DESC "519")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY520
	(IN ROOMS)
	(DESC "520")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY521
	(IN ROOMS)
	(DESC "521")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY522
	(IN ROOMS)
	(DESC "522")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY523
	(IN ROOMS)
	(DESC "523")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY524
	(IN ROOMS)
	(DESC "524")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY525
	(IN ROOMS)
	(DESC "525")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY526
	(IN ROOMS)
	(DESC "526")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY527
	(IN ROOMS)
	(DESC "527")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY528
	(IN ROOMS)
	(DESC "528")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY529
	(IN ROOMS)
	(DESC "529")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY530
	(IN ROOMS)
	(DESC "530")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY531
	(IN ROOMS)
	(DESC "531")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY532
	(IN ROOMS)
	(DESC "532")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY533
	(IN ROOMS)
	(DESC "533")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY534
	(IN ROOMS)
	(DESC "534")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY535
	(IN ROOMS)
	(DESC "535")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY536
	(IN ROOMS)
	(DESC "536")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY537
	(IN ROOMS)
	(DESC "537")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY538
	(IN ROOMS)
	(DESC "538")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY539
	(IN ROOMS)
	(DESC "539")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY540
	(IN ROOMS)
	(DESC "540")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY541
	(IN ROOMS)
	(DESC "541")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY542
	(IN ROOMS)
	(DESC "542")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY543
	(IN ROOMS)
	(DESC "543")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY544
	(IN ROOMS)
	(DESC "544")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY545
	(IN ROOMS)
	(DESC "545")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY546
	(IN ROOMS)
	(DESC "546")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY547
	(IN ROOMS)
	(DESC "547")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY548
	(IN ROOMS)
	(DESC "548")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY549
	(IN ROOMS)
	(DESC "549")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY550
	(IN ROOMS)
	(DESC "550")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY551
	(IN ROOMS)
	(DESC "551")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY552
	(IN ROOMS)
	(DESC "552")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY553
	(IN ROOMS)
	(DESC "553")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY554
	(IN ROOMS)
	(DESC "554")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY555
	(IN ROOMS)
	(DESC "555")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY556
	(IN ROOMS)
	(DESC "556")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY557
	(IN ROOMS)
	(DESC "557")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY558
	(IN ROOMS)
	(DESC "558")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY559
	(IN ROOMS)
	(DESC "559")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY560
	(IN ROOMS)
	(DESC "560")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY561
	(IN ROOMS)
	(DESC "561")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY562
	(IN ROOMS)
	(DESC "562")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY563
	(IN ROOMS)
	(DESC "563")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY564
	(IN ROOMS)
	(DESC "564")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY565
	(IN ROOMS)
	(DESC "565")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY566
	(IN ROOMS)
	(DESC "566")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY567
	(IN ROOMS)
	(DESC "567")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY568
	(IN ROOMS)
	(DESC "568")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY569
	(IN ROOMS)
	(DESC "569")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY570
	(IN ROOMS)
	(DESC "570")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY571
	(IN ROOMS)
	(DESC "571")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY572
	(IN ROOMS)
	(DESC "572")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY573
	(IN ROOMS)
	(DESC "573")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY574
	(IN ROOMS)
	(DESC "574")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY575
	(IN ROOMS)
	(DESC "575")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY576
	(IN ROOMS)
	(DESC "576")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY577
	(IN ROOMS)
	(DESC "577")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY578
	(IN ROOMS)
	(DESC "578")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY579
	(IN ROOMS)
	(DESC "579")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY580
	(IN ROOMS)
	(DESC "580")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY581
	(IN ROOMS)
	(DESC "581")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY582
	(IN ROOMS)
	(DESC "582")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY583
	(IN ROOMS)
	(DESC "583")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY584
	(IN ROOMS)
	(DESC "584")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY585
	(IN ROOMS)
	(DESC "585")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY586
	(IN ROOMS)
	(DESC "586")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY587
	(IN ROOMS)
	(DESC "587")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY588
	(IN ROOMS)
	(DESC "588")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY589
	(IN ROOMS)
	(DESC "589")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY590
	(IN ROOMS)
	(DESC "590")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY591
	(IN ROOMS)
	(DESC "591")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY592
	(IN ROOMS)
	(DESC "592")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY593
	(IN ROOMS)
	(DESC "593")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY594
	(IN ROOMS)
	(DESC "594")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY595
	(IN ROOMS)
	(DESC "595")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY596
	(IN ROOMS)
	(DESC "596")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY597
	(IN ROOMS)
	(DESC "597")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY598
	(IN ROOMS)
	(DESC "598")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY599
	(IN ROOMS)
	(DESC "599")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY600
	(IN ROOMS)
	(DESC "600")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY601
	(IN ROOMS)
	(DESC "601")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY602
	(IN ROOMS)
	(DESC "602")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY603
	(IN ROOMS)
	(DESC "603")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY604
	(IN ROOMS)
	(DESC "604")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY605
	(IN ROOMS)
	(DESC "605")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY606
	(IN ROOMS)
	(DESC "606")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY607
	(IN ROOMS)
	(DESC "607")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY608
	(IN ROOMS)
	(DESC "608")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY609
	(IN ROOMS)
	(DESC "609")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY610
	(IN ROOMS)
	(DESC "610")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY611
	(IN ROOMS)
	(DESC "611")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY612
	(IN ROOMS)
	(DESC "612")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY613
	(IN ROOMS)
	(DESC "613")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY614
	(IN ROOMS)
	(DESC "614")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY615
	(IN ROOMS)
	(DESC "615")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY616
	(IN ROOMS)
	(DESC "616")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY617
	(IN ROOMS)
	(DESC "617")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY618
	(IN ROOMS)
	(DESC "618")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY619
	(IN ROOMS)
	(DESC "619")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY620
	(IN ROOMS)
	(DESC "620")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY621
	(IN ROOMS)
	(DESC "621")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY622
	(IN ROOMS)
	(DESC "622")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY623
	(IN ROOMS)
	(DESC "623")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY624
	(IN ROOMS)
	(DESC "624")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY625
	(IN ROOMS)
	(DESC "625")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY626
	(IN ROOMS)
	(DESC "626")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY627
	(IN ROOMS)
	(DESC "627")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY628
	(IN ROOMS)
	(DESC "628")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY629
	(IN ROOMS)
	(DESC "629")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY630
	(IN ROOMS)
	(DESC "630")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY631
	(IN ROOMS)
	(DESC "631")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY632
	(IN ROOMS)
	(DESC "632")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY633
	(IN ROOMS)
	(DESC "633")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY634
	(IN ROOMS)
	(DESC "634")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY635
	(IN ROOMS)
	(DESC "635")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY636
	(IN ROOMS)
	(DESC "636")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY637
	(IN ROOMS)
	(DESC "637")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY638
	(IN ROOMS)
	(DESC "638")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY639
	(IN ROOMS)
	(DESC "639")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY640
	(IN ROOMS)
	(DESC "640")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY641
	(IN ROOMS)
	(DESC "641")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY642
	(IN ROOMS)
	(DESC "642")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY643
	(IN ROOMS)
	(DESC "643")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY644
	(IN ROOMS)
	(DESC "644")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY645
	(IN ROOMS)
	(DESC "645")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY646
	(IN ROOMS)
	(DESC "646")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY647
	(IN ROOMS)
	(DESC "647")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY648
	(IN ROOMS)
	(DESC "648")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY649
	(IN ROOMS)
	(DESC "649")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY650
	(IN ROOMS)
	(DESC "650")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY651
	(IN ROOMS)
	(DESC "651")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY652
	(IN ROOMS)
	(DESC "652")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY653
	(IN ROOMS)
	(DESC "653")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY654
	(IN ROOMS)
	(DESC "654")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY655
	(IN ROOMS)
	(DESC "655")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY656
	(IN ROOMS)
	(DESC "656")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY657
	(IN ROOMS)
	(DESC "657")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY658
	(IN ROOMS)
	(DESC "658")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY659
	(IN ROOMS)
	(DESC "659")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY660
	(IN ROOMS)
	(DESC "660")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY661
	(IN ROOMS)
	(DESC "661")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY662
	(IN ROOMS)
	(DESC "662")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY663
	(IN ROOMS)
	(DESC "663")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY664
	(IN ROOMS)
	(DESC "664")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY665
	(IN ROOMS)
	(DESC "665")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY666
	(IN ROOMS)
	(DESC "666")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY667
	(IN ROOMS)
	(DESC "667")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY668
	(IN ROOMS)
	(DESC "668")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY669
	(IN ROOMS)
	(DESC "669")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY670
	(IN ROOMS)
	(DESC "670")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY671
	(IN ROOMS)
	(DESC "671")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY672
	(IN ROOMS)
	(DESC "672")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY673
	(IN ROOMS)
	(DESC "673")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY674
	(IN ROOMS)
	(DESC "674")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY675
	(IN ROOMS)
	(DESC "675")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY676
	(IN ROOMS)
	(DESC "676")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY677
	(IN ROOMS)
	(DESC "677")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY678
	(IN ROOMS)
	(DESC "678")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY679
	(IN ROOMS)
	(DESC "679")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY680
	(IN ROOMS)
	(DESC "680")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY681
	(IN ROOMS)
	(DESC "681")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY682
	(IN ROOMS)
	(DESC "682")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY683
	(IN ROOMS)
	(DESC "683")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY684
	(IN ROOMS)
	(DESC "684")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY685
	(IN ROOMS)
	(DESC "685")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY686
	(IN ROOMS)
	(DESC "686")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY687
	(IN ROOMS)
	(DESC "687")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY688
	(IN ROOMS)
	(DESC "688")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY689
	(IN ROOMS)
	(DESC "689")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY690
	(IN ROOMS)
	(DESC "690")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY691
	(IN ROOMS)
	(DESC "691")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY692
	(IN ROOMS)
	(DESC "692")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY693
	(IN ROOMS)
	(DESC "693")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY694
	(IN ROOMS)
	(DESC "694")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY695
	(IN ROOMS)
	(DESC "695")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY696
	(IN ROOMS)
	(DESC "696")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY697
	(IN ROOMS)
	(DESC "697")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY698
	(IN ROOMS)
	(DESC "698")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY699
	(IN ROOMS)
	(DESC "699")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY700
	(IN ROOMS)
	(DESC "700")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY701
	(IN ROOMS)
	(DESC "701")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY702
	(IN ROOMS)
	(DESC "702")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY703
	(IN ROOMS)
	(DESC "703")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY704
	(IN ROOMS)
	(DESC "704")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY705
	(IN ROOMS)
	(DESC "705")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY706
	(IN ROOMS)
	(DESC "706")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY707
	(IN ROOMS)
	(DESC "707")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY708
	(IN ROOMS)
	(DESC "708")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT709 "You are swept ashore at the mouth of a wide river. Nearby, impaled on the jagged end of a broken branch, a skeleton in rusting armour dangles at the water's edge. Apparently not all shipwrecked mariners are as lucky as you.||Searching the body, you find a sword (COMBAT +1).||Staggering towards trails of smoke that are rising from beyond a copse of olive-green tropical palms, you arrive at a settlement of many thatched-roofed shacks raised on stilts at the river's edge. It is the depot town of Smogmaw, on the great southern continent.">

<ROOM STORY709
	(IN ROOMS)
	(DESC "709")
	(STORY TEXT709)
	(CONTINUE STORY044)
	(ITEMS <PLTABLE SWORD1>)
	(FLAGS LIGHTBIT)>

<ROOM STORY710
	(IN ROOMS)
	(DESC "710")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY711
	(IN ROOMS)
	(DESC "711")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY712
	(IN ROOMS)
	(DESC "712")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY713
	(IN ROOMS)
	(DESC "713")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<CONSTANT TEXT714 "You are washed up on a narrow stretch of beach at the back of a bay surrounded by high mist-shrouded peaks.||A bottle has been swept up on to the shingle beside you. Though your fingers are trembling with cold, you manage to unscrew it. Inside you find a ship's deeds, which you can add to your list of possessions.||After resting to recover your strength, you pick your way up a series of steep paths until you can get a clear view of the island. To the north lies an expanse of glittering blue forest, so there can be no question where you are -- Braelak, the Sorcerers' Isle. Nearer at hand is a tower built of obsidian blocks.">
<CONSTANT CHOICES714 <LTABLE "Enter the forest" "Go to the tower">>

<ROOM STORY714
	(IN ROOMS)
	(DESC "714")
	(LOCATION LOCATION-SORCERERS)
	(STORY TEXT714)
	(EVENTS STORY714-EVENTS)
	(CHOICES CHOICES714)
	(DESTINATIONS <PLTABLE STORY697 STORY426>)
	(TYPES TWO-CHOICES)
	(FLAGS LIGHTBIT)>

<ROUTINE STORY714-EVENTS ()
	<COND (,RUN-ONCE <KEEP-ITEM ,SHIPS-DEEDS>)>>

<ROOM STORY715
	(IN ROOMS)
	(DESC "715")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY716
	(IN ROOMS)
	(DESC "716")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY717
	(IN ROOMS)
	(DESC "717")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

<ROOM STORY718
	(IN ROOMS)
	(DESC "718")
	(VISITS 0)
	(LOCATION NONE)
	(BACKGROUND NONE)
	(STORY NONE)
	(EVENTS NONE)
	(CHOICES NONE)
	(DESTINATIONS NONE)
	(REQUIREMENTS NONE)
	(TYPES NONE)
	(CONTINUE NONE)
	(ITEMS NONE)
	(CODEWORDS NONE)
	(TITLES NONE)
	(INVESTMENTS 0)
	(MONEY 0)
	(DOOM F)
	(VICTORY F)
	(FLAGS LIGHTBIT)>

